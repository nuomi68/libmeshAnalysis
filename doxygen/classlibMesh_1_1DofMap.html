<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>libmesh解析: libMesh::DofMap类 参考</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">libmesh解析
   </div>
   <div id="projectbrief">本工作只是尝试解析原libmesh的代码,供学习使用</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'搜索');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>首页</span></a></li>
      <li class="current"><a href="annotated.html"><span>类</span></a></li>
      <li><a href="files.html"><span>文件</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="搜索" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>类列表</span></a></li>
      <li><a href="classes.html"><span>类索引</span></a></li>
      <li><a href="inherits.html"><span>类继承关系</span></a></li>
      <li><a href="functions.html"><span>类成员</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>全部</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>类</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>命名空间</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>文件</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>函数</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>变量</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>类型定义</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>枚举</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>枚举值</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>友元</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>页</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacelibMesh.html">libMesh</a></li><li class="navelem"><a class="el" href="classlibMesh_1_1DofMap.html">DofMap</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">类</a> &#124;
<a href="#pub-methods">Public 成员函数</a> &#124;
<a href="#pub-static-methods">静态 Public 成员函数</a> &#124;
<a href="#pub-attribs">Public 属性</a> &#124;
<a href="#pro-types">Protected 类型</a> &#124;
<a href="#pro-methods">Protected 成员函数</a> &#124;
<a href="#pro-static-attribs">静态 Protected 属性</a> &#124;
<a href="#pri-types">Private 类型</a> &#124;
<a href="#pri-methods">Private 成员函数</a> &#124;
<a href="#pri-static-methods">静态 Private 成员函数</a> &#124;
<a href="#pri-attribs">Private 属性</a> &#124;
<a href="#friends">友元</a> &#124;
<a href="classlibMesh_1_1DofMap-members.html">所有成员列表</a>  </div>
  <div class="headertitle">
<div class="title">libMesh::DofMap类 参考</div>  </div>
</div><!--header-->
<div class="contents">

<p>This class handles the numbering of degrees of freedom on a mesh.  
 <a href="classlibMesh_1_1DofMap.html#details">更多...</a></p>

<p><code>#include &lt;<a class="el" href="dof__map_8h_source.html">dof_map.h</a>&gt;</code></p>
<div class="dynheader">
类 libMesh::DofMap 继承关系图:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classlibMesh_1_1DofMap__inherit__graph.svg" width="350" height="202"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
<center><span class="legend">[<a href="graph_legend.html">图例</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
类</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap_1_1AugmentSendList.html">AugmentSendList</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Abstract base class to be used to add user-defined parallel degree of freedom couplings.  <a href="classlibMesh_1_1DofMap_1_1AugmentSendList.html#details">更多...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap_1_1AugmentSparsityPattern.html">AugmentSparsityPattern</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Backwards compatibility for prior <a class="el" href="classlibMesh_1_1DofMap_1_1AugmentSparsityPattern.html" title="Backwards compatibility for prior AugmentSparsityPattern users. ">AugmentSparsityPattern</a> users.  <a href="classlibMesh_1_1DofMap_1_1AugmentSparsityPattern.html#details">更多...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public 成员函数</h2></td></tr>
<tr class="memitem:ade33ee85034b79ffb7febd62a9e8fe97"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ade33ee85034b79ffb7febd62a9e8fe97">DofMap</a> (const unsigned int <a class="el" href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">sys_number</a>, MeshBase &amp;mesh)</td></tr>
<tr class="memdesc:ade33ee85034b79ffb7febd62a9e8fe97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#ade33ee85034b79ffb7febd62a9e8fe97">更多...</a><br/></td></tr>
<tr class="separator:ade33ee85034b79ffb7febd62a9e8fe97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addb6136725455c3a28e17193d3edf7ee"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#addb6136725455c3a28e17193d3edf7ee">~DofMap</a> ()</td></tr>
<tr class="memdesc:addb6136725455c3a28e17193d3edf7ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <a href="#addb6136725455c3a28e17193d3edf7ee">更多...</a><br/></td></tr>
<tr class="separator:addb6136725455c3a28e17193d3edf7ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa10200782a0f8fe0c4d3f7bdf10cedc6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#aa10200782a0f8fe0c4d3f7bdf10cedc6">attach_matrix</a> (<a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;matrix)</td></tr>
<tr class="memdesc:aa10200782a0f8fe0c4d3f7bdf10cedc6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Additional matrices may be attached to this <code><a class="el" href="classlibMesh_1_1DofMap.html" title="This class handles the numbering of degrees of freedom on a mesh. ">DofMap</a></code>.  <a href="#aa10200782a0f8fe0c4d3f7bdf10cedc6">更多...</a><br/></td></tr>
<tr class="separator:aa10200782a0f8fe0c4d3f7bdf10cedc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a080083acc01f3035d17895205d1399d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a080083acc01f3035d17895205d1399d4">update_sparsity_pattern</a> (<a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;matrix) const </td></tr>
<tr class="memdesc:a080083acc01f3035d17895205d1399d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Additional matrices may be be temporarily initialized by this <code><a class="el" href="classlibMesh_1_1DofMap.html" title="This class handles the numbering of degrees of freedom on a mesh. ">DofMap</a></code>.  <a href="#a080083acc01f3035d17895205d1399d4">更多...</a><br/></td></tr>
<tr class="separator:a080083acc01f3035d17895205d1399d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42a8ae63f7d7c5cfeb14b93bb78a3a3f"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a42a8ae63f7d7c5cfeb14b93bb78a3a3f">is_attached</a> (<a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;matrix)</td></tr>
<tr class="memdesc:a42a8ae63f7d7c5cfeb14b93bb78a3a3f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Matrices should not be attached more than once.  <a href="#a42a8ae63f7d7c5cfeb14b93bb78a3a3f">更多...</a><br/></td></tr>
<tr class="separator:a42a8ae63f7d7c5cfeb14b93bb78a3a3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04d8855d5a13cb4aff4e997ab34c847e"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a04d8855d5a13cb4aff4e997ab34c847e">distribute_dofs</a> (MeshBase &amp;)</td></tr>
<tr class="memdesc:a04d8855d5a13cb4aff4e997ab34c847e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Distribute dofs on the current mesh.  <a href="#a04d8855d5a13cb4aff4e997ab34c847e">更多...</a><br/></td></tr>
<tr class="separator:a04d8855d5a13cb4aff4e997ab34c847e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49379ce3a542eab41a8f8e44d0f154c2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a49379ce3a542eab41a8f8e44d0f154c2">compute_sparsity</a> (const MeshBase &amp;)</td></tr>
<tr class="memdesc:a49379ce3a542eab41a8f8e44d0f154c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the sparsity pattern for the matrices corresponding to <code>proc_id</code> and sends that data to Linear Algebra packages for preallocation of sparse matrices.  <a href="#a49379ce3a542eab41a8f8e44d0f154c2">更多...</a><br/></td></tr>
<tr class="separator:a49379ce3a542eab41a8f8e44d0f154c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a235d7415e617ce36b0f2af4afc106400"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a235d7415e617ce36b0f2af4afc106400">computed_sparsity_already</a> () const </td></tr>
<tr class="memdesc:a235d7415e617ce36b0f2af4afc106400"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true iff a sparsity pattern has already been computed.  <a href="#a235d7415e617ce36b0f2af4afc106400">更多...</a><br/></td></tr>
<tr class="separator:a235d7415e617ce36b0f2af4afc106400"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d60daee3f791c37d0957d9f367718d2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a3d60daee3f791c37d0957d9f367718d2">set_constrained_sparsity_construction</a> (bool use_constraints)</td></tr>
<tr class="memdesc:a3d60daee3f791c37d0957d9f367718d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the current policy for constructing sparsity patterns: if <code>use_constraints</code> is true (for robustness), we explicitly account for sparsity entries created by constraint matrix pre- and post- application.  <a href="#a3d60daee3f791c37d0957d9f367718d2">更多...</a><br/></td></tr>
<tr class="separator:a3d60daee3f791c37d0957d9f367718d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc0167bd8cd3f4dac4c0ac904c8dc6da"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#acc0167bd8cd3f4dac4c0ac904c8dc6da">constrained_sparsity_construction</a> ()</td></tr>
<tr class="memdesc:acc0167bd8cd3f4dac4c0ac904c8dc6da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true iff the current policy when constructing sparsity patterns is to explicitly account for sparsity entries created by constraint matrix pre- and post- application.  <a href="#acc0167bd8cd3f4dac4c0ac904c8dc6da">更多...</a><br/></td></tr>
<tr class="separator:acc0167bd8cd3f4dac4c0ac904c8dc6da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6481536ea3c70d31fb18fa35bfc88e33"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a6481536ea3c70d31fb18fa35bfc88e33">clear_sparsity</a> ()</td></tr>
<tr class="memdesc:a6481536ea3c70d31fb18fa35bfc88e33"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clears the sparsity pattern.  <a href="#a6481536ea3c70d31fb18fa35bfc88e33">更多...</a><br/></td></tr>
<tr class="separator:a6481536ea3c70d31fb18fa35bfc88e33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02a5778a146177c6965d1bf997878ca4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a02a5778a146177c6965d1bf997878ca4">remove_default_ghosting</a> ()</td></tr>
<tr class="memdesc:a02a5778a146177c6965d1bf997878ca4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove any default ghosting functor(s).  <a href="#a02a5778a146177c6965d1bf997878ca4">更多...</a><br/></td></tr>
<tr class="separator:a02a5778a146177c6965d1bf997878ca4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71555fd980f9337928ae75bc36a1bd4e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a71555fd980f9337928ae75bc36a1bd4e">add_default_ghosting</a> ()</td></tr>
<tr class="memdesc:a71555fd980f9337928ae75bc36a1bd4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add the default functor(s) for coupling and algebraic ghosting.  <a href="#a71555fd980f9337928ae75bc36a1bd4e">更多...</a><br/></td></tr>
<tr class="separator:a71555fd980f9337928ae75bc36a1bd4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae17b27f47b3731f6ce72312edd957bf7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ae17b27f47b3731f6ce72312edd957bf7">add_coupling_functor</a> (GhostingFunctor &amp;coupling_functor, bool to_mesh=true)</td></tr>
<tr class="memdesc:ae17b27f47b3731f6ce72312edd957bf7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a functor which can specify coupling requirements for creation of sparse matrices.  <a href="#ae17b27f47b3731f6ce72312edd957bf7">更多...</a><br/></td></tr>
<tr class="separator:ae17b27f47b3731f6ce72312edd957bf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acecfc7f5984014d7756f6792c782fa39"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#acecfc7f5984014d7756f6792c782fa39">add_coupling_functor</a> (std::shared_ptr&lt; GhostingFunctor &gt; coupling_functor, bool to_mesh=true)</td></tr>
<tr class="memdesc:acecfc7f5984014d7756f6792c782fa39"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a functor which can specify coupling requirements for creation of sparse matrices.  <a href="#acecfc7f5984014d7756f6792c782fa39">更多...</a><br/></td></tr>
<tr class="separator:acecfc7f5984014d7756f6792c782fa39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f8cd289185341279958ce2baaed3fc0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a2f8cd289185341279958ce2baaed3fc0">remove_coupling_functor</a> (GhostingFunctor &amp;coupling_functor)</td></tr>
<tr class="memdesc:a2f8cd289185341279958ce2baaed3fc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes a functor which was previously added to the set of coupling functors, from both this <a class="el" href="classlibMesh_1_1DofMap.html" title="This class handles the numbering of degrees of freedom on a mesh. ">DofMap</a> and from the underlying mesh.  <a href="#a2f8cd289185341279958ce2baaed3fc0">更多...</a><br/></td></tr>
<tr class="separator:a2f8cd289185341279958ce2baaed3fc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a167ad5d7c58f7ef60da5e365764962c1"><td class="memItemLeft" align="right" valign="top">std::set&lt; GhostingFunctor * &gt;<br class="typebreak"/>
::const_iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a167ad5d7c58f7ef60da5e365764962c1">coupling_functors_begin</a> () const </td></tr>
<tr class="memdesc:a167ad5d7c58f7ef60da5e365764962c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Beginning of range of coupling functors.  <a href="#a167ad5d7c58f7ef60da5e365764962c1">更多...</a><br/></td></tr>
<tr class="separator:a167ad5d7c58f7ef60da5e365764962c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13a2755e548a51040ee833c1aca2520b"><td class="memItemLeft" align="right" valign="top">std::set&lt; GhostingFunctor * &gt;<br class="typebreak"/>
::const_iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a13a2755e548a51040ee833c1aca2520b">coupling_functors_end</a> () const </td></tr>
<tr class="memdesc:a13a2755e548a51040ee833c1aca2520b"><td class="mdescLeft">&#160;</td><td class="mdescRight">End of range of coupling functors.  <a href="#a13a2755e548a51040ee833c1aca2520b">更多...</a><br/></td></tr>
<tr class="separator:a13a2755e548a51040ee833c1aca2520b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa387f2af29a1998bc1236a20a9870b64"><td class="memItemLeft" align="right" valign="top">DefaultCoupling &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#aa387f2af29a1998bc1236a20a9870b64">default_coupling</a> ()</td></tr>
<tr class="memdesc:aa387f2af29a1998bc1236a20a9870b64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default coupling functor.  <a href="#aa387f2af29a1998bc1236a20a9870b64">更多...</a><br/></td></tr>
<tr class="separator:aa387f2af29a1998bc1236a20a9870b64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a0c5eeda42bc54bb3ae1c2d05ec5227"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a9a0c5eeda42bc54bb3ae1c2d05ec5227">add_algebraic_ghosting_functor</a> (GhostingFunctor &amp;evaluable_functor, bool to_mesh=true)</td></tr>
<tr class="memdesc:a9a0c5eeda42bc54bb3ae1c2d05ec5227"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a functor which can specify algebraic ghosting requirements for use with distributed vectors.  <a href="#a9a0c5eeda42bc54bb3ae1c2d05ec5227">更多...</a><br/></td></tr>
<tr class="separator:a9a0c5eeda42bc54bb3ae1c2d05ec5227"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e7708655c2f2bece396fb675504af2d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a6e7708655c2f2bece396fb675504af2d">add_algebraic_ghosting_functor</a> (std::shared_ptr&lt; GhostingFunctor &gt; evaluable_functor, bool to_mesh=true)</td></tr>
<tr class="memdesc:a6e7708655c2f2bece396fb675504af2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a functor which can specify algebraic ghosting requirements for use with distributed vectors.  <a href="#a6e7708655c2f2bece396fb675504af2d">更多...</a><br/></td></tr>
<tr class="separator:a6e7708655c2f2bece396fb675504af2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bf50c47e4d226197777f2aef750b47d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a5bf50c47e4d226197777f2aef750b47d">remove_algebraic_ghosting_functor</a> (GhostingFunctor &amp;evaluable_functor)</td></tr>
<tr class="memdesc:a5bf50c47e4d226197777f2aef750b47d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes a functor which was previously added to the set of algebraic ghosting functors, from both this <a class="el" href="classlibMesh_1_1DofMap.html" title="This class handles the numbering of degrees of freedom on a mesh. ">DofMap</a> and from the underlying mesh.  <a href="#a5bf50c47e4d226197777f2aef750b47d">更多...</a><br/></td></tr>
<tr class="separator:a5bf50c47e4d226197777f2aef750b47d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc22ec21b664be90d810a7c28a4d94ba"><td class="memItemLeft" align="right" valign="top">std::set&lt; GhostingFunctor * &gt;<br class="typebreak"/>
::const_iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#acc22ec21b664be90d810a7c28a4d94ba">algebraic_ghosting_functors_begin</a> () const </td></tr>
<tr class="memdesc:acc22ec21b664be90d810a7c28a4d94ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Beginning of range of algebraic ghosting functors.  <a href="#acc22ec21b664be90d810a7c28a4d94ba">更多...</a><br/></td></tr>
<tr class="separator:acc22ec21b664be90d810a7c28a4d94ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a752e6253240ff035da7835c865284225"><td class="memItemLeft" align="right" valign="top">std::set&lt; GhostingFunctor * &gt;<br class="typebreak"/>
::const_iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a752e6253240ff035da7835c865284225">algebraic_ghosting_functors_end</a> () const </td></tr>
<tr class="memdesc:a752e6253240ff035da7835c865284225"><td class="mdescLeft">&#160;</td><td class="mdescRight">End of range of algebraic ghosting functors.  <a href="#a752e6253240ff035da7835c865284225">更多...</a><br/></td></tr>
<tr class="separator:a752e6253240ff035da7835c865284225"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac341c27edd859113d774716d5ad18d9f"><td class="memItemLeft" align="right" valign="top">DefaultCoupling &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ac341c27edd859113d774716d5ad18d9f">default_algebraic_ghosting</a> ()</td></tr>
<tr class="memdesc:ac341c27edd859113d774716d5ad18d9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default algebraic ghosting functor.  <a href="#ac341c27edd859113d774716d5ad18d9f">更多...</a><br/></td></tr>
<tr class="separator:ac341c27edd859113d774716d5ad18d9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57b95cd39743e3277f4e2b80007f33da"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a57b95cd39743e3277f4e2b80007f33da">attach_extra_sparsity_object</a> (<a class="el" href="classlibMesh_1_1SparsityPattern_1_1AugmentSparsityPattern.html">SparsityPattern::AugmentSparsityPattern</a> &amp;asp)</td></tr>
<tr class="memdesc:a57b95cd39743e3277f4e2b80007f33da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attach an object to use to populate the sparsity pattern with extra entries.  <a href="#a57b95cd39743e3277f4e2b80007f33da">更多...</a><br/></td></tr>
<tr class="separator:a57b95cd39743e3277f4e2b80007f33da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5058fffef0da9dcdc175a0ee63f587d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a5058fffef0da9dcdc175a0ee63f587d8">attach_extra_sparsity_function</a> (void(*func)(<a class="el" href="classlibMesh_1_1SparsityPattern_1_1Graph.html">SparsityPattern::Graph</a> &amp;sparsity, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;n_nz, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;n_oz, void *), void *context=nullptr)</td></tr>
<tr class="memdesc:a5058fffef0da9dcdc175a0ee63f587d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attach a function pointer to use as a callback to populate the sparsity pattern with extra entries.  <a href="#a5058fffef0da9dcdc175a0ee63f587d8">更多...</a><br/></td></tr>
<tr class="separator:a5058fffef0da9dcdc175a0ee63f587d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae50b05ef1b5ff63ad103626f5622729d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ae50b05ef1b5ff63ad103626f5622729d">attach_extra_send_list_object</a> (<a class="el" href="classlibMesh_1_1DofMap_1_1AugmentSendList.html">DofMap::AugmentSendList</a> &amp;asl)</td></tr>
<tr class="memdesc:ae50b05ef1b5ff63ad103626f5622729d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attach an object to populate the send_list with extra entries.  <a href="#ae50b05ef1b5ff63ad103626f5622729d">更多...</a><br/></td></tr>
<tr class="separator:ae50b05ef1b5ff63ad103626f5622729d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36f672b01ab7060eb641b946abeff74b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a36f672b01ab7060eb641b946abeff74b">attach_extra_send_list_function</a> (void(*func)(std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;, void *), void *context=nullptr)</td></tr>
<tr class="memdesc:a36f672b01ab7060eb641b946abeff74b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attach a function pointer to use as a callback to populate the send_list with extra entries.  <a href="#a36f672b01ab7060eb641b946abeff74b">更多...</a><br/></td></tr>
<tr class="separator:a36f672b01ab7060eb641b946abeff74b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47865aeb6379c68169e926dd0ecc2b71"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a47865aeb6379c68169e926dd0ecc2b71">prepare_send_list</a> ()</td></tr>
<tr class="memdesc:a47865aeb6379c68169e926dd0ecc2b71"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes the <code>_send_list</code> vector (which may have duplicate entries) and sorts it.  <a href="#a47865aeb6379c68169e926dd0ecc2b71">更多...</a><br/></td></tr>
<tr class="separator:a47865aeb6379c68169e926dd0ecc2b71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f04c34ba9909c7d788196575c619aff"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a7f04c34ba9909c7d788196575c619aff">clear_send_list</a> ()</td></tr>
<tr class="memdesc:a7f04c34ba9909c7d788196575c619aff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clears the <code>_send_list</code> vector.  <a href="#a7f04c34ba9909c7d788196575c619aff">更多...</a><br/></td></tr>
<tr class="separator:a7f04c34ba9909c7d788196575c619aff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a114f4760a9d5c427c0f7e1823ec8b883"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a114f4760a9d5c427c0f7e1823ec8b883">reinit_send_list</a> (MeshBase &amp;mesh)</td></tr>
<tr class="memdesc:a114f4760a9d5c427c0f7e1823ec8b883"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clears the <code>_send_list</code> vector and then rebuilds it.  <a href="#a114f4760a9d5c427c0f7e1823ec8b883">更多...</a><br/></td></tr>
<tr class="separator:a114f4760a9d5c427c0f7e1823ec8b883"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31c127241d3271719ede3d0a6902e9e4"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a31c127241d3271719ede3d0a6902e9e4">get_send_list</a> () const </td></tr>
<tr class="separator:a31c127241d3271719ede3d0a6902e9e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9cdb6dfd5b60e06a971d96d92eee54e"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ac9cdb6dfd5b60e06a971d96d92eee54e">get_n_nz</a> () const </td></tr>
<tr class="separator:ac9cdb6dfd5b60e06a971d96d92eee54e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a355cfed88fa20ed5d74349531f17a18b"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a355cfed88fa20ed5d74349531f17a18b">get_n_oz</a> () const </td></tr>
<tr class="separator:a355cfed88fa20ed5d74349531f17a18b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfe552841b3b6ae8ad0817adc08961ae"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classlibMesh_1_1SparsityPattern_1_1Build.html">SparsityPattern::Build</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#acfe552841b3b6ae8ad0817adc08961ae">get_sparsity_pattern</a> () const </td></tr>
<tr class="separator:acfe552841b3b6ae8ad0817adc08961ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10698e15df1162ca2dc4e9d6517039a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a10698e15df1162ca2dc4e9d6517039a7">add_variable_group</a> (<a class="el" href="classlibMesh_1_1VariableGroup.html">VariableGroup</a> var_group)</td></tr>
<tr class="memdesc:a10698e15df1162ca2dc4e9d6517039a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add an unknown of order <code>order</code> and finite element type <code>type</code> to the system of equations.  <a href="#a10698e15df1162ca2dc4e9d6517039a7">更多...</a><br/></td></tr>
<tr class="separator:a10698e15df1162ca2dc4e9d6517039a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a694b0be4a4514f1d7f0775ddfec78d4b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a694b0be4a4514f1d7f0775ddfec78d4b">set_error_on_cyclic_constraint</a> (bool error_on_cyclic_constraint)</td></tr>
<tr class="memdesc:a694b0be4a4514f1d7f0775ddfec78d4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Specify whether or not we perform an extra (opt-mode enabled) check for constraint loops.  <a href="#a694b0be4a4514f1d7f0775ddfec78d4b">更多...</a><br/></td></tr>
<tr class="separator:a694b0be4a4514f1d7f0775ddfec78d4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af72602b9f4e23db0dbe054bf4dafe123"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#af72602b9f4e23db0dbe054bf4dafe123">set_error_on_constraint_loop</a> (bool error_on_constraint_loop)</td></tr>
<tr class="separator:af72602b9f4e23db0dbe054bf4dafe123"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab59bc8ca645e02067744580fdf4c9616"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classlibMesh_1_1VariableGroup.html">VariableGroup</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ab59bc8ca645e02067744580fdf4c9616">variable_group</a> (const unsigned int c) const </td></tr>
<tr class="separator:ab59bc8ca645e02067744580fdf4c9616"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab36a0dc3c2c457fa8c01c1b0ba37facc"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classlibMesh_1_1Variable.html">Variable</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ab36a0dc3c2c457fa8c01c1b0ba37facc">variable</a> (const unsigned int c) const </td></tr>
<tr class="separator:ab36a0dc3c2c457fa8c01c1b0ba37facc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43aa131ac08b4b6aff6d865e672638da"><td class="memItemLeft" align="right" valign="top">Order&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a43aa131ac08b4b6aff6d865e672638da">variable_order</a> (const unsigned int c) const </td></tr>
<tr class="separator:a43aa131ac08b4b6aff6d865e672638da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9da01b7cbcfcea58b75763f80593344a"><td class="memItemLeft" align="right" valign="top">Order&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a9da01b7cbcfcea58b75763f80593344a">variable_group_order</a> (const unsigned int vg) const </td></tr>
<tr class="separator:a9da01b7cbcfcea58b75763f80593344a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c010bb250d4cd8d65794452f46d141a"><td class="memItemLeft" align="right" valign="top">const FEType &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a0c010bb250d4cd8d65794452f46d141a">variable_type</a> (const unsigned int c) const </td></tr>
<tr class="separator:a0c010bb250d4cd8d65794452f46d141a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a2bcb4503981fc74555ec17a45cb3c3"><td class="memItemLeft" align="right" valign="top">const FEType &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a6a2bcb4503981fc74555ec17a45cb3c3">variable_group_type</a> (const unsigned int vg) const </td></tr>
<tr class="separator:a6a2bcb4503981fc74555ec17a45cb3c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6058ea4ca2ef36bd90f44bcb052a1d1e"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a6058ea4ca2ef36bd90f44bcb052a1d1e">n_variable_groups</a> () const </td></tr>
<tr class="separator:a6058ea4ca2ef36bd90f44bcb052a1d1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee89c467613b296c215421d60d5ae961"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#aee89c467613b296c215421d60d5ae961">n_variables</a> () const </td></tr>
<tr class="separator:aee89c467613b296c215421d60d5ae961"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3262c6d5e69e4a6c07dd9b44d79365d1"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a3262c6d5e69e4a6c07dd9b44d79365d1">var_group_from_var_number</a> (unsigned int var_num) const </td></tr>
<tr class="separator:a3262c6d5e69e4a6c07dd9b44d79365d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cd39b3d232f88b53e993010177ecb29"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a8cd39b3d232f88b53e993010177ecb29">has_blocked_representation</a> () const </td></tr>
<tr class="separator:a8cd39b3d232f88b53e993010177ecb29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2336dd53d13c233c14d7d4389d0702a"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ad2336dd53d13c233c14d7d4389d0702a">block_size</a> () const </td></tr>
<tr class="separator:ad2336dd53d13c233c14d7d4389d0702a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77f8d984574b1bf8886057799e9b0134"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a77f8d984574b1bf8886057799e9b0134">n_dofs</a> () const </td></tr>
<tr class="separator:a77f8d984574b1bf8886057799e9b0134"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39feeb5bedb05e160b5190e26d433605"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a39feeb5bedb05e160b5190e26d433605">n_SCALAR_dofs</a> () const </td></tr>
<tr class="separator:a39feeb5bedb05e160b5190e26d433605"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e8912a9fc6b900604ff23807edadd3b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a8e8912a9fc6b900604ff23807edadd3b">n_local_dofs</a> () const </td></tr>
<tr class="separator:a8e8912a9fc6b900604ff23807edadd3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a765ac72717810e0a86f04ab8a938cd22"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a765ac72717810e0a86f04ab8a938cd22">n_dofs_on_processor</a> (const <a class="el" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> proc) const </td></tr>
<tr class="separator:a765ac72717810e0a86f04ab8a938cd22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cc5678707a3bcb0f64b1cb5c73c813c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a2cc5678707a3bcb0f64b1cb5c73c813c">first_dof</a> (const <a class="el" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> proc) const </td></tr>
<tr class="separator:a2cc5678707a3bcb0f64b1cb5c73c813c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe4e2d426832365090b199b7083c0a77"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#afe4e2d426832365090b199b7083c0a77">first_dof</a> () const </td></tr>
<tr class="separator:afe4e2d426832365090b199b7083c0a77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2e51e61ac671b5abf4773535ca5d3b1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ae2e51e61ac671b5abf4773535ca5d3b1">first_old_dof</a> (const <a class="el" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> proc) const </td></tr>
<tr class="separator:ae2e51e61ac671b5abf4773535ca5d3b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f178534a18c87d8c2c76e1f60a1a08f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a8f178534a18c87d8c2c76e1f60a1a08f">first_old_dof</a> () const </td></tr>
<tr class="separator:a8f178534a18c87d8c2c76e1f60a1a08f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a265de993749f5bab70c3f9c860defd49"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a265de993749f5bab70c3f9c860defd49">end_dof</a> (const <a class="el" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> proc) const </td></tr>
<tr class="separator:a265de993749f5bab70c3f9c860defd49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92230d3049a3a7a97b8ba2f34b3ec677"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a92230d3049a3a7a97b8ba2f34b3ec677">end_dof</a> () const </td></tr>
<tr class="separator:a92230d3049a3a7a97b8ba2f34b3ec677"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e2e96a2b0e37592427bab97460d2767"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a8e2e96a2b0e37592427bab97460d2767">dof_owner</a> (const <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> dof) const </td></tr>
<tr class="separator:a8e2e96a2b0e37592427bab97460d2767"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6801d9d76f5c6958889614ce566d49d0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a6801d9d76f5c6958889614ce566d49d0">end_old_dof</a> (const <a class="el" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> proc) const </td></tr>
<tr class="separator:a6801d9d76f5c6958889614ce566d49d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9279162157eed83c6f739a4a675a3499"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a9279162157eed83c6f739a4a675a3499">end_old_dof</a> () const </td></tr>
<tr class="separator:a9279162157eed83c6f739a4a675a3499"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d323b6fcb736454a9f6074ebda9ec28"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a0d323b6fcb736454a9f6074ebda9ec28">dof_indices</a> (const Elem *const elem, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;di) const </td></tr>
<tr class="memdesc:a0d323b6fcb736454a9f6074ebda9ec28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fills the vector <code>di</code> with the global degree of freedom indices for the element.  <a href="#a0d323b6fcb736454a9f6074ebda9ec28">更多...</a><br/></td></tr>
<tr class="separator:a0d323b6fcb736454a9f6074ebda9ec28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46ac4c9d94a25c31fe9670fcffdfa0a1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a46ac4c9d94a25c31fe9670fcffdfa0a1">dof_indices</a> (const Elem *const elem, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;di, const unsigned int vn, int p_level=-12345) const </td></tr>
<tr class="memdesc:a46ac4c9d94a25c31fe9670fcffdfa0a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fills the vector <code>di</code> with the global degree of freedom indices for the element.  <a href="#a46ac4c9d94a25c31fe9670fcffdfa0a1">更多...</a><br/></td></tr>
<tr class="separator:a46ac4c9d94a25c31fe9670fcffdfa0a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1b251eccf3b1be48e48f6de23dd98bf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ad1b251eccf3b1be48e48f6de23dd98bf">dof_indices</a> (const Node *const node, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;di) const </td></tr>
<tr class="memdesc:ad1b251eccf3b1be48e48f6de23dd98bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fills the vector <code>di</code> with the global degree of freedom indices for the <code>node</code>.  <a href="#ad1b251eccf3b1be48e48f6de23dd98bf">更多...</a><br/></td></tr>
<tr class="separator:ad1b251eccf3b1be48e48f6de23dd98bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3803d572c6076f4a583aa13090e4d4e4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a3803d572c6076f4a583aa13090e4d4e4">dof_indices</a> (const Node *const node, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;di, const unsigned int vn) const </td></tr>
<tr class="memdesc:a3803d572c6076f4a583aa13090e4d4e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fills the vector <code>di</code> with the global degree of freedom indices for the <code>node</code>, for one variable <code>vn</code>.  <a href="#a3803d572c6076f4a583aa13090e4d4e4">更多...</a><br/></td></tr>
<tr class="separator:a3803d572c6076f4a583aa13090e4d4e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbf22d6eef2a9f7067da340663339055"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#acbf22d6eef2a9f7067da340663339055">dof_indices</a> (const Elem &amp;elem, unsigned int n, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;di, const unsigned int vn) const </td></tr>
<tr class="memdesc:acbf22d6eef2a9f7067da340663339055"><td class="mdescLeft">&#160;</td><td class="mdescRight">Appends to the vector <code>di</code> the global degree of freedom indices for <code>elem.node_ref(n)</code>, for one variable <code>vn</code>.  <a href="#acbf22d6eef2a9f7067da340663339055">更多...</a><br/></td></tr>
<tr class="separator:acbf22d6eef2a9f7067da340663339055"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28da2b029b6461593a746fb946d17ab1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a28da2b029b6461593a746fb946d17ab1">old_dof_indices</a> (const Elem &amp;elem, unsigned int n, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;di, const unsigned int vn) const </td></tr>
<tr class="memdesc:a28da2b029b6461593a746fb946d17ab1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Appends to the vector <code>di</code> the old global degree of freedom indices for <code>elem.node_ref(n)</code>, for one variable <code>vn</code>.  <a href="#a28da2b029b6461593a746fb946d17ab1">更多...</a><br/></td></tr>
<tr class="separator:a28da2b029b6461593a746fb946d17ab1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a347faeed226256bbb37de75dda07b8a3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a347faeed226256bbb37de75dda07b8a3">SCALAR_dof_indices</a> (std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;di, const unsigned int vn, const bool old_dofs=false) const </td></tr>
<tr class="memdesc:a347faeed226256bbb37de75dda07b8a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fills the vector <code>di</code> with the global degree of freedom indices corresponding to the SCALAR variable vn.  <a href="#a347faeed226256bbb37de75dda07b8a3">更多...</a><br/></td></tr>
<tr class="separator:a347faeed226256bbb37de75dda07b8a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa654bbcfc7f4d67d7cc6e3bb8cc390b3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#aa654bbcfc7f4d67d7cc6e3bb8cc390b3">semilocal_index</a> (<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> dof_index) const </td></tr>
<tr class="separator:aa654bbcfc7f4d67d7cc6e3bb8cc390b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a275eef27e02119cb8b20507ccda4d04d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a275eef27e02119cb8b20507ccda4d04d">all_semilocal_indices</a> (const std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;<a class="el" href="classlibMesh_1_1DofMap.html#a0d323b6fcb736454a9f6074ebda9ec28">dof_indices</a>) const </td></tr>
<tr class="separator:a275eef27e02119cb8b20507ccda4d04d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6d9ab04643e9028f7f0c9b4d18e0455"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">local_index</a> (<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> dof_index) const </td></tr>
<tr class="separator:ab6d9ab04643e9028f7f0c9b4d18e0455"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5829342d4c6136d3b802d1fc0ccf4af2"><td class="memTemplParams" colspan="2">template&lt;typename DofObjectSubclass &gt; </td></tr>
<tr class="memitem:a5829342d4c6136d3b802d1fc0ccf4af2"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a5829342d4c6136d3b802d1fc0ccf4af2">is_evaluable</a> (const DofObjectSubclass &amp;obj, unsigned int var_num=<a class="el" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a>) const </td></tr>
<tr class="separator:a5829342d4c6136d3b802d1fc0ccf4af2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2eb44e4da2c8afcd039995ef239457da"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a2eb44e4da2c8afcd039995ef239457da">set_implicit_neighbor_dofs</a> (bool implicit_neighbor_dofs)</td></tr>
<tr class="memdesc:a2eb44e4da2c8afcd039995ef239457da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allow the implicit_neighbor_dofs flag to be set programmatically.  <a href="#a2eb44e4da2c8afcd039995ef239457da">更多...</a><br/></td></tr>
<tr class="separator:a2eb44e4da2c8afcd039995ef239457da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4775dc7cbf1b1d282fcf8fdc088f3eaf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a4775dc7cbf1b1d282fcf8fdc088f3eaf">set_verify_dirichlet_bc_consistency</a> (bool val)</td></tr>
<tr class="memdesc:a4775dc7cbf1b1d282fcf8fdc088f3eaf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the _verify_dirichlet_bc_consistency flag.  <a href="#a4775dc7cbf1b1d282fcf8fdc088f3eaf">更多...</a><br/></td></tr>
<tr class="separator:a4775dc7cbf1b1d282fcf8fdc088f3eaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2489e7c067abb05feba00459ac70a1ba"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a2489e7c067abb05feba00459ac70a1ba">use_coupled_neighbor_dofs</a> (const MeshBase &amp;mesh) const </td></tr>
<tr class="memdesc:a2489e7c067abb05feba00459ac70a1ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tells other library functions whether or not this problem includes coupling between dofs in neighboring cells, as can currently be specified on the command line or inferred from the use of all discontinuous variables.  <a href="#a2489e7c067abb05feba00459ac70a1ba">更多...</a><br/></td></tr>
<tr class="separator:a2489e7c067abb05feba00459ac70a1ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b5809663dddaec5f98739ba049f0a8d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a4b5809663dddaec5f98739ba049f0a8d">extract_local_vector</a> (const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;Ug, const std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;<a class="el" href="classlibMesh_1_1DofMap.html#a0d323b6fcb736454a9f6074ebda9ec28">dof_indices</a>, <a class="el" href="classlibMesh_1_1DenseVectorBase.html">DenseVectorBase</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;Ue) const </td></tr>
<tr class="memdesc:a4b5809663dddaec5f98739ba049f0a8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Builds the local element vector <code>Ue</code> from the global vector <code>Ug</code>, accounting for any constrained degrees of freedom.  <a href="#a4b5809663dddaec5f98739ba049f0a8d">更多...</a><br/></td></tr>
<tr class="separator:a4b5809663dddaec5f98739ba049f0a8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3ddb5b24d39d8098a008348e006cdbf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#aa3ddb5b24d39d8098a008348e006cdbf">local_variable_indices</a> (std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;idx, const MeshBase &amp;mesh, unsigned int var_num) const </td></tr>
<tr class="memdesc:aa3ddb5b24d39d8098a008348e006cdbf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fills an array of those dof indices which belong to the given variable number and live on the current processor.  <a href="#aa3ddb5b24d39d8098a008348e006cdbf">更多...</a><br/></td></tr>
<tr class="separator:aa3ddb5b24d39d8098a008348e006cdbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad83df6befb2ac64f657f874731ab03f1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ad83df6befb2ac64f657f874731ab03f1">n_constrained_dofs</a> () const </td></tr>
<tr class="separator:ad83df6befb2ac64f657f874731ab03f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd5ddb7a400e9f4afc942fcaff084860"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#abd5ddb7a400e9f4afc942fcaff084860">n_local_constrained_dofs</a> () const </td></tr>
<tr class="separator:abd5ddb7a400e9f4afc942fcaff084860"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dc427af82815a5265de4e9c8ccd0fc6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a2dc427af82815a5265de4e9c8ccd0fc6">n_constrained_nodes</a> () const </td></tr>
<tr class="separator:a2dc427af82815a5265de4e9c8ccd0fc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7892d89bda5e4d39308dcb4e9a982bfc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a7892d89bda5e4d39308dcb4e9a982bfc">create_dof_constraints</a> (const MeshBase &amp;, <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> time=0)</td></tr>
<tr class="memdesc:a7892d89bda5e4d39308dcb4e9a982bfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rebuilds the raw degree of freedom and <a class="el" href="classlibMesh_1_1DofObject.html" title="The DofObject defines an abstract base class for objects that have degrees of freedom associated with...">DofObject</a> constraints.  <a href="#a7892d89bda5e4d39308dcb4e9a982bfc">更多...</a><br/></td></tr>
<tr class="separator:a7892d89bda5e4d39308dcb4e9a982bfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21fda1ca99f13ac340a05a8e41ecc8e9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a21fda1ca99f13ac340a05a8e41ecc8e9">allgather_recursive_constraints</a> (MeshBase &amp;)</td></tr>
<tr class="memdesc:a21fda1ca99f13ac340a05a8e41ecc8e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gathers constraint equation dependencies from other processors.  <a href="#a21fda1ca99f13ac340a05a8e41ecc8e9">更多...</a><br/></td></tr>
<tr class="separator:a21fda1ca99f13ac340a05a8e41ecc8e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3db4816e2bba5ce9617e7bee6329de19"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a3db4816e2bba5ce9617e7bee6329de19">scatter_constraints</a> (MeshBase &amp;)</td></tr>
<tr class="memdesc:a3db4816e2bba5ce9617e7bee6329de19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends constraint equations to constraining processors.  <a href="#a3db4816e2bba5ce9617e7bee6329de19">更多...</a><br/></td></tr>
<tr class="separator:a3db4816e2bba5ce9617e7bee6329de19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ad8b64590135362f5ac09c581f828bf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a2ad8b64590135362f5ac09c581f828bf">gather_constraints</a> (MeshBase &amp;mesh, std::set&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;unexpanded_dofs, bool look_for_constrainees)</td></tr>
<tr class="memdesc:a2ad8b64590135362f5ac09c581f828bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function for querying about constraint equations on other processors.  <a href="#a2ad8b64590135362f5ac09c581f828bf">更多...</a><br/></td></tr>
<tr class="separator:a2ad8b64590135362f5ac09c581f828bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae07a8531f8f6a082a473c2e4b17a9ea2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ae07a8531f8f6a082a473c2e4b17a9ea2">process_constraints</a> (MeshBase &amp;)</td></tr>
<tr class="memdesc:ae07a8531f8f6a082a473c2e4b17a9ea2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Postprocesses any constrained degrees of freedom to be constrained only in terms of unconstrained dofs, then adds unconstrained dofs to the send_list and prepares that for use.  <a href="#ae07a8531f8f6a082a473c2e4b17a9ea2">更多...</a><br/></td></tr>
<tr class="separator:ae07a8531f8f6a082a473c2e4b17a9ea2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30a6ab4b65749be311da80b48f312fd3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a30a6ab4b65749be311da80b48f312fd3">check_for_cyclic_constraints</a> ()</td></tr>
<tr class="memdesc:a30a6ab4b65749be311da80b48f312fd3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Throw an error if we detect any constraint loops, i.e.  <a href="#a30a6ab4b65749be311da80b48f312fd3">更多...</a><br/></td></tr>
<tr class="separator:a30a6ab4b65749be311da80b48f312fd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab905c6911894def0c2cd5e8163adec15"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ab905c6911894def0c2cd5e8163adec15">check_for_constraint_loops</a> ()</td></tr>
<tr class="separator:ab905c6911894def0c2cd5e8163adec15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada019c02054ed5945504a6c5fc856d69"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ada019c02054ed5945504a6c5fc856d69">add_constraint_row</a> (const <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> dof_number, const <a class="el" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp;constraint_row, const <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> constraint_rhs, const bool forbid_constraint_overwrite)</td></tr>
<tr class="memdesc:ada019c02054ed5945504a6c5fc856d69"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a copy of the user-defined row to the constraint matrix, using an inhomogeneous right-hand-side for the constraint equation.  <a href="#ada019c02054ed5945504a6c5fc856d69">更多...</a><br/></td></tr>
<tr class="separator:ada019c02054ed5945504a6c5fc856d69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf485df94525efa4993f755c5b65a448"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#acf485df94525efa4993f755c5b65a448">add_adjoint_constraint_row</a> (const unsigned int qoi_index, const <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> dof_number, const <a class="el" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp;constraint_row, const <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> constraint_rhs, const bool forbid_constraint_overwrite)</td></tr>
<tr class="memdesc:acf485df94525efa4993f755c5b65a448"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a copy of the user-defined row to the constraint matrix, using an inhomogeneous right-hand-side for the adjoint constraint equation.  <a href="#acf485df94525efa4993f755c5b65a448">更多...</a><br/></td></tr>
<tr class="separator:acf485df94525efa4993f755c5b65a448"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84adefac2c57cc5a76ceae26ef7f9472"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a84adefac2c57cc5a76ceae26ef7f9472">add_constraint_row</a> (const <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> dof_number, const <a class="el" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp;constraint_row, const bool forbid_constraint_overwrite=true)</td></tr>
<tr class="memdesc:a84adefac2c57cc5a76ceae26ef7f9472"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a copy of the user-defined row to the constraint matrix, using a homogeneous right-hand-side for the constraint equation.  <a href="#a84adefac2c57cc5a76ceae26ef7f9472">更多...</a><br/></td></tr>
<tr class="separator:a84adefac2c57cc5a76ceae26ef7f9472"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac72b84326e15a8e0b57c739f3b7c5a30"><td class="memItemLeft" align="right" valign="top">DofConstraints::const_iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ac72b84326e15a8e0b57c739f3b7c5a30">constraint_rows_begin</a> () const </td></tr>
<tr class="separator:ac72b84326e15a8e0b57c739f3b7c5a30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d8722d80a7bbdc6e4c3873c03d0e237"><td class="memItemLeft" align="right" valign="top">DofConstraints::const_iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a5d8722d80a7bbdc6e4c3873c03d0e237">constraint_rows_end</a> () const </td></tr>
<tr class="separator:a5d8722d80a7bbdc6e4c3873c03d0e237"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a924e4fba899cb386b81281a362cd8a4b"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classlibMesh_1_1DofConstraints.html">DofConstraints</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a924e4fba899cb386b81281a362cd8a4b">get_dof_constraints</a> () const </td></tr>
<tr class="memdesc:a924e4fba899cb386b81281a362cd8a4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Provide a const accessor to the <a class="el" href="classlibMesh_1_1DofConstraints.html" title="The constraint matrix storage format. ">DofConstraints</a> map.  <a href="#a924e4fba899cb386b81281a362cd8a4b">更多...</a><br/></td></tr>
<tr class="separator:a924e4fba899cb386b81281a362cd8a4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72f54b69e830ade14656c309586850f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a72f54b69e830ade14656c309586850f8">stash_dof_constraints</a> ()</td></tr>
<tr class="separator:a72f54b69e830ade14656c309586850f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af08d2b93738109ef74741d685e063982"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#af08d2b93738109ef74741d685e063982">unstash_dof_constraints</a> ()</td></tr>
<tr class="separator:af08d2b93738109ef74741d685e063982"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7168817015b9e35965dbbe7cdd683668"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a7168817015b9e35965dbbe7cdd683668">swap_dof_constraints</a> ()</td></tr>
<tr class="memdesc:a7168817015b9e35965dbbe7cdd683668"><td class="mdescLeft">&#160;</td><td class="mdescRight">Similar to the stash/unstash_dof_constraints() API, but swaps _dof_constraints and _stashed_dof_constraints without asserting that the source or destination is empty first.  <a href="#a7168817015b9e35965dbbe7cdd683668">更多...</a><br/></td></tr>
<tr class="separator:a7168817015b9e35965dbbe7cdd683668"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ad33eaeee9257b3935f06f602cdffd6"><td class="memItemLeft" align="right" valign="top">NodeConstraints::const_iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a5ad33eaeee9257b3935f06f602cdffd6">node_constraint_rows_begin</a> () const </td></tr>
<tr class="separator:a5ad33eaeee9257b3935f06f602cdffd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7733ca0e62963ab432b59141869d212f"><td class="memItemLeft" align="right" valign="top">NodeConstraints::const_iterator&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a7733ca0e62963ab432b59141869d212f">node_constraint_rows_end</a> () const </td></tr>
<tr class="separator:a7733ca0e62963ab432b59141869d212f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9846273ba4930ef0364bc1fc954af914"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">is_constrained_dof</a> (const <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> dof) const </td></tr>
<tr class="separator:a9846273ba4930ef0364bc1fc954af914"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae298edab0dbe71a35cc29e55990e4580"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ae298edab0dbe71a35cc29e55990e4580">has_heterogeneous_adjoint_constraints</a> (const unsigned int qoi_num) const </td></tr>
<tr class="separator:ae298edab0dbe71a35cc29e55990e4580"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a313fa92f3f5e620f78746a94298b1008"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a313fa92f3f5e620f78746a94298b1008">has_heterogenous_adjoint_constraints</a> (const unsigned int qoi_num) const </td></tr>
<tr class="memdesc:a313fa92f3f5e620f78746a94298b1008"><td class="mdescLeft">&#160;</td><td class="mdescRight">Backwards compatibility with misspelling.  <a href="#a313fa92f3f5e620f78746a94298b1008">更多...</a><br/></td></tr>
<tr class="separator:a313fa92f3f5e620f78746a94298b1008"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ea2b1a9e7e0ee6a436f478693e98257"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a6ea2b1a9e7e0ee6a436f478693e98257">has_heterogeneous_adjoint_constraint</a> (const unsigned int qoi_num, const <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> dof) const </td></tr>
<tr class="separator:a6ea2b1a9e7e0ee6a436f478693e98257"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f0d4a9dfa8ec0f5a69d7535d89afb73"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a8f0d4a9dfa8ec0f5a69d7535d89afb73">has_heterogenous_adjoint_constraint</a> (const unsigned int qoi_num, const <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> dof) const </td></tr>
<tr class="memdesc:a8f0d4a9dfa8ec0f5a69d7535d89afb73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Backwards compatibility with misspelling.  <a href="#a8f0d4a9dfa8ec0f5a69d7535d89afb73">更多...</a><br/></td></tr>
<tr class="separator:a8f0d4a9dfa8ec0f5a69d7535d89afb73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b140935368fe85cf0ead6d5a0452c0b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a4b140935368fe85cf0ead6d5a0452c0b">get_primal_constraint_values</a> ()</td></tr>
<tr class="separator:a4b140935368fe85cf0ead6d5a0452c0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa074902e46e34c42cab1888d111911f3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#aa074902e46e34c42cab1888d111911f3">is_constrained_node</a> (const Node *node) const </td></tr>
<tr class="separator:aa074902e46e34c42cab1888d111911f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4025cf112c6862b2d1de87c21b2a6c5d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a4025cf112c6862b2d1de87c21b2a6c5d">print_dof_constraints</a> (std::ostream &amp;os=<a class="el" href="namespacelibMesh.html#a08e2b5dd30d71db9e43c52a5a631fdae">libMesh::out</a>, bool print_nonlocal=false) const </td></tr>
<tr class="memdesc:a4025cf112c6862b2d1de87c21b2a6c5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints (from processor 0) all DoF and Node constraints.  <a href="#a4025cf112c6862b2d1de87c21b2a6c5d">更多...</a><br/></td></tr>
<tr class="separator:a4025cf112c6862b2d1de87c21b2a6c5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe6b1771bcaadff20add06bd0b1bd21d"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#abe6b1771bcaadff20add06bd0b1bd21d">get_local_constraints</a> (bool print_nonlocal=false) const </td></tr>
<tr class="memdesc:abe6b1771bcaadff20add06bd0b1bd21d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a string reporting all DoF and Node constraints local to this processor.  <a href="#abe6b1771bcaadff20add06bd0b1bd21d">更多...</a><br/></td></tr>
<tr class="separator:abe6b1771bcaadff20add06bd0b1bd21d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b82ea6d41b2d2b4a8ffee27047dae97"><td class="memItemLeft" align="right" valign="top">std::pair&lt; <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a>, <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a1b82ea6d41b2d2b4a8ffee27047dae97">max_constraint_error</a> (const System &amp;system, <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *v=nullptr) const </td></tr>
<tr class="memdesc:a1b82ea6d41b2d2b4a8ffee27047dae97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tests the constrained degrees of freedom on the numeric vector <code>v</code>, which represents a solution defined on the mesh, returning a pair whose first entry is the maximum absolute error on a constrained DoF and whose second entry is the maximum relative error.  <a href="#a1b82ea6d41b2d2b4a8ffee27047dae97">更多...</a><br/></td></tr>
<tr class="separator:a1b82ea6d41b2d2b4a8ffee27047dae97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f2fa131424c1b5448c39df7d2c30214"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a8f2fa131424c1b5448c39df7d2c30214">constrain_element_matrix</a> (<a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;matrix, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;elem_dofs, bool asymmetric_constraint_rows=true) const </td></tr>
<tr class="memdesc:a8f2fa131424c1b5448c39df7d2c30214"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constrains the element matrix.  <a href="#a8f2fa131424c1b5448c39df7d2c30214">更多...</a><br/></td></tr>
<tr class="separator:a8f2fa131424c1b5448c39df7d2c30214"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a321f229f5e8f3da023d934e09f5f9800"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a321f229f5e8f3da023d934e09f5f9800">constrain_element_matrix</a> (<a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;matrix, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;row_dofs, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;col_dofs, bool asymmetric_constraint_rows=true) const </td></tr>
<tr class="memdesc:a321f229f5e8f3da023d934e09f5f9800"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constrains the element matrix.  <a href="#a321f229f5e8f3da023d934e09f5f9800">更多...</a><br/></td></tr>
<tr class="separator:a321f229f5e8f3da023d934e09f5f9800"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87cac81dddd24844c6fef77f53436b97"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a87cac81dddd24844c6fef77f53436b97">constrain_element_vector</a> (<a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;rhs, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;dofs, bool asymmetric_constraint_rows=true) const </td></tr>
<tr class="memdesc:a87cac81dddd24844c6fef77f53436b97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constrains the element vector.  <a href="#a87cac81dddd24844c6fef77f53436b97">更多...</a><br/></td></tr>
<tr class="separator:a87cac81dddd24844c6fef77f53436b97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69628a36f483277e58d6324ab636255e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a69628a36f483277e58d6324ab636255e">constrain_element_matrix_and_vector</a> (<a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;matrix, <a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;rhs, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;elem_dofs, bool asymmetric_constraint_rows=true) const </td></tr>
<tr class="memdesc:a69628a36f483277e58d6324ab636255e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constrains the element matrix and vector.  <a href="#a69628a36f483277e58d6324ab636255e">更多...</a><br/></td></tr>
<tr class="separator:a69628a36f483277e58d6324ab636255e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41e6fec77b9c1b0a7628420b61966749"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a41e6fec77b9c1b0a7628420b61966749">heterogeneously_constrain_element_matrix_and_vector</a> (<a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;matrix, <a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;rhs, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;elem_dofs, bool asymmetric_constraint_rows=true, int qoi_index=-1) const </td></tr>
<tr class="memdesc:a41e6fec77b9c1b0a7628420b61966749"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constrains the element matrix and vector.  <a href="#a41e6fec77b9c1b0a7628420b61966749">更多...</a><br/></td></tr>
<tr class="separator:a41e6fec77b9c1b0a7628420b61966749"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d15c198fea09321f4627a0fc27538cf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a5d15c198fea09321f4627a0fc27538cf">heterogenously_constrain_element_matrix_and_vector</a> (<a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;matrix, <a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;rhs, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;elem_dofs, bool asymmetric_constraint_rows=true, int qoi_index=-1) const </td></tr>
<tr class="separator:a5d15c198fea09321f4627a0fc27538cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb5c11b2b264f019b221f737cf16a819"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#adb5c11b2b264f019b221f737cf16a819">heterogeneously_constrain_element_vector</a> (const <a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;matrix, <a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;rhs, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;elem_dofs, bool asymmetric_constraint_rows=true, int qoi_index=-1) const </td></tr>
<tr class="memdesc:adb5c11b2b264f019b221f737cf16a819"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constrains the element vector.  <a href="#adb5c11b2b264f019b221f737cf16a819">更多...</a><br/></td></tr>
<tr class="separator:adb5c11b2b264f019b221f737cf16a819"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa86c932ce47e056bd16607889f5c730e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#aa86c932ce47e056bd16607889f5c730e">heterogenously_constrain_element_vector</a> (const <a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;matrix, <a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;rhs, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;elem_dofs, bool asymmetric_constraint_rows=true, int qoi_index=-1) const </td></tr>
<tr class="separator:aa86c932ce47e056bd16607889f5c730e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05f3a8cb72bf066c64f9cc19b5d0d139"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a05f3a8cb72bf066c64f9cc19b5d0d139">heterogeneously_constrain_element_jacobian_and_residual</a> (<a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;matrix, <a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;rhs, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;elem_dofs, <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;solution_local) const </td></tr>
<tr class="memdesc:a05f3a8cb72bf066c64f9cc19b5d0d139"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constrains the element Jacobian and residual.  <a href="#a05f3a8cb72bf066c64f9cc19b5d0d139">更多...</a><br/></td></tr>
<tr class="separator:a05f3a8cb72bf066c64f9cc19b5d0d139"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca6a247a0b3e914b3093b7c28014c46f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#aca6a247a0b3e914b3093b7c28014c46f">heterogeneously_constrain_element_residual</a> (<a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;rhs, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;elem_dofs, <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;solution_local) const </td></tr>
<tr class="memdesc:aca6a247a0b3e914b3093b7c28014c46f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constrains the element residual.  <a href="#aca6a247a0b3e914b3093b7c28014c46f">更多...</a><br/></td></tr>
<tr class="separator:aca6a247a0b3e914b3093b7c28014c46f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd49fc855887ac6b446a645e84731a2e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#acd49fc855887ac6b446a645e84731a2e">constrain_element_residual</a> (<a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;rhs, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;elem_dofs, <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;solution_local) const </td></tr>
<tr class="memdesc:acd49fc855887ac6b446a645e84731a2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constrains the element residual.  <a href="#acd49fc855887ac6b446a645e84731a2e">更多...</a><br/></td></tr>
<tr class="separator:acd49fc855887ac6b446a645e84731a2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bacc34820b779d4c6d69bc1f99570d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a3bacc34820b779d4c6d69bc1f99570d4">constrain_element_dyad_matrix</a> (<a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;v, <a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;w, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;row_dofs, bool asymmetric_constraint_rows=true) const </td></tr>
<tr class="memdesc:a3bacc34820b779d4c6d69bc1f99570d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constrains a dyadic element matrix B = v w'.  <a href="#a3bacc34820b779d4c6d69bc1f99570d4">更多...</a><br/></td></tr>
<tr class="separator:a3bacc34820b779d4c6d69bc1f99570d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c5b5d5c7bef82683bbe5ac51d66d4d6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a5c5b5d5c7bef82683bbe5ac51d66d4d6">constrain_nothing</a> (std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;dofs) const </td></tr>
<tr class="memdesc:a5c5b5d5c7bef82683bbe5ac51d66d4d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Does not actually constrain anything, but modifies <code>dofs</code> in the same way as any of the constrain functions would do, i.e.  <a href="#a5c5b5d5c7bef82683bbe5ac51d66d4d6">更多...</a><br/></td></tr>
<tr class="separator:a5c5b5d5c7bef82683bbe5ac51d66d4d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a447d1cb12f905ae3d8ede821fe8a9743"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a447d1cb12f905ae3d8ede821fe8a9743">enforce_constraints_exactly</a> (const System &amp;system, <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *v=nullptr, bool homogeneous=false) const </td></tr>
<tr class="memdesc:a447d1cb12f905ae3d8ede821fe8a9743"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constrains the numeric vector <code>v</code>, which represents a solution defined on the mesh.  <a href="#a447d1cb12f905ae3d8ede821fe8a9743">更多...</a><br/></td></tr>
<tr class="separator:a447d1cb12f905ae3d8ede821fe8a9743"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acef530b92074c6876bcb892f5f7fc1a5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#acef530b92074c6876bcb892f5f7fc1a5">enforce_adjoint_constraints_exactly</a> (<a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;v, unsigned int q) const </td></tr>
<tr class="memdesc:acef530b92074c6876bcb892f5f7fc1a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Heterogeneously constrains the numeric vector <code>v</code>, which represents an adjoint solution defined on the mesh for quantity fo interest <code>q</code>.  <a href="#acef530b92074c6876bcb892f5f7fc1a5">更多...</a><br/></td></tr>
<tr class="separator:acef530b92074c6876bcb892f5f7fc1a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc1ba7620d261bdf02941e041b955997"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#afc1ba7620d261bdf02941e041b955997">enforce_constraints_on_residual</a> (const NonlinearImplicitSystem &amp;system, <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *rhs, <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; const *solution, bool homogeneous=true) const </td></tr>
<tr class="separator:afc1ba7620d261bdf02941e041b955997"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac68494bc83127a4fb0dfd6c6c9755783"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ac68494bc83127a4fb0dfd6c6c9755783">enforce_constraints_on_jacobian</a> (const NonlinearImplicitSystem &amp;system, <a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *jac) const </td></tr>
<tr class="separator:ac68494bc83127a4fb0dfd6c6c9755783"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade407291cc858bb97e3476cd47259702"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ade407291cc858bb97e3476cd47259702">add_periodic_boundary</a> (const <a class="el" href="classlibMesh_1_1PeriodicBoundaryBase.html">PeriodicBoundaryBase</a> &amp;periodic_boundary)</td></tr>
<tr class="memdesc:ade407291cc858bb97e3476cd47259702"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a copy of the specified periodic boundary to the system.  <a href="#ade407291cc858bb97e3476cd47259702">更多...</a><br/></td></tr>
<tr class="separator:ade407291cc858bb97e3476cd47259702"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a724af7741f2b45c26cf950b2f3b6d146"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a724af7741f2b45c26cf950b2f3b6d146">add_periodic_boundary</a> (const <a class="el" href="classlibMesh_1_1PeriodicBoundaryBase.html">PeriodicBoundaryBase</a> &amp;boundary, const <a class="el" href="classlibMesh_1_1PeriodicBoundaryBase.html">PeriodicBoundaryBase</a> &amp;inverse_boundary)</td></tr>
<tr class="memdesc:a724af7741f2b45c26cf950b2f3b6d146"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a periodic boundary pair.  <a href="#a724af7741f2b45c26cf950b2f3b6d146">更多...</a><br/></td></tr>
<tr class="separator:a724af7741f2b45c26cf950b2f3b6d146"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a1ee7c34e87faace0226676ae7b48a5"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a2a1ee7c34e87faace0226676ae7b48a5">is_periodic_boundary</a> (const <a class="el" href="namespacelibMesh.html#a3f4d8a52b5ef6ff6156ca209e12b5564">boundary_id_type</a> boundaryid) const </td></tr>
<tr class="separator:a2a1ee7c34e87faace0226676ae7b48a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8fbe12a80566efce1259ea93601dc2a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1PeriodicBoundaries.html">PeriodicBoundaries</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ad8fbe12a80566efce1259ea93601dc2a">get_periodic_boundaries</a> ()</td></tr>
<tr class="separator:ad8fbe12a80566efce1259ea93601dc2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e1f4efb4c68ffaf232b69a7f5499da8"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classlibMesh_1_1PeriodicBoundaries.html">PeriodicBoundaries</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a0e1f4efb4c68ffaf232b69a7f5499da8">get_periodic_boundaries</a> () const </td></tr>
<tr class="separator:a0e1f4efb4c68ffaf232b69a7f5499da8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47b7566f3cf2608d913792fd3e963b5d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a47b7566f3cf2608d913792fd3e963b5d">add_dirichlet_boundary</a> (const <a class="el" href="classlibMesh_1_1DirichletBoundary.html">DirichletBoundary</a> &amp;dirichlet_boundary)</td></tr>
<tr class="memdesc:a47b7566f3cf2608d913792fd3e963b5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a copy of the specified Dirichlet boundary to the system.  <a href="#a47b7566f3cf2608d913792fd3e963b5d">更多...</a><br/></td></tr>
<tr class="separator:a47b7566f3cf2608d913792fd3e963b5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7473e667efd0197d42213c8126ad910a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a7473e667efd0197d42213c8126ad910a">add_adjoint_dirichlet_boundary</a> (const <a class="el" href="classlibMesh_1_1DirichletBoundary.html">DirichletBoundary</a> &amp;dirichlet_boundary, unsigned int q)</td></tr>
<tr class="memdesc:a7473e667efd0197d42213c8126ad910a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a copy of the specified Dirichlet boundary to the system, corresponding to the adjoint problem defined by Quantity of Interest <code>q</code>.  <a href="#a7473e667efd0197d42213c8126ad910a">更多...</a><br/></td></tr>
<tr class="separator:a7473e667efd0197d42213c8126ad910a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6183b4266a0562a8e53f898d685c689"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ae6183b4266a0562a8e53f898d685c689">remove_dirichlet_boundary</a> (const <a class="el" href="classlibMesh_1_1DirichletBoundary.html">DirichletBoundary</a> &amp;dirichlet_boundary)</td></tr>
<tr class="memdesc:ae6183b4266a0562a8e53f898d685c689"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes the specified Dirichlet boundary from the system.  <a href="#ae6183b4266a0562a8e53f898d685c689">更多...</a><br/></td></tr>
<tr class="separator:ae6183b4266a0562a8e53f898d685c689"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b0fefa113360f285feebc78bd3d27f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a1b0fefa113360f285feebc78bd3d27f5">remove_adjoint_dirichlet_boundary</a> (const <a class="el" href="classlibMesh_1_1DirichletBoundary.html">DirichletBoundary</a> &amp;dirichlet_boundary, unsigned int q)</td></tr>
<tr class="memdesc:a1b0fefa113360f285feebc78bd3d27f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes from the system the specified Dirichlet boundary for the adjoint equation defined by Quantity of interest index q.  <a href="#a1b0fefa113360f285feebc78bd3d27f5">更多...</a><br/></td></tr>
<tr class="separator:a1b0fefa113360f285feebc78bd3d27f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa80551b7b77842fbbdba05173010e57e"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classlibMesh_1_1DirichletBoundaries.html">DirichletBoundaries</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#aa80551b7b77842fbbdba05173010e57e">get_dirichlet_boundaries</a> () const </td></tr>
<tr class="separator:aa80551b7b77842fbbdba05173010e57e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae079c07a133ed49ebf98cefbf348c197"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1DirichletBoundaries.html">DirichletBoundaries</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ae079c07a133ed49ebf98cefbf348c197">get_dirichlet_boundaries</a> ()</td></tr>
<tr class="separator:ae079c07a133ed49ebf98cefbf348c197"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96c57f4ed89dab22d3b1257c595d1dcd"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a96c57f4ed89dab22d3b1257c595d1dcd">has_adjoint_dirichlet_boundaries</a> (unsigned int q) const </td></tr>
<tr class="separator:a96c57f4ed89dab22d3b1257c595d1dcd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb79ba461e1294d3d2bda7c87ee96e93"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classlibMesh_1_1DirichletBoundaries.html">DirichletBoundaries</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#acb79ba461e1294d3d2bda7c87ee96e93">get_adjoint_dirichlet_boundaries</a> (unsigned int q) const </td></tr>
<tr class="separator:acb79ba461e1294d3d2bda7c87ee96e93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8e870d5119711e35e9aecf9b487a4ee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1DirichletBoundaries.html">DirichletBoundaries</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#af8e870d5119711e35e9aecf9b487a4ee">get_adjoint_dirichlet_boundaries</a> (unsigned int q)</td></tr>
<tr class="separator:af8e870d5119711e35e9aecf9b487a4ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7346f3c1d26e6084479657e6b706d245"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a7346f3c1d26e6084479657e6b706d245">check_dirichlet_bcid_consistency</a> (const MeshBase &amp;mesh, const <a class="el" href="classlibMesh_1_1DirichletBoundary.html">DirichletBoundary</a> &amp;boundary) const </td></tr>
<tr class="memdesc:a7346f3c1d26e6084479657e6b706d245"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check that all the ids in dirichlet_bcids are actually present in the mesh.  <a href="#a7346f3c1d26e6084479657e6b706d245">更多...</a><br/></td></tr>
<tr class="separator:a7346f3c1d26e6084479657e6b706d245"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82797eed62ab734a8442ffb4c497f5ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a82797eed62ab734a8442ffb4c497f5ea">old_dof_indices</a> (const Elem *const elem, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;di, const unsigned int vn=<a class="el" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a>) const </td></tr>
<tr class="memdesc:a82797eed62ab734a8442ffb4c497f5ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">After a mesh is refined and repartitioned it is possible that the <code>_send_list</code> will need to be augmented.  <a href="#a82797eed62ab734a8442ffb4c497f5ea">更多...</a><br/></td></tr>
<tr class="separator:a82797eed62ab734a8442ffb4c497f5ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a5ccf3ea5ac20cd67ee29805c42d6c5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a1a5ccf3ea5ac20cd67ee29805c42d6c5">n_old_dofs</a> () const </td></tr>
<tr class="separator:a1a5ccf3ea5ac20cd67ee29805c42d6c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c8e17a57f38de4ae0060311b5497989"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a1c8e17a57f38de4ae0060311b5497989">constrain_p_dofs</a> (unsigned int var, const Elem *elem, unsigned int s, unsigned int p)</td></tr>
<tr class="memdesc:a1c8e17a57f38de4ae0060311b5497989"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constrains degrees of freedom on side <code>s</code> of element <code>elem</code> which correspond to variable number <code>var</code> and to p refinement levels above <code>p</code>.  <a href="#a1c8e17a57f38de4ae0060311b5497989">更多...</a><br/></td></tr>
<tr class="separator:a1c8e17a57f38de4ae0060311b5497989"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf4ed8e608b51a7a4e95935bf42ebbb1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#abf4ed8e608b51a7a4e95935bf42ebbb1">reinit</a> (MeshBase &amp;mesh)</td></tr>
<tr class="memdesc:abf4ed8e608b51a7a4e95935bf42ebbb1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reinitialize the underlying data structures conformal to the current mesh.  <a href="#abf4ed8e608b51a7a4e95935bf42ebbb1">更多...</a><br/></td></tr>
<tr class="separator:abf4ed8e608b51a7a4e95935bf42ebbb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a480f80bc9234a5586711833b87a89784"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a480f80bc9234a5586711833b87a89784">clear</a> ()</td></tr>
<tr class="memdesc:a480f80bc9234a5586711833b87a89784"><td class="mdescLeft">&#160;</td><td class="mdescRight">Free all new memory associated with the object, but restore its original state, with the mesh pointer and any default ghosting.  <a href="#a480f80bc9234a5586711833b87a89784">更多...</a><br/></td></tr>
<tr class="separator:a480f80bc9234a5586711833b87a89784"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b01b32e3e5a146cbda0a64e9e39f451"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a0b01b32e3e5a146cbda0a64e9e39f451">print_info</a> (std::ostream &amp;os=<a class="el" href="namespacelibMesh.html#a08e2b5dd30d71db9e43c52a5a631fdae">libMesh::out</a>) const </td></tr>
<tr class="memdesc:a0b01b32e3e5a146cbda0a64e9e39f451"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints summary info about the sparsity bandwidth and constraints.  <a href="#a0b01b32e3e5a146cbda0a64e9e39f451">更多...</a><br/></td></tr>
<tr class="separator:a0b01b32e3e5a146cbda0a64e9e39f451"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e4f1eeb9c6c7a7196d96d969bfb0e32"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a4e4f1eeb9c6c7a7196d96d969bfb0e32">get_info</a> () const </td></tr>
<tr class="memdesc:a4e4f1eeb9c6c7a7196d96d969bfb0e32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets summary info about the sparsity bandwidth and constraints.  <a href="#a4e4f1eeb9c6c7a7196d96d969bfb0e32">更多...</a><br/></td></tr>
<tr class="separator:a4e4f1eeb9c6c7a7196d96d969bfb0e32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a244e7a1cd82d5e6ae8780c93205ec1fa"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">sys_number</a> () const </td></tr>
<tr class="separator:a244e7a1cd82d5e6ae8780c93205ec1fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a9137c2889d7b37503ff390f1034083"><td class="memItemLeft" align="right" valign="top">std::unique_ptr<br class="typebreak"/>
&lt; <a class="el" href="classlibMesh_1_1SparsityPattern_1_1Build.html">SparsityPattern::Build</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a2a9137c2889d7b37503ff390f1034083">build_sparsity</a> (const MeshBase &amp;mesh, bool calculate_constrained=false) const </td></tr>
<tr class="memdesc:a2a9137c2889d7b37503ff390f1034083"><td class="mdescLeft">&#160;</td><td class="mdescRight">Builds a sparsity pattern for matrices using the current degree-of-freedom numbering and coupling.  <a href="#a2a9137c2889d7b37503ff390f1034083">更多...</a><br/></td></tr>
<tr class="separator:a2a9137c2889d7b37503ff390f1034083"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a709945cd61f9c28ef504f3d7d1ac6962"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a709945cd61f9c28ef504f3d7d1ac6962">should_p_refine</a> (unsigned int g, bool p_refine)</td></tr>
<tr class="memdesc:a709945cd61f9c28ef504f3d7d1ac6962"><td class="mdescLeft">&#160;</td><td class="mdescRight">Describe whether the given variable group should be p-refined.  <a href="#a709945cd61f9c28ef504f3d7d1ac6962">更多...</a><br/></td></tr>
<tr class="separator:a709945cd61f9c28ef504f3d7d1ac6962"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7246dc103533c5b41635ef3b467a739"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#af7246dc103533c5b41635ef3b467a739">should_p_refine</a> (unsigned int g) const </td></tr>
<tr class="memdesc:af7246dc103533c5b41635ef3b467a739"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether the given variable group should be p-refined.  <a href="#af7246dc103533c5b41635ef3b467a739">更多...</a><br/></td></tr>
<tr class="separator:af7246dc103533c5b41635ef3b467a739"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65eaac8ba07b919a2042addb902d4c75"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a65eaac8ba07b919a2042addb902d4c75">should_p_refine_var</a> (unsigned int var) const </td></tr>
<tr class="memdesc:a65eaac8ba07b919a2042addb902d4c75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Whether the given variable should be p-refined.  <a href="#a65eaac8ba07b919a2042addb902d4c75">更多...</a><br/></td></tr>
<tr class="separator:a65eaac8ba07b919a2042addb902d4c75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50b09652f7ce880c57162036dadc763f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a50b09652f7ce880c57162036dadc763f">should_p_refine</a> (FEFamily, bool)=delete</td></tr>
<tr class="separator:a50b09652f7ce880c57162036dadc763f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a356438358e2137848c04b66abc6b396e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a356438358e2137848c04b66abc6b396e">should_p_refine</a> (Order, bool)=delete</td></tr>
<tr class="separator:a356438358e2137848c04b66abc6b396e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59a34ed0ac2739c2108a7c2fc01d8347"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a59a34ed0ac2739c2108a7c2fc01d8347">should_p_refine</a> (FEFamily) const =delete</td></tr>
<tr class="separator:a59a34ed0ac2739c2108a7c2fc01d8347"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0363ec6658f4a1620ca7427cb6e505e7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a0363ec6658f4a1620ca7427cb6e505e7">should_p_refine</a> (Order) const =delete</td></tr>
<tr class="separator:a0363ec6658f4a1620ca7427cb6e505e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
静态 Public 成员函数</h2></td></tr>
<tr class="memitem:a103b37125ae9eaaadf6f7854df17faa2"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#a103b37125ae9eaaadf6f7854df17faa2">get_info</a> ()</td></tr>
<tr class="memdesc:a103b37125ae9eaaadf6f7854df17faa2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a string containing the reference information.  <a href="#a103b37125ae9eaaadf6f7854df17faa2">更多...</a><br/></td></tr>
<tr class="separator:a103b37125ae9eaaadf6f7854df17faa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13ce734a14ffd1dbb6496dab702da8e1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#a13ce734a14ffd1dbb6496dab702da8e1">print_info</a> (std::ostream &amp;out_stream=<a class="el" href="namespacelibMesh.html#a08e2b5dd30d71db9e43c52a5a631fdae">libMesh::out</a>)</td></tr>
<tr class="memdesc:a13ce734a14ffd1dbb6496dab702da8e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints the reference information, by default to <code><a class="el" href="namespacelibMesh.html#a08e2b5dd30d71db9e43c52a5a631fdae">libMesh::out</a></code>.  <a href="#a13ce734a14ffd1dbb6496dab702da8e1">更多...</a><br/></td></tr>
<tr class="separator:a13ce734a14ffd1dbb6496dab702da8e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50e74641afc6e2870c9e1ce412f8c44f"><td class="memItemLeft" align="right" valign="top">static unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#a50e74641afc6e2870c9e1ce412f8c44f">n_objects</a> ()</td></tr>
<tr class="memdesc:a50e74641afc6e2870c9e1ce412f8c44f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints the number of outstanding (created, but not yet destroyed) objects.  <a href="#a50e74641afc6e2870c9e1ce412f8c44f">更多...</a><br/></td></tr>
<tr class="separator:a50e74641afc6e2870c9e1ce412f8c44f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86837c50216b2ddb800b3836d2a08c09"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#a86837c50216b2ddb800b3836d2a08c09">enable_print_counter_info</a> ()</td></tr>
<tr class="memdesc:a86837c50216b2ddb800b3836d2a08c09"><td class="mdescLeft">&#160;</td><td class="mdescRight">Methods to enable/disable the reference counter output from <a class="el" href="classlibMesh_1_1ReferenceCounter.html#a13ce734a14ffd1dbb6496dab702da8e1" title="Prints the reference information, by default to libMesh::out. ">print_info()</a>  <a href="#a86837c50216b2ddb800b3836d2a08c09">更多...</a><br/></td></tr>
<tr class="separator:a86837c50216b2ddb800b3836d2a08c09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c0a2d3d3c531f9f069b0d623d4ace0f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#a5c0a2d3d3c531f9f069b0d623d4ace0f">disable_print_counter_info</a> ()</td></tr>
<tr class="separator:a5c0a2d3d3c531f9f069b0d623d4ace0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public 属性</h2></td></tr>
<tr class="memitem:ab276e172c5488ab3b387b235e28556cf"><td class="memItemLeft" align="right" valign="top">CouplingMatrix *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ab276e172c5488ab3b387b235e28556cf">_dof_coupling</a></td></tr>
<tr class="memdesc:ab276e172c5488ab3b387b235e28556cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Degree of freedom coupling.  <a href="#ab276e172c5488ab3b387b235e28556cf">更多...</a><br/></td></tr>
<tr class="separator:ab276e172c5488ab3b387b235e28556cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-types"></a>
Protected 类型</h2></td></tr>
<tr class="memitem:adb5daadc989c1fe71ec8d173adf0ed1e"><td class="memItemLeft" align="right" valign="top">typedef std::map&lt; std::string, <br class="typebreak"/>
std::pair&lt; unsigned int, <br class="typebreak"/>
unsigned int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#adb5daadc989c1fe71ec8d173adf0ed1e">Counts</a></td></tr>
<tr class="memdesc:adb5daadc989c1fe71ec8d173adf0ed1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data structure to log the information.  <a href="#adb5daadc989c1fe71ec8d173adf0ed1e">更多...</a><br/></td></tr>
<tr class="separator:adb5daadc989c1fe71ec8d173adf0ed1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected 成员函数</h2></td></tr>
<tr class="memitem:af0cd2f1fbd46c66dade1e750436ee7ab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#af0cd2f1fbd46c66dade1e750436ee7ab">increment_constructor_count</a> (const std::string &amp;name) noexcept</td></tr>
<tr class="memdesc:af0cd2f1fbd46c66dade1e750436ee7ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Increments the construction counter.  <a href="#af0cd2f1fbd46c66dade1e750436ee7ab">更多...</a><br/></td></tr>
<tr class="separator:af0cd2f1fbd46c66dade1e750436ee7ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a769ddb2e2299db1aafcdfb33dfb830d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#a769ddb2e2299db1aafcdfb33dfb830d8">increment_destructor_count</a> (const std::string &amp;name) noexcept</td></tr>
<tr class="memdesc:a769ddb2e2299db1aafcdfb33dfb830d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Increments the destruction counter.  <a href="#a769ddb2e2299db1aafcdfb33dfb830d8">更多...</a><br/></td></tr>
<tr class="separator:a769ddb2e2299db1aafcdfb33dfb830d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-static-attribs"></a>
静态 Protected 属性</h2></td></tr>
<tr class="memitem:a7c913252d05560f8bc7c75a63547c4c3"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classlibMesh_1_1ReferenceCounter.html#adb5daadc989c1fe71ec8d173adf0ed1e">Counts</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#a7c913252d05560f8bc7c75a63547c4c3">_counts</a></td></tr>
<tr class="memdesc:a7c913252d05560f8bc7c75a63547c4c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Actually holds the data.  <a href="#a7c913252d05560f8bc7c75a63547c4c3">更多...</a><br/></td></tr>
<tr class="separator:a7c913252d05560f8bc7c75a63547c4c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2c30f0f71dcd00f00faa8e46aa3e043"><td class="memItemLeft" align="right" valign="top">static Threads::atomic<br class="typebreak"/>
&lt; unsigned int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#ad2c30f0f71dcd00f00faa8e46aa3e043">_n_objects</a></td></tr>
<tr class="memdesc:ad2c30f0f71dcd00f00faa8e46aa3e043"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of objects.  <a href="#ad2c30f0f71dcd00f00faa8e46aa3e043">更多...</a><br/></td></tr>
<tr class="separator:ad2c30f0f71dcd00f00faa8e46aa3e043"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abedbd3a4ce19686187449a8a0557b74b"><td class="memItemLeft" align="right" valign="top">static Threads::spin_mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#abedbd3a4ce19686187449a8a0557b74b">_mutex</a></td></tr>
<tr class="memdesc:abedbd3a4ce19686187449a8a0557b74b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mutual exclusion object to enable thread-safe reference counting.  <a href="#abedbd3a4ce19686187449a8a0557b74b">更多...</a><br/></td></tr>
<tr class="separator:abedbd3a4ce19686187449a8a0557b74b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f75e8a4a280f2c41636f2ae1307a311"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#a8f75e8a4a280f2c41636f2ae1307a311">_enable_print_counter</a> = true</td></tr>
<tr class="memdesc:a8f75e8a4a280f2c41636f2ae1307a311"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag to control whether reference count information is printed when print_info is called.  <a href="#a8f75e8a4a280f2c41636f2ae1307a311">更多...</a><br/></td></tr>
<tr class="separator:a8f75e8a4a280f2c41636f2ae1307a311"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private 类型</h2></td></tr>
<tr class="memitem:abf72c97b24845ea8b10a7c4a83e726b4"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classlibMesh_1_1DofObject.html">DofObject</a> *(DofMap::*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#abf72c97b24845ea8b10a7c4a83e726b4">dofobject_accessor</a> )(MeshBase &amp;mesh, <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> i) const </td></tr>
<tr class="memdesc:abf72c97b24845ea8b10a7c4a83e726b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">A member function type like <code><a class="el" href="classlibMesh_1_1DofMap.html#a8f4c45c1d3d4de70b46e63063153c12a">node_ptr()</a></code> or <code><a class="el" href="classlibMesh_1_1DofMap.html#ad3218b71187390e1b03182c32a547149">elem_ptr()</a></code>.  <a href="#abf72c97b24845ea8b10a7c4a83e726b4">更多...</a><br/></td></tr>
<tr class="separator:abf72c97b24845ea8b10a7c4a83e726b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abddb472d25fdb74e211e214710c48534"><td class="memItemLeft" align="right" valign="top">typedef std::set<br class="typebreak"/>
&lt; std::unique_ptr<br class="typebreak"/>
&lt; CouplingMatrix &gt;<br class="typebreak"/>
, Utility::CompareUnderlying &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#abddb472d25fdb74e211e214710c48534">CouplingMatricesSet</a></td></tr>
<tr class="separator:abddb472d25fdb74e211e214710c48534"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private 成员函数</h2></td></tr>
<tr class="memitem:ab71695347ecade298eba425d3150ffc6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ab71695347ecade298eba425d3150ffc6">_dof_indices</a> (const Elem &amp;elem, int p_level, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;di, const unsigned int vg, const unsigned int vig, const Node *const *nodes, unsigned int n_nodes#ifdef DEBUG, const unsigned int v, std::size_t &amp;tot_size#endif) const </td></tr>
<tr class="memdesc:ab71695347ecade298eba425d3150ffc6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function that gets the dof indices on the current element for a non-SCALAR type variable, where the variable is identified by its variable group number <code>vg</code> and its offset <code>vig</code> from the first variable in that group.  <a href="#ab71695347ecade298eba425d3150ffc6">更多...</a><br/></td></tr>
<tr class="separator:ab71695347ecade298eba425d3150ffc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5da0a54ecad33de039c252ddcc6ecb88"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a5da0a54ecad33de039c252ddcc6ecb88">_node_dof_indices</a> (const Elem &amp;elem, unsigned int n, const <a class="el" href="classlibMesh_1_1DofObject.html">DofObject</a> &amp;obj, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;di, const unsigned int vn) const </td></tr>
<tr class="memdesc:a5da0a54ecad33de039c252ddcc6ecb88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function that implements the element-nodal versions of dof_indices and old_dof_indices.  <a href="#a5da0a54ecad33de039c252ddcc6ecb88">更多...</a><br/></td></tr>
<tr class="separator:a5da0a54ecad33de039c252ddcc6ecb88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cbe9d7dc9f93f266817f997562bfa7c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a9cbe9d7dc9f93f266817f997562bfa7c">invalidate_dofs</a> (MeshBase &amp;mesh) const </td></tr>
<tr class="memdesc:a9cbe9d7dc9f93f266817f997562bfa7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Invalidates all active <a class="el" href="classlibMesh_1_1DofObject.html" title="The DofObject defines an abstract base class for objects that have degrees of freedom associated with...">DofObject</a> dofs for this system.  <a href="#a9cbe9d7dc9f93f266817f997562bfa7c">更多...</a><br/></td></tr>
<tr class="separator:a9cbe9d7dc9f93f266817f997562bfa7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f4c45c1d3d4de70b46e63063153c12a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1DofObject.html">DofObject</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a8f4c45c1d3d4de70b46e63063153c12a">node_ptr</a> (MeshBase &amp;mesh, <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> i) const </td></tr>
<tr class="separator:a8f4c45c1d3d4de70b46e63063153c12a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3218b71187390e1b03182c32a547149"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1DofObject.html">DofObject</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ad3218b71187390e1b03182c32a547149">elem_ptr</a> (MeshBase &amp;mesh, <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> i) const </td></tr>
<tr class="separator:ad3218b71187390e1b03182c32a547149"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bad83b3b5e37a8afe4ea251d72df300"><td class="memTemplParams" colspan="2">template&lt;typename iterator_type &gt; </td></tr>
<tr class="memitem:a7bad83b3b5e37a8afe4ea251d72df300"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a7bad83b3b5e37a8afe4ea251d72df300">set_nonlocal_dof_objects</a> (iterator_type objects_begin, iterator_type objects_end, MeshBase &amp;mesh, <a class="el" href="classlibMesh_1_1DofMap.html#abf72c97b24845ea8b10a7c4a83e726b4">dofobject_accessor</a> objects)</td></tr>
<tr class="memdesc:a7bad83b3b5e37a8afe4ea251d72df300"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function for distributing dofs in parallel.  <a href="#a7bad83b3b5e37a8afe4ea251d72df300">更多...</a><br/></td></tr>
<tr class="separator:a7bad83b3b5e37a8afe4ea251d72df300"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af781ec4ff23b34cd4332a357f1647fdd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#af781ec4ff23b34cd4332a357f1647fdd">distribute_local_dofs_var_major</a> (<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &amp;next_free_dof, MeshBase &amp;mesh)</td></tr>
<tr class="memdesc:af781ec4ff23b34cd4332a357f1647fdd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Distributes the global degrees of freedom, for dofs on this processor.  <a href="#af781ec4ff23b34cd4332a357f1647fdd">更多...</a><br/></td></tr>
<tr class="separator:af781ec4ff23b34cd4332a357f1647fdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fa08b142ac3e34a8213017252b96d30"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a5fa08b142ac3e34a8213017252b96d30">distribute_local_dofs_node_major</a> (<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &amp;next_free_dof, MeshBase &amp;mesh)</td></tr>
<tr class="memdesc:a5fa08b142ac3e34a8213017252b96d30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Distributes the global degrees of freedom for dofs on this processor.  <a href="#a5fa08b142ac3e34a8213017252b96d30">更多...</a><br/></td></tr>
<tr class="separator:a5fa08b142ac3e34a8213017252b96d30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e7b566e7d6125d46b18f34d9727f376"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a0e7b566e7d6125d46b18f34d9727f376">distribute_scalar_dofs</a> (<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &amp;next_free_dof)</td></tr>
<tr class="separator:a0e7b566e7d6125d46b18f34d9727f376"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6abf52a43c1480656cfc1c77428d08b8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a6abf52a43c1480656cfc1c77428d08b8">assert_no_nodes_missed</a> (MeshBase &amp;mesh)</td></tr>
<tr class="separator:a6abf52a43c1480656cfc1c77428d08b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed8eba054300e64164af4a8257bae8d8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#aed8eba054300e64164af4a8257bae8d8">add_neighbors_to_send_list</a> (MeshBase &amp;mesh)</td></tr>
<tr class="memdesc:aed8eba054300e64164af4a8257bae8d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds entries to the <code>_send_list</code> vector corresponding to DoFs on elements neighboring the current processor.  <a href="#aed8eba054300e64164af4a8257bae8d8">更多...</a><br/></td></tr>
<tr class="separator:aed8eba054300e64164af4a8257bae8d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9a7484991ea22915a82b4f0852df055"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ad9a7484991ea22915a82b4f0852df055">build_constraint_matrix</a> (<a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;C, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;elem_dofs, const bool called_recursively=false) const </td></tr>
<tr class="memdesc:ad9a7484991ea22915a82b4f0852df055"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build the constraint matrix C associated with the element degree of freedom indices elem_dofs.  <a href="#ad9a7484991ea22915a82b4f0852df055">更多...</a><br/></td></tr>
<tr class="separator:ad9a7484991ea22915a82b4f0852df055"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2ed5b18088aa8e52795beaf93cde513"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ad2ed5b18088aa8e52795beaf93cde513">build_constraint_matrix_and_vector</a> (<a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;C, <a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;H, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;elem_dofs, int qoi_index=-1, const bool called_recursively=false) const </td></tr>
<tr class="memdesc:ad2ed5b18088aa8e52795beaf93cde513"><td class="mdescLeft">&#160;</td><td class="mdescRight">Build the constraint matrix C and the forcing vector H associated with the element degree of freedom indices elem_dofs.  <a href="#ad2ed5b18088aa8e52795beaf93cde513">更多...</a><br/></td></tr>
<tr class="separator:ad2ed5b18088aa8e52795beaf93cde513"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3894dde74bae40ba948e3be6656bfb72"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a3894dde74bae40ba948e3be6656bfb72">find_connected_dofs</a> (std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;elem_dofs) const </td></tr>
<tr class="memdesc:a3894dde74bae40ba948e3be6656bfb72"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds all the DOFS associated with the element DOFs elem_dofs.  <a href="#a3894dde74bae40ba948e3be6656bfb72">更多...</a><br/></td></tr>
<tr class="separator:a3894dde74bae40ba948e3be6656bfb72"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ab53c009c0cba6ca266a97841e19828"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a7ab53c009c0cba6ca266a97841e19828">find_connected_dof_objects</a> (std::vector&lt; const <a class="el" href="classlibMesh_1_1DofObject.html">DofObject</a> * &gt; &amp;objs) const </td></tr>
<tr class="memdesc:a7ab53c009c0cba6ca266a97841e19828"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds all the DofObjects associated with the set in <code>objs</code>.  <a href="#a7ab53c009c0cba6ca266a97841e19828">更多...</a><br/></td></tr>
<tr class="separator:a7ab53c009c0cba6ca266a97841e19828"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0783b9a05a297be8f1c3e630301e0604"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a0783b9a05a297be8f1c3e630301e0604">add_constraints_to_send_list</a> ()</td></tr>
<tr class="memdesc:a0783b9a05a297be8f1c3e630301e0604"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds entries to the <code>_send_list</code> vector corresponding to DoFs which are dependencies for constraint equations on the current processor.  <a href="#a0783b9a05a297be8f1c3e630301e0604">更多...</a><br/></td></tr>
<tr class="separator:a0783b9a05a297be8f1c3e630301e0604"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b79bfce2f7aefdd722b9bd8b34a9a11"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a4b79bfce2f7aefdd722b9bd8b34a9a11">process_mesh_constraint_rows</a> (const MeshBase &amp;mesh)</td></tr>
<tr class="memdesc:a4b79bfce2f7aefdd722b9bd8b34a9a11"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds any spline constraints from the Mesh to our DoF constraints.  <a href="#a4b79bfce2f7aefdd722b9bd8b34a9a11">更多...</a><br/></td></tr>
<tr class="separator:a4b79bfce2f7aefdd722b9bd8b34a9a11"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
静态 Private 成员函数</h2></td></tr>
<tr class="memitem:aaba8d0fe4f60763e0a52f7ae1d4b7153"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#aaba8d0fe4f60763e0a52f7ae1d4b7153">merge_ghost_functor_outputs</a> (GhostingFunctor::map_type &amp;elements_to_ghost, <a class="el" href="classlibMesh_1_1DofMap.html#abddb472d25fdb74e211e214710c48534">CouplingMatricesSet</a> &amp;temporary_coupling_matrices, const std::set&lt; GhostingFunctor * &gt;::iterator &amp;gf_begin, const std::set&lt; GhostingFunctor * &gt;::iterator &amp;gf_end, const MeshBase::const_element_iterator &amp;elems_begin, const MeshBase::const_element_iterator &amp;elems_end, <a class="el" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> p)</td></tr>
<tr class="separator:aaba8d0fe4f60763e0a52f7ae1d4b7153"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private 属性</h2></td></tr>
<tr class="memitem:aef749fe651254903abfc12d9b81e2a16"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#aef749fe651254903abfc12d9b81e2a16">_error_on_constraint_loop</a></td></tr>
<tr class="memdesc:aef749fe651254903abfc12d9b81e2a16"><td class="mdescLeft">&#160;</td><td class="mdescRight">This flag indicates whether or not we do an opt-mode check for the presence of constraint loops, i.e.  <a href="#aef749fe651254903abfc12d9b81e2a16">更多...</a><br/></td></tr>
<tr class="separator:aef749fe651254903abfc12d9b81e2a16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a780be47336e49e2f9cd55bba69ee919a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a780be47336e49e2f9cd55bba69ee919a">_constrained_sparsity_construction</a></td></tr>
<tr class="memdesc:a780be47336e49e2f9cd55bba69ee919a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This flag indicates whether or not we explicitly take constraint equations into account when computing a sparsity pattern.  <a href="#a780be47336e49e2f9cd55bba69ee919a">更多...</a><br/></td></tr>
<tr class="separator:a780be47336e49e2f9cd55bba69ee919a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5232a8054e580a408f394ba1574c63df"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classlibMesh_1_1Variable.html">Variable</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">_variables</a></td></tr>
<tr class="memdesc:a5232a8054e580a408f394ba1574c63df"><td class="mdescLeft">&#160;</td><td class="mdescRight">The finite element type for each variable.  <a href="#a5232a8054e580a408f394ba1574c63df">更多...</a><br/></td></tr>
<tr class="separator:a5232a8054e580a408f394ba1574c63df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad840cf4659b6b1a2f781d29225e82743"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classlibMesh_1_1VariableGroup.html">VariableGroup</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a></td></tr>
<tr class="memdesc:ad840cf4659b6b1a2f781d29225e82743"><td class="mdescLeft">&#160;</td><td class="mdescRight">The finite element type for each variable group.  <a href="#ad840cf4659b6b1a2f781d29225e82743">更多...</a><br/></td></tr>
<tr class="separator:ad840cf4659b6b1a2f781d29225e82743"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04bedd57c80ef97a7d9a0a3e2fe8a248"><td class="memItemLeft" align="right" valign="top">std::vector&lt; unsigned int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a04bedd57c80ef97a7d9a0a3e2fe8a248">_variable_group_numbers</a></td></tr>
<tr class="memdesc:a04bedd57c80ef97a7d9a0a3e2fe8a248"><td class="mdescLeft">&#160;</td><td class="mdescRight">The variable group number for each variable.  <a href="#a04bedd57c80ef97a7d9a0a3e2fe8a248">更多...</a><br/></td></tr>
<tr class="separator:a04bedd57c80ef97a7d9a0a3e2fe8a248"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bc6f6a2a702bfb9511b442d99fc7a28"><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; unsigned <br class="typebreak"/>
int, unsigned int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a1bc6f6a2a702bfb9511b442d99fc7a28">_var_to_vg</a></td></tr>
<tr class="memdesc:a1bc6f6a2a702bfb9511b442d99fc7a28"><td class="mdescLeft">&#160;</td><td class="mdescRight">A map from variable number to variable group number.  <a href="#a1bc6f6a2a702bfb9511b442d99fc7a28">更多...</a><br/></td></tr>
<tr class="separator:a1bc6f6a2a702bfb9511b442d99fc7a28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32b9faf7127f48555386705a952460d6"><td class="memItemLeft" align="right" valign="top">const unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a32b9faf7127f48555386705a952460d6">_sys_number</a></td></tr>
<tr class="memdesc:a32b9faf7127f48555386705a952460d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">The number of the system we manage DOFs for.  <a href="#a32b9faf7127f48555386705a952460d6">更多...</a><br/></td></tr>
<tr class="separator:a32b9faf7127f48555386705a952460d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0f1617e6f28fc596497b370092bcc17"><td class="memItemLeft" align="right" valign="top">MeshBase &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a></td></tr>
<tr class="memdesc:ac0f1617e6f28fc596497b370092bcc17"><td class="mdescLeft">&#160;</td><td class="mdescRight">The mesh that system uses.  <a href="#ac0f1617e6f28fc596497b370092bcc17">更多...</a><br/></td></tr>
<tr class="separator:ac0f1617e6f28fc596497b370092bcc17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacf8838eb951b139f05e56e338ac2195"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a><br class="typebreak"/>
&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">_matrices</a></td></tr>
<tr class="memdesc:aacf8838eb951b139f05e56e338ac2195"><td class="mdescLeft">&#160;</td><td class="mdescRight">Additional matrices handled by this object.  <a href="#aacf8838eb951b139f05e56e338ac2195">更多...</a><br/></td></tr>
<tr class="separator:aacf8838eb951b139f05e56e338ac2195"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab72062de06b72df985ac5bf16837a7da"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a></td></tr>
<tr class="memdesc:ab72062de06b72df985ac5bf16837a7da"><td class="mdescLeft">&#160;</td><td class="mdescRight">First DOF index on processor <code>p</code>.  <a href="#ab72062de06b72df985ac5bf16837a7da">更多...</a><br/></td></tr>
<tr class="separator:ab72062de06b72df985ac5bf16837a7da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af43f96a9e11b3f4221306fdfd4511aaa"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a></td></tr>
<tr class="memdesc:af43f96a9e11b3f4221306fdfd4511aaa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Last DOF index (plus 1) on processor <code>p</code>.  <a href="#af43f96a9e11b3f4221306fdfd4511aaa">更多...</a><br/></td></tr>
<tr class="separator:af43f96a9e11b3f4221306fdfd4511aaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1fc10139391d71da470387d9e4adbb5"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#af1fc10139391d71da470387d9e4adbb5">_first_scalar_df</a></td></tr>
<tr class="memdesc:af1fc10139391d71da470387d9e4adbb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">First DOF index for SCALAR variable v, or garbage for non-SCALAR variable v.  <a href="#af1fc10139391d71da470387d9e4adbb5">更多...</a><br/></td></tr>
<tr class="separator:af1fc10139391d71da470387d9e4adbb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b3873478d701811b9562b514fc2c369"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a></td></tr>
<tr class="memdesc:a2b3873478d701811b9562b514fc2c369"><td class="mdescLeft">&#160;</td><td class="mdescRight">A list containing all the global DOF indices that affect the solution on my processor.  <a href="#a2b3873478d701811b9562b514fc2c369">更多...</a><br/></td></tr>
<tr class="separator:a2b3873478d701811b9562b514fc2c369"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d69e59ae9a96426ceca2f356caab1b6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1SparsityPattern_1_1AugmentSparsityPattern.html">SparsityPattern::AugmentSparsityPattern</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a8d69e59ae9a96426ceca2f356caab1b6">_augment_sparsity_pattern</a></td></tr>
<tr class="memdesc:a8d69e59ae9a96426ceca2f356caab1b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function object to call to add extra entries to the sparsity pattern.  <a href="#a8d69e59ae9a96426ceca2f356caab1b6">更多...</a><br/></td></tr>
<tr class="separator:a8d69e59ae9a96426ceca2f356caab1b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3513c402066e6431799e388d62be036"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ab3513c402066e6431799e388d62be036">_extra_sparsity_function</a> )(<a class="el" href="classlibMesh_1_1SparsityPattern_1_1Graph.html">SparsityPattern::Graph</a> &amp;, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;n_nz, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;n_oz, void *)</td></tr>
<tr class="memdesc:ab3513c402066e6431799e388d62be036"><td class="mdescLeft">&#160;</td><td class="mdescRight">A function pointer to a function to call to add extra entries to the sparsity pattern.  <a href="#ab3513c402066e6431799e388d62be036">更多...</a><br/></td></tr>
<tr class="separator:ab3513c402066e6431799e388d62be036"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a283ce213140aa281498b56e138ee8de2"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a283ce213140aa281498b56e138ee8de2">_extra_sparsity_context</a></td></tr>
<tr class="memdesc:a283ce213140aa281498b56e138ee8de2"><td class="mdescLeft">&#160;</td><td class="mdescRight">A pointer associated with the extra sparsity that can optionally be passed in.  <a href="#a283ce213140aa281498b56e138ee8de2">更多...</a><br/></td></tr>
<tr class="separator:a283ce213140aa281498b56e138ee8de2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a409a5dccf85edf7260f6186482cb9c9c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1DofMap_1_1AugmentSendList.html">AugmentSendList</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a409a5dccf85edf7260f6186482cb9c9c">_augment_send_list</a></td></tr>
<tr class="memdesc:a409a5dccf85edf7260f6186482cb9c9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function object to call to add extra entries to the send list.  <a href="#a409a5dccf85edf7260f6186482cb9c9c">更多...</a><br/></td></tr>
<tr class="separator:a409a5dccf85edf7260f6186482cb9c9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1bdebf08fdd914c71545e45624e3c8f"><td class="memItemLeft" align="right" valign="top">void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#af1bdebf08fdd914c71545e45624e3c8f">_extra_send_list_function</a> )(std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;, void *)</td></tr>
<tr class="memdesc:af1bdebf08fdd914c71545e45624e3c8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">A function pointer to a function to call to add extra entries to the send list.  <a href="#af1bdebf08fdd914c71545e45624e3c8f">更多...</a><br/></td></tr>
<tr class="separator:af1bdebf08fdd914c71545e45624e3c8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c450ba54bc8caffac28eed88a98a17d"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a6c450ba54bc8caffac28eed88a98a17d">_extra_send_list_context</a></td></tr>
<tr class="memdesc:a6c450ba54bc8caffac28eed88a98a17d"><td class="mdescLeft">&#160;</td><td class="mdescRight">A pointer associated with the extra send list that can optionally be passed in.  <a href="#a6c450ba54bc8caffac28eed88a98a17d">更多...</a><br/></td></tr>
<tr class="separator:a6c450ba54bc8caffac28eed88a98a17d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb069d1433ad6f8eeb4d5ebf44ae4dc8"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; DefaultCoupling &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">_default_coupling</a></td></tr>
<tr class="memdesc:abb069d1433ad6f8eeb4d5ebf44ae4dc8"><td class="mdescLeft">&#160;</td><td class="mdescRight">The default coupling GhostingFunctor, used to implement standard <a class="el" href="namespacelibMesh.html" title="The libMesh namespace provides an interface to certain functionality in the library. ">libMesh</a> sparsity pattern construction.  <a href="#abb069d1433ad6f8eeb4d5ebf44ae4dc8">更多...</a><br/></td></tr>
<tr class="separator:abb069d1433ad6f8eeb4d5ebf44ae4dc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4eb9c9ed9c530781aac48df4fc0cf27b"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; DefaultCoupling &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">_default_evaluating</a></td></tr>
<tr class="memdesc:a4eb9c9ed9c530781aac48df4fc0cf27b"><td class="mdescLeft">&#160;</td><td class="mdescRight">The default algebraic GhostingFunctor, used to implement standard <a class="el" href="namespacelibMesh.html" title="The libMesh namespace provides an interface to certain functionality in the library. ">libMesh</a> send_list construction.  <a href="#a4eb9c9ed9c530781aac48df4fc0cf27b">更多...</a><br/></td></tr>
<tr class="separator:a4eb9c9ed9c530781aac48df4fc0cf27b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a378d58f5e860f781a52adb61464c9378"><td class="memItemLeft" align="right" valign="top">std::set&lt; GhostingFunctor * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a378d58f5e860f781a52adb61464c9378">_algebraic_ghosting_functors</a></td></tr>
<tr class="memdesc:a378d58f5e860f781a52adb61464c9378"><td class="mdescLeft">&#160;</td><td class="mdescRight">The list of all GhostingFunctor objects to be used when distributing ghosted vectors.  <a href="#a378d58f5e860f781a52adb61464c9378">更多...</a><br/></td></tr>
<tr class="separator:a378d58f5e860f781a52adb61464c9378"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef1ebc9176a3f7ec9607ba4b26808991"><td class="memItemLeft" align="right" valign="top">std::set&lt; GhostingFunctor * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">_coupling_functors</a></td></tr>
<tr class="memdesc:aef1ebc9176a3f7ec9607ba4b26808991"><td class="mdescLeft">&#160;</td><td class="mdescRight">The list of all GhostingFunctor objects to be used when coupling degrees of freedom in matrix sparsity patterns.  <a href="#aef1ebc9176a3f7ec9607ba4b26808991">更多...</a><br/></td></tr>
<tr class="separator:aef1ebc9176a3f7ec9607ba4b26808991"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac72a2e7009922c18fc0a59ebcceb58b1"><td class="memItemLeft" align="right" valign="top">std::map&lt; GhostingFunctor <br class="typebreak"/>
*, std::shared_ptr<br class="typebreak"/>
&lt; GhostingFunctor &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ac72a2e7009922c18fc0a59ebcceb58b1">_shared_functors</a></td></tr>
<tr class="memdesc:ac72a2e7009922c18fc0a59ebcceb58b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hang on to references to any GhostingFunctor objects we were passed in shared_ptr form.  <a href="#ac72a2e7009922c18fc0a59ebcceb58b1">更多...</a><br/></td></tr>
<tr class="separator:ac72a2e7009922c18fc0a59ebcceb58b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8ed6583656addff061ba113f0ca4347"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">need_full_sparsity_pattern</a></td></tr>
<tr class="memdesc:aa8ed6583656addff061ba113f0ca4347"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default false; set to true if any attached matrix requires a full sparsity pattern.  <a href="#aa8ed6583656addff061ba113f0ca4347">更多...</a><br/></td></tr>
<tr class="separator:aa8ed6583656addff061ba113f0ca4347"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab14c66a56c0815c857dc662bea96f124"><td class="memItemLeft" align="right" valign="top">std::unique_ptr<br class="typebreak"/>
&lt; <a class="el" href="classlibMesh_1_1SparsityPattern_1_1Build.html">SparsityPattern::Build</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a></td></tr>
<tr class="memdesc:ab14c66a56c0815c857dc662bea96f124"><td class="mdescLeft">&#160;</td><td class="mdescRight">The sparsity pattern of the global matrix.  <a href="#ab14c66a56c0815c857dc662bea96f124">更多...</a><br/></td></tr>
<tr class="separator:ab14c66a56c0815c857dc662bea96f124"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0964620ae8054b969297d1d9087b7b05"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a0964620ae8054b969297d1d9087b7b05">_n_dfs</a></td></tr>
<tr class="memdesc:a0964620ae8054b969297d1d9087b7b05"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of degrees of freedom.  <a href="#a0964620ae8054b969297d1d9087b7b05">更多...</a><br/></td></tr>
<tr class="separator:a0964620ae8054b969297d1d9087b7b05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dbee781954d22ad785846b3a2a45193"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">_n_SCALAR_dofs</a></td></tr>
<tr class="memdesc:a8dbee781954d22ad785846b3a2a45193"><td class="mdescLeft">&#160;</td><td class="mdescRight">The total number of SCALAR dofs associated to all SCALAR variables.  <a href="#a8dbee781954d22ad785846b3a2a45193">更多...</a><br/></td></tr>
<tr class="separator:a8dbee781954d22ad785846b3a2a45193"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbca79dca4f02ab917e89aeac3113808"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#abbca79dca4f02ab917e89aeac3113808">_n_old_dfs</a></td></tr>
<tr class="memdesc:abbca79dca4f02ab917e89aeac3113808"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of degrees of freedom on old dof objects.  <a href="#abbca79dca4f02ab917e89aeac3113808">更多...</a><br/></td></tr>
<tr class="separator:abbca79dca4f02ab917e89aeac3113808"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab91d708f5167f50c0392b2fd5dea2559"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ab91d708f5167f50c0392b2fd5dea2559">_first_old_df</a></td></tr>
<tr class="memdesc:ab91d708f5167f50c0392b2fd5dea2559"><td class="mdescLeft">&#160;</td><td class="mdescRight">First old DOF index on processor <code>p</code>.  <a href="#ab91d708f5167f50c0392b2fd5dea2559">更多...</a><br/></td></tr>
<tr class="separator:ab91d708f5167f50c0392b2fd5dea2559"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab96f5b260e5925063553da996bb3b428"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ab96f5b260e5925063553da996bb3b428">_end_old_df</a></td></tr>
<tr class="memdesc:ab96f5b260e5925063553da996bb3b428"><td class="mdescLeft">&#160;</td><td class="mdescRight">Last old DOF index (plus 1) on processor <code>p</code>.  <a href="#ab96f5b260e5925063553da996bb3b428">更多...</a><br/></td></tr>
<tr class="separator:ab96f5b260e5925063553da996bb3b428"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92da14cf60e82ed600bfe67ca3422765"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a92da14cf60e82ed600bfe67ca3422765">_first_old_scalar_df</a></td></tr>
<tr class="memdesc:a92da14cf60e82ed600bfe67ca3422765"><td class="mdescLeft">&#160;</td><td class="mdescRight">First old DOF index for SCALAR variable v, or garbage for non-SCALAR variable v.  <a href="#a92da14cf60e82ed600bfe67ca3422765">更多...</a><br/></td></tr>
<tr class="separator:a92da14cf60e82ed600bfe67ca3422765"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82dd81ff9e21bdc2d9c80f80c692a9ea"><td class="memItemLeft" align="right" valign="top">std::unordered_set&lt; unsigned int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a82dd81ff9e21bdc2d9c80f80c692a9ea">_dont_p_refine</a></td></tr>
<tr class="memdesc:a82dd81ff9e21bdc2d9c80f80c692a9ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">A container of variable groups that we should not p-refine.  <a href="#a82dd81ff9e21bdc2d9c80f80c692a9ea">更多...</a><br/></td></tr>
<tr class="separator:a82dd81ff9e21bdc2d9c80f80c692a9ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7fe4d0cf13618e6dd04ff22fdaca0ba"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1DofConstraints.html">DofConstraints</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a></td></tr>
<tr class="memdesc:af7fe4d0cf13618e6dd04ff22fdaca0ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data structure containing DOF constraints.  <a href="#af7fe4d0cf13618e6dd04ff22fdaca0ba">更多...</a><br/></td></tr>
<tr class="separator:af7fe4d0cf13618e6dd04ff22fdaca0ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af21470daae1a06d29df4bac4807a019c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1DofConstraints.html">DofConstraints</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#af21470daae1a06d29df4bac4807a019c">_stashed_dof_constraints</a></td></tr>
<tr class="separator:af21470daae1a06d29df4bac4807a019c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24e7c497429c2bd81a5cc39f71cfa6e0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a></td></tr>
<tr class="separator:a24e7c497429c2bd81a5cc39f71cfa6e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89fdd1d933dc29089eabf3e07908374d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1AdjointDofConstraintValues.html">AdjointDofConstraintValues</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a></td></tr>
<tr class="separator:a89fdd1d933dc29089eabf3e07908374d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8856db766d722a0edaa9f5c5d94d40f7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1NodeConstraints.html">NodeConstraints</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a></td></tr>
<tr class="memdesc:a8856db766d722a0edaa9f5c5d94d40f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data structure containing <a class="el" href="classlibMesh_1_1DofObject.html" title="The DofObject defines an abstract base class for objects that have degrees of freedom associated with...">DofObject</a> constraints.  <a href="#a8856db766d722a0edaa9f5c5d94d40f7">更多...</a><br/></td></tr>
<tr class="separator:a8856db766d722a0edaa9f5c5d94d40f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab91693b08a22cfe1af7781287157ac8a"><td class="memItemLeft" align="right" valign="top">std::unique_ptr<br class="typebreak"/>
&lt; <a class="el" href="classlibMesh_1_1PeriodicBoundaries.html">PeriodicBoundaries</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a></td></tr>
<tr class="memdesc:ab91693b08a22cfe1af7781287157ac8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data structure containing periodic boundaries.  <a href="#ab91693b08a22cfe1af7781287157ac8a">更多...</a><br/></td></tr>
<tr class="separator:ab91693b08a22cfe1af7781287157ac8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e9be7e72291d4fd6e841ae7733a5ff0"><td class="memItemLeft" align="right" valign="top">std::unique_ptr<br class="typebreak"/>
&lt; <a class="el" href="classlibMesh_1_1DirichletBoundaries.html">DirichletBoundaries</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">_dirichlet_boundaries</a></td></tr>
<tr class="memdesc:a2e9be7e72291d4fd6e841ae7733a5ff0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data structure containing Dirichlet functions.  <a href="#a2e9be7e72291d4fd6e841ae7733a5ff0">更多...</a><br/></td></tr>
<tr class="separator:a2e9be7e72291d4fd6e841ae7733a5ff0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a376604ef648f92ce79ed7d2c810b55f3"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::unique_ptr<br class="typebreak"/>
&lt; <a class="el" href="classlibMesh_1_1DirichletBoundaries.html">DirichletBoundaries</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a376604ef648f92ce79ed7d2c810b55f3">_adjoint_dirichlet_boundaries</a></td></tr>
<tr class="memdesc:a376604ef648f92ce79ed7d2c810b55f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data structure containing Dirichlet functions.  <a href="#a376604ef648f92ce79ed7d2c810b55f3">更多...</a><br/></td></tr>
<tr class="separator:a376604ef648f92ce79ed7d2c810b55f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6ed76ce98cd73ed8339f505a5284fef"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#aa6ed76ce98cd73ed8339f505a5284fef">_implicit_neighbor_dofs_initialized</a></td></tr>
<tr class="memdesc:aa6ed76ce98cd73ed8339f505a5284fef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bools to indicate if we override the &ndash;implicit_neighbor_dofs commandline options.  <a href="#aa6ed76ce98cd73ed8339f505a5284fef">更多...</a><br/></td></tr>
<tr class="separator:aa6ed76ce98cd73ed8339f505a5284fef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09368a6dcd32c12d7a51dc00852982d5"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a09368a6dcd32c12d7a51dc00852982d5">_implicit_neighbor_dofs</a></td></tr>
<tr class="separator:a09368a6dcd32c12d7a51dc00852982d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a126ef1ca10f48a41d48010b3296ddef7"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a126ef1ca10f48a41d48010b3296ddef7">_verify_dirichlet_bc_consistency</a></td></tr>
<tr class="memdesc:a126ef1ca10f48a41d48010b3296ddef7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag which determines whether we should do some additional checking of the consistency of the <a class="el" href="classlibMesh_1_1DirichletBoundary.html" title="This class allows one to associate Dirichlet boundary values with a given set of mesh boundary ids an...">DirichletBoundary</a> objects added by the user.  <a href="#a126ef1ca10f48a41d48010b3296ddef7">更多...</a><br/></td></tr>
<tr class="separator:a126ef1ca10f48a41d48010b3296ddef7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
友元</h2></td></tr>
<tr class="memitem:a298e05b1935249e7045795d918f46d70"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DofMap.html#a298e05b1935249e7045795d918f46d70">SparsityPattern::Build</a></td></tr>
<tr class="separator:a298e05b1935249e7045795d918f46d70"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">详细描述</h2>
<div class="textblock"><p>This class handles the numbering of degrees of freedom on a mesh. </p>
<p>For systems of equations the class supports a fixed number of variables. The degrees of freedom are numbered such that sequential, contiguous blocks belong to distinct processors. This is so that the resulting data structures will work well with parallel linear algebra packages.</p>
<dl class="section author"><dt>作者</dt><dd>Benjamin S. Kirk </dd></dl>
<dl class="section date"><dt>日期</dt><dd>2002-2007 Manages the degrees of freedom (DOFs) in a simulation. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00169">169</a> 行定义.</p>
</div><h2 class="groupheader">成员类型定义说明</h2>
<a class="anchor" id="adb5daadc989c1fe71ec8d173adf0ed1e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::map&lt;std::string, std::pair&lt;unsigned int, unsigned int&gt; &gt; <a class="el" href="classlibMesh_1_1ReferenceCounter.html#adb5daadc989c1fe71ec8d173adf0ed1e">libMesh::ReferenceCounter::Counts</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Data structure to log the information. </p>
<p>The log is identified by the class name. </p>

<p>在文件 <a class="el" href="reference__counter_8h_source.html">reference_counter.h</a> 第 <a class="el" href="reference__counter_8h_source.html#l00119">119</a> 行定义.</p>

</div>
</div>
<a class="anchor" id="abddb472d25fdb74e211e214710c48534"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::set&lt;std::unique_ptr&lt;CouplingMatrix&gt;, Utility::CompareUnderlying&gt; <a class="el" href="classlibMesh_1_1DofMap.html#abddb472d25fdb74e211e214710c48534">libMesh::DofMap::CouplingMatricesSet</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01742">1742</a> 行定义.</p>

</div>
</div>
<a class="anchor" id="abf72c97b24845ea8b10a7c4a83e726b4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classlibMesh_1_1DofObject.html">DofObject</a>*(DofMap::* libMesh::DofMap::dofobject_accessor)(MeshBase &amp;mesh, <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> i) const </td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A member function type like <code><a class="el" href="classlibMesh_1_1DofMap.html#a8f4c45c1d3d4de70b46e63063153c12a">node_ptr()</a></code> or <code><a class="el" href="classlibMesh_1_1DofMap.html#ad3218b71187390e1b03182c32a547149">elem_ptr()</a></code>. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01690">1690</a> 行定义.</p>

</div>
</div>
<h2 class="groupheader">构造及析构函数说明</h2>
<a class="anchor" id="ade33ee85034b79ffb7febd62a9e8fe97"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">libMesh::DofMap::DofMap </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>sys_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor. </p>
<p>Requires the number of the system for which we will be numbering degrees of freedom &amp; the parent object we are contained in, which defines our communication space. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l00135">135</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01933">_default_coupling</a>, <a class="el" href="dof__map_8h_source.html#l01941">_default_evaluating</a>, <a class="el" href="dof__map_8h_source.html#l01871">_matrices</a>, <a class="el" href="dof__map_8h_source.html#l01864">_mesh</a>, <a class="el" href="dof__map_8h_source.html#l02050">_periodic_boundaries</a>, <a class="el" href="dof__map_8C_source.html#l01886">add_algebraic_ghosting_functor()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l01861">add_coupling_functor()</a>.</p>
<div class="fragment"><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                                :</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  ParallelObject (mesh.comm()),</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab276e172c5488ab3b387b235e28556cf">_dof_coupling</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#aef749fe651254903abfc12d9b81e2a16">_error_on_constraint_loop</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a780be47336e49e2f9cd55bba69ee919a">_constrained_sparsity_construction</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">_variables</a>(),</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a>(),</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a04bedd57c80ef97a7d9a0a3e2fe8a248">_variable_group_numbers</a>(),</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a32b9faf7127f48555386705a952460d6">_sys_number</a>(number),</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a>(mesh),</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">_matrices</a>(),</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a>(),</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>(),</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#af1fc10139391d71da470387d9e4adbb5">_first_scalar_df</a>(),</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>(),</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a8d69e59ae9a96426ceca2f356caab1b6">_augment_sparsity_pattern</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab3513c402066e6431799e388d62be036">_extra_sparsity_function</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a283ce213140aa281498b56e138ee8de2">_extra_sparsity_context</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a409a5dccf85edf7260f6186482cb9c9c">_augment_send_list</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#af1bdebf08fdd914c71545e45624e3c8f">_extra_send_list_function</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a6c450ba54bc8caffac28eed88a98a17d">_extra_send_list_context</a>(<span class="keyword">nullptr</span>),</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">_default_coupling</a>(std::make_unique&lt;DefaultCoupling&gt;()),</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">_default_evaluating</a>(std::make_unique&lt;DefaultCoupling&gt;()),</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">need_full_sparsity_pattern</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a0964620ae8054b969297d1d9087b7b05">_n_dfs</a>(0),</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">_n_SCALAR_dofs</a>(0)</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_AMR</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="preprocessor"></span>  , <a class="code" href="classlibMesh_1_1DofMap.html#abbca79dca4f02ab917e89aeac3113808">_n_old_dfs</a>(0),</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab91d708f5167f50c0392b2fd5dea2559">_first_old_df</a>(),</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab96f5b260e5925063553da996bb3b428">_end_old_df</a>(),</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a92da14cf60e82ed600bfe67ca3422765">_first_old_scalar_df</a>()</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef LIBMESH_ENABLE_CONSTRAINTS</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="preprocessor"></span>  , <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>()</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  , <a class="code" href="classlibMesh_1_1DofMap.html#af21470daae1a06d29df4bac4807a019c">_stashed_dof_constraints</a>()</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  , <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>()</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  , <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>()</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor"></span>  , <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>()</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef LIBMESH_ENABLE_PERIODIC</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="preprocessor"></span>  , <a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>(std::make_unique&lt;PeriodicBoundaries&gt;())</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef LIBMESH_ENABLE_DIRICHLET</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="preprocessor"></span>  , <a class="code" href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">_dirichlet_boundaries</a>(std::make_unique&lt;DirichletBoundaries&gt;())</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  , <a class="code" href="classlibMesh_1_1DofMap.html#a376604ef648f92ce79ed7d2c810b55f3">_adjoint_dirichlet_boundaries</a>()</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="preprocessor"></span>  , <a class="code" href="classlibMesh_1_1DofMap.html#aa6ed76ce98cd73ed8339f505a5284fef">_implicit_neighbor_dofs_initialized</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a09368a6dcd32c12d7a51dc00852982d5">_implicit_neighbor_dofs</a>(<span class="keyword">false</span>),</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a126ef1ca10f48a41d48010b3296ddef7">_verify_dirichlet_bc_consistency</a>(<span class="keyword">true</span>)</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;{</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">_matrices</a>.clear();</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">_default_coupling</a>-&gt;set_mesh(&amp;<a class="code" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a>);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">_default_evaluating</a>-&gt;set_mesh(&amp;<a class="code" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a>);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">_default_evaluating</a>-&gt;set_n_levels(1);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_PERIODIC</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="preprocessor"></span>  <a class="code" href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">_default_coupling</a>-&gt;set_periodic_boundaries(_periodic_boundaries.get());</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">_default_evaluating</a>-&gt;set_periodic_boundaries(_periodic_boundaries.get());</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ae17b27f47b3731f6ce72312edd957bf7">add_coupling_functor</a>(*<a class="code" href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">_default_coupling</a>);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9a0c5eeda42bc54bb3ae1c2d05ec5227">add_algebraic_ghosting_functor</a>(*<a class="code" href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">_default_evaluating</a>);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad840cf4659b6b1a2f781d29225e82743"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">libMesh::DofMap::_variable_groups</a></div><div class="ttdeci">std::vector&lt; VariableGroup &gt; _variable_groups</div><div class="ttdoc">The finite element type for each variable group. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01844">dof_map.h:1844</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aa6ed76ce98cd73ed8339f505a5284fef"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa6ed76ce98cd73ed8339f505a5284fef">libMesh::DofMap::_implicit_neighbor_dofs_initialized</a></div><div class="ttdeci">bool _implicit_neighbor_dofs_initialized</div><div class="ttdoc">Bools to indicate if we override the –implicit_neighbor_dofs commandline options. ...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02073">dof_map.h:2073</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a32b9faf7127f48555386705a952460d6"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a32b9faf7127f48555386705a952460d6">libMesh::DofMap::_sys_number</a></div><div class="ttdeci">const unsigned int _sys_number</div><div class="ttdoc">The number of the system we manage DOFs for. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01859">dof_map.h:1859</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a09368a6dcd32c12d7a51dc00852982d5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a09368a6dcd32c12d7a51dc00852982d5">libMesh::DofMap::_implicit_neighbor_dofs</a></div><div class="ttdeci">bool _implicit_neighbor_dofs</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02074">dof_map.h:2074</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aef749fe651254903abfc12d9b81e2a16"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aef749fe651254903abfc12d9b81e2a16">libMesh::DofMap::_error_on_constraint_loop</a></div><div class="ttdeci">bool _error_on_constraint_loop</div><div class="ttdoc">This flag indicates whether or not we do an opt-mode check for the presence of constraint loops...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01828">dof_map.h:1828</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a283ce213140aa281498b56e138ee8de2"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a283ce213140aa281498b56e138ee8de2">libMesh::DofMap::_extra_sparsity_context</a></div><div class="ttdeci">void * _extra_sparsity_context</div><div class="ttdoc">A pointer associated with the extra sparsity that can optionally be passed in. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01910">dof_map.h:1910</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2b3873478d701811b9562b514fc2c369"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">libMesh::DofMap::_send_list</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _send_list</div><div class="ttdoc">A list containing all the global DOF indices that affect the solution on my processor. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01893">dof_map.h:1893</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2e9be7e72291d4fd6e841ae7733a5ff0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">libMesh::DofMap::_dirichlet_boundaries</a></div><div class="ttdeci">std::unique_ptr&lt; DirichletBoundaries &gt; _dirichlet_boundaries</div><div class="ttdoc">Data structure containing Dirichlet functions. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02058">dof_map.h:2058</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab96f5b260e5925063553da996bb3b428"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab96f5b260e5925063553da996bb3b428">libMesh::DofMap::_end_old_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _end_old_df</div><div class="ttdoc">Last old DOF index (plus 1) on processor p. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02011">dof_map.h:2011</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ae17b27f47b3731f6ce72312edd957bf7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ae17b27f47b3731f6ce72312edd957bf7">libMesh::DofMap::add_coupling_functor</a></div><div class="ttdeci">void add_coupling_functor(GhostingFunctor &amp;coupling_functor, bool to_mesh=true)</div><div class="ttdoc">Adds a functor which can specify coupling requirements for creation of sparse matrices. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01861">dof_map.C:1861</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab91d708f5167f50c0392b2fd5dea2559"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab91d708f5167f50c0392b2fd5dea2559">libMesh::DofMap::_first_old_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_old_df</div><div class="ttdoc">First old DOF index on processor p. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02006">dof_map.h:2006</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af1fc10139391d71da470387d9e4adbb5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af1fc10139391d71da470387d9e4adbb5">libMesh::DofMap::_first_scalar_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_scalar_df</div><div class="ttdoc">First DOF index for SCALAR variable v, or garbage for non-SCALAR variable v. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01887">dof_map.h:1887</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02034">dof_map.h:2034</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a780be47336e49e2f9cd55bba69ee919a"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a780be47336e49e2f9cd55bba69ee919a">libMesh::DofMap::_constrained_sparsity_construction</a></div><div class="ttdeci">bool _constrained_sparsity_construction</div><div class="ttdoc">This flag indicates whether or not we explicitly take constraint equations into account when computin...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01834">dof_map.h:1834</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a409a5dccf85edf7260f6186482cb9c9c"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a409a5dccf85edf7260f6186482cb9c9c">libMesh::DofMap::_augment_send_list</a></div><div class="ttdeci">AugmentSendList * _augment_send_list</div><div class="ttdoc">Function object to call to add extra entries to the send list. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01915">dof_map.h:1915</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aa8ed6583656addff061ba113f0ca4347"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">libMesh::DofMap::need_full_sparsity_pattern</a></div><div class="ttdeci">bool need_full_sparsity_pattern</div><div class="ttdoc">Default false; set to true if any attached matrix requires a full sparsity pattern. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01976">dof_map.h:1976</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a92da14cf60e82ed600bfe67ca3422765"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a92da14cf60e82ed600bfe67ca3422765">libMesh::DofMap::_first_old_scalar_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_old_scalar_df</div><div class="ttdoc">First old DOF index for SCALAR variable v, or garbage for non-SCALAR variable v. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02017">dof_map.h:2017</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8dbee781954d22ad785846b3a2a45193"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">libMesh::DofMap::_n_SCALAR_dofs</a></div><div class="ttdeci">dof_id_type _n_SCALAR_dofs</div><div class="ttdoc">The total number of SCALAR dofs associated to all SCALAR variables. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01994">dof_map.h:1994</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab276e172c5488ab3b387b235e28556cf"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab276e172c5488ab3b387b235e28556cf">libMesh::DofMap::_dof_coupling</a></div><div class="ttdeci">CouplingMatrix * _dof_coupling</div><div class="ttdoc">Degree of freedom coupling. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01589">dof_map.h:1589</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a6c450ba54bc8caffac28eed88a98a17d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a6c450ba54bc8caffac28eed88a98a17d">libMesh::DofMap::_extra_send_list_context</a></div><div class="ttdeci">void * _extra_send_list_context</div><div class="ttdoc">A pointer associated with the extra send list that can optionally be passed in. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01925">dof_map.h:1925</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aacf8838eb951b139f05e56e338ac2195"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">libMesh::DofMap::_matrices</a></div><div class="ttdeci">std::vector&lt; SparseMatrix&lt; Number &gt; * &gt; _matrices</div><div class="ttdoc">Additional matrices handled by this object. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01871">dof_map.h:1871</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a376604ef648f92ce79ed7d2c810b55f3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a376604ef648f92ce79ed7d2c810b55f3">libMesh::DofMap::_adjoint_dirichlet_boundaries</a></div><div class="ttdeci">std::vector&lt; std::unique_ptr&lt; DirichletBoundaries &gt; &gt; _adjoint_dirichlet_boundaries</div><div class="ttdoc">Data structure containing Dirichlet functions. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02064">dof_map.h:2064</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab91693b08a22cfe1af7781287157ac8a"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">libMesh::DofMap::_periodic_boundaries</a></div><div class="ttdeci">std::unique_ptr&lt; PeriodicBoundaries &gt; _periodic_boundaries</div><div class="ttdoc">Data structure containing periodic boundaries. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02050">dof_map.h:2050</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a126ef1ca10f48a41d48010b3296ddef7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a126ef1ca10f48a41d48010b3296ddef7">libMesh::DofMap::_verify_dirichlet_bc_consistency</a></div><div class="ttdeci">bool _verify_dirichlet_bc_consistency</div><div class="ttdoc">Flag which determines whether we should do some additional checking of the consistency of the Dirichl...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02086">dof_map.h:2086</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_abb069d1433ad6f8eeb4d5ebf44ae4dc8"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">libMesh::DofMap::_default_coupling</a></div><div class="ttdeci">std::unique_ptr&lt; DefaultCoupling &gt; _default_coupling</div><div class="ttdoc">The default coupling GhostingFunctor, used to implement standard libMesh sparsity pattern constructio...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01933">dof_map.h:1933</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02032">dof_map.h:2032</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a5232a8054e580a408f394ba1574c63df"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">libMesh::DofMap::_variables</a></div><div class="ttdeci">std::vector&lt; Variable &gt; _variables</div><div class="ttdoc">The finite element type for each variable. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01839">dof_map.h:1839</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af21470daae1a06d29df4bac4807a019c"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af21470daae1a06d29df4bac4807a019c">libMesh::DofMap::_stashed_dof_constraints</a></div><div class="ttdeci">DofConstraints _stashed_dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8d69e59ae9a96426ceca2f356caab1b6"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8d69e59ae9a96426ceca2f356caab1b6">libMesh::DofMap::_augment_sparsity_pattern</a></div><div class="ttdeci">SparsityPattern::AugmentSparsityPattern * _augment_sparsity_pattern</div><div class="ttdoc">Function object to call to add extra entries to the sparsity pattern. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01898">dof_map.h:1898</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_abbca79dca4f02ab917e89aeac3113808"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#abbca79dca4f02ab917e89aeac3113808">libMesh::DofMap::_n_old_dfs</a></div><div class="ttdeci">dof_id_type _n_old_dfs</div><div class="ttdoc">Total number of degrees of freedom on old dof objects. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02001">dof_map.h:2001</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af43f96a9e11b3f4221306fdfd4511aaa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">libMesh::DofMap::_end_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _end_df</div><div class="ttdoc">Last DOF index (plus 1) on processor p. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01881">dof_map.h:1881</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab72062de06b72df985ac5bf16837a7da"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">libMesh::DofMap::_first_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_df</div><div class="ttdoc">First DOF index on processor p. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01876">dof_map.h:1876</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ac0f1617e6f28fc596497b370092bcc17"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">libMesh::DofMap::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdoc">The mesh that system uses. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01864">dof_map.h:1864</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab3513c402066e6431799e388d62be036"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab3513c402066e6431799e388d62be036">libMesh::DofMap::_extra_sparsity_function</a></div><div class="ttdeci">void(* _extra_sparsity_function)(SparsityPattern::Graph &amp;, std::vector&lt; dof_id_type &gt; &amp;n_nz, std::vector&lt; dof_id_type &gt; &amp;n_oz, void *)</div><div class="ttdoc">A function pointer to a function to call to add extra entries to the sparsity pattern. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01903">dof_map.h:1903</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a4eb9c9ed9c530781aac48df4fc0cf27b"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">libMesh::DofMap::_default_evaluating</a></div><div class="ttdeci">std::unique_ptr&lt; DefaultCoupling &gt; _default_evaluating</div><div class="ttdoc">The default algebraic GhostingFunctor, used to implement standard libMesh send_list construction...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01941">dof_map.h:1941</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af1bdebf08fdd914c71545e45624e3c8f"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af1bdebf08fdd914c71545e45624e3c8f">libMesh::DofMap::_extra_send_list_function</a></div><div class="ttdeci">void(* _extra_send_list_function)(std::vector&lt; dof_id_type &gt; &amp;, void *)</div><div class="ttdoc">A function pointer to a function to call to add extra entries to the send list. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01920">dof_map.h:1920</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a04bedd57c80ef97a7d9a0a3e2fe8a248"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a04bedd57c80ef97a7d9a0a3e2fe8a248">libMesh::DofMap::_variable_group_numbers</a></div><div class="ttdeci">std::vector&lt; unsigned int &gt; _variable_group_numbers</div><div class="ttdoc">The variable group number for each variable. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01849">dof_map.h:1849</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9a0c5eeda42bc54bb3ae1c2d05ec5227"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9a0c5eeda42bc54bb3ae1c2d05ec5227">libMesh::DofMap::add_algebraic_ghosting_functor</a></div><div class="ttdeci">void add_algebraic_ghosting_functor(GhostingFunctor &amp;evaluable_functor, bool to_mesh=true)</div><div class="ttdoc">Adds a functor which can specify algebraic ghosting requirements for use with distributed vectors...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01886">dof_map.C:1886</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a0964620ae8054b969297d1d9087b7b05"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a0964620ae8054b969297d1d9087b7b05">libMesh::DofMap::_n_dfs</a></div><div class="ttdeci">dof_id_type _n_dfs</div><div class="ttdoc">Total number of degrees of freedom. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01988">dof_map.h:1988</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8856db766d722a0edaa9f5c5d94d40f7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">libMesh::DofMap::_node_constraints</a></div><div class="ttdeci">NodeConstraints _node_constraints</div><div class="ttdoc">Data structure containing DofObject constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02041">dof_map.h:2041</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="addb6136725455c3a28e17193d3edf7ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">libMesh::DofMap::~DofMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l00206">206</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01933">_default_coupling</a>, <a class="el" href="dof__map_8h_source.html#l01941">_default_evaluating</a>, <a class="el" href="dof__map_8h_source.html#l01864">_mesh</a> , 以及 <a class="el" href="dof__map_8C_source.html#l00850">clear()</a>.</p>
<div class="fragment"><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;{</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a480f80bc9234a5586711833b87a89784">clear</a>();</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="comment">// clear() resets all but the default DofMap-based functors.  We</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="comment">// need to remove those from the mesh too before we die.</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a>.remove_ghosting_functor(*<a class="code" href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">_default_coupling</a>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a>.remove_ghosting_functor(*<a class="code" href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">_default_evaluating</a>);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a480f80bc9234a5586711833b87a89784"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a480f80bc9234a5586711833b87a89784">libMesh::DofMap::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">Free all new memory associated with the object, but restore its original state, with the mesh pointer...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l00850">dof_map.C:850</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_abb069d1433ad6f8eeb4d5ebf44ae4dc8"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">libMesh::DofMap::_default_coupling</a></div><div class="ttdeci">std::unique_ptr&lt; DefaultCoupling &gt; _default_coupling</div><div class="ttdoc">The default coupling GhostingFunctor, used to implement standard libMesh sparsity pattern constructio...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01933">dof_map.h:1933</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ac0f1617e6f28fc596497b370092bcc17"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">libMesh::DofMap::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdoc">The mesh that system uses. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01864">dof_map.h:1864</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a4eb9c9ed9c530781aac48df4fc0cf27b"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">libMesh::DofMap::_default_evaluating</a></div><div class="ttdeci">std::unique_ptr&lt; DefaultCoupling &gt; _default_evaluating</div><div class="ttdoc">The default algebraic GhostingFunctor, used to implement standard libMesh send_list construction...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01941">dof_map.h:1941</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">成员函数说明</h2>
<a class="anchor" id="ab71695347ecade298eba425d3150ffc6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::_dof_indices </td>
          <td>(</td>
          <td class="paramtype">const Elem &amp;&#160;</td>
          <td class="paramname"><em>elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>p_level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>di</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>vg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>vig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Node *const *&#160;</td>
          <td class="paramname"><em>nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int n_nodes#ifdef&#160;</td>
          <td class="paramname"><em>DEBUG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::size_t &amp;tot_size#&#160;</td>
          <td class="paramname"><em>endif</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper function that gets the dof indices on the current element for a non-SCALAR type variable, where the variable is identified by its variable group number <code>vg</code> and its offset <code>vig</code> from the first variable in that group. </p>
<p>In DEBUG mode, the tot_size parameter will add up the total number of dof indices that should have been added to di, and v will be the variable number corresponding to vg and vig. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l02381">2381</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02022">_dont_p_refine</a>, <a class="el" href="variable_8h_source.html#l00157">libMesh::Variable::active_on_subdomain()</a>, <a class="el" href="dof__object_8h_source.html#l00477">libMesh::DofObject::invalid_id</a>, <a class="el" href="dof__map_8h_source.html#l00659">n_dofs()</a>, <a class="el" href="dof__map_8h_source.html#l02093">sys_number()</a>, <a class="el" href="variable_8h_source.html#l00140">libMesh::Variable::type()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02101">variable_group()</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01992">dof_indices()</a>.</p>
<div class="fragment"><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;{</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;  <span class="keyword">const</span> VariableGroup &amp; var = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab59bc8ca645e02067744580fdf4c9616">variable_group</a>(vg);</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;  <span class="keywordflow">if</span> (var.active_on_subdomain(elem.subdomain_id()))</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;    {</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;      <span class="keyword">const</span> ElemType type        = elem.type();</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sys_num = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">sys_number</a>();</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_INFINITE_ELEMENTS</span></div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;<span class="preprocessor"></span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> is_inf          = elem.infinite();</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> extra_hanging_dofs =</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;        FEInterface::extra_hanging_dofs(var.type());</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;      FEType fe_type = var.type();</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> add_p_level =</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_AMR</span></div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;<span class="preprocessor"></span>          !<a class="code" href="classlibMesh_1_1DofMap.html#a82dd81ff9e21bdc2d9c80f80c692a9ea">_dont_p_refine</a>.count(vg);</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;<span class="preprocessor"></span>          <span class="keyword">false</span>;</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;<span class="preprocessor"></span>      <span class="comment">// The number of dofs per element is non-static for subdivision FE</span></div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;      <span class="keywordflow">if</span> (var.type().family == SUBDIVISION)</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;        tot_size += n_nodes;</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;        <span class="comment">// FIXME: Is the passed-in p_level just elem.p_level()? If so,</span></div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;        <span class="comment">// this seems redundant.</span></div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;        tot_size += FEInterface::n_dofs(fe_type, add_p_level*p_level, &amp;elem);</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;      <span class="comment">// The total Order is not required when getting the function</span></div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;      <span class="comment">// pointer, it is only needed when the function is called (see</span></div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;      <span class="comment">// below).</span></div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;      <span class="keyword">const</span> FEInterface::n_dofs_at_node_ptr ndan =</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;        FEInterface::n_dofs_at_node_function(fe_type, &amp;elem);</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;      <span class="comment">// Get the node-based DOF numbers</span></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=0; n != n_nodes; n++)</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;        {</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;          <span class="keyword">const</span> Node &amp; node = *nodes[n];</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;          <span class="comment">// Cache the intermediate lookups that are common to every</span></div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;          <span class="comment">// component</span></div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;<span class="preprocessor"></span>          <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt;</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;            vg_and_offset = node.var_to_vg_and_offset(sys_num,v);</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;          libmesh_assert_equal_to (vg, vg_and_offset.first);</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;          libmesh_assert_equal_to (vig, vg_and_offset.second);</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;<span class="preprocessor"></span>          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_comp = node.n_comp_group(sys_num,vg);</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;          <span class="comment">// There is a potential problem with h refinement.  Imagine a</span></div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;          <span class="comment">// quad9 that has a linear FE on it.  Then, on the hanging side,</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;          <span class="comment">// it can falsely identify a DOF at the mid-edge node. This is why</span></div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;          <span class="comment">// we go through FEInterface instead of node.n_comp() directly.</span></div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nc =</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_INFINITE_ELEMENTS</span></div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;<span class="preprocessor"></span>            is_inf ?</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;            FEInterface::n_dofs_at_node(fe_type, add_p_level*p_level, &amp;elem, n) :</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;#endif</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;            ndan (type, static_cast&lt;Order&gt;(fe_type.order + add_p_level*p_level), n);</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;          <span class="comment">// If this is a non-vertex on a hanging node with extra</span></div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;          <span class="comment">// degrees of freedom, we use the non-vertex dofs (which</span></div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;          <span class="comment">// come in reverse order starting from the end, to</span></div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;          <span class="comment">// simplify p refinement)</span></div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;          <span class="keywordflow">if</span> (extra_hanging_dofs &amp;&amp; !elem.is_vertex(n))</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;            {</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">int</span> dof_offset = n_comp - nc;</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;              <span class="comment">// We should never have fewer dofs than necessary on a</span></div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;              <span class="comment">// node unless we&#39;re getting indices on a parent element,</span></div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;              <span class="comment">// and we should never need the indices on such a node</span></div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;              <span class="keywordflow">if</span> (dof_offset &lt; 0)</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;                {</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;                  libmesh_assert(!elem.active());</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;                  di.resize(di.size() + nc, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;                }</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=<span class="keywordtype">int</span>(n_comp)-1; i&gt;=dof_offset; i--)</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;                  {</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;                    <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> d =</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;                      node.dof_number(sys_num, vg, vig, i, n_comp);</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;                    libmesh_assert_not_equal_to (d, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;                    di.push_back(d);</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;                  }</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;            }</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;          <span class="comment">// If this is a vertex or an element without extra hanging</span></div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;          <span class="comment">// dofs, our dofs come in forward order coming from the</span></div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;          <span class="comment">// beginning</span></div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;            {</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;              <span class="comment">// We have a good component index only if it&#39;s being</span></div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;              <span class="comment">// used on this FE type (nc) *and* it&#39;s available on</span></div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;              <span class="comment">// this DofObject (n_comp).</span></div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> good_nc = std::min(n_comp, nc);</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i!=good_nc; ++i)</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;                {</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;                  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> d =</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;                    node.dof_number(sys_num, vg, vig, i, n_comp);</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;                  libmesh_assert_not_equal_to (d, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;                  libmesh_assert_less (d, this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a77f8d984574b1bf8886057799e9b0134">n_dofs</a>());</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;                  di.push_back(d);</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;                }</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;              <span class="comment">// With fewer good component indices than we need, e.g.</span></div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;              <span class="comment">// due to subdomain expansion, the remaining expected</span></div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;              <span class="comment">// indices are marked invalid.</span></div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;              <span class="keywordflow">if</span> (n_comp &lt; nc)</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=n_comp; i!=nc; ++i)</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;                  di.push_back(<a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;            }</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;        }</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;      <span class="comment">// If there are any element-based DOF numbers, get them</span></div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nc = FEInterface::n_dofs_per_elem(fe_type, add_p_level*p_level, &amp;elem);</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;      <span class="comment">// We should never have fewer dofs than necessary on an</span></div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;      <span class="comment">// element unless we&#39;re getting indices on a parent element</span></div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;      <span class="comment">// (and we should never need those indices) or off-domain for a</span></div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;      <span class="comment">// subdomain-restricted variable (where invalid_id is the</span></div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;      <span class="comment">// correct thing to return)</span></div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;      <span class="keywordflow">if</span> (nc != 0)</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;        {</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_comp = elem.n_comp_group(sys_num,vg);</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;          <span class="keywordflow">if</span> (elem.n_systems() &gt; sys_num &amp;&amp; nc &lt;= n_comp)</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;            {</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;nc; i++)</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;                {</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;                  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> d =</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;                    elem.dof_number(sys_num, vg, vig, i, n_comp);</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;                  libmesh_assert_not_equal_to (d, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;                  di.push_back(d);</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;                }</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;            }</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;            {</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;              libmesh_assert(!elem.active() || fe_type.family == LAGRANGE || fe_type.family == SUBDIVISION);</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;              di.resize(di.size() + nc, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;            }</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;        }</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;    }</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a77f8d984574b1bf8886057799e9b0134"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a77f8d984574b1bf8886057799e9b0134">libMesh::DofMap::n_dofs</a></div><div class="ttdeci">dof_id_type n_dofs() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00659">dof_map.h:659</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab59bc8ca645e02067744580fdf4c9616"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab59bc8ca645e02067744580fdf4c9616">libMesh::DofMap::variable_group</a></div><div class="ttdeci">const VariableGroup &amp; variable_group(const unsigned int c) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02101">dof_map.h:2101</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_adf3b0ebe7fcc0c41bced4c9f17bf4822"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">libMesh::DofObject::invalid_id</a></div><div class="ttdeci">static const dof_id_type invalid_id</div><div class="ttdoc">An invalid id to distinguish an uninitialized DofObject. </div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00477">dof_object.h:477</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a244e7a1cd82d5e6ae8780c93205ec1fa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02093">dof_map.h:2093</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a82dd81ff9e21bdc2d9c80f80c692a9ea"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a82dd81ff9e21bdc2d9c80f80c692a9ea">libMesh::DofMap::_dont_p_refine</a></div><div class="ttdeci">std::unordered_set&lt; unsigned int &gt; _dont_p_refine</div><div class="ttdoc">A container of variable groups that we should not p-refine. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02022">dof_map.h:2022</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5da0a54ecad33de039c252ddcc6ecb88"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::_node_dof_indices </td>
          <td>(</td>
          <td class="paramtype">const Elem &amp;&#160;</td>
          <td class="paramname"><em>elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1DofObject.html">DofObject</a> &amp;&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>di</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>vn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper function that implements the element-nodal versions of dof_indices and old_dof_indices. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l02296">2296</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02022">_dont_p_refine</a>, <a class="el" href="dof__object_8h_source.html#l01025">libMesh::DofObject::dof_number()</a>, <a class="el" href="dof__object_8h_source.html#l00477">libMesh::DofObject::invalid_id</a>, <a class="el" href="dof__object_8h_source.html#l01008">libMesh::DofObject::n_comp_group()</a>, <a class="el" href="dof__map_8h_source.html#l02093">sys_number()</a>, <a class="el" href="variable_8h_source.html#l00140">libMesh::Variable::type()</a>, <a class="el" href="dof__object_8h_source.html#l01193">libMesh::DofObject::var_to_vg_and_offset()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02101">variable_group()</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l02271">dof_indices()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l02283">old_dof_indices()</a>.</p>
<div class="fragment"><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;{</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;  <span class="comment">// Half of this is a cut and paste of _dof_indices code below, but</span></div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;  <span class="comment">// duplication actually seems cleaner than creating a helper</span></div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;  <span class="comment">// function with a million arguments and hoping the compiler inlines</span></div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;  <span class="comment">// it properly into one of our most highly trafficked functions.</span></div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;_node_dof_indices()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sys_num = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">sys_number</a>();</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> [vg, vig] =</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;    obj.var_to_vg_and_offset(sys_num,vn);</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_comp = obj.n_comp_group(sys_num,vg);</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;  <span class="keyword">const</span> VariableGroup &amp; var = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab59bc8ca645e02067744580fdf4c9616">variable_group</a>(vg);</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;  FEType fe_type = var.type();</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> extra_hanging_dofs =</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;    FEInterface::extra_hanging_dofs(fe_type);</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> add_p_level =</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_AMR</span></div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;<span class="preprocessor"></span>      !<a class="code" href="classlibMesh_1_1DofMap.html#a82dd81ff9e21bdc2d9c80f80c692a9ea">_dont_p_refine</a>.count(vg);</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;<span class="preprocessor"></span>      <span class="keyword">false</span>;</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;  <span class="comment">// There is a potential problem with h refinement.  Imagine a</span></div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;  <span class="comment">// quad9 that has a linear FE on it.  Then, on the hanging side,</span></div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;  <span class="comment">// it can falsely identify a DOF at the mid-edge node. This is why</span></div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;  <span class="comment">// we go through FEInterface instead of obj-&gt;n_comp() directly.</span></div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nc =</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;    FEInterface::n_dofs_at_node(fe_type, &amp;elem, n, add_p_level);</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;  <span class="comment">// If this is a non-vertex on a hanging node with extra</span></div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;  <span class="comment">// degrees of freedom, we use the non-vertex dofs (which</span></div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;  <span class="comment">// come in reverse order starting from the end, to</span></div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;  <span class="comment">// simplify p refinement)</span></div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;  <span class="keywordflow">if</span> (extra_hanging_dofs &amp;&amp; nc &amp;&amp; !elem.is_vertex(n))</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;    {</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> dof_offset = n_comp - nc;</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;      <span class="comment">// We should never have fewer dofs than necessary on a</span></div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;      <span class="comment">// node unless we&#39;re getting indices on a parent element,</span></div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;      <span class="comment">// and we should never need the indices on such a node</span></div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;      <span class="keywordflow">if</span> (dof_offset &lt; 0)</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;        {</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;          libmesh_assert(!elem.active());</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;          di.resize(di.size() + nc, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;        }</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = dof_offset; i != n_comp; ++i)</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;          {</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> d =</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;              obj.dof_number(sys_num, vg, vig, i, n_comp);</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;            libmesh_assert_not_equal_to (d, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;            di.push_back(d);</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;          }</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;    }</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;  <span class="comment">// If this is a vertex or an element without extra hanging</span></div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;  <span class="comment">// dofs, our dofs come in forward order coming from the</span></div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;  <span class="comment">// beginning.  But we still might not have all those dofs, in cases</span></div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;  <span class="comment">// where a subdomain-restricted variable just had its subdomain</span></div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;  <span class="comment">// expanded.</span></div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;    {</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> good_nc =</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;        std::min(static_cast&lt;unsigned int&gt;(n_comp), nc);</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i != good_nc; ++i)</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;        {</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> d =</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;            obj.dof_number(sys_num, vg, vig, i, n_comp);</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;          libmesh_assert_not_equal_to (d, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;          di.push_back(d);</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;        }</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=good_nc; i != nc; ++i)</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;        di.push_back(<a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;    }</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab59bc8ca645e02067744580fdf4c9616"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab59bc8ca645e02067744580fdf4c9616">libMesh::DofMap::variable_group</a></div><div class="ttdeci">const VariableGroup &amp; variable_group(const unsigned int c) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02101">dof_map.h:2101</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_adf3b0ebe7fcc0c41bced4c9f17bf4822"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">libMesh::DofObject::invalid_id</a></div><div class="ttdeci">static const dof_id_type invalid_id</div><div class="ttdoc">An invalid id to distinguish an uninitialized DofObject. </div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00477">dof_object.h:477</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a244e7a1cd82d5e6ae8780c93205ec1fa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02093">dof_map.h:2093</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a82dd81ff9e21bdc2d9c80f80c692a9ea"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a82dd81ff9e21bdc2d9c80f80c692a9ea">libMesh::DofMap::_dont_p_refine</a></div><div class="ttdeci">std::unordered_set&lt; unsigned int &gt; _dont_p_refine</div><div class="ttdoc">A container of variable groups that we should not p-refine. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02022">dof_map.h:2022</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acf485df94525efa4993f755c5b65a448"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_adjoint_constraint_row </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>qoi_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td>
          <td class="paramname"><em>dof_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp;&#160;</td>
          <td class="paramname"><em>constraint_row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>&#160;</td>
          <td class="paramname"><em>constraint_rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>forbid_constraint_overwrite</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a copy of the user-defined row to the constraint matrix, using an inhomogeneous right-hand-side for the adjoint constraint equation. </p>
<p><code>forbid_constraint_overwrite</code> here only tests for overwriting the rhs. This method should only be used when an equivalent constraint (with a potentially different rhs) already exists for the primal problem. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l02218">2218</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02034">_adjoint_constraint_values</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02179">is_constrained_dof()</a>.</p>
<div class="fragment"><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;{</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;  <span class="comment">// Optionally allow the user to overwrite constraints.  Defaults to false.</span></div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;  <span class="keywordflow">if</span> (forbid_constraint_overwrite)</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;    {</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;      libmesh_error_msg_if(!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">is_constrained_dof</a>(dof_number),</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;                           <span class="stringliteral">&quot;ERROR: DOF &quot;</span> &lt;&lt; dof_number &lt;&lt; <span class="stringliteral">&quot; has no corresponding primal constraint!&quot;</span>);</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;<span class="preprocessor"></span>      <span class="comment">// No way to do this without a non-normalized tolerance?</span></div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;      <span class="comment">// // If the user passed in more than just the rhs, let&#39;s check the</span></div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;      <span class="comment">// // coefficients for consistency</span></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;      <span class="comment">// if (!constraint_row.empty())</span></div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;      <span class="comment">//   {</span></div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;      <span class="comment">//     DofConstraintRow row = _dof_constraints[dof_number];</span></div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;      <span class="comment">//     for (const auto &amp; [dof, val] : row)</span></div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;      <span class="comment">//       libmesh_assert(constraint_row.find(dof)-&gt;second == val);</span></div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;      <span class="comment">//   }</span></div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;      <span class="comment">// if (_adjoint_constraint_values[qoi_index].find(dof_number) !=</span></div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;      <span class="comment">//     _adjoint_constraint_values[qoi_index].end())</span></div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;      <span class="comment">//   libmesh_assert_equal_to(_adjoint_constraint_values[qoi_index][dof_number],</span></div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;      <span class="comment">//                           constraint_rhs);</span></div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;<span class="preprocessor"></span>    }</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;  <span class="comment">// Creates the map of rhs values if it doesn&#39;t already exist; then</span></div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;  <span class="comment">// adds the current value to that map</span></div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;  <span class="comment">// We don&#39;t get insert_or_assign until C++17 so we make do.</span></div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;  std::pair&lt;DofConstraintValueMap::iterator, bool&gt; rhs_it =</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>[qoi_index].emplace(dof_number, constraint_rhs);</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;  <span class="keywordflow">if</span> (!rhs_it.second)</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    rhs_it.first-&gt;second = constraint_rhs;</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02034">dof_map.h:2034</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9846273ba4930ef0364bc1fc954af914"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02179">dof_map.h:2179</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7473e667efd0197d42213c8126ad910a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_adjoint_dirichlet_boundary </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1DirichletBoundary.html">DirichletBoundary</a> &amp;&#160;</td>
          <td class="paramname"><em>dirichlet_boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a copy of the specified Dirichlet boundary to the system, corresponding to the adjoint problem defined by Quantity of Interest <code>q</code>. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l05456">5456</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02064">_adjoint_dirichlet_boundaries</a>.</p>
<div class="fragment"><div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;{</div>
<div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> old_size = cast_int&lt;unsigned int&gt;</div>
<div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;    (<a class="code" href="classlibMesh_1_1DofMap.html#a376604ef648f92ce79ed7d2c810b55f3">_adjoint_dirichlet_boundaries</a>.size());</div>
<div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = old_size; i &lt;= qoi_index; ++i)</div>
<div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a376604ef648f92ce79ed7d2c810b55f3">_adjoint_dirichlet_boundaries</a>.push_back(std::make_unique&lt;DirichletBoundaries&gt;());</div>
<div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;</div>
<div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;  <span class="comment">// Make copy of DirichletBoundary, owned by _adjoint_dirichlet_boundaries</span></div>
<div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a376604ef648f92ce79ed7d2c810b55f3">_adjoint_dirichlet_boundaries</a>[qoi_index]-&gt;push_back</div>
<div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;    (std::make_unique&lt;DirichletBoundary&gt;(dirichlet_boundary));</div>
<div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a376604ef648f92ce79ed7d2c810b55f3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a376604ef648f92ce79ed7d2c810b55f3">libMesh::DofMap::_adjoint_dirichlet_boundaries</a></div><div class="ttdeci">std::vector&lt; std::unique_ptr&lt; DirichletBoundaries &gt; &gt; _adjoint_dirichlet_boundaries</div><div class="ttdoc">Data structure containing Dirichlet functions. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02064">dof_map.h:2064</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9a0c5eeda42bc54bb3ae1c2d05ec5227"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_algebraic_ghosting_functor </td>
          <td>(</td>
          <td class="paramtype">GhostingFunctor &amp;&#160;</td>
          <td class="paramname"><em>evaluable_functor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>to_mesh</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a functor which can specify algebraic ghosting requirements for use with distributed vectors. </p>
<p>Degrees of freedom on other processors which match the elements and variables returned by these functors will be added to the send_list, and the elements on other processors will be ghosted on a distributed mesh, so that the elements can always be found and the solutions on them will always be evaluable.</p>
<p>GhostingFunctor memory must be managed by the code which calls this function; the GhostingFunctor lifetime is expected to extend until either the functor is removed or the <a class="el" href="classlibMesh_1_1DofMap.html" title="This class handles the numbering of degrees of freedom on a mesh. ">DofMap</a> is destructed.</p>
<p>When <code>to_mesh</code> is true, the <code>coupling_functor</code> is also added to our associated mesh, to ensure that evaluable elements do not get lost during mesh distribution. (if evaluable elements were <em>already</em> lost there's no getting them back after the fact, sorry)</p>
<p>If <code>to_mesh</code> is false, no change to mesh ghosting is made; the Mesh must already have ghosting functor(s) specifying a superset of <code>evaluable_functor</code> or this is a horrible bug. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l01886">1886</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01951">_algebraic_ghosting_functors</a> , 以及 <a class="el" href="dof__map_8h_source.html#l01864">_mesh</a>.</p>

<p>参考自 <a class="el" href="dof__map_8h_source.html#l00391">add_algebraic_ghosting_functor()</a>, <a class="el" href="dof__map_8C_source.html#l01852">add_default_ghosting()</a>, <a class="el" href="dof__map_8C_source.html#l00850">clear()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l00135">DofMap()</a>.</p>
<div class="fragment"><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;{</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a378d58f5e860f781a52adb61464c9378">_algebraic_ghosting_functors</a>.insert(&amp;evaluable_functor);</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;  evaluable_functor.set_mesh(&amp;<a class="code" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a>);</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;  <span class="keywordflow">if</span> (to_mesh)</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a>.add_ghosting_functor(evaluable_functor);</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a378d58f5e860f781a52adb61464c9378"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a378d58f5e860f781a52adb61464c9378">libMesh::DofMap::_algebraic_ghosting_functors</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt; _algebraic_ghosting_functors</div><div class="ttdoc">The list of all GhostingFunctor objects to be used when distributing ghosted vectors. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01951">dof_map.h:1951</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ac0f1617e6f28fc596497b370092bcc17"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">libMesh::DofMap::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdoc">The mesh that system uses. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01864">dof_map.h:1864</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6e7708655c2f2bece396fb675504af2d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_algebraic_ghosting_functor </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; GhostingFunctor &gt;&#160;</td>
          <td class="paramname"><em>evaluable_functor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>to_mesh</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds a functor which can specify algebraic ghosting requirements for use with distributed vectors. </p>
<p>GhostingFunctor memory when using this method is managed by the shared_ptr mechanism. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00391">391</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01970">_shared_functors</a> , 以及 <a class="el" href="dof__map_8C_source.html#l01886">add_algebraic_ghosting_functor()</a>.</p>
<div class="fragment"><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  { <a class="code" href="classlibMesh_1_1DofMap.html#ac72a2e7009922c18fc0a59ebcceb58b1">_shared_functors</a>[evaluable_functor.get()] = evaluable_functor;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9a0c5eeda42bc54bb3ae1c2d05ec5227">add_algebraic_ghosting_functor</a>(*evaluable_functor, to_mesh); }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ac72a2e7009922c18fc0a59ebcceb58b1"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ac72a2e7009922c18fc0a59ebcceb58b1">libMesh::DofMap::_shared_functors</a></div><div class="ttdeci">std::map&lt; GhostingFunctor *, std::shared_ptr&lt; GhostingFunctor &gt; &gt; _shared_functors</div><div class="ttdoc">Hang on to references to any GhostingFunctor objects we were passed in shared_ptr form...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01970">dof_map.h:1970</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9a0c5eeda42bc54bb3ae1c2d05ec5227"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9a0c5eeda42bc54bb3ae1c2d05ec5227">libMesh::DofMap::add_algebraic_ghosting_functor</a></div><div class="ttdeci">void add_algebraic_ghosting_functor(GhostingFunctor &amp;evaluable_functor, bool to_mesh=true)</div><div class="ttdoc">Adds a functor which can specify algebraic ghosting requirements for use with distributed vectors...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01886">dof_map.C:1886</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ada019c02054ed5945504a6c5fc856d69"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_constraint_row </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td>
          <td class="paramname"><em>dof_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp;&#160;</td>
          <td class="paramname"><em>constraint_row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>&#160;</td>
          <td class="paramname"><em>constraint_rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>forbid_constraint_overwrite</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a copy of the user-defined row to the constraint matrix, using an inhomogeneous right-hand-side for the constraint equation. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l02183">2183</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>, <a class="el" href="dof__map_8h_source.html#l02032">_primal_constraint_values</a>, <a class="el" href="dof__map_8h_source.html#l02179">is_constrained_dof()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l00659">n_dofs()</a>.</p>

<p>参考自 <a class="el" href="dof__map_8h_source.html#l01002">add_constraint_row()</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l01898">process_mesh_constraint_rows()</a>.</p>
<div class="fragment"><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;{</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;  <span class="comment">// Optionally allow the user to overwrite constraints.  Defaults to false.</span></div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;  libmesh_error_msg_if(forbid_constraint_overwrite &amp;&amp; this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">is_constrained_dof</a>(dof_number),</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;                       <span class="stringliteral">&quot;ERROR: DOF &quot;</span> &lt;&lt; dof_number &lt;&lt; <span class="stringliteral">&quot; was already constrained!&quot;</span>);</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;  libmesh_assert_less(dof_number, this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a77f8d984574b1bf8886057799e9b0134">n_dofs</a>());</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;  <span class="comment">// There is an implied &quot;1&quot; on the diagonal of the constraint row, and the user</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;  <span class="comment">// should not try to manually set _any_ value on the diagonal.</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;  libmesh_assert_msg(!constraint_row.count(dof_number),</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;                     <span class="stringliteral">&quot;Error: constraint_row for dof &quot;</span> &lt;&lt; dof_number &lt;&lt;</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;                     <span class="stringliteral">&quot; should not contain an entry for dof &quot;</span> &lt;&lt; dof_number);</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; pr : constraint_row)</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;    libmesh_assert_less(pr.first, this-&gt;n_dofs());</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;  <span class="comment">// We don&#39;t get insert_or_assign until C++17 so we make do.</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;  std::pair&lt;DofConstraints::iterator, bool&gt; it =</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.emplace(dof_number, constraint_row);</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;  <span class="keywordflow">if</span> (!it.second)</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;    it.first-&gt;second = constraint_row;</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;  std::pair&lt;DofConstraintValueMap::iterator, bool&gt; rhs_it =</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.emplace(dof_number, constraint_rhs);</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;  <span class="keywordflow">if</span> (!rhs_it.second)</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;    rhs_it.first-&gt;second = constraint_rhs;</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a77f8d984574b1bf8886057799e9b0134"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a77f8d984574b1bf8886057799e9b0134">libMesh::DofMap::n_dofs</a></div><div class="ttdeci">dof_id_type n_dofs() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00659">dof_map.h:659</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9846273ba4930ef0364bc1fc954af914"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02179">dof_map.h:2179</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02032">dof_map.h:2032</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a84adefac2c57cc5a76ceae26ef7f9472"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_constraint_row </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td>
          <td class="paramname"><em>dof_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp;&#160;</td>
          <td class="paramname"><em>constraint_row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>forbid_constraint_overwrite</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds a copy of the user-defined row to the constraint matrix, using a homogeneous right-hand-side for the constraint equation. </p>
<p>By default, produces an error if the DOF was already constrained. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01002">1002</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map__constraints_8C_source.html#l02183">add_constraint_row()</a>.</p>
<div class="fragment"><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  { <a class="code" href="classlibMesh_1_1DofMap.html#ada019c02054ed5945504a6c5fc856d69">add_constraint_row</a>(dof_number, constraint_row, 0., forbid_constraint_overwrite); }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ada019c02054ed5945504a6c5fc856d69"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ada019c02054ed5945504a6c5fc856d69">libMesh::DofMap::add_constraint_row</a></div><div class="ttdeci">void add_constraint_row(const dof_id_type dof_number, const DofConstraintRow &amp;constraint_row, const Number constraint_rhs, const bool forbid_constraint_overwrite)</div><div class="ttdoc">Adds a copy of the user-defined row to the constraint matrix, using an inhomogeneous right-hand-side ...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l02183">dof_map_constraints.C:2183</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0783b9a05a297be8f1c3e630301e0604"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_constraints_to_send_list </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds entries to the <code>_send_list</code> vector corresponding to DoFs which are dependencies for constraint equations on the current processor. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l05349">5349</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>, <a class="el" href="dof__map_8h_source.html#l01893">_send_list</a> , 以及 <a class="el" href="dof__map_8h_source.html#l00831">local_index()</a>.</p>

<p>参考自 <a class="el" href="dof__map__constraints_8C_source.html#l04372">process_constraints()</a>.</p>
<div class="fragment"><div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;{</div>
<div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div>
<div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;  parallel_object_only();</div>
<div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;</div>
<div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;  <span class="comment">// Return immediately if there&#39;s nothing to gather</span></div>
<div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;  <span class="keywordflow">if</span> (this-&gt;n_processors() == 1)</div>
<div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;</div>
<div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;  <span class="comment">// We might get to return immediately if none of the processors</span></div>
<div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;  <span class="comment">// found any constraints</span></div>
<div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> has_constraints = !<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.empty();</div>
<div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;  this-&gt;comm().max(has_constraints);</div>
<div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;  <span class="keywordflow">if</span> (!has_constraints)</div>
<div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;</div>
<div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; [constrained_dof, constraint_row] : <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>)</div>
<div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;    {</div>
<div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;      <span class="comment">// We only need the dependencies of our own constrained dofs</span></div>
<div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;      <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">local_index</a>(constrained_dof))</div>
<div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;</div>
<div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; j : constraint_row)</div>
<div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;        {</div>
<div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;          <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constraint_dependency = j.first;</div>
<div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;</div>
<div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;          <span class="comment">// No point in adding one of our own dofs to the send_list</span></div>
<div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;          <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">local_index</a>(constraint_dependency))</div>
<div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;</div>
<div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;          <a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>.push_back(constraint_dependency);</div>
<div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;        }</div>
<div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;    }</div>
<div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2b3873478d701811b9562b514fc2c369"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">libMesh::DofMap::_send_list</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _send_list</div><div class="ttdoc">A list containing all the global DOF indices that affect the solution on my processor. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01893">dof_map.h:1893</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab6d9ab04643e9028f7f0c9b4d18e0455"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">libMesh::DofMap::local_index</a></div><div class="ttdeci">bool local_index(dof_id_type dof_index) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00831">dof_map.h:831</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae17b27f47b3731f6ce72312edd957bf7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_coupling_functor </td>
          <td>(</td>
          <td class="paramtype">GhostingFunctor &amp;&#160;</td>
          <td class="paramname"><em>coupling_functor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>to_mesh</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a functor which can specify coupling requirements for creation of sparse matrices. </p>
<p>Degree of freedom pairs which match the elements and variables returned by these functors will be added to the sparsity pattern, and the degrees of freedom which live on other processors will be added to the send_list for use on ghosted vectors, and the elements which live on other processors will be ghosted on a distributed mesh.</p>
<p>GhostingFunctor memory must be managed by the code which calls this function; the GhostingFunctor lifetime is expected to extend until either the functor is removed or the <a class="el" href="classlibMesh_1_1DofMap.html" title="This class handles the numbering of degrees of freedom on a mesh. ">DofMap</a> is destructed.</p>
<p>When <code>to_mesh</code> is true, the <code>coupling_functor</code> is also added to our associated mesh, to ensure that coupled elements do not get lost during mesh distribution. (if coupled elements were <em>already</em> lost there's no getting them back after the fact, sorry)</p>
<p>If <code>to_mesh</code> is false, no change to mesh ghosting is made; the Mesh must already have ghosting functor(s) specifying a superset of <code>coupling_functor</code> or this is a horrible bug. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l01861">1861</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01964">_coupling_functors</a> , 以及 <a class="el" href="dof__map_8h_source.html#l01864">_mesh</a>.</p>

<p>参考自 <a class="el" href="dof__map_8h_source.html#l00329">add_coupling_functor()</a>, <a class="el" href="dof__map_8C_source.html#l01852">add_default_ghosting()</a>, <a class="el" href="dof__map_8C_source.html#l00850">clear()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l00135">DofMap()</a>.</p>
<div class="fragment"><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;{</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">_coupling_functors</a>.insert(&amp;coupling_functor);</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;  coupling_functor.set_mesh(&amp;<a class="code" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a>);</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;  <span class="keywordflow">if</span> (to_mesh)</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a>.add_ghosting_functor(coupling_functor);</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aef1ebc9176a3f7ec9607ba4b26808991"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">libMesh::DofMap::_coupling_functors</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt; _coupling_functors</div><div class="ttdoc">The list of all GhostingFunctor objects to be used when coupling degrees of freedom in matrix sparsit...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01964">dof_map.h:1964</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ac0f1617e6f28fc596497b370092bcc17"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">libMesh::DofMap::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdoc">The mesh that system uses. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01864">dof_map.h:1864</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acecfc7f5984014d7756f6792c782fa39"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_coupling_functor </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; GhostingFunctor &gt;&#160;</td>
          <td class="paramname"><em>coupling_functor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>to_mesh</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds a functor which can specify coupling requirements for creation of sparse matrices. </p>
<p>GhostingFunctor memory when using this method is managed by the shared_ptr mechanism. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00329">329</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01970">_shared_functors</a> , 以及 <a class="el" href="dof__map_8C_source.html#l01861">add_coupling_functor()</a>.</p>
<div class="fragment"><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  { <a class="code" href="classlibMesh_1_1DofMap.html#ac72a2e7009922c18fc0a59ebcceb58b1">_shared_functors</a>[coupling_functor.get()] = coupling_functor;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ae17b27f47b3731f6ce72312edd957bf7">add_coupling_functor</a>(*coupling_functor, to_mesh); }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ae17b27f47b3731f6ce72312edd957bf7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ae17b27f47b3731f6ce72312edd957bf7">libMesh::DofMap::add_coupling_functor</a></div><div class="ttdeci">void add_coupling_functor(GhostingFunctor &amp;coupling_functor, bool to_mesh=true)</div><div class="ttdoc">Adds a functor which can specify coupling requirements for creation of sparse matrices. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01861">dof_map.C:1861</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ac72a2e7009922c18fc0a59ebcceb58b1"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ac72a2e7009922c18fc0a59ebcceb58b1">libMesh::DofMap::_shared_functors</a></div><div class="ttdeci">std::map&lt; GhostingFunctor *, std::shared_ptr&lt; GhostingFunctor &gt; &gt; _shared_functors</div><div class="ttdoc">Hang on to references to any GhostingFunctor objects we were passed in shared_ptr form...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01970">dof_map.h:1970</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a71555fd980f9337928ae75bc36a1bd4e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_default_ghosting </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add the default functor(s) for coupling and algebraic ghosting. </p>
<p>User-added ghosting functors will be unaffected. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l01852">1852</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8C_source.html#l01886">add_algebraic_ghosting_functor()</a>, <a class="el" href="dof__map_8C_source.html#l01861">add_coupling_functor()</a>, <a class="el" href="dof__map_8h_source.html#l00418">default_algebraic_ghosting()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l00356">default_coupling()</a>.</p>
<div class="fragment"><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;{</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ae17b27f47b3731f6ce72312edd957bf7">add_coupling_functor</a>(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aa387f2af29a1998bc1236a20a9870b64">default_coupling</a>());</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9a0c5eeda42bc54bb3ae1c2d05ec5227">add_algebraic_ghosting_functor</a>(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ac341c27edd859113d774716d5ad18d9f">default_algebraic_ghosting</a>());</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aa387f2af29a1998bc1236a20a9870b64"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa387f2af29a1998bc1236a20a9870b64">libMesh::DofMap::default_coupling</a></div><div class="ttdeci">DefaultCoupling &amp; default_coupling()</div><div class="ttdoc">Default coupling functor. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00356">dof_map.h:356</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ac341c27edd859113d774716d5ad18d9f"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ac341c27edd859113d774716d5ad18d9f">libMesh::DofMap::default_algebraic_ghosting</a></div><div class="ttdeci">DefaultCoupling &amp; default_algebraic_ghosting()</div><div class="ttdoc">Default algebraic ghosting functor. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00418">dof_map.h:418</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ae17b27f47b3731f6ce72312edd957bf7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ae17b27f47b3731f6ce72312edd957bf7">libMesh::DofMap::add_coupling_functor</a></div><div class="ttdeci">void add_coupling_functor(GhostingFunctor &amp;coupling_functor, bool to_mesh=true)</div><div class="ttdoc">Adds a functor which can specify coupling requirements for creation of sparse matrices. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01861">dof_map.C:1861</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9a0c5eeda42bc54bb3ae1c2d05ec5227"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9a0c5eeda42bc54bb3ae1c2d05ec5227">libMesh::DofMap::add_algebraic_ghosting_functor</a></div><div class="ttdeci">void add_algebraic_ghosting_functor(GhostingFunctor &amp;evaluable_functor, bool to_mesh=true)</div><div class="ttdoc">Adds a functor which can specify algebraic ghosting requirements for use with distributed vectors...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01886">dof_map.C:1886</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a47b7566f3cf2608d913792fd3e963b5d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_dirichlet_boundary </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1DirichletBoundary.html">DirichletBoundary</a> &amp;&#160;</td>
          <td class="paramname"><em>dirichlet_boundary</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a copy of the specified Dirichlet boundary to the system. </p>
<p>The constraints implied by <a class="el" href="classlibMesh_1_1DirichletBoundary.html" title="This class allows one to associate Dirichlet boundary values with a given set of mesh boundary ids an...">DirichletBoundary</a> objects are imposed in the same order in which <a class="el" href="classlibMesh_1_1DirichletBoundary.html" title="This class allows one to associate Dirichlet boundary values with a given set of mesh boundary ids an...">DirichletBoundary</a> objects are added to the <a class="el" href="classlibMesh_1_1DofMap.html" title="This class handles the numbering of degrees of freedom on a mesh. ">DofMap</a>. When multiple <a class="el" href="classlibMesh_1_1DirichletBoundary.html" title="This class allows one to associate Dirichlet boundary values with a given set of mesh boundary ids an...">DirichletBoundary</a> objects would impose competing constraints on a given DOF, the <em>first</em> <a class="el" href="classlibMesh_1_1DirichletBoundary.html" title="This class allows one to associate Dirichlet boundary values with a given set of mesh boundary ids an...">DirichletBoundary</a> to constrain the DOF "wins". This distinction is important when e.g. two surfaces (sidesets) intersect. The nodes on the intersection will be constrained according to whichever sideset's <a class="el" href="classlibMesh_1_1DirichletBoundary.html" title="This class allows one to associate Dirichlet boundary values with a given set of mesh boundary ids an...">DirichletBoundary</a> object was added to the <a class="el" href="classlibMesh_1_1DofMap.html" title="This class handles the numbering of degrees of freedom on a mesh. ">DofMap</a> first. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l05450">5450</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02058">_dirichlet_boundaries</a>.</p>
<div class="fragment"><div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;{</div>
<div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">_dirichlet_boundaries</a>-&gt;push_back(std::make_unique&lt;DirichletBoundary&gt;(dirichlet_boundary));</div>
<div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2e9be7e72291d4fd6e841ae7733a5ff0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">libMesh::DofMap::_dirichlet_boundaries</a></div><div class="ttdeci">std::unique_ptr&lt; DirichletBoundaries &gt; _dirichlet_boundaries</div><div class="ttdoc">Data structure containing Dirichlet functions. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02058">dof_map.h:2058</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aed8eba054300e64164af4a8257bae8d8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_neighbors_to_send_list </td>
          <td>(</td>
          <td class="paramtype">MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds entries to the <code>_send_list</code> vector corresponding to DoFs on elements neighboring the current processor. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l01544">1544</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01893">_send_list</a>, <a class="el" href="dof__map_8h_source.html#l00406">algebraic_ghosting_functors_begin()</a>, <a class="el" href="dof__map_8h_source.html#l00412">algebraic_ghosting_functors_end()</a>, <a class="el" href="dof__map_8h_source.html#l00344">coupling_functors_begin()</a>, <a class="el" href="dof__map_8h_source.html#l00350">coupling_functors_end()</a>, <a class="el" href="dof__map_8C_source.html#l01992">dof_indices()</a>, <a class="el" href="dof__object_8h_source.html#l00477">libMesh::DofObject::invalid_id</a>, <a class="el" href="dof__map_8h_source.html#l00831">local_index()</a>, <a class="el" href="dof__map_8C_source.html#l01440">merge_ghost_functor_outputs()</a>, <a class="el" href="dof__map_8h_source.html#l00659">n_dofs()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l00621">n_variables()</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00927">distribute_dofs()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l01734">reinit_send_list()</a>.</p>
<div class="fragment"><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;{</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;add_neighbors_to_send_list()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;  <span class="comment">// Return immediately if there&#39;s no ghost data</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;  <span class="keywordflow">if</span> (this-&gt;n_processors() == 1)</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_var  = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aee89c467613b296c215421d60d5ae961">n_variables</a>();</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;  MeshBase::const_element_iterator       local_elem_it</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    = mesh.active_local_elements_begin();</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  <span class="keyword">const</span> MeshBase::const_element_iterator local_elem_end</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    = mesh.active_local_elements_end();</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  GhostingFunctor::map_type elements_to_send;</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#abddb472d25fdb74e211e214710c48534">DofMap::CouplingMatricesSet</a> temporary_coupling_matrices;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;  <span class="comment">// We need to add dofs to the send list if they&#39;ve been directly</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  <span class="comment">// requested by an algebraic ghosting functor or they&#39;ve been</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  <span class="comment">// indirectly requested by a coupling functor.</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aaba8d0fe4f60763e0a52f7ae1d4b7153">merge_ghost_functor_outputs</a>(elements_to_send,</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                                    temporary_coupling_matrices,</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                                    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#acc22ec21b664be90d810a7c28a4d94ba">algebraic_ghosting_functors_begin</a>(),</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;                                    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a752e6253240ff035da7835c865284225">algebraic_ghosting_functors_end</a>(),</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;                                    local_elem_it, local_elem_end, mesh.processor_id());</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aaba8d0fe4f60763e0a52f7ae1d4b7153">merge_ghost_functor_outputs</a>(elements_to_send,</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                                    temporary_coupling_matrices,</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                                    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a167ad5d7c58f7ef60da5e365764962c1">coupling_functors_begin</a>(),</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;                                    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a13a2755e548a51040ee833c1aca2520b">coupling_functors_end</a>(),</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;                                    local_elem_it, local_elem_end, mesh.processor_id());</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;  <span class="comment">// Making a list of non-zero coupling matrix columns is an</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;  <span class="comment">// O(N_var^2) operation.  We cache it so we only have to do it once</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;  <span class="comment">// per CouplingMatrix and not once per element.</span></div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;  std::map&lt;const CouplingMatrix *, std::vector&lt;unsigned int&gt;&gt;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    column_variable_lists;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; [partner, ghost_coupling] : elements_to_send)</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    {</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;      <span class="comment">// We asked ghosting functors not to give us local elements</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;      libmesh_assert_not_equal_to</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;        (partner-&gt;processor_id(), this-&gt;processor_id());</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;      <span class="comment">// Loop over any present coupling matrix column variables if we</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;      <span class="comment">// have a coupling matrix, or just add all variables to</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;      <span class="comment">// send_list if not.</span></div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;      <span class="keywordflow">if</span> (ghost_coupling)</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;        {</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;          libmesh_assert_equal_to (ghost_coupling-&gt;size(), n_var);</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;          <span class="comment">// Try to find a cached list of column variables.</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;          std::map&lt;const CouplingMatrix *, std::vector&lt;unsigned int&gt;&gt;::const_iterator</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;            column_variable_list = column_variable_lists.find(ghost_coupling);</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;          <span class="comment">// If we didn&#39;t find it, then we need to create it.</span></div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;          <span class="keywordflow">if</span> (column_variable_list == column_variable_lists.end())</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;            {</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;              <span class="keyword">auto</span> inserted_variable_list_pair =</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;                column_variable_lists.emplace(ghost_coupling, std::vector&lt;unsigned int&gt;());</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;              column_variable_list = inserted_variable_list_pair.first;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;              std::vector&lt;unsigned int&gt; &amp; new_variable_list =</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;                inserted_variable_list_pair.first-&gt;second;</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;              std::vector&lt;unsigned char&gt; has_variable(n_var, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vi = 0; vi != n_var; ++vi)</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                {</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                  ConstCouplingRow ccr(vi, *ghost_coupling);</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;                  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; vj : ccr)</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                    has_variable[vj] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                }</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vj = 0; vj != n_var; ++vj)</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                {</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                  <span class="keywordflow">if</span> (has_variable[vj])</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                    new_variable_list.push_back(vj);</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                }</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;            }</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;          <span class="keyword">const</span> std::vector&lt;unsigned int&gt; &amp; variable_list =</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;            column_variable_list-&gt;second;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; vj : variable_list)</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;            {</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;              std::vector&lt;dof_id_type&gt; di;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;              this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a0d323b6fcb736454a9f6074ebda9ec28">dof_indices</a> (partner, di, vj);</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;              <span class="comment">// Insert the remote DOF indices into the send list</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;              <span class="keywordflow">for</span> (<span class="keyword">auto</span> d : di)</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                <span class="keywordflow">if</span> (d != <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a> &amp;&amp;</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                    !this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">local_index</a>(d))</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                  {</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                    libmesh_assert_less(d, this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a77f8d984574b1bf8886057799e9b0134">n_dofs</a>());</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                    <a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>.push_back(d);</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                  }</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;            }</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;        }</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;        {</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;          std::vector&lt;dof_id_type&gt; di;</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a0d323b6fcb736454a9f6074ebda9ec28">dof_indices</a> (partner, di);</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;          <span class="comment">// Insert the remote DOF indices into the send list</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; dof : di)</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;            <span class="keywordflow">if</span> (dof != <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a> &amp;&amp;</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                !this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">local_index</a>(dof))</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;              {</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                libmesh_assert_less(dof, this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a77f8d984574b1bf8886057799e9b0134">n_dofs</a>());</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;                <a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>.push_back(dof);</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;              }</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        }</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    }</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;  <span class="comment">// We&#39;re now done with any merged coupling matrices we had to create.</span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;  temporary_coupling_matrices.clear();</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;  <span class="comment">//-------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;  <span class="comment">// Our coupling functors added dofs from neighboring elements to the</span></div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;  <span class="comment">// send list, but we may still need to add non-local dofs from local</span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  <span class="comment">// elements.</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;  <span class="comment">//-------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;  <span class="comment">// Loop over the active local elements, adding all active elements</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;  <span class="comment">// that neighbor an active local element to the send list.</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;  <span class="keywordflow">for</span> ( ; local_elem_it != local_elem_end; ++local_elem_it)</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    {</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;      <span class="keyword">const</span> Elem * elem = *local_elem_it;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;      std::vector&lt;dof_id_type&gt; di;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a0d323b6fcb736454a9f6074ebda9ec28">dof_indices</a> (elem, di);</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;      <span class="comment">// Insert the remote DOF indices into the send list</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; dof : di)</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;        <span class="keywordflow">if</span> (dof != <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a> &amp;&amp;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;            !this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">local_index</a>(dof))</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;          {</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;            libmesh_assert_less(dof, this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a77f8d984574b1bf8886057799e9b0134">n_dofs</a>());</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;            <a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>.push_back(dof);</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;          }</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    }</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_acc22ec21b664be90d810a7c28a4d94ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#acc22ec21b664be90d810a7c28a4d94ba">libMesh::DofMap::algebraic_ghosting_functors_begin</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt;::const_iterator algebraic_ghosting_functors_begin() const </div><div class="ttdoc">Beginning of range of algebraic ghosting functors. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00406">dof_map.h:406</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a167ad5d7c58f7ef60da5e365764962c1"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a167ad5d7c58f7ef60da5e365764962c1">libMesh::DofMap::coupling_functors_begin</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt;::const_iterator coupling_functors_begin() const </div><div class="ttdoc">Beginning of range of coupling functors. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00344">dof_map.h:344</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2b3873478d701811b9562b514fc2c369"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">libMesh::DofMap::_send_list</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _send_list</div><div class="ttdoc">A list containing all the global DOF indices that affect the solution on my processor. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01893">dof_map.h:1893</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab6d9ab04643e9028f7f0c9b4d18e0455"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">libMesh::DofMap::local_index</a></div><div class="ttdeci">bool local_index(dof_id_type dof_index) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00831">dof_map.h:831</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a77f8d984574b1bf8886057799e9b0134"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a77f8d984574b1bf8886057799e9b0134">libMesh::DofMap::n_dofs</a></div><div class="ttdeci">dof_id_type n_dofs() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00659">dof_map.h:659</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_abddb472d25fdb74e211e214710c48534"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#abddb472d25fdb74e211e214710c48534">libMesh::DofMap::CouplingMatricesSet</a></div><div class="ttdeci">std::set&lt; std::unique_ptr&lt; CouplingMatrix &gt;, Utility::CompareUnderlying &gt; CouplingMatricesSet</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01742">dof_map.h:1742</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_adf3b0ebe7fcc0c41bced4c9f17bf4822"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">libMesh::DofObject::invalid_id</a></div><div class="ttdeci">static const dof_id_type invalid_id</div><div class="ttdoc">An invalid id to distinguish an uninitialized DofObject. </div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00477">dof_object.h:477</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a752e6253240ff035da7835c865284225"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a752e6253240ff035da7835c865284225">libMesh::DofMap::algebraic_ghosting_functors_end</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt;::const_iterator algebraic_ghosting_functors_end() const </div><div class="ttdoc">End of range of algebraic ghosting functors. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00412">dof_map.h:412</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aee89c467613b296c215421d60d5ae961"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aee89c467613b296c215421d60d5ae961">libMesh::DofMap::n_variables</a></div><div class="ttdeci">unsigned int n_variables() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00621">dof_map.h:621</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aaba8d0fe4f60763e0a52f7ae1d4b7153"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aaba8d0fe4f60763e0a52f7ae1d4b7153">libMesh::DofMap::merge_ghost_functor_outputs</a></div><div class="ttdeci">static void merge_ghost_functor_outputs(GhostingFunctor::map_type &amp;elements_to_ghost, CouplingMatricesSet &amp;temporary_coupling_matrices, const std::set&lt; GhostingFunctor * &gt;::iterator &amp;gf_begin, const std::set&lt; GhostingFunctor * &gt;::iterator &amp;gf_end, const MeshBase::const_element_iterator &amp;elems_begin, const MeshBase::const_element_iterator &amp;elems_end, processor_id_type p)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01440">dof_map.C:1440</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a13a2755e548a51040ee833c1aca2520b"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a13a2755e548a51040ee833c1aca2520b">libMesh::DofMap::coupling_functors_end</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt;::const_iterator coupling_functors_end() const </div><div class="ttdoc">End of range of coupling functors. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00350">dof_map.h:350</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a0d323b6fcb736454a9f6074ebda9ec28"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a0d323b6fcb736454a9f6074ebda9ec28">libMesh::DofMap::dof_indices</a></div><div class="ttdeci">void dof_indices(const Elem *const elem, std::vector&lt; dof_id_type &gt; &amp;di) const </div><div class="ttdoc">Fills the vector di with the global degree of freedom indices for the element. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01992">dof_map.C:1992</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ade407291cc858bb97e3476cd47259702"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_periodic_boundary </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1PeriodicBoundaryBase.html">PeriodicBoundaryBase</a> &amp;&#160;</td>
          <td class="paramname"><em>periodic_boundary</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds a copy of the specified periodic boundary to the system. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l05570">5570</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02050">_periodic_boundaries</a>, <a class="el" href="classlibMesh_1_1PeriodicBoundaryBase.html#a658208e4484e7d10ae3f9a46a0461bcc">libMesh::PeriodicBoundaryBase::clone()</a>, <a class="el" href="periodic__boundary__base_8h_source.html#l00053">libMesh::PeriodicBoundaryBase::INVERSE</a>, <a class="el" href="periodic__boundary__base_8C_source.html#l00064">libMesh::PeriodicBoundaryBase::merge()</a>, <a class="el" href="periodic__boundary__base_8h_source.html#l00058">libMesh::PeriodicBoundaryBase::myboundary</a> , 以及 <a class="el" href="periodic__boundary__base_8h_source.html#l00058">libMesh::PeriodicBoundaryBase::pairedboundary</a>.</p>
<div class="fragment"><div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;{</div>
<div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;  <span class="comment">// See if we already have a periodic boundary associated myboundary...</span></div>
<div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;  <a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html">PeriodicBoundaryBase</a> * existing_boundary = <a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>-&gt;boundary(periodic_boundary.<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#a8a4f08f0de1b7be3dadb7f03a72e3c0e">myboundary</a>);</div>
<div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160;</div>
<div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160;  <span class="keywordflow">if</span> (!existing_boundary)</div>
<div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160;    {</div>
<div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160;      <span class="comment">// ...if not, clone the input (and its inverse) and add them to the PeriodicBoundaries object</span></div>
<div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160;      <span class="comment">// Pass the pairedboundary of the original as the boundary id of the inverse clone.</span></div>
<div class="line"><a name="l05579"></a><span class="lineno"> 5579</span>&#160;      <a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>-&gt;emplace(periodic_boundary.<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#a8a4f08f0de1b7be3dadb7f03a72e3c0e">myboundary</a>, periodic_boundary.<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#a658208e4484e7d10ae3f9a46a0461bcc">clone</a>());</div>
<div class="line"><a name="l05580"></a><span class="lineno"> 5580</span>&#160;      <a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>-&gt;emplace(periodic_boundary.<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#ae13b4c2ab5ee3d245de1f0147adf0518">pairedboundary</a>, periodic_boundary.<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#a658208e4484e7d10ae3f9a46a0461bcc">clone</a>(<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#a0d7044909251be42051d019cfd3e8dc7a4340508bb4bc47cb649a5f4716407a31">PeriodicBoundaryBase::INVERSE</a>));</div>
<div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160;    }</div>
<div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;    {</div>
<div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160;      <span class="comment">// ...otherwise, merge this object&#39;s variable IDs with the existing boundary object&#39;s.</span></div>
<div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;      existing_boundary-&gt;<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#ae5706185efc36bd840b9ecbd38e74ecc">merge</a>(periodic_boundary);</div>
<div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160;</div>
<div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;      <span class="comment">// Do the same merging process for the inverse boundary.  Note: the inverse better already exist!</span></div>
<div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;      <a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html">PeriodicBoundaryBase</a> * inverse_boundary = <a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>-&gt;boundary(periodic_boundary.<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#ae13b4c2ab5ee3d245de1f0147adf0518">pairedboundary</a>);</div>
<div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160;      libmesh_assert(inverse_boundary);</div>
<div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;      inverse_boundary-&gt;<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#ae5706185efc36bd840b9ecbd38e74ecc">merge</a>(periodic_boundary);</div>
<div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160;    }</div>
<div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1PeriodicBoundaryBase_html_ae13b4c2ab5ee3d245de1f0147adf0518"><div class="ttname"><a href="classlibMesh_1_1PeriodicBoundaryBase.html#ae13b4c2ab5ee3d245de1f0147adf0518">libMesh::PeriodicBoundaryBase::pairedboundary</a></div><div class="ttdeci">boundary_id_type pairedboundary</div><div class="ttdef"><b>Definition:</b> <a href="periodic__boundary__base_8h_source.html#l00058">periodic_boundary_base.h:58</a></div></div>
<div class="ttc" id="classlibMesh_1_1PeriodicBoundaryBase_html_ae5706185efc36bd840b9ecbd38e74ecc"><div class="ttname"><a href="classlibMesh_1_1PeriodicBoundaryBase.html#ae5706185efc36bd840b9ecbd38e74ecc">libMesh::PeriodicBoundaryBase::merge</a></div><div class="ttdeci">void merge(const PeriodicBoundaryBase &amp;pb)</div><div class="ttdef"><b>Definition:</b> <a href="periodic__boundary__base_8C_source.html#l00064">periodic_boundary_base.C:64</a></div></div>
<div class="ttc" id="classlibMesh_1_1PeriodicBoundaryBase_html_a8a4f08f0de1b7be3dadb7f03a72e3c0e"><div class="ttname"><a href="classlibMesh_1_1PeriodicBoundaryBase.html#a8a4f08f0de1b7be3dadb7f03a72e3c0e">libMesh::PeriodicBoundaryBase::myboundary</a></div><div class="ttdeci">boundary_id_type myboundary</div><div class="ttdoc">The boundary ID of this boundary and its counterpart. </div><div class="ttdef"><b>Definition:</b> <a href="periodic__boundary__base_8h_source.html#l00058">periodic_boundary_base.h:58</a></div></div>
<div class="ttc" id="classlibMesh_1_1PeriodicBoundaryBase_html_a658208e4484e7d10ae3f9a46a0461bcc"><div class="ttname"><a href="classlibMesh_1_1PeriodicBoundaryBase.html#a658208e4484e7d10ae3f9a46a0461bcc">libMesh::PeriodicBoundaryBase::clone</a></div><div class="ttdeci">virtual std::unique_ptr&lt; PeriodicBoundaryBase &gt; clone(TransformationType t=FORWARD) const =0</div><div class="ttdoc">If we want the DofMap to be able to make copies of references and store them in the underlying map...</div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab91693b08a22cfe1af7781287157ac8a"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">libMesh::DofMap::_periodic_boundaries</a></div><div class="ttdeci">std::unique_ptr&lt; PeriodicBoundaries &gt; _periodic_boundaries</div><div class="ttdoc">Data structure containing periodic boundaries. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02050">dof_map.h:2050</a></div></div>
<div class="ttc" id="classlibMesh_1_1PeriodicBoundaryBase_html"><div class="ttname"><a href="classlibMesh_1_1PeriodicBoundaryBase.html">libMesh::PeriodicBoundaryBase</a></div><div class="ttdoc">The base class for defining periodic boundaries. </div><div class="ttdef"><b>Definition:</b> <a href="periodic__boundary__base_8h_source.html#l00048">periodic_boundary_base.h:48</a></div></div>
<div class="ttc" id="classlibMesh_1_1PeriodicBoundaryBase_html_a0d7044909251be42051d019cfd3e8dc7a4340508bb4bc47cb649a5f4716407a31"><div class="ttname"><a href="classlibMesh_1_1PeriodicBoundaryBase.html#a0d7044909251be42051d019cfd3e8dc7a4340508bb4bc47cb649a5f4716407a31">libMesh::PeriodicBoundaryBase::INVERSE</a></div><div class="ttdef"><b>Definition:</b> <a href="periodic__boundary__base_8h_source.html#l00053">periodic_boundary_base.h:53</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a724af7741f2b45c26cf950b2f3b6d146"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_periodic_boundary </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1PeriodicBoundaryBase.html">PeriodicBoundaryBase</a> &amp;&#160;</td>
          <td class="paramname"><em>boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1PeriodicBoundaryBase.html">PeriodicBoundaryBase</a> &amp;&#160;</td>
          <td class="paramname"><em>inverse_boundary</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a periodic boundary pair. </p>
<dl class="params"><dt>参数</dt><dd>
  <table class="params">
    <tr><td class="paramname">boundary</td><td>- primary boundary </td></tr>
    <tr><td class="paramname">inverse_boundary</td><td>- inverse boundary </td></tr>
  </table>
  </dd>
</dl>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l05597">5597</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02050">_periodic_boundaries</a>, <a class="el" href="classlibMesh_1_1PeriodicBoundaryBase.html#a658208e4484e7d10ae3f9a46a0461bcc">libMesh::PeriodicBoundaryBase::clone()</a>, <a class="el" href="periodic__boundary__base_8h_source.html#l00058">libMesh::PeriodicBoundaryBase::myboundary</a> , 以及 <a class="el" href="periodic__boundary__base_8h_source.html#l00058">libMesh::PeriodicBoundaryBase::pairedboundary</a>.</p>
<div class="fragment"><div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;{</div>
<div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160;  libmesh_assert_equal_to (boundary.<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#a8a4f08f0de1b7be3dadb7f03a72e3c0e">myboundary</a>, inverse_boundary.<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#ae13b4c2ab5ee3d245de1f0147adf0518">pairedboundary</a>);</div>
<div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;  libmesh_assert_equal_to (boundary.<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#ae13b4c2ab5ee3d245de1f0147adf0518">pairedboundary</a>, inverse_boundary.<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#a8a4f08f0de1b7be3dadb7f03a72e3c0e">myboundary</a>);</div>
<div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;</div>
<div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160;  <span class="comment">// Store clones of the passed-in objects. These will be cleaned up</span></div>
<div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;  <span class="comment">// automatically in the _periodic_boundaries destructor.</span></div>
<div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>-&gt;emplace(boundary.<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#a8a4f08f0de1b7be3dadb7f03a72e3c0e">myboundary</a>, boundary.<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#a658208e4484e7d10ae3f9a46a0461bcc">clone</a>());</div>
<div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>-&gt;emplace(inverse_boundary.<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#a8a4f08f0de1b7be3dadb7f03a72e3c0e">myboundary</a>, inverse_boundary.<a class="code" href="classlibMesh_1_1PeriodicBoundaryBase.html#a658208e4484e7d10ae3f9a46a0461bcc">clone</a>());</div>
<div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1PeriodicBoundaryBase_html_ae13b4c2ab5ee3d245de1f0147adf0518"><div class="ttname"><a href="classlibMesh_1_1PeriodicBoundaryBase.html#ae13b4c2ab5ee3d245de1f0147adf0518">libMesh::PeriodicBoundaryBase::pairedboundary</a></div><div class="ttdeci">boundary_id_type pairedboundary</div><div class="ttdef"><b>Definition:</b> <a href="periodic__boundary__base_8h_source.html#l00058">periodic_boundary_base.h:58</a></div></div>
<div class="ttc" id="classlibMesh_1_1PeriodicBoundaryBase_html_a8a4f08f0de1b7be3dadb7f03a72e3c0e"><div class="ttname"><a href="classlibMesh_1_1PeriodicBoundaryBase.html#a8a4f08f0de1b7be3dadb7f03a72e3c0e">libMesh::PeriodicBoundaryBase::myboundary</a></div><div class="ttdeci">boundary_id_type myboundary</div><div class="ttdoc">The boundary ID of this boundary and its counterpart. </div><div class="ttdef"><b>Definition:</b> <a href="periodic__boundary__base_8h_source.html#l00058">periodic_boundary_base.h:58</a></div></div>
<div class="ttc" id="classlibMesh_1_1PeriodicBoundaryBase_html_a658208e4484e7d10ae3f9a46a0461bcc"><div class="ttname"><a href="classlibMesh_1_1PeriodicBoundaryBase.html#a658208e4484e7d10ae3f9a46a0461bcc">libMesh::PeriodicBoundaryBase::clone</a></div><div class="ttdeci">virtual std::unique_ptr&lt; PeriodicBoundaryBase &gt; clone(TransformationType t=FORWARD) const =0</div><div class="ttdoc">If we want the DofMap to be able to make copies of references and store them in the underlying map...</div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab91693b08a22cfe1af7781287157ac8a"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">libMesh::DofMap::_periodic_boundaries</a></div><div class="ttdeci">std::unique_ptr&lt; PeriodicBoundaries &gt; _periodic_boundaries</div><div class="ttdoc">Data structure containing periodic boundaries. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02050">dof_map.h:2050</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a10698e15df1162ca2dc4e9d6517039a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::add_variable_group </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1VariableGroup.html">VariableGroup</a>&#160;</td>
          <td class="paramname"><em>var_group</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add an unknown of order <code>order</code> and finite element type <code>type</code> to the system of equations. </p>
<p>Add a group of unknowns of order <code>order</code> and finite element type <code>type</code> to the system of equations. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l00252">252</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01854">_var_to_vg</a>, <a class="el" href="dof__map_8h_source.html#l01849">_variable_group_numbers</a>, <a class="el" href="dof__map_8h_source.html#l01844">_variable_groups</a>, <a class="el" href="dof__map_8h_source.html#l01839">_variables</a> , 以及 <a class="el" href="variable_8h_source.html#l00256">libMesh::VariableGroup::n_variables()</a>.</p>
<div class="fragment"><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;{</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="comment">// Ensure that we are not duplicating an existing entry in _variable_groups</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordflow">if</span> (std::find(<a class="code" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a>.begin(), <a class="code" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a>.end(), var_group) == <a class="code" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a>.end())</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vg = cast_int&lt;unsigned int&gt;(<a class="code" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a>.size());</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;   <a class="code" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a>.push_back(std::move(var_group));</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    VariableGroup &amp; new_var_group = <a class="code" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a>.back();</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> var : make_range(new_var_group.n_variables()))</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="keyword">auto</span> var_instance = new_var_group(var);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> vn = var_instance.number();</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <a class="code" href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">_variables</a>.push_back (std::move(var_instance));</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;      <a class="code" href="classlibMesh_1_1DofMap.html#a04bedd57c80ef97a7d9a0a3e2fe8a248">_variable_group_numbers</a>.push_back (vg);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <a class="code" href="classlibMesh_1_1DofMap.html#a1bc6f6a2a702bfb9511b442d99fc7a28">_var_to_vg</a>.emplace(vn, vg);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="comment">// End if check for var_group in _variable_groups</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad840cf4659b6b1a2f781d29225e82743"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">libMesh::DofMap::_variable_groups</a></div><div class="ttdeci">std::vector&lt; VariableGroup &gt; _variable_groups</div><div class="ttdoc">The finite element type for each variable group. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01844">dof_map.h:1844</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a1bc6f6a2a702bfb9511b442d99fc7a28"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a1bc6f6a2a702bfb9511b442d99fc7a28">libMesh::DofMap::_var_to_vg</a></div><div class="ttdeci">std::unordered_map&lt; unsigned int, unsigned int &gt; _var_to_vg</div><div class="ttdoc">A map from variable number to variable group number. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01854">dof_map.h:1854</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a5232a8054e580a408f394ba1574c63df"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">libMesh::DofMap::_variables</a></div><div class="ttdeci">std::vector&lt; Variable &gt; _variables</div><div class="ttdoc">The finite element type for each variable. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01839">dof_map.h:1839</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a04bedd57c80ef97a7d9a0a3e2fe8a248"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a04bedd57c80ef97a7d9a0a3e2fe8a248">libMesh::DofMap::_variable_group_numbers</a></div><div class="ttdeci">std::vector&lt; unsigned int &gt; _variable_group_numbers</div><div class="ttdoc">The variable group number for each variable. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01849">dof_map.h:1849</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acc22ec21b664be90d810a7c28a4d94ba"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::set&lt;GhostingFunctor *&gt;::const_iterator libMesh::DofMap::algebraic_ghosting_functors_begin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Beginning of range of algebraic ghosting functors. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00406">406</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01951">_algebraic_ghosting_functors</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01544">add_neighbors_to_send_list()</a>.</p>
<div class="fragment"><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  { <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a378d58f5e860f781a52adb61464c9378">_algebraic_ghosting_functors</a>.begin(); }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a378d58f5e860f781a52adb61464c9378"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a378d58f5e860f781a52adb61464c9378">libMesh::DofMap::_algebraic_ghosting_functors</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt; _algebraic_ghosting_functors</div><div class="ttdoc">The list of all GhostingFunctor objects to be used when distributing ghosted vectors. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01951">dof_map.h:1951</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a752e6253240ff035da7835c865284225"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::set&lt;GhostingFunctor *&gt;::const_iterator libMesh::DofMap::algebraic_ghosting_functors_end </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>End of range of algebraic ghosting functors. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00412">412</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01951">_algebraic_ghosting_functors</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01544">add_neighbors_to_send_list()</a>.</p>
<div class="fragment"><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  { <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a378d58f5e860f781a52adb61464c9378">_algebraic_ghosting_functors</a>.end(); }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a378d58f5e860f781a52adb61464c9378"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a378d58f5e860f781a52adb61464c9378">libMesh::DofMap::_algebraic_ghosting_functors</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt; _algebraic_ghosting_functors</div><div class="ttdoc">The list of all GhostingFunctor objects to be used when distributing ghosted vectors. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01951">dof_map.h:1951</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a275eef27e02119cb8b20507ccda4d04d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::all_semilocal_indices </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>dof_indices</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd><code>true</code> if all degree of freedom indices in <code>dof_indices</code> are either local indices or in the <code>send_list</code>.</dd></dl>
<dl class="section note"><dt>注解</dt><dd>This is an O(logN) operation for a send_list of size N; we don't cache enough information for O(1) right now. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l02596">2596</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8C_source.html#l02580">semilocal_index()</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l02609">is_evaluable()</a>.</p>
<div class="fragment"><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;{</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;  <span class="comment">// We&#39;re all semilocal unless we find a counterexample</span></div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; di : dof_indices_in)</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;    <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aa654bbcfc7f4d67d7cc6e3bb8cc390b3">semilocal_index</a>(di))</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aa654bbcfc7f4d67d7cc6e3bb8cc390b3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa654bbcfc7f4d67d7cc6e3bb8cc390b3">libMesh::DofMap::semilocal_index</a></div><div class="ttdeci">bool semilocal_index(dof_id_type dof_index) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l02580">dof_map.C:2580</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a21fda1ca99f13ac340a05a8e41ecc8e9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::allgather_recursive_constraints </td>
          <td>(</td>
          <td class="paramtype">MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gathers constraint equation dependencies from other processors. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l03708">3708</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02034">_adjoint_constraint_values</a>, <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>, <a class="el" href="dof__map_8h_source.html#l02041">_node_constraints</a>, <a class="el" href="dof__map_8h_source.html#l02032">_primal_constraint_values</a>, <a class="el" href="dof__map__constraints_8C_source.html#l05055">gather_constraints()</a>, <a class="el" href="dof__object_8h_source.html#l00477">libMesh::DofObject::invalid_id</a>, <a class="el" href="dof__map_8h_source.html#l02179">is_constrained_dof()</a>, <a class="el" href="dof__map_8h_source.html#l02163">is_constrained_node()</a>, <a class="el" href="libmesh__common_8h_source.html#l00196">libMesh::libmesh_isnan()</a>, <a class="el" href="libmesh__common_8h_source.html#l00143">libMesh::Real</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02093">sys_number()</a>.</p>

<p>参考自 <a class="el" href="dof__map__constraints_8C_source.html#l04372">process_constraints()</a>.</p>
<div class="fragment"><div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;{</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;  parallel_object_only();</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;</div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;  <span class="comment">// Return immediately if there&#39;s nothing to gather</span></div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;  <span class="keywordflow">if</span> (this-&gt;n_processors() == 1)</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;</div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;  <span class="comment">// We might get to return immediately if none of the processors</span></div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;  <span class="comment">// found any constraints</span></div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> has_constraints = !<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.empty()</div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;<span class="preprocessor"></span>    || !<a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>.empty()</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;<span class="preprocessor">#endif // LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;<span class="preprocessor"></span>    ;</div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;  this-&gt;comm().max(has_constraints);</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;  <span class="keywordflow">if</span> (!has_constraints)</div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;</div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;  <span class="comment">// If we have heterogeneous adjoint constraints we need to</span></div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;  <span class="comment">// communicate those too.</span></div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> max_qoi_num =</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.empty() ?</div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;    0 : <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.rbegin()-&gt;first+1;</div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;</div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;<span class="preprocessor"></span>  <span class="comment">// We may need to send nodes ahead of data about them</span></div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;  std::vector&lt;Parallel::Request&gt; packed_range_sends;</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;</div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;  <span class="comment">// We may be receiving packed_range sends out of order with</span></div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;  <span class="comment">// parallel_sync tags, so make sure they&#39;re received correctly.</span></div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;  Parallel::MessageTag range_tag = this-&gt;comm().get_unique_tag();</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;</div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;  <span class="comment">// We only need to do these sends on a distributed mesh</span></div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> dist_mesh = !mesh.is_serial();</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;  <span class="comment">// We might have calculated constraints for constrained dofs</span></div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;  <span class="comment">// which have support on other processors.</span></div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;  <span class="comment">// Push these out first.</span></div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;  {</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;    std::map&lt;processor_id_type, std::set&lt;dof_id_type&gt;&gt; pushed_ids;</div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;<span class="preprocessor"></span>    std::map&lt;processor_id_type, std::set&lt;dof_id_type&gt;&gt; pushed_node_ids;</div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sys_num = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">sys_number</a>();</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;    <span class="comment">// Collect the constraints to push to each processor</span></div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : as_range(mesh.active_not_local_elements_begin(),</div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;                                mesh.active_not_local_elements_end()))</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;      {</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> n_nodes = elem-&gt;n_nodes();</div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;        <span class="comment">// Just checking dof_indices on the foreign element isn&#39;t</span></div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;        <span class="comment">// enough.  Consider a central hanging node between a coarse</span></div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;        <span class="comment">// Q2/Q1 element and its finer neighbors on a higher-ranked</span></div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;        <span class="comment">// processor.  The coarse element&#39;s processor will own the node,</span></div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;        <span class="comment">// and will thereby own the pressure dof on that node, despite</span></div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;        <span class="comment">// the fact that that pressure dof doesn&#39;t directly exist on the</span></div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;        <span class="comment">// coarse element!</span></div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;        <span class="comment">// So, we loop through dofs manually.</span></div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;        {</div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_vars = elem-&gt;n_vars(sys_num);</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v=0; v != n_vars; ++v)</div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;            {</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_comp = elem-&gt;n_comp(sys_num,v);</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> c=0; c != n_comp; ++c)</div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;                {</div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span> =</div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;                    elem-&gt;dof_number(sys_num,v,c);</div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;                  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">is_constrained_dof</a>(<span class="keywordtype">id</span>))</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;                    pushed_ids[elem-&gt;processor_id()].insert(<span class="keywordtype">id</span>);</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;                }</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;            }</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;        }</div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> n = 0; n != n_nodes; ++n)</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;          {</div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;            <span class="keyword">const</span> Node &amp; node = elem-&gt;node_ref(n);</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_vars = node.n_vars(sys_num);</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v=0; v != n_vars; ++v)</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;              {</div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_comp = node.n_comp(sys_num,v);</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> c=0; c != n_comp; ++c)</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;                  {</div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span> =</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;                      node.dof_number(sys_num,v,c);</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;                    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">is_constrained_dof</a>(<span class="keywordtype">id</span>))</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;                      pushed_ids[elem-&gt;processor_id()].insert(<span class="keywordtype">id</span>);</div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;                  }</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;              }</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;          }</div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;</div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;<span class="preprocessor"></span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> n = 0; n != n_nodes; ++n)</div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;          <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aa074902e46e34c42cab1888d111911f3">is_constrained_node</a>(elem-&gt;node_ptr(n)))</div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;            pushed_node_ids[elem-&gt;processor_id()].insert(elem-&gt;node_id(n));</div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;<span class="preprocessor"></span>      }</div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;</div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;    <span class="comment">// Rewrite those id sets as vectors for sending and receiving,</span></div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;    <span class="comment">// then find the corresponding data for each id, then push it all.</span></div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;    std::map&lt;processor_id_type, std::vector&lt;dof_id_type&gt;&gt;</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;      pushed_id_vecs, received_id_vecs;</div>
<div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; p : pushed_ids)</div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;      pushed_id_vecs[p.first].assign(p.second.begin(), p.second.end());</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;</div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;    std::map&lt;processor_id_type, std::vector&lt;std::vector&lt;std::pair&lt;dof_id_type,Real&gt;&gt;&gt;&gt;</div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;      pushed_keys_vals, received_keys_vals;</div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;    std::map&lt;processor_id_type, std::vector&lt;std::vector&lt;Number&gt;&gt;&gt; pushed_rhss, received_rhss;</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; p : pushed_id_vecs)</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;      {</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;        <span class="keyword">auto</span> &amp; keys_vals = pushed_keys_vals[p.first];</div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;        keys_vals.reserve(p.second.size());</div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;        <span class="keyword">auto</span> &amp; rhss = pushed_rhss[p.first];</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;        rhss.reserve(p.second.size());</div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; pushed_id : p.second)</div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;          {</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; row = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>[pushed_id];</div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;            keys_vals.emplace_back(row.begin(), row.end());</div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;</div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;            rhss.push_back(std::vector&lt;Number&gt;(max_qoi_num+1));</div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;            std::vector&lt;Number&gt; &amp; rhs = rhss.back();</div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;            DofConstraintValueMap::const_iterator rhsit =</div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;              <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.find(pushed_id);</div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;            rhs[max_qoi_num] =</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;              (rhsit == <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.end()) ?</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;              0 : rhsit-&gt;second;</div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;            for (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q != max_qoi_num; ++q)</div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;              {</div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;                AdjointDofConstraintValues::const_iterator adjoint_map_it =</div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;                  <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.find(q);</div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;</div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;                <span class="keywordflow">if</span> (adjoint_map_it == <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.end())</div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;                  <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;                <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a> &amp; constraint_map =</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;                  adjoint_map_it-&gt;second;</div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;</div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;                DofConstraintValueMap::const_iterator adj_rhsit =</div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;                  constraint_map.find(pushed_id);</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;</div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;                rhs[q] =</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;                  (adj_rhsit == constraint_map.end()) ?</div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;                  0 : adj_rhsit-&gt;second;</div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;              }</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;          }</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;      }</div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;</div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;    <span class="keyword">auto</span> ids_action_functor =</div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;      [&amp; received_id_vecs]</div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;      (<a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> pid,</div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;       <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; data)</div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;      {</div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;        received_id_vecs[pid] = data;</div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;      };</div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;    Parallel::push_parallel_vector_data</div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;      (this-&gt;comm(), pushed_id_vecs, ids_action_functor);</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;    <span class="keyword">auto</span> keys_vals_action_functor =</div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;      [&amp; received_keys_vals]</div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;      (<a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> pid,</div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;       <span class="keyword">const</span> std::vector&lt;std::vector&lt;std::pair&lt;dof_id_type,Real&gt;&gt;&gt; &amp; data)</div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;      {</div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;        received_keys_vals[pid] = data;</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;      };</div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;</div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;    Parallel::push_parallel_vector_data</div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;      (this-&gt;comm(), pushed_keys_vals, keys_vals_action_functor);</div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;    <span class="keyword">auto</span> rhss_action_functor =</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;      [&amp; received_rhss]</div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;      (<a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> pid,</div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;       <span class="keyword">const</span> std::vector&lt;std::vector&lt;Number&gt;&gt; &amp; data)</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;      {</div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;        received_rhss[pid] = data;</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;      };</div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;</div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;    Parallel::push_parallel_vector_data</div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;      (this-&gt;comm(), pushed_rhss, rhss_action_functor);</div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;</div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;    <span class="comment">// Now we have all the DofConstraint rows and rhs values received</span></div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;    <span class="comment">// from others, so add the DoF constraints that we&#39;ve been sent</span></div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;</div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;<span class="preprocessor"></span>    std::map&lt;processor_id_type, std::vector&lt;dof_id_type&gt;&gt;</div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;      pushed_node_id_vecs, received_node_id_vecs;</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; p : pushed_node_ids)</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;      pushed_node_id_vecs[p.first].assign(p.second.begin(), p.second.end());</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;</div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;    std::map&lt;processor_id_type, std::vector&lt;std::vector&lt;std::pair&lt;dof_id_type,Real&gt;&gt;&gt;&gt;</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;      pushed_node_keys_vals, received_node_keys_vals;</div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;    std::map&lt;processor_id_type, std::vector&lt;Point&gt;&gt; pushed_offsets, received_offsets;</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; p : pushed_node_id_vecs)</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;      {</div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> pid = p.first;</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;        <span class="comment">// FIXME - this could be an unordered set, given a</span></div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;        <span class="comment">// hash&lt;pointers&gt; specialization</span></div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;        std::set&lt;const Node *&gt; nodes_requested;</div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;        <span class="keyword">auto</span> &amp; node_keys_vals = pushed_node_keys_vals[pid];</div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;        node_keys_vals.reserve(p.second.size());</div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;        <span class="keyword">auto</span> &amp; offsets = pushed_offsets[pid];</div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;        offsets.reserve(p.second.size());</div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; pushed_node_id : p.second)</div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;          {</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;            <span class="keyword">const</span> Node * node = mesh.node_ptr(pushed_node_id);</div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;            <a class="code" href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">NodeConstraintRow</a> &amp; row = <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>[node].first;</div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;            <span class="keyword">const</span> std::size_t row_size = row.size();</div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;            node_keys_vals.push_back</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;              (std::vector&lt;std::pair&lt;dof_id_type,Real&gt;&gt;());</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;            std::vector&lt;std::pair&lt;dof_id_type,Real&gt;&gt; &amp; this_node_kv =</div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;              node_keys_vals.back();</div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;            this_node_kv.reserve(row_size);</div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; j : row)</div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;              {</div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;                this_node_kv.emplace_back(j.first-&gt;id(), j.second);</div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;                <span class="comment">// If we&#39;re not sure whether our send</span></div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;                <span class="comment">// destination already has this node, let&#39;s give</span></div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;                <span class="comment">// it a copy.</span></div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;                <span class="keywordflow">if</span> (j.first-&gt;processor_id() != pid &amp;&amp; dist_mesh)</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;                  nodes_requested.insert(j.first);</div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;              }</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;            offsets.push_back(<a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>[node].second);</div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;</div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;          }</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;</div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;        <span class="comment">// Constraining nodes might not even exist on our</span></div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;        <span class="comment">// correspondant&#39;s subset of a distributed mesh, so let&#39;s</span></div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;        <span class="comment">// make them exist.</span></div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;        <span class="keywordflow">if</span> (dist_mesh)</div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;          {</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;            packed_range_sends.push_back(Parallel::Request());</div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;            this-&gt;comm().send_packed_range</div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;              (pid, &amp;mesh, nodes_requested.begin(), nodes_requested.end(),</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;               packed_range_sends.back(), range_tag);</div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;          }</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;      }</div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;    <span class="keyword">auto</span> node_ids_action_functor =</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;      [&amp; received_node_id_vecs]</div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;      (<a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> pid,</div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;       <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; data)</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;      {</div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;        received_node_id_vecs[pid] = data;</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;      };</div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;    Parallel::push_parallel_vector_data</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;      (this-&gt;comm(), pushed_node_id_vecs, node_ids_action_functor);</div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;</div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;    <span class="keyword">auto</span> node_keys_vals_action_functor =</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;      [&amp; received_node_keys_vals]</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;      (<a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> pid,</div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;       <span class="keyword">const</span> std::vector&lt;std::vector&lt;std::pair&lt;dof_id_type,Real&gt;&gt;&gt; &amp; data)</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;      {</div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;        received_node_keys_vals[pid] = data;</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;      };</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;</div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;    Parallel::push_parallel_vector_data</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;      (this-&gt;comm(), pushed_node_keys_vals,</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;       node_keys_vals_action_functor);</div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;    <span class="keyword">auto</span> node_offsets_action_functor =</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;      [&amp; received_offsets]</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;      (<a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> pid,</div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;       <span class="keyword">const</span> std::vector&lt;Point&gt; &amp; data)</div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;      {</div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;        received_offsets[pid] = data;</div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;      };</div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;</div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;    Parallel::push_parallel_vector_data</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;      (this-&gt;comm(), pushed_offsets, node_offsets_action_functor);</div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;    <span class="comment">// Add all the dof constraints that I&#39;ve been sent</span></div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; [pid, pushed_ids_to_me] : received_id_vecs)</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;      {</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;        libmesh_assert(received_keys_vals.count(pid));</div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;        libmesh_assert(received_rhss.count(pid));</div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp; pushed_keys_vals_to_me = received_keys_vals.at(pid);</div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp; pushed_rhss_to_me = received_rhss.at(pid);</div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;        libmesh_assert_equal_to (pushed_ids_to_me.size(),</div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;                                 pushed_keys_vals_to_me.size());</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;        libmesh_assert_equal_to (pushed_ids_to_me.size(),</div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;                                 pushed_rhss_to_me.size());</div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : index_range(pushed_ids_to_me))</div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;          {</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;            <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained = pushed_ids_to_me[i];</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;</div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;            <span class="comment">// If we don&#39;t already have a constraint for this dof,</span></div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;            <span class="comment">// add the one we were sent</span></div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;            <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">is_constrained_dof</a>(constrained))</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;              {</div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;                <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; row = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>[constrained];</div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; kv : pushed_keys_vals_to_me[i])</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;                  {</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;                    libmesh_assert_less(kv.first, this-&gt;n_dofs());</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;                    row[kv.first] = kv.second;</div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;                  }</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;                <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> primal_rhs = pushed_rhss_to_me[i][max_qoi_num];</div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;</div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="namespacelibMesh.html#abfa0098cb32eb62d442c8f7bb66afd55">libmesh_isnan</a>(primal_rhs))</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;                  libmesh_assert(pushed_keys_vals_to_me[i].empty());</div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;</div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;                <span class="keywordflow">if</span> (primal_rhs != <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>(0))</div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;                  <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>[constrained] = primal_rhs;</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;                  <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.erase(constrained);</div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q != max_qoi_num; ++q)</div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;                  {</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;                    AdjointDofConstraintValues::iterator adjoint_map_it =</div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;                      <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.find(q);</div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;                    <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> adj_rhs = pushed_rhss_to_me[i][q];</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;                    <span class="keywordflow">if</span> ((adjoint_map_it == <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.end()) &amp;&amp;</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;                        adj_rhs == <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>(0))</div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;                      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;</div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;                    <span class="keywordflow">if</span> (adjoint_map_it == <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.end())</div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;                      adjoint_map_it = <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.emplace</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;                        (q, <a class="code" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a>()).first;</div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;</div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;                    <a class="code" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a> &amp; constraint_map =</div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;                      adjoint_map_it-&gt;second;</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;</div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;                    <span class="keywordflow">if</span> (adj_rhs != <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>(0))</div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;                      constraint_map[constrained] = adj_rhs;</div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;                      constraint_map.erase(constrained);</div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;                  }</div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;              }</div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;          }</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;      }</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;<span class="preprocessor"></span>    <span class="comment">// Add all the node constraints that I&#39;ve been sent</span></div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; [pid, pushed_node_ids_to_me] : received_node_id_vecs)</div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;      {</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;        <span class="comment">// Before we act on any new constraint rows, we may need to</span></div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;        <span class="comment">// make sure we have all the nodes involved!</span></div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;        <span class="keywordflow">if</span> (dist_mesh)</div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;          this-&gt;comm().receive_packed_range</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;            (pid, &amp;mesh, null_output_iterator&lt;Node&gt;(),</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;             (Node**)<span class="keyword">nullptr</span>, range_tag);</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;        libmesh_assert(received_node_keys_vals.count(pid));</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;        libmesh_assert(received_offsets.count(pid));</div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp; pushed_node_keys_vals_to_me = received_node_keys_vals.at(pid);</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> &amp; pushed_offsets_to_me = received_offsets.at(pid);</div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;        libmesh_assert_equal_to (pushed_node_ids_to_me.size(),</div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;                                 pushed_node_keys_vals_to_me.size());</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;        libmesh_assert_equal_to (pushed_node_ids_to_me.size(),</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;                                 pushed_offsets_to_me.size());</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;</div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : index_range(pushed_node_ids_to_me))</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;          {</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;            <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained_id = pushed_node_ids_to_me[i];</div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;</div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;            <span class="comment">// If we don&#39;t already have a constraint for this node,</span></div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;            <span class="comment">// add the one we were sent</span></div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;            <span class="keyword">const</span> Node * constrained = mesh.node_ptr(constrained_id);</div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;            <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aa074902e46e34c42cab1888d111911f3">is_constrained_node</a>(constrained))</div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;              {</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;                <a class="code" href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">NodeConstraintRow</a> &amp; row = <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>[constrained].first;</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; kv : pushed_node_keys_vals_to_me[i])</div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;                  {</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;                    <span class="keyword">const</span> Node * key_node = mesh.node_ptr(kv.first);</div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;                    libmesh_assert(key_node);</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;                    row[key_node] = kv.second;</div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;                  }</div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;                <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>[constrained].second = pushed_offsets_to_me[i];</div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;              }</div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;          }</div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;      }</div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;<span class="preprocessor">#endif // LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;<span class="preprocessor"></span>  }</div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;</div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;  <span class="comment">// Now start checking for any other constraints we need</span></div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;  <span class="comment">// to know about, requesting them recursively.</span></div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;</div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;  <span class="comment">// Create sets containing the DOFs and nodes we already depend on</span></div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;  <span class="keyword">typedef</span> std::set&lt;dof_id_type&gt; DoF_RCSet;</div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;  DoF_RCSet unexpanded_dofs;</div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;</div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; i : <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>)</div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;    unexpanded_dofs.insert(i.first);</div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;</div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;  <span class="comment">// Gather all the dof constraints we need</span></div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a2ad8b64590135362f5ac09c581f828bf">gather_constraints</a>(mesh, unexpanded_dofs, <span class="keyword">false</span>);</div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;</div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;  <span class="comment">// Gather all the node constraints we need</span></div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;<span class="preprocessor"></span>  <span class="keyword">typedef</span> std::set&lt;const Node *&gt; Node_RCSet;</div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;  Node_RCSet unexpanded_nodes;</div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;</div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; i : <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>)</div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;    unexpanded_nodes.insert(i.first);</div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;</div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;  <span class="comment">// We have to keep recursing while the unexpanded set is</span></div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;  <span class="comment">// nonempty on *any* processor</span></div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;  <span class="keywordtype">bool</span> unexpanded_set_nonempty = !unexpanded_nodes.empty();</div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;  this-&gt;comm().max(unexpanded_set_nonempty);</div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;</div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;  <span class="keywordflow">while</span> (unexpanded_set_nonempty)</div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;    {</div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;      <span class="comment">// Let&#39;s make sure we don&#39;t lose sync in this loop.</span></div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;      parallel_object_only();</div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;</div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;      <span class="comment">// Request sets</span></div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;      Node_RCSet node_request_set;</div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;</div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;      <span class="comment">// Request sets to send to each processor</span></div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;      std::map&lt;processor_id_type, std::vector&lt;dof_id_type&gt;&gt;</div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;        requested_node_ids;</div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;      <span class="comment">// And the sizes of each</span></div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;      std::map&lt;processor_id_type, dof_id_type&gt; node_ids_on_proc;</div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;</div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;      <span class="comment">// Fill (and thereby sort and uniq!) the main request sets</span></div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; i : unexpanded_nodes)</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;        {</div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;          <a class="code" href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">NodeConstraintRow</a> &amp; row = _node_constraints[i].first;</div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; j : row)</div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;            {</div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;              <span class="keyword">const</span> Node * <span class="keyword">const</span> node = j.first;</div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;              libmesh_assert(node);</div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;</div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;              <span class="comment">// If it&#39;s non-local and we haven&#39;t already got a</span></div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;              <span class="comment">// constraint for it, we might need to ask for one</span></div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;              <span class="keywordflow">if</span> ((node-&gt;processor_id() != this-&gt;processor_id()) &amp;&amp;</div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;                  !_node_constraints.count(node))</div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;                node_request_set.insert(node);</div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;            }</div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;        }</div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;      <span class="comment">// Clear the unexpanded constraint sets; we&#39;re about to expand</span></div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;      <span class="comment">// them</span></div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;      unexpanded_nodes.clear();</div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;</div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;      <span class="comment">// Count requests by processor</span></div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; node : node_request_set)</div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;        {</div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;          libmesh_assert(node);</div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;          libmesh_assert_less (node-&gt;processor_id(), this-&gt;n_processors());</div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;          node_ids_on_proc[node-&gt;processor_id()]++;</div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;        }</div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;</div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> pair : node_ids_on_proc)</div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;        requested_node_ids[pair.first].reserve(pair.second);</div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;</div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;      <span class="comment">// Prepare each processor&#39;s request set</span></div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; node : node_request_set)</div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;        requested_node_ids[node-&gt;processor_id()].push_back(node-&gt;id());</div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;</div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;      <span class="keyword">typedef</span> std::vector&lt;std::pair&lt;dof_id_type, Real&gt;&gt; row_datum;</div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;</div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;      <span class="keyword">auto</span> node_row_gather_functor =</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;        [<span class="keyword">this</span>,</div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;         &amp; mesh,</div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;         dist_mesh,</div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;         &amp; packed_range_sends,</div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;         &amp; range_tag]</div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;        (<a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> pid,</div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;         <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; ids,</div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;         std::vector&lt;row_datum&gt; &amp; data)</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;        {</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;          <span class="comment">// FIXME - this could be an unordered set, given a</span></div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;          <span class="comment">// hash&lt;pointers&gt; specialization</span></div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;          std::set&lt;const Node *&gt; nodes_requested;</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;</div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;          <span class="comment">// Fill those requests</span></div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;          <span class="keyword">const</span> std::size_t query_size = ids.size();</div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;</div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;          data.resize(query_size);</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;          <span class="keywordflow">for</span> (std::size_t i=0; i != query_size; ++i)</div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;            {</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;              <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained_id = ids[i];</div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;              <span class="keyword">const</span> Node * constrained_node = mesh.node_ptr(constrained_id);</div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;              <span class="keywordflow">if</span> (_node_constraints.count(constrained_node))</div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;                {</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;                  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">NodeConstraintRow</a> &amp; row = _node_constraints[constrained_node].first;</div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;                  std::size_t row_size = row.size();</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;                  data[i].reserve(row_size);</div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;                  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; j : row)</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;                    {</div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;                      <span class="keyword">const</span> Node * node = j.first;</div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;                      data[i].emplace_back(node-&gt;id(), j.second);</div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;</div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;                      <span class="comment">// If we&#39;re not sure whether our send</span></div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;                      <span class="comment">// destination already has this node, let&#39;s give</span></div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;                      <span class="comment">// it a copy.</span></div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;                      <span class="keywordflow">if</span> (node-&gt;processor_id() != pid &amp;&amp; dist_mesh)</div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;                        nodes_requested.insert(node);</div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;</div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;                      <span class="comment">// We can have 0 nodal constraint</span></div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;                      <span class="comment">// coefficients, where no Lagrange constraint</span></div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;                      <span class="comment">// exists but non-Lagrange basis constraints</span></div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;                      <span class="comment">// might.</span></div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;                      <span class="comment">// libmesh_assert(j.second);</span></div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;                    }</div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;                }</div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;                {</div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;                  <span class="comment">// We have to distinguish &quot;constraint with no</span></div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;                  <span class="comment">// constraining nodes&quot; (e.g. due to user node</span></div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;                  <span class="comment">// constraint equations) from &quot;no constraint&quot;.</span></div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;                  <span class="comment">// We&#39;ll use invalid_id for the latter.</span></div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;                  data[i].emplace_back(<a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>, <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a>(0));</div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;                }</div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;            }</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;</div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;          <span class="comment">// Constraining nodes might not even exist on our</span></div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;          <span class="comment">// correspondant&#39;s subset of a distributed mesh, so let&#39;s</span></div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;          <span class="comment">// make them exist.</span></div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;          <span class="keywordflow">if</span> (dist_mesh)</div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;            {</div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;              packed_range_sends.push_back(Parallel::Request());</div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;              this-&gt;comm().send_packed_range</div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;                (pid, &amp;mesh, nodes_requested.begin(), nodes_requested.end(),</div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;                 packed_range_sends.back(), range_tag);</div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;            }</div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;        };</div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;</div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;      <span class="keyword">typedef</span> Point node_rhs_datum;</div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;</div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;      <span class="keyword">auto</span> node_rhs_gather_functor =</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;        [<span class="keyword">this</span>,</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;         &amp; mesh]</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;        (<a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a>,</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;         <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; ids,</div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;         std::vector&lt;node_rhs_datum&gt; &amp; data)</div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;        {</div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;          <span class="comment">// Fill those requests</span></div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;          <span class="keyword">const</span> std::size_t query_size = ids.size();</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;          data.resize(query_size);</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;          <span class="keywordflow">for</span> (std::size_t i=0; i != query_size; ++i)</div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;            {</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;              <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained_id = ids[i];</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;              <span class="keyword">const</span> Node * constrained_node = mesh.node_ptr(constrained_id);</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;              <span class="keywordflow">if</span> (_node_constraints.count(constrained_node))</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;                data[i] = _node_constraints[constrained_node].second;</div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;                data[i](0) = std::numeric_limits&lt;Real&gt;::quiet_NaN();</div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;            }</div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;        };</div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;</div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;      <span class="keyword">auto</span> node_row_action_functor =</div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;        [<span class="keyword">this</span>,</div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;         &amp; mesh,</div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;         dist_mesh,</div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;         &amp; range_tag,</div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;         &amp; unexpanded_nodes]</div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;        (<a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> pid,</div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;         <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; ids,</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;         <span class="keyword">const</span> std::vector&lt;row_datum&gt; &amp; data)</div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;        {</div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;          <span class="comment">// Before we act on any new constraint rows, we may need to</span></div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;          <span class="comment">// make sure we have all the nodes involved!</span></div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;          <span class="keywordflow">if</span> (dist_mesh)</div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;            this-&gt;comm().receive_packed_range</div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;              (pid, &amp;mesh, null_output_iterator&lt;Node&gt;(),</div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;               (Node**)<span class="keyword">nullptr</span>, range_tag);</div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;</div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;          <span class="comment">// Add any new constraint rows we&#39;ve found</span></div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;          <span class="keyword">const</span> std::size_t query_size = ids.size();</div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;</div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;          <span class="keywordflow">for</span> (std::size_t i=0; i != query_size; ++i)</div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;            {</div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained_id = ids[i];</div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;</div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;              <span class="comment">// An empty row is an constraint with an empty row; for</span></div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;              <span class="comment">// no constraint we use a &quot;no row&quot; placeholder</span></div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;              <span class="keywordflow">if</span> (data[i].empty())</div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;                {</div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;                  <span class="keyword">const</span> Node * constrained_node = mesh.node_ptr(constrained_id);</div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;                  <a class="code" href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">NodeConstraintRow</a> &amp; row = _node_constraints[constrained_node].first;</div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;                  row.clear();</div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;                }</div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (data[i][0].first != <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>)</div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;                {</div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;                  <span class="keyword">const</span> Node * constrained_node = mesh.node_ptr(constrained_id);</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;                  <a class="code" href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">NodeConstraintRow</a> &amp; row = _node_constraints[constrained_node].first;</div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;                  row.clear();</div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;                  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; pair : data[i])</div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;                    {</div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;                      <span class="keyword">const</span> Node * key_node =</div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;                        mesh.node_ptr(pair.first);</div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;                      libmesh_assert(key_node);</div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;                      row[key_node] = pair.second;</div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;                    }</div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;</div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;                  <span class="comment">// And prepare to check for more recursive constraints</span></div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;                  unexpanded_nodes.insert(constrained_node);</div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;                }</div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;            }</div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;        };</div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;</div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;      <span class="keyword">auto</span> node_rhs_action_functor =</div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;        [<span class="keyword">this</span>,</div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;         &amp; mesh]</div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;        (<a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a>,</div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;         <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; ids,</div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;         <span class="keyword">const</span> std::vector&lt;node_rhs_datum&gt; &amp; data)</div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;        {</div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;          <span class="comment">// Add rhs data for any new node constraint rows we&#39;ve found</span></div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;          <span class="keyword">const</span> std::size_t query_size = ids.size();</div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;          <span class="keywordflow">for</span> (std::size_t i=0; i != query_size; ++i)</div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;            {</div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;              <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained_id = ids[i];</div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;              <span class="keyword">const</span> Node * constrained_node = mesh.node_ptr(constrained_id);</div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;</div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;              <span class="keywordflow">if</span> (!<a class="code" href="namespacelibMesh.html#abfa0098cb32eb62d442c8f7bb66afd55">libmesh_isnan</a>(data[i](0)))</div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;                _node_constraints[constrained_node].second = data[i];</div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;                _node_constraints.erase(constrained_node);</div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;            }</div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;        };</div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;</div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;      <span class="comment">// Now request node constraint rows from other processors</span></div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;      row_datum * node_row_ex = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;      Parallel::pull_parallel_vector_data</div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;        (this-&gt;comm(), requested_node_ids, node_row_gather_functor,</div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;         node_row_action_functor, node_row_ex);</div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;      <span class="comment">// And request node constraint right hand sides from other procesors</span></div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;      node_rhs_datum * node_rhs_ex = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;      Parallel::pull_parallel_vector_data</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;        (this-&gt;comm(), requested_node_ids, node_rhs_gather_functor,</div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;         node_rhs_action_functor, node_rhs_ex);</div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;</div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;      <span class="comment">// We have to keep recursing while the unexpanded set is</span></div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;      <span class="comment">// nonempty on *any* processor</span></div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;      unexpanded_set_nonempty = !unexpanded_nodes.empty();</div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;      this-&gt;comm().max(unexpanded_set_nonempty);</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;    }</div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;  Parallel::wait(packed_range_sends);</div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;<span class="preprocessor">#endif // LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;<span class="preprocessor"></span>}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2ad8b64590135362f5ac09c581f828bf"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2ad8b64590135362f5ac09c581f828bf">libMesh::DofMap::gather_constraints</a></div><div class="ttdeci">void gather_constraints(MeshBase &amp;mesh, std::set&lt; dof_id_type &gt; &amp;unexpanded_dofs, bool look_for_constrainees)</div><div class="ttdoc">Helper function for querying about constraint equations on other processors. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l05055">dof_map_constraints.C:5055</a></div></div>
<div class="ttc" id="namespacelibMesh_html_abfa0098cb32eb62d442c8f7bb66afd55"><div class="ttname"><a href="namespacelibMesh.html#abfa0098cb32eb62d442c8f7bb66afd55">libMesh::libmesh_isnan</a></div><div class="ttdeci">bool libmesh_isnan(T x)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00196">libmesh_common.h:196</a></div></div>
<div class="ttc" id="namespacelibMesh_html_af18245d4f872c36a41fc74086bda3e80"><div class="ttname"><a href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">libMesh::processor_id_type</a></div><div class="ttdeci">uint8_t processor_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00104">id_types.h:104</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02034">dof_map.h:2034</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9846273ba4930ef0364bc1fc954af914"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02179">dof_map.h:2179</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aa074902e46e34c42cab1888d111911f3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa074902e46e34c42cab1888d111911f3">libMesh::DofMap::is_constrained_node</a></div><div class="ttdeci">bool is_constrained_node(const Node *node) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02163">dof_map.h:2163</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_adf3b0ebe7fcc0c41bced4c9f17bf4822"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">libMesh::DofObject::invalid_id</a></div><div class="ttdeci">static const dof_id_type invalid_id</div><div class="ttdoc">An invalid id to distinguish an uninitialized DofObject. </div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00477">dof_object.h:477</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a244e7a1cd82d5e6ae8780c93205ec1fa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02093">dof_map.h:2093</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofConstraintValueMap_html"><div class="ttname"><a href="classlibMesh_1_1DofConstraintValueMap.html">libMesh::DofConstraintValueMap</a></div><div class="ttdoc">Storage for DofConstraint right hand sides for a particular problem. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00110">dof_map.h:110</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aef28359fb4851abec08fc99cfbac118d"><div class="ttname"><a href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">libMesh::Real</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef LIBMESH_DEFAULT_SCALAR_TYPE Real</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00143">libmesh_common.h:143</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02032">dof_map.h:2032</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdoc">A row of the Dof constraint matrix. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00090">dof_map.h:90</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a0d8f16f2dd1d9a0c1780943811e37c1c"><div class="ttname"><a href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">libMesh::NodeConstraintRow</a></div><div class="ttdeci">std::map&lt; const Node *, Real, std::less&lt; const Node * &gt;, Threads::scalable_allocator&lt; std::pair&lt; const Node *const, Real &gt; &gt; &gt; NodeConstraintRow</div><div class="ttdoc">A row of the Node constraint mapping. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00138">dof_map.h:138</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a8b17bf24a15bc292850c3a3894e2e8f9"><div class="ttname"><a href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">libMesh::Number</a></div><div class="ttdeci">Real Number</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00214">libmesh_common.h:214</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8856db766d722a0edaa9f5c5d94d40f7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">libMesh::DofMap::_node_constraints</a></div><div class="ttdeci">NodeConstraints _node_constraints</div><div class="ttdoc">Data structure containing DofObject constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02041">dof_map.h:2041</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6abf52a43c1480656cfc1c77428d08b8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::assert_no_nodes_missed </td>
          <td>(</td>
          <td class="paramtype">MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l01418">1418</a> 行定义.</p>

<p>参考 <a class="el" href="dof__object_8h_source.html#l00477">libMesh::DofObject::invalid_id</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02093">sys_number()</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01196">distribute_local_dofs_node_major()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l01299">distribute_local_dofs_var_major()</a>.</p>
<div class="fragment"><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;{</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;  MeshTools::libmesh_assert_valid_procids&lt;Node&gt;(mesh);</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; node : mesh.local_node_ptr_range())</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    {</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_var_g = node-&gt;n_var_groups(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">sys_number</a>());</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vg=0; vg != n_var_g; ++vg)</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        {</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_comp_g =</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;            node-&gt;n_comp_group(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">sys_number</a>(), vg);</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;          <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> my_first_dof = n_comp_g ?</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;            node-&gt;vg_dof_base(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">sys_number</a>(), vg) : 0;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;          libmesh_assert_not_equal_to (my_first_dof, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        }</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    }</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_adf3b0ebe7fcc0c41bced4c9f17bf4822"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">libMesh::DofObject::invalid_id</a></div><div class="ttdeci">static const dof_id_type invalid_id</div><div class="ttdoc">An invalid id to distinguish an uninitialized DofObject. </div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00477">dof_object.h:477</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a244e7a1cd82d5e6ae8780c93205ec1fa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02093">dof_map.h:2093</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a36f672b01ab7060eb641b946abeff74b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::attach_extra_send_list_function </td>
          <td>(</td>
          <td class="paramtype">void(*)(std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;, void *)&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>context</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Attach a function pointer to use as a callback to populate the send_list with extra entries. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00468">468</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01925">_extra_send_list_context</a> , 以及 <a class="el" href="dof__map_8h_source.html#l01920">_extra_send_list_function</a>.</p>
<div class="fragment"><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  { <a class="code" href="classlibMesh_1_1DofMap.html#af1bdebf08fdd914c71545e45624e3c8f">_extra_send_list_function</a> = func; <a class="code" href="classlibMesh_1_1DofMap.html#a6c450ba54bc8caffac28eed88a98a17d">_extra_send_list_context</a> = context; }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a6c450ba54bc8caffac28eed88a98a17d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a6c450ba54bc8caffac28eed88a98a17d">libMesh::DofMap::_extra_send_list_context</a></div><div class="ttdeci">void * _extra_send_list_context</div><div class="ttdoc">A pointer associated with the extra send list that can optionally be passed in. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01925">dof_map.h:1925</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af1bdebf08fdd914c71545e45624e3c8f"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af1bdebf08fdd914c71545e45624e3c8f">libMesh::DofMap::_extra_send_list_function</a></div><div class="ttdeci">void(* _extra_send_list_function)(std::vector&lt; dof_id_type &gt; &amp;, void *)</div><div class="ttdoc">A function pointer to a function to call to add extra entries to the send list. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01920">dof_map.h:1920</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae50b05ef1b5ff63ad103626f5622729d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::attach_extra_send_list_object </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DofMap_1_1AugmentSendList.html">DofMap::AugmentSendList</a> &amp;&#160;</td>
          <td class="paramname"><em>asl</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Attach an object to populate the send_list with extra entries. </p>
<p>This should only add to the send list, but no checking is done to enforce this behavior.</p>
<p>This is an advanced function... use at your own peril! </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00459">459</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01915">_augment_send_list</a>.</p>
<div class="fragment"><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a409a5dccf85edf7260f6186482cb9c9c">_augment_send_list</a> = &amp;asl;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a409a5dccf85edf7260f6186482cb9c9c"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a409a5dccf85edf7260f6186482cb9c9c">libMesh::DofMap::_augment_send_list</a></div><div class="ttdeci">AugmentSendList * _augment_send_list</div><div class="ttdoc">Function object to call to add extra entries to the send list. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01915">dof_map.h:1915</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5058fffef0da9dcdc175a0ee63f587d8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::attach_extra_sparsity_function </td>
          <td>(</td>
          <td class="paramtype">void(*)(<a class="el" href="classlibMesh_1_1SparsityPattern_1_1Graph.html">SparsityPattern::Graph</a> &amp;sparsity, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;n_nz, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;n_oz, void *)&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>context</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Attach a function pointer to use as a callback to populate the sparsity pattern with extra entries. </p>
<p>Care must be taken that when adding entries they are sorted into the Rows</p>
<p>Further, you <em>must</em> modify n_nz and n_oz properly!</p>
<p>This is an advanced function... use at your own peril! </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00445">445</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01910">_extra_sparsity_context</a> , 以及 <a class="el" href="dof__map_8h_source.html#l01903">_extra_sparsity_function</a>.</p>
<div class="fragment"><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  { <a class="code" href="classlibMesh_1_1DofMap.html#ab3513c402066e6431799e388d62be036">_extra_sparsity_function</a> = func; <a class="code" href="classlibMesh_1_1DofMap.html#a283ce213140aa281498b56e138ee8de2">_extra_sparsity_context</a> = context; }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a283ce213140aa281498b56e138ee8de2"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a283ce213140aa281498b56e138ee8de2">libMesh::DofMap::_extra_sparsity_context</a></div><div class="ttdeci">void * _extra_sparsity_context</div><div class="ttdoc">A pointer associated with the extra sparsity that can optionally be passed in. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01910">dof_map.h:1910</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab3513c402066e6431799e388d62be036"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab3513c402066e6431799e388d62be036">libMesh::DofMap::_extra_sparsity_function</a></div><div class="ttdeci">void(* _extra_sparsity_function)(SparsityPattern::Graph &amp;, std::vector&lt; dof_id_type &gt; &amp;n_nz, std::vector&lt; dof_id_type &gt; &amp;n_oz, void *)</div><div class="ttdoc">A function pointer to a function to call to add extra entries to the sparsity pattern. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01903">dof_map.h:1903</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a57b95cd39743e3277f4e2b80007f33da"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::attach_extra_sparsity_object </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1SparsityPattern_1_1AugmentSparsityPattern.html">SparsityPattern::AugmentSparsityPattern</a> &amp;&#160;</td>
          <td class="paramname"><em>asp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Attach an object to use to populate the sparsity pattern with extra entries. </p>
<p>Care must be taken that when adding entries they are sorted into the Rows</p>
<p>Further, you <em>must</em> modify n_nz and n_oz properly!</p>
<p>This is an advanced function... use at your own peril! </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00430">430</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01898">_augment_sparsity_pattern</a>.</p>
<div class="fragment"><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a8d69e59ae9a96426ceca2f356caab1b6">_augment_sparsity_pattern</a> = &amp;asp;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8d69e59ae9a96426ceca2f356caab1b6"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8d69e59ae9a96426ceca2f356caab1b6">libMesh::DofMap::_augment_sparsity_pattern</a></div><div class="ttdeci">SparsityPattern::AugmentSparsityPattern * _augment_sparsity_pattern</div><div class="ttdoc">Function object to call to add extra entries to the sparsity pattern. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01898">dof_map.h:1898</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa10200782a0f8fe0c4d3f7bdf10cedc6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::attach_matrix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Additional matrices may be attached to this <code><a class="el" href="classlibMesh_1_1DofMap.html" title="This class handles the numbering of degrees of freedom on a mesh. ">DofMap</a></code>. </p>
<p>They are initialized to the same sparsity structure as the major matrix. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l00278">278</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01871">_matrices</a>, <a class="el" href="sparse__matrix_8h_source.html#l00126">libMesh::SparseMatrix&lt; T &gt;::need_full_sparsity_pattern()</a>, <a class="el" href="dof__map_8h_source.html#l01976">need_full_sparsity_pattern</a> , 以及 <a class="el" href="dof__map_8C_source.html#l00307">update_sparsity_pattern()</a>.</p>
<div class="fragment"><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;{</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  parallel_object_only();</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="comment">// We shouldn&#39;t be trying to re-attach the same matrices repeatedly</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  libmesh_assert (std::find(<a class="code" href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">_matrices</a>.begin(), <a class="code" href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">_matrices</a>.end(),</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                            &amp;matrix) == <a class="code" href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">_matrices</a>.end());</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">_matrices</a>.push_back(&amp;matrix);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a080083acc01f3035d17895205d1399d4">update_sparsity_pattern</a>(matrix);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">if</span> (matrix.need_full_sparsity_pattern())</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">need_full_sparsity_pattern</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aa8ed6583656addff061ba113f0ca4347"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">libMesh::DofMap::need_full_sparsity_pattern</a></div><div class="ttdeci">bool need_full_sparsity_pattern</div><div class="ttdoc">Default false; set to true if any attached matrix requires a full sparsity pattern. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01976">dof_map.h:1976</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a080083acc01f3035d17895205d1399d4"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a080083acc01f3035d17895205d1399d4">libMesh::DofMap::update_sparsity_pattern</a></div><div class="ttdeci">void update_sparsity_pattern(SparseMatrix&lt; Number &gt; &amp;matrix) const </div><div class="ttdoc">Additional matrices may be be temporarily initialized by this DofMap. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l00307">dof_map.C:307</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aacf8838eb951b139f05e56e338ac2195"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">libMesh::DofMap::_matrices</a></div><div class="ttdeci">std::vector&lt; SparseMatrix&lt; Number &gt; * &gt; _matrices</div><div class="ttdoc">Additional matrices handled by this object. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01871">dof_map.h:1871</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad2336dd53d13c233c14d7d4389d0702a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int libMesh::DofMap::block_size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The block size, if the variables are amenable to block storage. Otherwise 1. This routine was originally designed to enable a blocked storage, but it turns out this information is still super useful for solvers even when we do not use the blocked storage (e.g., MATMPIBAIJ in PETSc). For example (in PCHMG), for a system of PDEs, to construct an efficient multilevel preconditioner, we coarsen the matrix of one single PDE instead of the entire huge matrix. In order to accomplish this, we need to know many PDEs we have. Another use case, the fieldsplit preconditioner can be constructed in place with this info without involving any user efforts. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00651">651</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l00634">has_blocked_representation()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l00621">n_variables()</a>.</p>
<div class="fragment"><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordflow">return</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8cd39b3d232f88b53e993010177ecb29">has_blocked_representation</a>() ? this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aee89c467613b296c215421d60d5ae961">n_variables</a>() : 1);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aee89c467613b296c215421d60d5ae961"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aee89c467613b296c215421d60d5ae961">libMesh::DofMap::n_variables</a></div><div class="ttdeci">unsigned int n_variables() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00621">dof_map.h:621</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8cd39b3d232f88b53e993010177ecb29"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8cd39b3d232f88b53e993010177ecb29">libMesh::DofMap::has_blocked_representation</a></div><div class="ttdeci">bool has_blocked_representation() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00634">dof_map.h:634</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad9a7484991ea22915a82b4f0852df055"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::build_constraint_matrix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>elem_dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>called_recursively</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Build the constraint matrix C associated with the element degree of freedom indices elem_dofs. </p>
<p>The optional parameter <code>called_recursively</code> should be left at the default value <code>false</code>. This is used to handle the special case of an element's degrees of freedom being constrained in terms of other, local degrees of freedom. The usual case is for an elements DOFs to be constrained by some other, external DOFs. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l03459">3459</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>, <a class="el" href="dof__map_8h_source.html#l02179">is_constrained_dof()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00115">libMesh::DenseMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00122">libMesh::DenseMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="dense__matrix_8h_source.html#l01012">libMesh::DenseMatrix&lt; T &gt;::resize()</a> , 以及 <a class="el" href="dense__matrix__impl_8h_source.html#l00188">libMesh::DenseMatrix&lt; T &gt;::right_multiply()</a>.</p>

<p>参考自 <a class="el" href="dof__map__constraints_8C_source.html#l03048">constrain_element_dyad_matrix()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l02380">constrain_element_matrix()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l02450">constrain_element_matrix_and_vector()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03006">constrain_element_vector()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03099">constrain_nothing()</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l03381">max_constraint_error()</a>.</p>
<div class="fragment"><div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;{</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;  LOG_SCOPE_IF(<span class="stringliteral">&quot;build_constraint_matrix()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>, !called_recursively);</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;  <span class="comment">// Create a set containing the DOFs we already depend on</span></div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;  <span class="keyword">typedef</span> std::set&lt;dof_id_type&gt; RCSet;</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;  RCSet dof_set;</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;  <span class="keywordtype">bool</span> we_have_constraints = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;  <span class="comment">// Next insert any other dofs the current dofs might be constrained</span></div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;  <span class="comment">// in terms of.  Note that in this case we may not be done: Those</span></div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;  <span class="comment">// may in turn depend on others.  So, we need to repeat this process</span></div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;  <span class="comment">// in that case until the system depends only on unconstrained</span></div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;  <span class="comment">// degrees of freedom.</span></div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; dof : elem_dofs)</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">is_constrained_dof</a>(dof))</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;      {</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;        we_have_constraints = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;        <span class="comment">// If the DOF is constrained</span></div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;        DofConstraints::const_iterator</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;          pos = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(dof);</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;        libmesh_assert (pos != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end());</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; constraint_row = pos-&gt;second;</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;        <span class="comment">// Constraint rows in p refinement may be empty</span></div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;        <span class="comment">//libmesh_assert (!constraint_row.empty());</span></div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : constraint_row)</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;          dof_set.insert (item.first);</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;      }</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;  <span class="comment">// May be safe to return at this point</span></div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;  <span class="comment">// (but remember to stop the perflog)</span></div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;  <span class="keywordflow">if</span> (!we_have_constraints)</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; dof : elem_dofs)</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;    dof_set.erase (dof);</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;</div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;  <span class="comment">// If we added any DOFS then we need to do this recursively.</span></div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;  <span class="comment">// It is possible that we just added a DOF that is also</span></div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;  <span class="comment">// constrained!</span></div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;  <span class="comment">// Also, we need to handle the special case of an element having DOFs</span></div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;  <span class="comment">// constrained in terms of other, local DOFs</span></div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;  <span class="keywordflow">if</span> (!dof_set.empty() ||  <span class="comment">// case 1: constrained in terms of other DOFs</span></div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;      !called_recursively) <span class="comment">// case 2: constrained in terms of our own DOFs</span></div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;    {</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> old_size =</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;        cast_int&lt;unsigned int&gt;(elem_dofs.size());</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;      <span class="comment">// Add new dependency dofs to the end of the current dof set</span></div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;      elem_dofs.insert(elem_dofs.end(),</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;                       dof_set.begin(), dof_set.end());</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;      <span class="comment">// Now we can build the constraint matrix.</span></div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;      <span class="comment">// Note that resize also zeros for a DenseMatrix&lt;Number&gt;.</span></div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;      C.<a class="code" href="classlibMesh_1_1DenseMatrix.html#a83503e0038a23688676a69008aaabf5c">resize</a> (old_size,</div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;                cast_int&lt;unsigned int&gt;(elem_dofs.size()));</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;      <span class="comment">// Create the C constraint matrix.</span></div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i != old_size; i++)</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">is_constrained_dof</a>(elem_dofs[i]))</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;          {</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;            <span class="comment">// If the DOF is constrained</span></div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;            DofConstraints::const_iterator</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;              pos = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(elem_dofs[i]);</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;            libmesh_assert (pos != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end());</div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; constraint_row = pos-&gt;second;</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;            <span class="comment">// p refinement creates empty constraint rows</span></div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;            <span class="comment">//    libmesh_assert (!constraint_row.empty());</span></div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;</div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : constraint_row)</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0,</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;                   n_elem_dofs = cast_int&lt;unsigned int&gt;(elem_dofs.size());</div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;                   j != n_elem_dofs; j++)</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;                <span class="keywordflow">if</span> (elem_dofs[j] == item.first)</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;                  C(i,j) = item.second;</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;          }</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;          {</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;            C(i,i) = 1.;</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;          }</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;      <span class="comment">// May need to do this recursively.  It is possible</span></div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;      <span class="comment">// that we just replaced a constrained DOF with another</span></div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;      <span class="comment">// constrained DOF.</span></div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;      <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> Cnew;</div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ad9a7484991ea22915a82b4f0852df055">build_constraint_matrix</a> (Cnew, elem_dofs, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;      <span class="keywordflow">if</span> ((C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>() == Cnew.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>()) &amp;&amp;</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;          (Cnew.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>() == elem_dofs.size())) <span class="comment">// If the constraint matrix</span></div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;        C.<a class="code" href="classlibMesh_1_1DenseMatrix.html#aec22afa33a0cc7c64dc20cbb519b8eb0">right_multiply</a>(Cnew);           <span class="comment">// is constrained...</span></div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;      libmesh_assert_equal_to (C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>(), elem_dofs.size());</div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;    }</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a4fb8c524109fd5dff8c98855437544ee"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">libMesh::DenseMatrixBase::n</a></div><div class="ttdeci">unsigned int n() const </div><div class="ttdoc">返回矩阵的列维度。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00122">dense_matrix_base.h:122</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9846273ba4930ef0364bc1fc954af914"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02179">dof_map.h:2179</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a68bd665fb9252382cc9a28df4099d76a"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">libMesh::DenseMatrixBase::m</a></div><div class="ttdeci">unsigned int m() const </div><div class="ttdoc">返回矩阵的行维度。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00115">dense_matrix_base.h:115</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_aec22afa33a0cc7c64dc20cbb519b8eb0"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#aec22afa33a0cc7c64dc20cbb519b8eb0">libMesh::DenseMatrix::right_multiply</a></div><div class="ttdeci">virtual void right_multiply(const DenseMatrixBase&lt; T &gt; &amp;M2) overridefinal</div><div class="ttdoc">右乘以矩阵 M2。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00188">dense_matrix_impl.h:188</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad9a7484991ea22915a82b4f0852df055"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad9a7484991ea22915a82b4f0852df055">libMesh::DofMap::build_constraint_matrix</a></div><div class="ttdeci">void build_constraint_matrix(DenseMatrix&lt; Number &gt; &amp;C, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, const bool called_recursively=false) const </div><div class="ttdoc">Build the constraint matrix C associated with the element degree of freedom indices elem_dofs...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l03459">dof_map_constraints.C:3459</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_a83503e0038a23688676a69008aaabf5c"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#a83503e0038a23688676a69008aaabf5c">libMesh::DenseMatrix::resize</a></div><div class="ttdeci">void resize(const unsigned int new_m, const unsigned int new_n)</div><div class="ttdoc">调整矩阵的大小，并调用 zero() 方法。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix_8h_source.html#l01012">dense_matrix.h:1012</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdoc">A row of the Dof constraint matrix. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00090">dof_map.h:90</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html">libMesh::DenseMatrix</a></div><div class="ttdoc">定义用于有限元类型计算的密集矩阵。 用于在求和成全局矩阵之前存储单元刚度矩阵。所有被覆盖的虚函数都记录在dense_matrix_base.h中。 </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00065">dof_map.h:65</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad2ed5b18088aa8e52795beaf93cde513"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::build_constraint_matrix_and_vector </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>C</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>H</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>elem_dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qoi_index</em> = <code>-1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>called_recursively</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Build the constraint matrix C and the forcing vector H associated with the element degree of freedom indices elem_dofs. </p>
<p>The optional parameter <code>called_recursively</code> should be left at the default value <code>false</code>. This is used to handle the special case of an element's degrees of freedom being constrained in terms of other, local degrees of freedom. The usual case is for an elements DOFs to be constrained by some other, external DOFs and/or Dirichlet conditions.</p>
<p>The forcing vector will depend on which solution's heterogeneous constraints are being applied. For the default <code>qoi_index</code> this will be the primal solution; for <code>qoi_index</code> &gt;= 0 the corresponding adjoint solution's constraints will be used. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l03569">3569</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02034">_adjoint_constraint_values</a>, <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>, <a class="el" href="dof__map_8h_source.html#l02032">_primal_constraint_values</a>, <a class="el" href="dof__map_8h_source.html#l02179">is_constrained_dof()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00115">libMesh::DenseMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00122">libMesh::DenseMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="dense__vector_8h_source.html#l00404">libMesh::DenseVector&lt; T &gt;::resize()</a>, <a class="el" href="dense__matrix_8h_source.html#l01012">libMesh::DenseMatrix&lt; T &gt;::resize()</a>, <a class="el" href="dense__matrix__impl_8h_source.html#l00188">libMesh::DenseMatrix&lt; T &gt;::right_multiply()</a> , 以及 <a class="el" href="dense__matrix__impl_8h_source.html#l00473">libMesh::DenseMatrix&lt; T &gt;::vector_mult_add()</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01910">extract_local_vector()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l02529">heterogeneously_constrain_element_matrix_and_vector()</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l02836">heterogeneously_constrain_element_vector()</a>.</p>
<div class="fragment"><div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;{</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;  LOG_SCOPE_IF(<span class="stringliteral">&quot;build_constraint_matrix_and_vector()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>, !called_recursively);</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;  <span class="comment">// Create a set containing the DOFs we already depend on</span></div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;  <span class="keyword">typedef</span> std::set&lt;dof_id_type&gt; RCSet;</div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;  RCSet dof_set;</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;  <span class="keywordtype">bool</span> we_have_constraints = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;</div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;  <span class="comment">// Next insert any other dofs the current dofs might be constrained</span></div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;  <span class="comment">// in terms of.  Note that in this case we may not be done: Those</span></div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;  <span class="comment">// may in turn depend on others.  So, we need to repeat this process</span></div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;  <span class="comment">// in that case until the system depends only on unconstrained</span></div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;  <span class="comment">// degrees of freedom.</span></div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; dof : elem_dofs)</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">is_constrained_dof</a>(dof))</div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;      {</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;        we_have_constraints = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;        <span class="comment">// If the DOF is constrained</span></div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;        DofConstraints::const_iterator</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;          pos = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(dof);</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;        libmesh_assert (pos != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end());</div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; constraint_row = pos-&gt;second;</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;        <span class="comment">// Constraint rows in p refinement may be empty</span></div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;        <span class="comment">//libmesh_assert (!constraint_row.empty());</span></div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;</div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : constraint_row)</div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;          dof_set.insert (item.first);</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;      }</div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;</div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;  <span class="comment">// May be safe to return at this point</span></div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;  <span class="comment">// (but remember to stop the perflog)</span></div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;  <span class="keywordflow">if</span> (!we_have_constraints)</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; dof : elem_dofs)</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;    dof_set.erase (dof);</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;  <span class="comment">// If we added any DOFS then we need to do this recursively.</span></div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;  <span class="comment">// It is possible that we just added a DOF that is also</span></div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;  <span class="comment">// constrained!</span></div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;  <span class="comment">// Also, we need to handle the special case of an element having DOFs</span></div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;  <span class="comment">// constrained in terms of other, local DOFs</span></div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;  <span class="keywordflow">if</span> (!dof_set.empty() ||  <span class="comment">// case 1: constrained in terms of other DOFs</span></div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;      !called_recursively) <span class="comment">// case 2: constrained in terms of our own DOFs</span></div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;    {</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;      <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a> * rhs_values = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;      <span class="keywordflow">if</span> (qoi_index &lt; 0)</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;        rhs_values = &amp;<a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>;</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;        {</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;          <span class="keyword">const</span> AdjointDofConstraintValues::const_iterator</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;            it = <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.find(qoi_index);</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;          <span class="keywordflow">if</span> (it != <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.end())</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;            rhs_values = &amp;it-&gt;second;</div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;        }</div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> old_size =</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;        cast_int&lt;unsigned int&gt;(elem_dofs.size());</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;      <span class="comment">// Add new dependency dofs to the end of the current dof set</span></div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;      elem_dofs.insert(elem_dofs.end(),</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;                       dof_set.begin(), dof_set.end());</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;</div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;      <span class="comment">// Now we can build the constraint matrix and vector.</span></div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;      <span class="comment">// Note that resize also zeros for a DenseMatrix and DenseVector</span></div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;      C.<a class="code" href="classlibMesh_1_1DenseMatrix.html#a83503e0038a23688676a69008aaabf5c">resize</a> (old_size,</div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;                cast_int&lt;unsigned int&gt;(elem_dofs.size()));</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;      H.<a class="code" href="classlibMesh_1_1DenseVector.html#a08430ae781094632e8272cbb825d4f44">resize</a> (old_size);</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;      <span class="comment">// Create the C constraint matrix.</span></div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i != old_size; i++)</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">is_constrained_dof</a>(elem_dofs[i]))</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;          {</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;            <span class="comment">// If the DOF is constrained</span></div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;            DofConstraints::const_iterator</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;              pos = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(elem_dofs[i]);</div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;</div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;            libmesh_assert (pos != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end());</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; constraint_row = pos-&gt;second;</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;            <span class="comment">// p refinement creates empty constraint rows</span></div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;            <span class="comment">//    libmesh_assert (!constraint_row.empty());</span></div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : constraint_row)</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0,</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;                   n_elem_dofs = cast_int&lt;unsigned int&gt;(elem_dofs.size());</div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;                   j != n_elem_dofs; j++)</div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;                <span class="keywordflow">if</span> (elem_dofs[j] == item.first)</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;                  C(i,j) = item.second;</div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;</div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;            <span class="keywordflow">if</span> (rhs_values)</div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;              {</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;                DofConstraintValueMap::const_iterator rhsit =</div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;                  rhs_values-&gt;find(elem_dofs[i]);</div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;                <span class="keywordflow">if</span> (rhsit != rhs_values-&gt;end())</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;                  H(i) = rhsit-&gt;second;</div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;              }</div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;          }</div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;          {</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;            C(i,i) = 1.;</div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;          }</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;</div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;      <span class="comment">// May need to do this recursively.  It is possible</span></div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;      <span class="comment">// that we just replaced a constrained DOF with another</span></div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;      <span class="comment">// constrained DOF.</span></div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;      <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> Cnew;</div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;      <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> Hnew;</div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;</div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ad2ed5b18088aa8e52795beaf93cde513">build_constraint_matrix_and_vector</a> (Cnew, Hnew, elem_dofs,</div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;                                                qoi_index, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;      <span class="keywordflow">if</span> ((C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>() == Cnew.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>()) &amp;&amp;          <span class="comment">// If the constraint matrix</span></div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;          (Cnew.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>() == elem_dofs.size())) <span class="comment">// is constrained...</span></div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;        {</div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;          <span class="comment">// If x = Cy + h and y = Dz + g</span></div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;          <span class="comment">// Then x = (CD)z + (Cg + h)</span></div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;          C.<a class="code" href="classlibMesh_1_1DenseMatrix.html#aa524e3051fffc87a03e16791d917284a">vector_mult_add</a>(H, 1, Hnew);</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;</div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;          C.<a class="code" href="classlibMesh_1_1DenseMatrix.html#aec22afa33a0cc7c64dc20cbb519b8eb0">right_multiply</a>(Cnew);</div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;        }</div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;      libmesh_assert_equal_to (C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>(), elem_dofs.size());</div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;    }</div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a4fb8c524109fd5dff8c98855437544ee"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">libMesh::DenseMatrixBase::n</a></div><div class="ttdeci">unsigned int n() const </div><div class="ttdoc">返回矩阵的列维度。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00122">dense_matrix_base.h:122</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad2ed5b18088aa8e52795beaf93cde513"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad2ed5b18088aa8e52795beaf93cde513">libMesh::DofMap::build_constraint_matrix_and_vector</a></div><div class="ttdeci">void build_constraint_matrix_and_vector(DenseMatrix&lt; Number &gt; &amp;C, DenseVector&lt; Number &gt; &amp;H, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, int qoi_index=-1, const bool called_recursively=false) const </div><div class="ttdoc">Build the constraint matrix C and the forcing vector H associated with the element degree of freedom ...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l03569">dof_map_constraints.C:3569</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseVector_html_a08430ae781094632e8272cbb825d4f44"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html#a08430ae781094632e8272cbb825d4f44">libMesh::DenseVector::resize</a></div><div class="ttdeci">void resize(const unsigned int n)</div><div class="ttdoc">调整向量的大小。将所有元素设置为0。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__vector_8h_source.html#l00404">dense_vector.h:404</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02034">dof_map.h:2034</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9846273ba4930ef0364bc1fc954af914"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02179">dof_map.h:2179</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a68bd665fb9252382cc9a28df4099d76a"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">libMesh::DenseMatrixBase::m</a></div><div class="ttdeci">unsigned int m() const </div><div class="ttdoc">返回矩阵的行维度。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00115">dense_matrix_base.h:115</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_aa524e3051fffc87a03e16791d917284a"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#aa524e3051fffc87a03e16791d917284a">libMesh::DenseMatrix::vector_mult_add</a></div><div class="ttdeci">void vector_mult_add(DenseVector&lt; T &gt; &amp;dest, const T factor, const DenseVector&lt; T &gt; &amp;arg) const </div><div class="ttdoc">执行缩放矩阵-向量乘法，结果存储在 dest 中。 dest += factor * (*this) * arg. </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00473">dense_matrix_impl.h:473</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_aec22afa33a0cc7c64dc20cbb519b8eb0"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#aec22afa33a0cc7c64dc20cbb519b8eb0">libMesh::DenseMatrix::right_multiply</a></div><div class="ttdeci">virtual void right_multiply(const DenseMatrixBase&lt; T &gt; &amp;M2) overridefinal</div><div class="ttdoc">右乘以矩阵 M2。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00188">dense_matrix_impl.h:188</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofConstraintValueMap_html"><div class="ttname"><a href="classlibMesh_1_1DofConstraintValueMap.html">libMesh::DofConstraintValueMap</a></div><div class="ttdoc">Storage for DofConstraint right hand sides for a particular problem. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00110">dof_map.h:110</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02032">dof_map.h:2032</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_a83503e0038a23688676a69008aaabf5c"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#a83503e0038a23688676a69008aaabf5c">libMesh::DenseMatrix::resize</a></div><div class="ttdeci">void resize(const unsigned int new_m, const unsigned int new_n)</div><div class="ttdoc">调整矩阵的大小，并调用 zero() 方法。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix_8h_source.html#l01012">dense_matrix.h:1012</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdoc">A row of the Dof constraint matrix. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00090">dof_map.h:90</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseVector_html"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html">libMesh::DenseVector</a></div><div class="ttdoc">定义用于有限元计算的稠密向量类。该类基本上是为了补充 DenseMatrix 类而设计的。 它相对于 std::vector 具有额外的功能，使其在有限元中特别有用，特别是对于方程组。 所有重写的虚拟函...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00064">dof_map.h:64</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html">libMesh::DenseMatrix</a></div><div class="ttdoc">定义用于有限元类型计算的密集矩阵。 用于在求和成全局矩阵之前存储单元刚度矩阵。所有被覆盖的虚函数都记录在dense_matrix_base.h中。 </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00065">dof_map.h:65</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2a9137c2889d7b37503ff390f1034083"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt; <a class="el" href="classlibMesh_1_1SparsityPattern_1_1Build.html">SparsityPattern::Build</a> &gt; libMesh::DofMap::build_sparsity </td>
          <td>(</td>
          <td class="paramtype">const MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>calculate_constrained</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Builds a sparsity pattern for matrices using the current degree-of-freedom numbering and coupling. </p>
<p>By default, ignores constraint equations, for build speed; this is valid for the combination of !need_full_sparsity_pattern and constraints which only come from periodic boundary conditions and adaptive mesh refinement, where matrix constraint adds some matrix entries but removes equally many (or more) other entries.</p>
<p>Can be told to calculate sparsity for the constrained matrix, which may be necessary in the case of spline control node constraints or sufficiently many user constraints. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l00064">64</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01898">_augment_sparsity_pattern</a>, <a class="el" href="dof__map_8h_source.html#l01964">_coupling_functors</a>, <a class="el" href="dof__map_8h_source.html#l01589">_dof_coupling</a>, <a class="el" href="dof__map_8h_source.html#l01910">_extra_sparsity_context</a>, <a class="el" href="dof__map_8h_source.html#l01903">_extra_sparsity_function</a>, <a class="el" href="dof__map_8h_source.html#l00675">n_dofs_on_processor()</a>, <a class="el" href="dof__map_8h_source.html#l01976">need_full_sparsity_pattern</a>, <a class="el" href="namespacelibMesh.html#a08e2b5dd30d71db9e43c52a5a631fdae">libMesh::out</a> , 以及 <a class="el" href="dof__map_8C_source.html#l01760">use_coupled_neighbor_dofs()</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01816">compute_sparsity()</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l01898">process_mesh_constraint_rows()</a>.</p>
<div class="fragment"><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;{</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  libmesh_assert (mesh.is_prepared());</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;build_sparsity()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">// Compute the sparsity structure of the global matrix.  This can be</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="comment">// fed into a PetscMatrix to allocate exactly the number of nonzeros</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">// necessary to store the matrix.  This algorithm should be linear</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">// in the (# of elements)*(# nodes per element)</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="comment">// We can be more efficient in the threaded sparsity pattern assembly</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="comment">// if we don&#39;t need the exact pattern.  For some sparse matrix formats</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="comment">// a good upper bound will suffice.</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <span class="comment">// See if we need to include sparsity pattern entries for coupling</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="comment">// between neighbor dofs</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordtype">bool</span> implicit_neighbor_dofs = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a2489e7c067abb05feba00459ac70a1ba">use_coupled_neighbor_dofs</a>(mesh);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="comment">// We can compute the sparsity pattern in parallel on multiple</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="comment">// threads.  The goal is for each thread to compute the full sparsity</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="comment">// pattern for a subset of elements.  These sparsity patterns can</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="comment">// be efficiently merged in the SparsityPattern::Build::join()</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="comment">// method, especially if there is not too much overlap between them.</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="comment">// Even better, if the full sparsity pattern is not needed then</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="comment">// the number of nonzeros per row can be estimated from the</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="comment">// sparsity patterns created on each thread.</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="keyword">auto</span> sp = std::make_unique&lt;SparsityPattern::Build&gt;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    (*<span class="keyword">this</span>,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;     this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab276e172c5488ab3b387b235e28556cf">_dof_coupling</a>,</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;     this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">_coupling_functors</a>,</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;     implicit_neighbor_dofs,</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;     <a class="code" href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">need_full_sparsity_pattern</a>,</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;     calculate_constrained);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  Threads::parallel_reduce (ConstElemRange (mesh.active_local_elements_begin(),</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                                            mesh.active_local_elements_end()), *sp);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  sp-&gt;parallel_sync();</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor"></span>  <span class="comment">// Avoid declaring these variables unless asserts are enabled.</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> proc_id        = mesh.processor_id();</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> n_dofs_on_proc = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a765ac72717810e0a86f04ab8a938cd22">n_dofs_on_processor</a>(proc_id);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor"></span>  libmesh_assert_equal_to (sp-&gt;get_sparsity_pattern().size(), n_dofs_on_proc);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="comment">// Check to see if we have any extra stuff to add to the sparsity_pattern</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#ab3513c402066e6431799e388d62be036">_extra_sparsity_function</a>)</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#a8d69e59ae9a96426ceca2f356caab1b6">_augment_sparsity_pattern</a>)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;          libmesh_here();</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;          <a class="code" href="namespacelibMesh.html#a08e2b5dd30d71db9e43c52a5a631fdae">libMesh::out</a> &lt;&lt; <span class="stringliteral">&quot;WARNING:  You have specified both an extra sparsity function and object.\n&quot;</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;          Are you sure this is what you meant to do??&quot;</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                       &lt;&lt; std::endl;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      sp-&gt;apply_extra_sparsity_function(<a class="code" href="classlibMesh_1_1DofMap.html#ab3513c402066e6431799e388d62be036">_extra_sparsity_function</a>,</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                                        <a class="code" href="classlibMesh_1_1DofMap.html#a283ce213140aa281498b56e138ee8de2">_extra_sparsity_context</a>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#a8d69e59ae9a96426ceca2f356caab1b6">_augment_sparsity_pattern</a>)</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    sp-&gt;apply_extra_sparsity_object(*<a class="code" href="classlibMesh_1_1DofMap.html#a8d69e59ae9a96426ceca2f356caab1b6">_augment_sparsity_pattern</a>);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordflow">return</span> sp;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a283ce213140aa281498b56e138ee8de2"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a283ce213140aa281498b56e138ee8de2">libMesh::DofMap::_extra_sparsity_context</a></div><div class="ttdeci">void * _extra_sparsity_context</div><div class="ttdoc">A pointer associated with the extra sparsity that can optionally be passed in. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01910">dof_map.h:1910</a></div></div>
<div class="ttc" id="namespacelibMesh_html_af18245d4f872c36a41fc74086bda3e80"><div class="ttname"><a href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">libMesh::processor_id_type</a></div><div class="ttdeci">uint8_t processor_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00104">id_types.h:104</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a765ac72717810e0a86f04ab8a938cd22"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a765ac72717810e0a86f04ab8a938cd22">libMesh::DofMap::n_dofs_on_processor</a></div><div class="ttdeci">dof_id_type n_dofs_on_processor(const processor_id_type proc) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00675">dof_map.h:675</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aa8ed6583656addff061ba113f0ca4347"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">libMesh::DofMap::need_full_sparsity_pattern</a></div><div class="ttdeci">bool need_full_sparsity_pattern</div><div class="ttdoc">Default false; set to true if any attached matrix requires a full sparsity pattern. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01976">dof_map.h:1976</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a08e2b5dd30d71db9e43c52a5a631fdae"><div class="ttname"><a href="namespacelibMesh.html#a08e2b5dd30d71db9e43c52a5a631fdae">libMesh::out</a></div><div class="ttdeci">OStreamProxy out</div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab276e172c5488ab3b387b235e28556cf"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab276e172c5488ab3b387b235e28556cf">libMesh::DofMap::_dof_coupling</a></div><div class="ttdeci">CouplingMatrix * _dof_coupling</div><div class="ttdoc">Degree of freedom coupling. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01589">dof_map.h:1589</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8d69e59ae9a96426ceca2f356caab1b6"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8d69e59ae9a96426ceca2f356caab1b6">libMesh::DofMap::_augment_sparsity_pattern</a></div><div class="ttdeci">SparsityPattern::AugmentSparsityPattern * _augment_sparsity_pattern</div><div class="ttdoc">Function object to call to add extra entries to the sparsity pattern. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01898">dof_map.h:1898</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aef1ebc9176a3f7ec9607ba4b26808991"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">libMesh::DofMap::_coupling_functors</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt; _coupling_functors</div><div class="ttdoc">The list of all GhostingFunctor objects to be used when coupling degrees of freedom in matrix sparsit...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01964">dof_map.h:1964</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab3513c402066e6431799e388d62be036"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab3513c402066e6431799e388d62be036">libMesh::DofMap::_extra_sparsity_function</a></div><div class="ttdeci">void(* _extra_sparsity_function)(SparsityPattern::Graph &amp;, std::vector&lt; dof_id_type &gt; &amp;n_nz, std::vector&lt; dof_id_type &gt; &amp;n_oz, void *)</div><div class="ttdoc">A function pointer to a function to call to add extra entries to the sparsity pattern. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01903">dof_map.h:1903</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2489e7c067abb05feba00459ac70a1ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2489e7c067abb05feba00459ac70a1ba">libMesh::DofMap::use_coupled_neighbor_dofs</a></div><div class="ttdeci">bool use_coupled_neighbor_dofs(const MeshBase &amp;mesh) const </div><div class="ttdoc">Tells other library functions whether or not this problem includes coupling between dofs in neighbori...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01760">dof_map.C:1760</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7346f3c1d26e6084479657e6b706d245"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::check_dirichlet_bcid_consistency </td>
          <td>(</td>
          <td class="paramtype">const MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1DirichletBoundary.html">DirichletBoundary</a> &amp;&#160;</td>
          <td class="paramname"><em>boundary</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check that all the ids in dirichlet_bcids are actually present in the mesh. </p>
<p>If not, this will throw an error. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l05532">5532</a> 行定义.</p>

<p>参考 <a class="el" href="dirichlet__boundaries_8h_source.html#l00180">libMesh::DirichletBoundary::b</a>.</p>

<p>参考自 <a class="el" href="dof__map__constraints_8C_source.html#l01736">create_dof_constraints()</a>.</p>
<div class="fragment"><div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;{</div>
<div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;  <span class="keyword">const</span> std::set&lt;boundary_id_type&gt;&amp; mesh_side_bcids =</div>
<div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160;    mesh.get_boundary_info().get_boundary_ids();</div>
<div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160;  <span class="keyword">const</span> std::set&lt;boundary_id_type&gt;&amp; mesh_edge_bcids =</div>
<div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;    mesh.get_boundary_info().get_edge_boundary_ids();</div>
<div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;  <span class="keyword">const</span> std::set&lt;boundary_id_type&gt;&amp; mesh_node_bcids =</div>
<div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;    mesh.get_boundary_info().get_node_boundary_ids();</div>
<div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;  <span class="keyword">const</span> std::set&lt;boundary_id_type&gt;&amp; dbc_bcids = boundary.<a class="code" href="classlibMesh_1_1DirichletBoundary.html#a9375f30ebf033684e24bc0418872d022">b</a>;</div>
<div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;</div>
<div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;  <span class="comment">// DirichletBoundary id sets should be consistent across all ranks</span></div>
<div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;  libmesh_assert(mesh.comm().verify(dbc_bcids.size()));</div>
<div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;</div>
<div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; bc_id : dbc_bcids)</div>
<div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;    {</div>
<div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;      <span class="comment">// DirichletBoundary id sets should be consistent across all ranks</span></div>
<div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;      libmesh_assert(mesh.comm().verify(bc_id));</div>
<div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;</div>
<div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160;      <span class="keywordtype">bool</span> found_bcid = (mesh_side_bcids.find(bc_id) != mesh_side_bcids.end() ||</div>
<div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;                         mesh_edge_bcids.find(bc_id) != mesh_edge_bcids.end() ||</div>
<div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;                         mesh_node_bcids.find(bc_id) != mesh_node_bcids.end());</div>
<div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;</div>
<div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;      <span class="comment">// On a distributed mesh, boundary id sets may *not* be</span></div>
<div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160;      <span class="comment">// consistent across all ranks, since not all ranks see all</span></div>
<div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;      <span class="comment">// boundaries</span></div>
<div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;      mesh.comm().max(found_bcid);</div>
<div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160;</div>
<div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160;      libmesh_error_msg_if(!found_bcid,</div>
<div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;                           <span class="stringliteral">&quot;Could not find Dirichlet boundary id &quot;</span> &lt;&lt; bc_id &lt;&lt; <span class="stringliteral">&quot; in mesh!&quot;</span>);</div>
<div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;    }</div>
<div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DirichletBoundary_html_a9375f30ebf033684e24bc0418872d022"><div class="ttname"><a href="classlibMesh_1_1DirichletBoundary.html#a9375f30ebf033684e24bc0418872d022">libMesh::DirichletBoundary::b</a></div><div class="ttdeci">std::set&lt; boundary_id_type &gt; b</div><div class="ttdef"><b>Definition:</b> <a href="dirichlet__boundaries_8h_source.html#l00180">dirichlet_boundaries.h:180</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab905c6911894def0c2cd5e8163adec15"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::check_for_constraint_loops </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l04545">4545</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a> , 以及 <a class="el" href="libmesh__common_8h_source.html#l00143">libMesh::Real</a>.</p>

<p>参考自 <a class="el" href="dof__map__constraints_8C_source.html#l04539">check_for_cyclic_constraints()</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l04372">process_constraints()</a>.</p>
<div class="fragment"><div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;{</div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;  <span class="comment">// Create a set containing the DOFs we already depend on</span></div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;  <span class="keyword">typedef</span> std::set&lt;dof_id_type&gt; RCSet;</div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;  RCSet unexpanded_set;</div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;</div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;  <span class="comment">// Use dof_constraints_copy in this method so that we don&#39;t</span></div>
<div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;  <span class="comment">// mess with _dof_constraints.</span></div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;  <a class="code" href="classlibMesh_1_1DofConstraints.html">DofConstraints</a> dof_constraints_copy = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>;</div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;</div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; i : dof_constraints_copy)</div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;    unexpanded_set.insert(i.first);</div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;</div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;  <span class="keywordflow">while</span> (!unexpanded_set.empty())</div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;    <span class="keywordflow">for</span> (RCSet::iterator i = unexpanded_set.begin();</div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;         i != unexpanded_set.end(); <span class="comment">/* nothing */</span>)</div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;      {</div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;        <span class="comment">// If the DOF is constrained</span></div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;        DofConstraints::iterator</div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;          pos = dof_constraints_copy.find(*i);</div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;</div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;        libmesh_assert (pos != dof_constraints_copy.end());</div>
<div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;</div>
<div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;        <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; constraint_row = pos-&gt;second;</div>
<div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;</div>
<div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;        <span class="comment">// Comment out &quot;rhs&quot; parts of this method copied from process_constraints</span></div>
<div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;        <span class="comment">// DofConstraintValueMap::iterator rhsit =</span></div>
<div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;        <span class="comment">//   _primal_constraint_values.find(*i);</span></div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;        <span class="comment">// Number constraint_rhs = (rhsit == _primal_constraint_values.end()) ?</span></div>
<div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;        <span class="comment">//   0 : rhsit-&gt;second;</span></div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;</div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;        std::vector&lt;dof_id_type&gt; constraints_to_expand;</div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;</div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : constraint_row)</div>
<div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;          <span class="keywordflow">if</span> (item.first != *i &amp;&amp; this-&gt;is_constrained_dof(item.first))</div>
<div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;            {</div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;              unexpanded_set.insert(item.first);</div>
<div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;              constraints_to_expand.push_back(item.first);</div>
<div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;            }</div>
<div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;</div>
<div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; expandable : constraints_to_expand)</div>
<div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;          {</div>
<div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> this_coef = constraint_row[expandable];</div>
<div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;</div>
<div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;            DofConstraints::const_iterator</div>
<div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;              subpos = dof_constraints_copy.find(expandable);</div>
<div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;</div>
<div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;            libmesh_assert (subpos != dof_constraints_copy.end());</div>
<div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;</div>
<div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; subconstraint_row = subpos-&gt;second;</div>
<div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;</div>
<div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : subconstraint_row)</div>
<div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;              {</div>
<div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;                libmesh_error_msg_if(item.first == expandable, <span class="stringliteral">&quot;Constraint loop detected&quot;</span>);</div>
<div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;</div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;                constraint_row[item.first] += item.second * this_coef;</div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;              }</div>
<div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;</div>
<div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;            <span class="comment">// Comment out &quot;rhs&quot; parts of this method copied from process_constraints</span></div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;            <span class="comment">// DofConstraintValueMap::const_iterator subrhsit =</span></div>
<div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;            <span class="comment">//   _primal_constraint_values.find(expandable);</span></div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;            <span class="comment">// if (subrhsit != _primal_constraint_values.end())</span></div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;            <span class="comment">//   constraint_rhs += subrhsit-&gt;second * this_coef;</span></div>
<div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;</div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;            constraint_row.erase(expandable);</div>
<div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;          }</div>
<div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;</div>
<div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;        <span class="comment">// Comment out &quot;rhs&quot; parts of this method copied from process_constraints</span></div>
<div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;        <span class="comment">// if (rhsit == _primal_constraint_values.end())</span></div>
<div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;        <span class="comment">//   {</span></div>
<div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;        <span class="comment">//     if (constraint_rhs != Number(0))</span></div>
<div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;        <span class="comment">//       _primal_constraint_values[*i] = constraint_rhs;</span></div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;        <span class="comment">//     else</span></div>
<div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;        <span class="comment">//       _primal_constraint_values.erase(*i);</span></div>
<div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;        <span class="comment">//   }</span></div>
<div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;        <span class="comment">// else</span></div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;        <span class="comment">//   {</span></div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;        <span class="comment">//     if (constraint_rhs != Number(0))</span></div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;        <span class="comment">//       rhsit-&gt;second = constraint_rhs;</span></div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;        <span class="comment">//     else</span></div>
<div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;        <span class="comment">//       _primal_constraint_values.erase(rhsit);</span></div>
<div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;        <span class="comment">//   }</span></div>
<div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;</div>
<div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;        <span class="keywordflow">if</span> (constraints_to_expand.empty())</div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;          i = unexpanded_set.erase(i);</div>
<div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;          ++i;</div>
<div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;      }</div>
<div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aef28359fb4851abec08fc99cfbac118d"><div class="ttname"><a href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">libMesh::Real</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef LIBMESH_DEFAULT_SCALAR_TYPE Real</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00143">libmesh_common.h:143</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdoc">A row of the Dof constraint matrix. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00090">dof_map.h:90</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofConstraints_html"><div class="ttname"><a href="classlibMesh_1_1DofConstraints.html">libMesh::DofConstraints</a></div><div class="ttdoc">The constraint matrix storage format. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00098">dof_map.h:98</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a30a6ab4b65749be311da80b48f312fd3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::check_for_cyclic_constraints </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Throw an error if we detect any constraint loops, i.e. </p>
<p>A -&gt; B -&gt; C -&gt; A that is, "dof A is constrained in terms of dof B which is constrained in terms of dof C which is constrained in terms of dof A", since these are not supported by <a class="el" href="namespacelibMesh.html" title="The libMesh namespace provides an interface to certain functionality in the library. ">libMesh</a> and give erroneous results if they are present.</p>
<dl class="section note"><dt>注解</dt><dd>The original "cyclic constraint" terminology was unfortunate since the word cyclic is used by some software to indicate an actual type of rotational/angular constraint and not (as here) a cyclic graph. The former nomenclature will eventually be deprecated in favor of "constraint loop". </dd></dl>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l04539">4539</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map__constraints_8C_source.html#l04545">check_for_constraint_loops()</a>.</p>
<div class="fragment"><div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;{</div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;  <span class="comment">// Eventually make this officially libmesh_deprecated();</span></div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab905c6911894def0c2cd5e8163adec15">check_for_constraint_loops</a>();</div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab905c6911894def0c2cd5e8163adec15"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab905c6911894def0c2cd5e8163adec15">libMesh::DofMap::check_for_constraint_loops</a></div><div class="ttdeci">void check_for_constraint_loops()</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l04545">dof_map_constraints.C:4545</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a480f80bc9234a5586711833b87a89784"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::clear </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Free all new memory associated with the object, but restore its original state, with the mesh pointer and any default ghosting. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l00850">850</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02034">_adjoint_constraint_values</a>, <a class="el" href="dof__map_8h_source.html#l01951">_algebraic_ghosting_functors</a>, <a class="el" href="dof__map_8h_source.html#l01964">_coupling_functors</a>, <a class="el" href="dof__map_8h_source.html#l01933">_default_coupling</a>, <a class="el" href="dof__map_8h_source.html#l01941">_default_evaluating</a>, <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>, <a class="el" href="dof__map_8h_source.html#l01589">_dof_coupling</a>, <a class="el" href="dof__map_8h_source.html#l01881">_end_df</a>, <a class="el" href="dof__map_8h_source.html#l02011">_end_old_df</a>, <a class="el" href="dof__map_8h_source.html#l01876">_first_df</a>, <a class="el" href="dof__map_8h_source.html#l02006">_first_old_df</a>, <a class="el" href="dof__map_8h_source.html#l02017">_first_old_scalar_df</a>, <a class="el" href="dof__map_8h_source.html#l01887">_first_scalar_df</a>, <a class="el" href="dof__map_8h_source.html#l01871">_matrices</a>, <a class="el" href="dof__map_8h_source.html#l01864">_mesh</a>, <a class="el" href="dof__map_8h_source.html#l01988">_n_dfs</a>, <a class="el" href="dof__map_8h_source.html#l02001">_n_old_dfs</a>, <a class="el" href="dof__map_8h_source.html#l02032">_primal_constraint_values</a>, <a class="el" href="dof__map_8h_source.html#l01970">_shared_functors</a>, <a class="el" href="dof__map_8h_source.html#l02030">_stashed_dof_constraints</a>, <a class="el" href="dof__map_8h_source.html#l01854">_var_to_vg</a>, <a class="el" href="dof__map_8h_source.html#l01849">_variable_group_numbers</a>, <a class="el" href="dof__map_8h_source.html#l01844">_variable_groups</a>, <a class="el" href="dof__map_8h_source.html#l01839">_variables</a>, <a class="el" href="dof__map_8C_source.html#l01886">add_algebraic_ghosting_functor()</a>, <a class="el" href="dof__map_8C_source.html#l01861">add_coupling_functor()</a>, <a class="el" href="dof__map_8h_source.html#l00485">clear_send_list()</a>, <a class="el" href="dof__map_8C_source.html#l01837">clear_sparsity()</a>, <a class="el" href="dof__map_8h_source.html#l01976">need_full_sparsity_pattern</a> , 以及 <a class="el" href="dof__map_8C_source.html#l01760">use_coupled_neighbor_dofs()</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00206">~DofMap()</a>.</p>
<div class="fragment"><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;{</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="comment">// we don&#39;t want to clear</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="comment">// the coupling matrix!</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="comment">// It should not change...</span></div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;  <span class="comment">//_dof_coupling-&gt;clear();</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  <span class="comment">// But it would be inconsistent to leave our coupling settings</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <span class="comment">// through a clear()...</span></div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab276e172c5488ab3b387b235e28556cf">_dof_coupling</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <span class="comment">// Reset ghosting functor statuses</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  {</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; gf : <a class="code" href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">_coupling_functors</a>)</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      {</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        libmesh_assert(gf);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;        <a class="code" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a>.remove_ghosting_functor(*gf);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      }</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    this-&gt;_coupling_functors.clear();</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="comment">// Go back to default coupling</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">_default_coupling</a>-&gt;set_dof_coupling(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab276e172c5488ab3b387b235e28556cf">_dof_coupling</a>);</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">_default_coupling</a>-&gt;set_n_levels(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a2489e7c067abb05feba00459ac70a1ba">use_coupled_neighbor_dofs</a>(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a>));</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ae17b27f47b3731f6ce72312edd957bf7">add_coupling_functor</a>(*<a class="code" href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">_default_coupling</a>);</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  }</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  {</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; gf : <a class="code" href="classlibMesh_1_1DofMap.html#a378d58f5e860f781a52adb61464c9378">_algebraic_ghosting_functors</a>)</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      {</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        libmesh_assert(gf);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        <a class="code" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a>.remove_ghosting_functor(*gf);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      }</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    this-&gt;_algebraic_ghosting_functors.clear();</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <span class="comment">// Go back to default send_list generation</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="comment">// _default_evaluating-&gt;set_dof_coupling(this-&gt;_dof_coupling);</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">_default_evaluating</a>-&gt;set_n_levels(1);</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9a0c5eeda42bc54bb3ae1c2d05ec5227">add_algebraic_ghosting_functor</a>(*<a class="code" href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">_default_evaluating</a>);</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  }</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ac72a2e7009922c18fc0a59ebcceb58b1">_shared_functors</a>.clear();</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">_variables</a>.clear();</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a>.clear();</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a1bc6f6a2a702bfb9511b442d99fc7a28">_var_to_vg</a>.clear();</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a04bedd57c80ef97a7d9a0a3e2fe8a248">_variable_group_numbers</a>.clear();</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a>.clear();</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>.clear();</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#af1fc10139391d71da470387d9e4adbb5">_first_scalar_df</a>.clear();</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7f04c34ba9909c7d788196575c619aff">clear_send_list</a>();</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a6481536ea3c70d31fb18fa35bfc88e33">clear_sparsity</a>();</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">need_full_sparsity_pattern</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_AMR</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.clear();</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#af21470daae1a06d29df4bac4807a019c">_stashed_dof_constraints</a>.clear();</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.clear();</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.clear();</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#abbca79dca4f02ab917e89aeac3113808">_n_old_dfs</a> = 0;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab91d708f5167f50c0392b2fd5dea2559">_first_old_df</a>.clear();</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab96f5b260e5925063553da996bb3b428">_end_old_df</a>.clear();</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a92da14cf60e82ed600bfe67ca3422765">_first_old_scalar_df</a>.clear();</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">_matrices</a>.clear();</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a0964620ae8054b969297d1d9087b7b05">_n_dfs</a> = 0;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad840cf4659b6b1a2f781d29225e82743"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">libMesh::DofMap::_variable_groups</a></div><div class="ttdeci">std::vector&lt; VariableGroup &gt; _variable_groups</div><div class="ttdoc">The finite element type for each variable group. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01844">dof_map.h:1844</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7f04c34ba9909c7d788196575c619aff"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7f04c34ba9909c7d788196575c619aff">libMesh::DofMap::clear_send_list</a></div><div class="ttdeci">void clear_send_list()</div><div class="ttdoc">Clears the _send_list vector. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00485">dof_map.h:485</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a378d58f5e860f781a52adb61464c9378"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a378d58f5e860f781a52adb61464c9378">libMesh::DofMap::_algebraic_ghosting_functors</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt; _algebraic_ghosting_functors</div><div class="ttdoc">The list of all GhostingFunctor objects to be used when distributing ghosted vectors. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01951">dof_map.h:1951</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab96f5b260e5925063553da996bb3b428"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab96f5b260e5925063553da996bb3b428">libMesh::DofMap::_end_old_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _end_old_df</div><div class="ttdoc">Last old DOF index (plus 1) on processor p. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02011">dof_map.h:2011</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ae17b27f47b3731f6ce72312edd957bf7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ae17b27f47b3731f6ce72312edd957bf7">libMesh::DofMap::add_coupling_functor</a></div><div class="ttdeci">void add_coupling_functor(GhostingFunctor &amp;coupling_functor, bool to_mesh=true)</div><div class="ttdoc">Adds a functor which can specify coupling requirements for creation of sparse matrices. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01861">dof_map.C:1861</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab91d708f5167f50c0392b2fd5dea2559"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab91d708f5167f50c0392b2fd5dea2559">libMesh::DofMap::_first_old_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_old_df</div><div class="ttdoc">First old DOF index on processor p. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02006">dof_map.h:2006</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af1fc10139391d71da470387d9e4adbb5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af1fc10139391d71da470387d9e4adbb5">libMesh::DofMap::_first_scalar_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_scalar_df</div><div class="ttdoc">First DOF index for SCALAR variable v, or garbage for non-SCALAR variable v. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01887">dof_map.h:1887</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02034">dof_map.h:2034</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aa8ed6583656addff061ba113f0ca4347"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">libMesh::DofMap::need_full_sparsity_pattern</a></div><div class="ttdeci">bool need_full_sparsity_pattern</div><div class="ttdoc">Default false; set to true if any attached matrix requires a full sparsity pattern. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01976">dof_map.h:1976</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a1bc6f6a2a702bfb9511b442d99fc7a28"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a1bc6f6a2a702bfb9511b442d99fc7a28">libMesh::DofMap::_var_to_vg</a></div><div class="ttdeci">std::unordered_map&lt; unsigned int, unsigned int &gt; _var_to_vg</div><div class="ttdoc">A map from variable number to variable group number. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01854">dof_map.h:1854</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a92da14cf60e82ed600bfe67ca3422765"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a92da14cf60e82ed600bfe67ca3422765">libMesh::DofMap::_first_old_scalar_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_old_scalar_df</div><div class="ttdoc">First old DOF index for SCALAR variable v, or garbage for non-SCALAR variable v. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02017">dof_map.h:2017</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab276e172c5488ab3b387b235e28556cf"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab276e172c5488ab3b387b235e28556cf">libMesh::DofMap::_dof_coupling</a></div><div class="ttdeci">CouplingMatrix * _dof_coupling</div><div class="ttdoc">Degree of freedom coupling. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01589">dof_map.h:1589</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aacf8838eb951b139f05e56e338ac2195"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">libMesh::DofMap::_matrices</a></div><div class="ttdeci">std::vector&lt; SparseMatrix&lt; Number &gt; * &gt; _matrices</div><div class="ttdoc">Additional matrices handled by this object. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01871">dof_map.h:1871</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_abb069d1433ad6f8eeb4d5ebf44ae4dc8"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">libMesh::DofMap::_default_coupling</a></div><div class="ttdeci">std::unique_ptr&lt; DefaultCoupling &gt; _default_coupling</div><div class="ttdoc">The default coupling GhostingFunctor, used to implement standard libMesh sparsity pattern constructio...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01933">dof_map.h:1933</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02032">dof_map.h:2032</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a5232a8054e580a408f394ba1574c63df"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">libMesh::DofMap::_variables</a></div><div class="ttdeci">std::vector&lt; Variable &gt; _variables</div><div class="ttdoc">The finite element type for each variable. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01839">dof_map.h:1839</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af21470daae1a06d29df4bac4807a019c"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af21470daae1a06d29df4bac4807a019c">libMesh::DofMap::_stashed_dof_constraints</a></div><div class="ttdeci">DofConstraints _stashed_dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_abbca79dca4f02ab917e89aeac3113808"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#abbca79dca4f02ab917e89aeac3113808">libMesh::DofMap::_n_old_dfs</a></div><div class="ttdeci">dof_id_type _n_old_dfs</div><div class="ttdoc">Total number of degrees of freedom on old dof objects. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02001">dof_map.h:2001</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a6481536ea3c70d31fb18fa35bfc88e33"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a6481536ea3c70d31fb18fa35bfc88e33">libMesh::DofMap::clear_sparsity</a></div><div class="ttdeci">void clear_sparsity()</div><div class="ttdoc">Clears the sparsity pattern. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01837">dof_map.C:1837</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aef1ebc9176a3f7ec9607ba4b26808991"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">libMesh::DofMap::_coupling_functors</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt; _coupling_functors</div><div class="ttdoc">The list of all GhostingFunctor objects to be used when coupling degrees of freedom in matrix sparsit...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01964">dof_map.h:1964</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af43f96a9e11b3f4221306fdfd4511aaa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">libMesh::DofMap::_end_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _end_df</div><div class="ttdoc">Last DOF index (plus 1) on processor p. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01881">dof_map.h:1881</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab72062de06b72df985ac5bf16837a7da"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">libMesh::DofMap::_first_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_df</div><div class="ttdoc">First DOF index on processor p. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01876">dof_map.h:1876</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ac0f1617e6f28fc596497b370092bcc17"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">libMesh::DofMap::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdoc">The mesh that system uses. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01864">dof_map.h:1864</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a4eb9c9ed9c530781aac48df4fc0cf27b"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">libMesh::DofMap::_default_evaluating</a></div><div class="ttdeci">std::unique_ptr&lt; DefaultCoupling &gt; _default_evaluating</div><div class="ttdoc">The default algebraic GhostingFunctor, used to implement standard libMesh send_list construction...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01941">dof_map.h:1941</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a04bedd57c80ef97a7d9a0a3e2fe8a248"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a04bedd57c80ef97a7d9a0a3e2fe8a248">libMesh::DofMap::_variable_group_numbers</a></div><div class="ttdeci">std::vector&lt; unsigned int &gt; _variable_group_numbers</div><div class="ttdoc">The variable group number for each variable. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01849">dof_map.h:1849</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ac72a2e7009922c18fc0a59ebcceb58b1"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ac72a2e7009922c18fc0a59ebcceb58b1">libMesh::DofMap::_shared_functors</a></div><div class="ttdeci">std::map&lt; GhostingFunctor *, std::shared_ptr&lt; GhostingFunctor &gt; &gt; _shared_functors</div><div class="ttdoc">Hang on to references to any GhostingFunctor objects we were passed in shared_ptr form...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01970">dof_map.h:1970</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9a0c5eeda42bc54bb3ae1c2d05ec5227"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9a0c5eeda42bc54bb3ae1c2d05ec5227">libMesh::DofMap::add_algebraic_ghosting_functor</a></div><div class="ttdeci">void add_algebraic_ghosting_functor(GhostingFunctor &amp;evaluable_functor, bool to_mesh=true)</div><div class="ttdoc">Adds a functor which can specify algebraic ghosting requirements for use with distributed vectors...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01886">dof_map.C:1886</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2489e7c067abb05feba00459ac70a1ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2489e7c067abb05feba00459ac70a1ba">libMesh::DofMap::use_coupled_neighbor_dofs</a></div><div class="ttdeci">bool use_coupled_neighbor_dofs(const MeshBase &amp;mesh) const </div><div class="ttdoc">Tells other library functions whether or not this problem includes coupling between dofs in neighbori...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01760">dof_map.C:1760</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a0964620ae8054b969297d1d9087b7b05"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a0964620ae8054b969297d1d9087b7b05">libMesh::DofMap::_n_dfs</a></div><div class="ttdeci">dof_id_type _n_dfs</div><div class="ttdoc">Total number of degrees of freedom. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01988">dof_map.h:1988</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7f04c34ba9909c7d788196575c619aff"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::clear_send_list </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Clears the <code>_send_list</code> vector. </p>
<p>This should be done in order to completely rebuild the send_list from scratch rather than merely adding to the existing send_list. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00485">485</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01893">_send_list</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00850">clear()</a>, <a class="el" href="dof__map_8C_source.html#l00927">distribute_dofs()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l01734">reinit_send_list()</a>.</p>
<div class="fragment"><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  {</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>.clear();</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2b3873478d701811b9562b514fc2c369"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">libMesh::DofMap::_send_list</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _send_list</div><div class="ttdoc">A list containing all the global DOF indices that affect the solution on my processor. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01893">dof_map.h:1893</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6481536ea3c70d31fb18fa35bfc88e33"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::clear_sparsity </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clears the sparsity pattern. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l01837">1837</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01983">_sp</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00850">clear()</a>.</p>
<div class="fragment"><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;{</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>.reset();</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab14c66a56c0815c857dc662bea96f124"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">libMesh::DofMap::_sp</a></div><div class="ttdeci">std::unique_ptr&lt; SparsityPattern::Build &gt; _sp</div><div class="ttdoc">The sparsity pattern of the global matrix. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01983">dof_map.h:1983</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a49379ce3a542eab41a8f8e44d0f154c2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::compute_sparsity </td>
          <td>(</td>
          <td class="paramtype">const MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the sparsity pattern for the matrices corresponding to <code>proc_id</code> and sends that data to Linear Algebra packages for preallocation of sparse matrices. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l01816">1816</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01834">_constrained_sparsity_construction</a>, <a class="el" href="dof__map_8h_source.html#l01871">_matrices</a>, <a class="el" href="dof__map_8h_source.html#l01983">_sp</a>, <a class="el" href="dof__map_8C_source.html#l00064">build_sparsity()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l01976">need_full_sparsity_pattern</a>.</p>
<div class="fragment"><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;{</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a> = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a2a9137c2889d7b37503ff390f1034083">build_sparsity</a>(mesh, this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a780be47336e49e2f9cd55bba69ee919a">_constrained_sparsity_construction</a>);</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;  <span class="comment">// It is possible that some \p SparseMatrix implementations want to</span></div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;  <span class="comment">// see the sparsity pattern before we throw it away.  If so, we</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;  <span class="comment">// share a view of its arrays, and we pass it in to the matrices.</span></div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; mat : <a class="code" href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">_matrices</a>)</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;    {</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;      mat-&gt;attach_sparsity_pattern (*<a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>);</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">need_full_sparsity_pattern</a>)</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;        mat-&gt;update_sparsity_pattern (<a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>-&gt;get_sparsity_pattern());</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    }</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;  <span class="comment">// If we don&#39;t need the full sparsity pattern anymore, free the</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;  <span class="comment">// parts of it we don&#39;t need.</span></div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">need_full_sparsity_pattern</a>)</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>-&gt;clear_full_sparsity();</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab14c66a56c0815c857dc662bea96f124"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">libMesh::DofMap::_sp</a></div><div class="ttdeci">std::unique_ptr&lt; SparsityPattern::Build &gt; _sp</div><div class="ttdoc">The sparsity pattern of the global matrix. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01983">dof_map.h:1983</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a780be47336e49e2f9cd55bba69ee919a"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a780be47336e49e2f9cd55bba69ee919a">libMesh::DofMap::_constrained_sparsity_construction</a></div><div class="ttdeci">bool _constrained_sparsity_construction</div><div class="ttdoc">This flag indicates whether or not we explicitly take constraint equations into account when computin...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01834">dof_map.h:1834</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aa8ed6583656addff061ba113f0ca4347"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">libMesh::DofMap::need_full_sparsity_pattern</a></div><div class="ttdeci">bool need_full_sparsity_pattern</div><div class="ttdoc">Default false; set to true if any attached matrix requires a full sparsity pattern. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01976">dof_map.h:1976</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2a9137c2889d7b37503ff390f1034083"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2a9137c2889d7b37503ff390f1034083">libMesh::DofMap::build_sparsity</a></div><div class="ttdeci">std::unique_ptr&lt; SparsityPattern::Build &gt; build_sparsity(const MeshBase &amp;mesh, bool calculate_constrained=false) const </div><div class="ttdoc">Builds a sparsity pattern for matrices using the current degree-of-freedom numbering and coupling...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l00064">dof_map.C:64</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aacf8838eb951b139f05e56e338ac2195"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">libMesh::DofMap::_matrices</a></div><div class="ttdeci">std::vector&lt; SparseMatrix&lt; Number &gt; * &gt; _matrices</div><div class="ttdoc">Additional matrices handled by this object. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01871">dof_map.h:1871</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a235d7415e617ce36b0f2af4afc106400"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::computed_sparsity_already </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns true iff a sparsity pattern has already been computed. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l00296">296</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01983">_sp</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00307">update_sparsity_pattern()</a>.</p>
<div class="fragment"><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;{</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classlibMesh_1_1DofMap.html#a235d7415e617ce36b0f2af4afc106400">computed_sparsity_already</a> = <a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a> &amp;&amp;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    (!<a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>-&gt;get_n_nz().empty() ||</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;     !<a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>-&gt;get_n_oz().empty());</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  this-&gt;comm().max(computed_sparsity_already);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a235d7415e617ce36b0f2af4afc106400">computed_sparsity_already</a>;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab14c66a56c0815c857dc662bea96f124"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">libMesh::DofMap::_sp</a></div><div class="ttdeci">std::unique_ptr&lt; SparsityPattern::Build &gt; _sp</div><div class="ttdoc">The sparsity pattern of the global matrix. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01983">dof_map.h:1983</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a235d7415e617ce36b0f2af4afc106400"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a235d7415e617ce36b0f2af4afc106400">libMesh::DofMap::computed_sparsity_already</a></div><div class="ttdeci">bool computed_sparsity_already() const </div><div class="ttdoc">Returns true iff a sparsity pattern has already been computed. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l00296">dof_map.C:296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3bacc34820b779d4c6d69bc1f99570d4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::constrain_element_dyad_matrix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>row_dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>asymmetric_constraint_rows</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constrains a dyadic element matrix B = v w'. </p>
<p>This method requires the element matrix to be square, in which case the elem_dofs correspond to the global DOF indices of both the rows and columns of the element matrix. For this case the rows and columns of the matrix necessarily correspond to variables of the same approximation order. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l03048">3048</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03459">build_constraint_matrix()</a>, <a class="el" href="dof__map_8h_source.html#l02179">is_constrained_dof()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00115">libMesh::DenseMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00122">libMesh::DenseMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="dense__vector_8h_source.html#l00111">libMesh::DenseVector&lt; T &gt;::size()</a> , 以及 <a class="el" href="dense__matrix__impl_8h_source.html#l00392">libMesh::DenseMatrix&lt; T &gt;::vector_mult_transpose()</a>.</p>
<div class="fragment"><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;{</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;  libmesh_assert_equal_to (v.<a class="code" href="classlibMesh_1_1DenseVector.html#a06832d76a4df1deb9e45afb9555521d0">size</a>(), row_dofs.size());</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;  libmesh_assert_equal_to (w.<a class="code" href="classlibMesh_1_1DenseVector.html#a06832d76a4df1deb9e45afb9555521d0">size</a>(), row_dofs.size());</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;  <span class="comment">// check for easy return</span></div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.empty())</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;  <span class="comment">// The constrained RHS is built up as R^T F.</span></div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;  <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> R;</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ad9a7484991ea22915a82b4f0852df055">build_constraint_matrix</a> (R, row_dofs);</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;cnstrn_elem_dyad_mat()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;  <span class="comment">// It is possible that the vector is not constrained at all.</span></div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;  <span class="keywordflow">if</span> ((R.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>() == v.<a class="code" href="classlibMesh_1_1DenseVector.html#a06832d76a4df1deb9e45afb9555521d0">size</a>()) &amp;&amp;</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;      (R.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>() == row_dofs.size())) <span class="comment">// if the RHS is constrained</span></div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;    {</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;      <span class="comment">// Compute the matrix-vector products</span></div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;      <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> old_v(v);</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;      <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> old_w(w);</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;      <span class="comment">// compute matrix/vector product</span></div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;      R.<a class="code" href="classlibMesh_1_1DenseMatrix.html#ace7e590c10044121b6b348c3301e545a">vector_mult_transpose</a>(v, old_v);</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;      R.<a class="code" href="classlibMesh_1_1DenseMatrix.html#ace7e590c10044121b6b348c3301e545a">vector_mult_transpose</a>(w, old_w);</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;      libmesh_assert_equal_to (row_dofs.size(), v.<a class="code" href="classlibMesh_1_1DenseVector.html#a06832d76a4df1deb9e45afb9555521d0">size</a>());</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;      libmesh_assert_equal_to (row_dofs.size(), w.<a class="code" href="classlibMesh_1_1DenseVector.html#a06832d76a4df1deb9e45afb9555521d0">size</a>());</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;      <span class="comment">/* Constrain only v, not w.  */</span></div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0,</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;           n_row_dofs = cast_int&lt;unsigned int&gt;(row_dofs.size());</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;           i != n_row_dofs; i++)</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">is_constrained_dof</a>(row_dofs[i]))</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;          {</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;            <span class="comment">// If the DOF is constrained</span></div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;            libmesh_assert (<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(row_dofs[i]) != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end());</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;            v(i) = 0;</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;          }</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;    } <span class="comment">// end if the RHS is constrained.</span></div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a4fb8c524109fd5dff8c98855437544ee"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">libMesh::DenseMatrixBase::n</a></div><div class="ttdeci">unsigned int n() const </div><div class="ttdoc">返回矩阵的列维度。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00122">dense_matrix_base.h:122</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_ace7e590c10044121b6b348c3301e545a"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#ace7e590c10044121b6b348c3301e545a">libMesh::DenseMatrix::vector_mult_transpose</a></div><div class="ttdeci">void vector_mult_transpose(DenseVector&lt; T &gt; &amp;dest, const DenseVector&lt; T &gt; &amp;arg) const </div><div class="ttdoc">执行矩阵-向量乘法，dest := (*this)^T * arg。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00392">dense_matrix_impl.h:392</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9846273ba4930ef0364bc1fc954af914"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02179">dof_map.h:2179</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a68bd665fb9252382cc9a28df4099d76a"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">libMesh::DenseMatrixBase::m</a></div><div class="ttdeci">unsigned int m() const </div><div class="ttdoc">返回矩阵的行维度。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00115">dense_matrix_base.h:115</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad9a7484991ea22915a82b4f0852df055"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad9a7484991ea22915a82b4f0852df055">libMesh::DofMap::build_constraint_matrix</a></div><div class="ttdeci">void build_constraint_matrix(DenseMatrix&lt; Number &gt; &amp;C, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, const bool called_recursively=false) const </div><div class="ttdoc">Build the constraint matrix C associated with the element degree of freedom indices elem_dofs...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l03459">dof_map_constraints.C:3459</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseVector_html"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html">libMesh::DenseVector</a></div><div class="ttdoc">定义用于有限元计算的稠密向量类。该类基本上是为了补充 DenseMatrix 类而设计的。 它相对于 std::vector 具有额外的功能，使其在有限元中特别有用，特别是对于方程组。 所有重写的虚拟函...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00064">dof_map.h:64</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html">libMesh::DenseMatrix</a></div><div class="ttdoc">定义用于有限元类型计算的密集矩阵。 用于在求和成全局矩阵之前存储单元刚度矩阵。所有被覆盖的虚函数都记录在dense_matrix_base.h中。 </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00065">dof_map.h:65</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseVector_html_a06832d76a4df1deb9e45afb9555521d0"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html#a06832d76a4df1deb9e45afb9555521d0">libMesh::DenseVector::size</a></div><div class="ttdeci">virtual unsigned int size() const overridefinal</div><div class="ttdef"><b>Definition:</b> <a href="dense__vector_8h_source.html#l00111">dense_vector.h:111</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8f2fa131424c1b5448c39df7d2c30214"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::constrain_element_matrix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>elem_dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>asymmetric_constraint_rows</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constrains the element matrix. </p>
<p>This method requires the element matrix to be square, in which case the elem_dofs correspond to the global DOF indices of both the rows and columns of the element matrix. For this case the rows and columns of the matrix necessarily correspond to variables of the same approximation order.</p>
<p>If <code>asymmetric_constraint_rows</code> is set to true (as it is by default), constraint row equations will be reinforced in a way which breaks matrix symmetry but makes inexact linear solver solutions more likely to satisfy hanging node constraints. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l02380">2380</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03459">build_constraint_matrix()</a>, <a class="el" href="dof__map_8h_source.html#l02179">is_constrained_dof()</a>, <a class="el" href="dense__matrix__impl_8h_source.html#l00096">libMesh::DenseMatrix&lt; T &gt;::left_multiply_transpose()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00115">libMesh::DenseMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00122">libMesh::DenseMatrixBase&lt; T &gt;::n()</a> , 以及 <a class="el" href="dense__matrix__impl_8h_source.html#l00188">libMesh::DenseMatrix&lt; T &gt;::right_multiply()</a>.</p>
<div class="fragment"><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;{</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;  libmesh_assert_equal_to (elem_dofs.size(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>());</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;  libmesh_assert_equal_to (elem_dofs.size(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>());</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;  <span class="comment">// check for easy return</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.empty())</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;  <span class="comment">// The constrained matrix is built up as C^T K C.</span></div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;  <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> C;</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ad9a7484991ea22915a82b4f0852df055">build_constraint_matrix</a> (C, elem_dofs);</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;constrain_elem_matrix()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;  <span class="comment">// It is possible that the matrix is not constrained at all.</span></div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;  <span class="keywordflow">if</span> ((C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>() == matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>()) &amp;&amp;</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;      (C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>() == elem_dofs.size())) <span class="comment">// It the matrix is constrained</span></div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;    {</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;      <span class="comment">// Compute the matrix-matrix-matrix product C^T K C</span></div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;      matrix.<a class="code" href="classlibMesh_1_1DenseMatrix.html#aea84b08f2ffc1a36a5a87969287ac865">left_multiply_transpose</a>  (C);</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;      matrix.<a class="code" href="classlibMesh_1_1DenseMatrix.html#aec22afa33a0cc7c64dc20cbb519b8eb0">right_multiply</a> (C);</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;      libmesh_assert_equal_to (matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>());</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;      libmesh_assert_equal_to (matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>(), elem_dofs.size());</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;      libmesh_assert_equal_to (matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>(), elem_dofs.size());</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0,</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;           n_elem_dofs = cast_int&lt;unsigned int&gt;(elem_dofs.size());</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;           i != n_elem_dofs; i++)</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;        <span class="comment">// If the DOF is constrained</span></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">is_constrained_dof</a>(elem_dofs[i]))</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;          {</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> j : make_range(matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>()))</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;              matrix(i,j) = 0.;</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;            matrix(i,i) = 1.;</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;            <span class="keywordflow">if</span> (asymmetric_constraint_rows)</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;              {</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;                DofConstraints::const_iterator</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;                  pos = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(elem_dofs[i]);</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;                libmesh_assert (pos != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end());</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;                <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; constraint_row = pos-&gt;second;</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;                <span class="comment">// This is an overzealous assertion in the presence of</span></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;                <span class="comment">// heterogeneous constraints: we now can constrain &quot;u_i = c&quot;</span></div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;                <span class="comment">// with no other u_j terms involved.</span></div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;                <span class="comment">// libmesh_assert (!constraint_row.empty());</span></div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : constraint_row)</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j != n_elem_dofs; j++)</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;                    <span class="keywordflow">if</span> (elem_dofs[j] == item.first)</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;                      matrix(i,j) = -item.second;</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;              }</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;          }</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;    } <span class="comment">// end if is constrained...</span></div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a4fb8c524109fd5dff8c98855437544ee"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">libMesh::DenseMatrixBase::n</a></div><div class="ttdeci">unsigned int n() const </div><div class="ttdoc">返回矩阵的列维度。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00122">dense_matrix_base.h:122</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9846273ba4930ef0364bc1fc954af914"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02179">dof_map.h:2179</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a68bd665fb9252382cc9a28df4099d76a"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">libMesh::DenseMatrixBase::m</a></div><div class="ttdeci">unsigned int m() const </div><div class="ttdoc">返回矩阵的行维度。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00115">dense_matrix_base.h:115</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_aec22afa33a0cc7c64dc20cbb519b8eb0"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#aec22afa33a0cc7c64dc20cbb519b8eb0">libMesh::DenseMatrix::right_multiply</a></div><div class="ttdeci">virtual void right_multiply(const DenseMatrixBase&lt; T &gt; &amp;M2) overridefinal</div><div class="ttdoc">右乘以矩阵 M2。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00188">dense_matrix_impl.h:188</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad9a7484991ea22915a82b4f0852df055"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad9a7484991ea22915a82b4f0852df055">libMesh::DofMap::build_constraint_matrix</a></div><div class="ttdeci">void build_constraint_matrix(DenseMatrix&lt; Number &gt; &amp;C, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, const bool called_recursively=false) const </div><div class="ttdoc">Build the constraint matrix C associated with the element degree of freedom indices elem_dofs...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l03459">dof_map_constraints.C:3459</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_aea84b08f2ffc1a36a5a87969287ac865"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#aea84b08f2ffc1a36a5a87969287ac865">libMesh::DenseMatrix::left_multiply_transpose</a></div><div class="ttdeci">void left_multiply_transpose(const DenseMatrix&lt; T &gt; &amp;A)</div><div class="ttdoc">用矩阵 A 的转置左乘。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00096">dense_matrix_impl.h:96</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdoc">A row of the Dof constraint matrix. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00090">dof_map.h:90</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html">libMesh::DenseMatrix</a></div><div class="ttdoc">定义用于有限元类型计算的密集矩阵。 用于在求和成全局矩阵之前存储单元刚度矩阵。所有被覆盖的虚函数都记录在dense_matrix_base.h中。 </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00065">dof_map.h:65</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a321f229f5e8f3da023d934e09f5f9800"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::constrain_element_matrix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>row_dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>col_dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>asymmetric_constraint_rows</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constrains the element matrix. </p>
<p>This method allows the element matrix to be non-square, in which case the row_dofs and col_dofs may be of different size and correspond to variables approximated in different spaces. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l02914">2914</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03459">build_constraint_matrix()</a>, <a class="el" href="dof__map_8h_source.html#l02179">is_constrained_dof()</a>, <a class="el" href="dense__matrix__impl_8h_source.html#l00096">libMesh::DenseMatrix&lt; T &gt;::left_multiply_transpose()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00115">libMesh::DenseMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00122">libMesh::DenseMatrixBase&lt; T &gt;::n()</a> , 以及 <a class="el" href="dense__matrix__impl_8h_source.html#l00188">libMesh::DenseMatrix&lt; T &gt;::right_multiply()</a>.</p>
<div class="fragment"><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;{</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;  libmesh_assert_equal_to (row_dofs.size(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>());</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;  libmesh_assert_equal_to (col_dofs.size(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>());</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;  <span class="comment">// check for easy return</span></div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.empty())</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;  <span class="comment">// The constrained matrix is built up as R^T K C.</span></div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;  <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> R;</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;  <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> C;</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;  <span class="comment">// Safeguard against the user passing us the same</span></div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;  <span class="comment">// object for row_dofs and col_dofs.  If that is done</span></div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;  <span class="comment">// the calls to build_matrix would fail</span></div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;  std::vector&lt;dof_id_type&gt; orig_row_dofs(row_dofs);</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;  std::vector&lt;dof_id_type&gt; orig_col_dofs(col_dofs);</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ad9a7484991ea22915a82b4f0852df055">build_constraint_matrix</a> (R, orig_row_dofs);</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ad9a7484991ea22915a82b4f0852df055">build_constraint_matrix</a> (C, orig_col_dofs);</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;constrain_elem_matrix()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;  row_dofs = orig_row_dofs;</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;  col_dofs = orig_col_dofs;</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;  <span class="keywordtype">bool</span> constraint_found = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;  <span class="comment">// K_constrained = R^T K C</span></div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;  <span class="keywordflow">if</span> ((R.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>() == matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>()) &amp;&amp;</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;      (R.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>() == row_dofs.size()))</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;    {</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;      matrix.<a class="code" href="classlibMesh_1_1DenseMatrix.html#aea84b08f2ffc1a36a5a87969287ac865">left_multiply_transpose</a>  (R);</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;      constraint_found = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;    }</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;  <span class="keywordflow">if</span> ((C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>() == matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>()) &amp;&amp;</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;      (C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>() == col_dofs.size()))</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;    {</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;      matrix.<a class="code" href="classlibMesh_1_1DenseMatrix.html#aec22afa33a0cc7c64dc20cbb519b8eb0">right_multiply</a> (C);</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;      constraint_found = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;    }</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;  <span class="comment">// It is possible that the matrix is not constrained at all.</span></div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;  <span class="keywordflow">if</span> (constraint_found)</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;    {</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;      libmesh_assert_equal_to (matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>(), row_dofs.size());</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;      libmesh_assert_equal_to (matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>(), col_dofs.size());</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0,</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;           n_row_dofs = cast_int&lt;unsigned int&gt;(row_dofs.size());</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;           i != n_row_dofs; i++)</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">is_constrained_dof</a>(row_dofs[i]))</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;          {</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> j : make_range(matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>()))</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;              {</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;                <span class="keywordflow">if</span> (row_dofs[i] != col_dofs[j])</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;                  matrix(i,j) = 0.;</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;                <span class="keywordflow">else</span> <span class="comment">// If the DOF is constrained</span></div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;                  matrix(i,j) = 1.;</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;              }</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;            <span class="keywordflow">if</span> (asymmetric_constraint_rows)</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;              {</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;                DofConstraints::const_iterator</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;                  pos = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(row_dofs[i]);</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;                libmesh_assert (pos != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end());</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;                <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; constraint_row = pos-&gt;second;</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;                libmesh_assert (!constraint_row.empty());</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : constraint_row)</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0,</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;                       n_col_dofs = cast_int&lt;unsigned int&gt;(col_dofs.size());</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;                       j != n_col_dofs; j++)</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;                    <span class="keywordflow">if</span> (col_dofs[j] == item.first)</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;                      matrix(i,j) = -item.second;</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;              }</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;          }</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;    } <span class="comment">// end if is constrained...</span></div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a4fb8c524109fd5dff8c98855437544ee"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">libMesh::DenseMatrixBase::n</a></div><div class="ttdeci">unsigned int n() const </div><div class="ttdoc">返回矩阵的列维度。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00122">dense_matrix_base.h:122</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9846273ba4930ef0364bc1fc954af914"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02179">dof_map.h:2179</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a68bd665fb9252382cc9a28df4099d76a"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">libMesh::DenseMatrixBase::m</a></div><div class="ttdeci">unsigned int m() const </div><div class="ttdoc">返回矩阵的行维度。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00115">dense_matrix_base.h:115</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_aec22afa33a0cc7c64dc20cbb519b8eb0"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#aec22afa33a0cc7c64dc20cbb519b8eb0">libMesh::DenseMatrix::right_multiply</a></div><div class="ttdeci">virtual void right_multiply(const DenseMatrixBase&lt; T &gt; &amp;M2) overridefinal</div><div class="ttdoc">右乘以矩阵 M2。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00188">dense_matrix_impl.h:188</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad9a7484991ea22915a82b4f0852df055"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad9a7484991ea22915a82b4f0852df055">libMesh::DofMap::build_constraint_matrix</a></div><div class="ttdeci">void build_constraint_matrix(DenseMatrix&lt; Number &gt; &amp;C, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, const bool called_recursively=false) const </div><div class="ttdoc">Build the constraint matrix C associated with the element degree of freedom indices elem_dofs...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l03459">dof_map_constraints.C:3459</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_aea84b08f2ffc1a36a5a87969287ac865"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#aea84b08f2ffc1a36a5a87969287ac865">libMesh::DenseMatrix::left_multiply_transpose</a></div><div class="ttdeci">void left_multiply_transpose(const DenseMatrix&lt; T &gt; &amp;A)</div><div class="ttdoc">用矩阵 A 的转置左乘。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00096">dense_matrix_impl.h:96</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdoc">A row of the Dof constraint matrix. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00090">dof_map.h:90</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html">libMesh::DenseMatrix</a></div><div class="ttdoc">定义用于有限元类型计算的密集矩阵。 用于在求和成全局矩阵之前存储单元刚度矩阵。所有被覆盖的虚函数都记录在dense_matrix_base.h中。 </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00065">dof_map.h:65</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a69628a36f483277e58d6324ab636255e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::constrain_element_matrix_and_vector </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>elem_dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>asymmetric_constraint_rows</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constrains the element matrix and vector. </p>
<p>This method requires the element matrix to be square, in which case the elem_dofs correspond to the global DOF indices of both the rows and columns of the element matrix. For this case the rows and columns of the matrix necessarily correspond to variables of the same approximation order. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l02450">2450</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03459">build_constraint_matrix()</a>, <a class="el" href="dof__map_8h_source.html#l02179">is_constrained_dof()</a>, <a class="el" href="dense__matrix__impl_8h_source.html#l00096">libMesh::DenseMatrix&lt; T &gt;::left_multiply_transpose()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00115">libMesh::DenseMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00122">libMesh::DenseMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="dense__matrix__impl_8h_source.html#l00188">libMesh::DenseMatrix&lt; T &gt;::right_multiply()</a>, <a class="el" href="dense__vector_8h_source.html#l00111">libMesh::DenseVector&lt; T &gt;::size()</a> , 以及 <a class="el" href="dense__matrix__impl_8h_source.html#l00392">libMesh::DenseMatrix&lt; T &gt;::vector_mult_transpose()</a>.</p>
<div class="fragment"><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;{</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;  libmesh_assert_equal_to (elem_dofs.size(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>());</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;  libmesh_assert_equal_to (elem_dofs.size(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>());</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;  libmesh_assert_equal_to (elem_dofs.size(), rhs.<a class="code" href="classlibMesh_1_1DenseVector.html#a06832d76a4df1deb9e45afb9555521d0">size</a>());</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;  <span class="comment">// check for easy return</span></div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.empty())</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;  <span class="comment">// The constrained matrix is built up as C^T K C.</span></div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;  <span class="comment">// The constrained RHS is built up as C^T F</span></div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;  <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> C;</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ad9a7484991ea22915a82b4f0852df055">build_constraint_matrix</a> (C, elem_dofs);</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;cnstrn_elem_mat_vec()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;  <span class="comment">// It is possible that the matrix is not constrained at all.</span></div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;  <span class="keywordflow">if</span> ((C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>() == matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>()) &amp;&amp;</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;      (C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>() == elem_dofs.size())) <span class="comment">// It the matrix is constrained</span></div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    {</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;      <span class="comment">// Compute the matrix-matrix-matrix product C^T K C</span></div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;      matrix.<a class="code" href="classlibMesh_1_1DenseMatrix.html#aea84b08f2ffc1a36a5a87969287ac865">left_multiply_transpose</a>  (C);</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;      matrix.<a class="code" href="classlibMesh_1_1DenseMatrix.html#aec22afa33a0cc7c64dc20cbb519b8eb0">right_multiply</a> (C);</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;      libmesh_assert_equal_to (matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>());</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;      libmesh_assert_equal_to (matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>(), elem_dofs.size());</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;      libmesh_assert_equal_to (matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>(), elem_dofs.size());</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0,</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;           n_elem_dofs = cast_int&lt;unsigned int&gt;(elem_dofs.size());</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;           i != n_elem_dofs; i++)</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">is_constrained_dof</a>(elem_dofs[i]))</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;          {</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> j : make_range(matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>()))</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;              matrix(i,j) = 0.;</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;            <span class="comment">// If the DOF is constrained</span></div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;            matrix(i,i) = 1.;</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;            <span class="comment">// This will put a nonsymmetric entry in the constraint</span></div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;            <span class="comment">// row to ensure that the linear system produces the</span></div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;            <span class="comment">// correct value for the constrained DOF.</span></div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;            <span class="keywordflow">if</span> (asymmetric_constraint_rows)</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;              {</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;                DofConstraints::const_iterator</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;                  pos = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(elem_dofs[i]);</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;                libmesh_assert (pos != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end());</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;                <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; constraint_row = pos-&gt;second;</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;                <span class="comment">// p refinement creates empty constraint rows</span></div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;                <span class="comment">//    libmesh_assert (!constraint_row.empty());</span></div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : constraint_row)</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j != n_elem_dofs; j++)</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;                    <span class="keywordflow">if</span> (elem_dofs[j] == item.first)</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;                      matrix(i,j) = -item.second;</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;              }</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;          }</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;      <span class="comment">// Compute the matrix-vector product C^T F</span></div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;      <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> old_rhs(rhs);</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;      <span class="comment">// compute matrix/vector product</span></div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;      C.<a class="code" href="classlibMesh_1_1DenseMatrix.html#ace7e590c10044121b6b348c3301e545a">vector_mult_transpose</a>(rhs, old_rhs);</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;    } <span class="comment">// end if is constrained...</span></div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a4fb8c524109fd5dff8c98855437544ee"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">libMesh::DenseMatrixBase::n</a></div><div class="ttdeci">unsigned int n() const </div><div class="ttdoc">返回矩阵的列维度。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00122">dense_matrix_base.h:122</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_ace7e590c10044121b6b348c3301e545a"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#ace7e590c10044121b6b348c3301e545a">libMesh::DenseMatrix::vector_mult_transpose</a></div><div class="ttdeci">void vector_mult_transpose(DenseVector&lt; T &gt; &amp;dest, const DenseVector&lt; T &gt; &amp;arg) const </div><div class="ttdoc">执行矩阵-向量乘法，dest := (*this)^T * arg。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00392">dense_matrix_impl.h:392</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9846273ba4930ef0364bc1fc954af914"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02179">dof_map.h:2179</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a68bd665fb9252382cc9a28df4099d76a"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">libMesh::DenseMatrixBase::m</a></div><div class="ttdeci">unsigned int m() const </div><div class="ttdoc">返回矩阵的行维度。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00115">dense_matrix_base.h:115</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_aec22afa33a0cc7c64dc20cbb519b8eb0"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#aec22afa33a0cc7c64dc20cbb519b8eb0">libMesh::DenseMatrix::right_multiply</a></div><div class="ttdeci">virtual void right_multiply(const DenseMatrixBase&lt; T &gt; &amp;M2) overridefinal</div><div class="ttdoc">右乘以矩阵 M2。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00188">dense_matrix_impl.h:188</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad9a7484991ea22915a82b4f0852df055"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad9a7484991ea22915a82b4f0852df055">libMesh::DofMap::build_constraint_matrix</a></div><div class="ttdeci">void build_constraint_matrix(DenseMatrix&lt; Number &gt; &amp;C, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, const bool called_recursively=false) const </div><div class="ttdoc">Build the constraint matrix C associated with the element degree of freedom indices elem_dofs...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l03459">dof_map_constraints.C:3459</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_aea84b08f2ffc1a36a5a87969287ac865"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#aea84b08f2ffc1a36a5a87969287ac865">libMesh::DenseMatrix::left_multiply_transpose</a></div><div class="ttdeci">void left_multiply_transpose(const DenseMatrix&lt; T &gt; &amp;A)</div><div class="ttdoc">用矩阵 A 的转置左乘。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00096">dense_matrix_impl.h:96</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdoc">A row of the Dof constraint matrix. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00090">dof_map.h:90</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseVector_html"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html">libMesh::DenseVector</a></div><div class="ttdoc">定义用于有限元计算的稠密向量类。该类基本上是为了补充 DenseMatrix 类而设计的。 它相对于 std::vector 具有额外的功能，使其在有限元中特别有用，特别是对于方程组。 所有重写的虚拟函...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00064">dof_map.h:64</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html">libMesh::DenseMatrix</a></div><div class="ttdoc">定义用于有限元类型计算的密集矩阵。 用于在求和成全局矩阵之前存储单元刚度矩阵。所有被覆盖的虚函数都记录在dense_matrix_base.h中。 </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00065">dof_map.h:65</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseVector_html_a06832d76a4df1deb9e45afb9555521d0"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html#a06832d76a4df1deb9e45afb9555521d0">libMesh::DenseVector::size</a></div><div class="ttdeci">virtual unsigned int size() const overridefinal</div><div class="ttdef"><b>Definition:</b> <a href="dense__vector_8h_source.html#l00111">dense_vector.h:111</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acd49fc855887ac6b446a645e84731a2e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::constrain_element_residual </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>elem_dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>solution_local</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constrains the element residual. </p>
<p>The element Jacobian is square, and the elem_dofs should correspond to the global DOF indices of both the rows and columns of the element matrix, and the dof constraint should not include any heterogeneous terms.</p>
<p>The residual-constraining version of this method creates linear systems in which heterogeneously constrained degrees of freedom create non-zero residual terms when not at their correct offset values, as would be appropriate for finding a solution to a nonlinear problem in a quasi-Newton solve.</p>
<p>The <code>solution</code> vector passed in should be a serialized or ghosted primal solution </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l02782">2782</a> 行定义.</p>

<p>参考 <a class="el" href="dense__matrix__base_8h_source.html#l00122">libMesh::DenseMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="dense__vector_8h_source.html#l00111">libMesh::DenseVector&lt; T &gt;::size()</a>, <a class="el" href="numeric__vector_8h_source.html#l00166">libMesh::NumericVector&lt; T &gt;::type()</a> , 以及 <a class="el" href="dense__matrix__impl_8h_source.html#l00392">libMesh::DenseMatrix&lt; T &gt;::vector_mult_transpose()</a>.</p>
<div class="fragment"><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;{</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;  libmesh_assert_equal_to (elem_dofs.size(), rhs.<a class="code" href="classlibMesh_1_1DenseVector.html#a06832d76a4df1deb9e45afb9555521d0">size</a>());</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;  libmesh_assert (solution_local.<a class="code" href="classlibMesh_1_1NumericVector.html#a3b6bc13960a5d0022beea138c4e86dc4">type</a>() == SERIAL ||</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;                  solution_local.<a class="code" href="classlibMesh_1_1NumericVector.html#a3b6bc13960a5d0022beea138c4e86dc4">type</a>() == GHOSTED);</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;  <span class="comment">// check for easy return</span></div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.empty())</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;  <span class="comment">// The constrained RHS is built up as C^T F</span></div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;  <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> C;</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ad9a7484991ea22915a82b4f0852df055">build_constraint_matrix</a> (C, elem_dofs);</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;cnstrn_elem_residual()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;  <span class="comment">// It is possible that the matrix is not constrained at all.</span></div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;  <span class="keywordflow">if</span> (C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>() != elem_dofs.size())</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;  <span class="comment">// Compute the matrix-vector product C^T F</span></div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;  <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> old_rhs(rhs);</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;  C.<a class="code" href="classlibMesh_1_1DenseMatrix.html#ace7e590c10044121b6b348c3301e545a">vector_mult_transpose</a>(rhs, old_rhs);</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0,</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;       n_elem_dofs = cast_int&lt;unsigned int&gt;(elem_dofs.size());</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;       i != n_elem_dofs; i++)</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;    {</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> dof_id = elem_dofs[i];</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;      <span class="keyword">const</span> DofConstraints::const_iterator</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;        pos = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(dof_id);</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;      <span class="keywordflow">if</span> (pos != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end())</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;        {</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;          <span class="comment">// This will put a nonsymmetric entry in the constraint</span></div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;          <span class="comment">// row to ensure that the linear system produces the</span></div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;          <span class="comment">// correct value for the constrained DOF.</span></div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; constraint_row = pos-&gt;second;</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;          <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &amp; rhs_val = rhs(i);</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;          rhs_val = 0;</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; [constraining_dof, coef] : constraint_row)</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;            rhs_val -= coef * solution_local(constraining_dof);</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;          rhs_val += solution_local(dof_id);</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;        }</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;    }</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a4fb8c524109fd5dff8c98855437544ee"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">libMesh::DenseMatrixBase::n</a></div><div class="ttdeci">unsigned int n() const </div><div class="ttdoc">返回矩阵的列维度。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00122">dense_matrix_base.h:122</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_ace7e590c10044121b6b348c3301e545a"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#ace7e590c10044121b6b348c3301e545a">libMesh::DenseMatrix::vector_mult_transpose</a></div><div class="ttdeci">void vector_mult_transpose(DenseVector&lt; T &gt; &amp;dest, const DenseVector&lt; T &gt; &amp;arg) const </div><div class="ttdoc">执行矩阵-向量乘法，dest := (*this)^T * arg。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00392">dense_matrix_impl.h:392</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad9a7484991ea22915a82b4f0852df055"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad9a7484991ea22915a82b4f0852df055">libMesh::DofMap::build_constraint_matrix</a></div><div class="ttdeci">void build_constraint_matrix(DenseMatrix&lt; Number &gt; &amp;C, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, const bool called_recursively=false) const </div><div class="ttdoc">Build the constraint matrix C associated with the element degree of freedom indices elem_dofs...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l03459">dof_map_constraints.C:3459</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdoc">A row of the Dof constraint matrix. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00090">dof_map.h:90</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a3b6bc13960a5d0022beea138c4e86dc4"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a3b6bc13960a5d0022beea138c4e86dc4">libMesh::NumericVector::type</a></div><div class="ttdeci">ParallelType type() const </div><div class="ttdoc">获取向量的类型。 </div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8h_source.html#l00166">numeric_vector.h:166</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseVector_html"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html">libMesh::DenseVector</a></div><div class="ttdoc">定义用于有限元计算的稠密向量类。该类基本上是为了补充 DenseMatrix 类而设计的。 它相对于 std::vector 具有额外的功能，使其在有限元中特别有用，特别是对于方程组。 所有重写的虚拟函...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00064">dof_map.h:64</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a8b17bf24a15bc292850c3a3894e2e8f9"><div class="ttname"><a href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">libMesh::Number</a></div><div class="ttdeci">Real Number</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00214">libmesh_common.h:214</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html">libMesh::DenseMatrix</a></div><div class="ttdoc">定义用于有限元类型计算的密集矩阵。 用于在求和成全局矩阵之前存储单元刚度矩阵。所有被覆盖的虚函数都记录在dense_matrix_base.h中。 </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00065">dof_map.h:65</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseVector_html_a06832d76a4df1deb9e45afb9555521d0"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html#a06832d76a4df1deb9e45afb9555521d0">libMesh::DenseVector::size</a></div><div class="ttdeci">virtual unsigned int size() const overridefinal</div><div class="ttdef"><b>Definition:</b> <a href="dense__vector_8h_source.html#l00111">dense_vector.h:111</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a87cac81dddd24844c6fef77f53436b97"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::constrain_element_vector </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>asymmetric_constraint_rows</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constrains the element vector. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l03006">3006</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03459">build_constraint_matrix()</a>, <a class="el" href="dof__map_8h_source.html#l02179">is_constrained_dof()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00115">libMesh::DenseMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00122">libMesh::DenseMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="dense__vector_8h_source.html#l00111">libMesh::DenseVector&lt; T &gt;::size()</a> , 以及 <a class="el" href="dense__matrix__impl_8h_source.html#l00392">libMesh::DenseMatrix&lt; T &gt;::vector_mult_transpose()</a>.</p>
<div class="fragment"><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;{</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;  libmesh_assert_equal_to (rhs.<a class="code" href="classlibMesh_1_1DenseVector.html#a06832d76a4df1deb9e45afb9555521d0">size</a>(), row_dofs.size());</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;  <span class="comment">// check for easy return</span></div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.empty())</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;  <span class="comment">// The constrained RHS is built up as R^T F.</span></div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;  <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> R;</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ad9a7484991ea22915a82b4f0852df055">build_constraint_matrix</a> (R, row_dofs);</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;constrain_elem_vector()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;  <span class="comment">// It is possible that the vector is not constrained at all.</span></div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;  <span class="keywordflow">if</span> ((R.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>() == rhs.<a class="code" href="classlibMesh_1_1DenseVector.html#a06832d76a4df1deb9e45afb9555521d0">size</a>()) &amp;&amp;</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;      (R.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>() == row_dofs.size())) <span class="comment">// if the RHS is constrained</span></div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;    {</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;      <span class="comment">// Compute the matrix-vector product</span></div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;      <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> old_rhs(rhs);</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;      R.<a class="code" href="classlibMesh_1_1DenseMatrix.html#ace7e590c10044121b6b348c3301e545a">vector_mult_transpose</a>(rhs, old_rhs);</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;      libmesh_assert_equal_to (row_dofs.size(), rhs.<a class="code" href="classlibMesh_1_1DenseVector.html#a06832d76a4df1deb9e45afb9555521d0">size</a>());</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0,</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;           n_row_dofs = cast_int&lt;unsigned int&gt;(row_dofs.size());</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;           i != n_row_dofs; i++)</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">is_constrained_dof</a>(row_dofs[i]))</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;          {</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;            <span class="comment">// If the DOF is constrained</span></div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;            libmesh_assert (<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(row_dofs[i]) != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end());</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;            rhs(i) = 0;</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;          }</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;    } <span class="comment">// end if the RHS is constrained.</span></div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a4fb8c524109fd5dff8c98855437544ee"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">libMesh::DenseMatrixBase::n</a></div><div class="ttdeci">unsigned int n() const </div><div class="ttdoc">返回矩阵的列维度。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00122">dense_matrix_base.h:122</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_ace7e590c10044121b6b348c3301e545a"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#ace7e590c10044121b6b348c3301e545a">libMesh::DenseMatrix::vector_mult_transpose</a></div><div class="ttdeci">void vector_mult_transpose(DenseVector&lt; T &gt; &amp;dest, const DenseVector&lt; T &gt; &amp;arg) const </div><div class="ttdoc">执行矩阵-向量乘法，dest := (*this)^T * arg。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00392">dense_matrix_impl.h:392</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9846273ba4930ef0364bc1fc954af914"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02179">dof_map.h:2179</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a68bd665fb9252382cc9a28df4099d76a"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">libMesh::DenseMatrixBase::m</a></div><div class="ttdeci">unsigned int m() const </div><div class="ttdoc">返回矩阵的行维度。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00115">dense_matrix_base.h:115</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad9a7484991ea22915a82b4f0852df055"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad9a7484991ea22915a82b4f0852df055">libMesh::DofMap::build_constraint_matrix</a></div><div class="ttdeci">void build_constraint_matrix(DenseMatrix&lt; Number &gt; &amp;C, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, const bool called_recursively=false) const </div><div class="ttdoc">Build the constraint matrix C associated with the element degree of freedom indices elem_dofs...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l03459">dof_map_constraints.C:3459</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseVector_html"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html">libMesh::DenseVector</a></div><div class="ttdoc">定义用于有限元计算的稠密向量类。该类基本上是为了补充 DenseMatrix 类而设计的。 它相对于 std::vector 具有额外的功能，使其在有限元中特别有用，特别是对于方程组。 所有重写的虚拟函...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00064">dof_map.h:64</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html">libMesh::DenseMatrix</a></div><div class="ttdoc">定义用于有限元类型计算的密集矩阵。 用于在求和成全局矩阵之前存储单元刚度矩阵。所有被覆盖的虚函数都记录在dense_matrix_base.h中。 </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00065">dof_map.h:65</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseVector_html_a06832d76a4df1deb9e45afb9555521d0"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html#a06832d76a4df1deb9e45afb9555521d0">libMesh::DenseVector::size</a></div><div class="ttdeci">virtual unsigned int size() const overridefinal</div><div class="ttdef"><b>Definition:</b> <a href="dense__vector_8h_source.html#l00111">dense_vector.h:111</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5c5b5d5c7bef82683bbe5ac51d66d4d6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::constrain_nothing </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>dofs</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Does not actually constrain anything, but modifies <code>dofs</code> in the same way as any of the constrain functions would do, i.e. </p>
<p>adds those dofs in terms of which any of the existing dofs is constrained. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l03099">3099</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l03459">build_constraint_matrix()</a>.</p>
<div class="fragment"><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;{</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;  <span class="comment">// check for easy return</span></div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.empty())</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;  <span class="comment">// All the work is done by \p build_constraint_matrix.  We just need</span></div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;  <span class="comment">// a dummy matrix.</span></div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;  <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> R;</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ad9a7484991ea22915a82b4f0852df055">build_constraint_matrix</a> (R, dofs);</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad9a7484991ea22915a82b4f0852df055"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad9a7484991ea22915a82b4f0852df055">libMesh::DofMap::build_constraint_matrix</a></div><div class="ttdeci">void build_constraint_matrix(DenseMatrix&lt; Number &gt; &amp;C, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, const bool called_recursively=false) const </div><div class="ttdoc">Build the constraint matrix C associated with the element degree of freedom indices elem_dofs...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l03459">dof_map_constraints.C:3459</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html">libMesh::DenseMatrix</a></div><div class="ttdoc">定义用于有限元类型计算的密集矩阵。 用于在求和成全局矩阵之前存储单元刚度矩阵。所有被覆盖的虚函数都记录在dense_matrix_base.h中。 </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00065">dof_map.h:65</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1c8e17a57f38de4ae0060311b5497989"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::constrain_p_dofs </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>var</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Elem *&#160;</td>
          <td class="paramname"><em>elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constrains degrees of freedom on side <code>s</code> of element <code>elem</code> which correspond to variable number <code>var</code> and to p refinement levels above <code>p</code>. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l05391">5391</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>, <a class="el" href="dof__map_8h_source.html#l02032">_primal_constraint_values</a>, <a class="el" href="dof__map_8h_source.html#l02093">sys_number()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02141">variable_type()</a>.</p>
<div class="fragment"><div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;{</div>
<div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;  <span class="comment">// We&#39;re constraining dofs on elem which correspond to p refinement</span></div>
<div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;  <span class="comment">// levels above p - this only makes sense if elem&#39;s p refinement</span></div>
<div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;  <span class="comment">// level is above p.</span></div>
<div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;  libmesh_assert_greater (elem-&gt;p_level(), p);</div>
<div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;  libmesh_assert_less (s, elem-&gt;n_sides());</div>
<div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;</div>
<div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sys_num = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">sys_number</a>();</div>
<div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;  FEType fe_type = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a0c010bb250d4cd8d65794452f46d141a">variable_type</a>(var);</div>
<div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;</div>
<div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_nodes = elem-&gt;n_nodes();</div>
<div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 0; n != n_nodes; ++n)</div>
<div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;    <span class="keywordflow">if</span> (elem-&gt;is_node_on_side(n, s))</div>
<div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;      {</div>
<div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;        <span class="keyword">const</span> Node &amp; node = elem-&gt;node_ref(n);</div>
<div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> low_nc =</div>
<div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;          FEInterface::n_dofs_at_node (fe_type, p, elem, n);</div>
<div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> high_nc =</div>
<div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;          FEInterface::n_dofs_at_node (fe_type, elem, n);</div>
<div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;</div>
<div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;        <span class="comment">// since we may be running this method concurrently</span></div>
<div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;        <span class="comment">// on multiple threads we need to acquire a lock</span></div>
<div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;        <span class="comment">// before modifying the _dof_constraints object.</span></div>
<div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;        Threads::spin_mutex::scoped_lock lock(Threads::spin_mtx);</div>
<div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;</div>
<div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;        <span class="keywordflow">if</span> (elem-&gt;is_vertex(n))</div>
<div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;          {</div>
<div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;            <span class="comment">// Add &quot;this is zero&quot; constraint rows for high p vertex</span></div>
<div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;            <span class="comment">// dofs</span></div>
<div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = low_nc; i != high_nc; ++i)</div>
<div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;              {</div>
<div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;                <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>[node.dof_number(sys_num,var,i)].clear();</div>
<div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;                <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.erase(node.dof_number(sys_num,var,i));</div>
<div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;              }</div>
<div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;          }</div>
<div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;          {</div>
<div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> total_dofs = node.n_comp(sys_num, var);</div>
<div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;            libmesh_assert_greater_equal (total_dofs, high_nc);</div>
<div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;            <span class="comment">// Add &quot;this is zero&quot; constraint rows for high p</span></div>
<div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;            <span class="comment">// non-vertex dofs, which are numbered in reverse</span></div>
<div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = low_nc; j != high_nc; ++j)</div>
<div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;              {</div>
<div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = total_dofs - j - 1;</div>
<div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;                <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>[node.dof_number(sys_num,var,i)].clear();</div>
<div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;                <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.erase(node.dof_number(sys_num,var,i));</div>
<div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;              }</div>
<div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;          }</div>
<div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;      }</div>
<div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a0c010bb250d4cd8d65794452f46d141a"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a0c010bb250d4cd8d65794452f46d141a">libMesh::DofMap::variable_type</a></div><div class="ttdeci">const FEType &amp; variable_type(const unsigned int c) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02141">dof_map.h:2141</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a244e7a1cd82d5e6ae8780c93205ec1fa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02093">dof_map.h:2093</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02032">dof_map.h:2032</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acc0167bd8cd3f4dac4c0ac904c8dc6da"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::constrained_sparsity_construction </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns true iff the current policy when constructing sparsity patterns is to explicitly account for sparsity entries created by constraint matrix pre- and post- application. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02309">2309</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01834">_constrained_sparsity_construction</a>.</p>
<div class="fragment"><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;{</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_CONSTRAINTS</span></div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a780be47336e49e2f9cd55bba69ee919a">_constrained_sparsity_construction</a>;</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;<span class="preprocessor"></span>}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a780be47336e49e2f9cd55bba69ee919a"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a780be47336e49e2f9cd55bba69ee919a">libMesh::DofMap::_constrained_sparsity_construction</a></div><div class="ttdeci">bool _constrained_sparsity_construction</div><div class="ttdoc">This flag indicates whether or not we explicitly take constraint equations into account when computin...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01834">dof_map.h:1834</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac72b84326e15a8e0b57c739f3b7c5a30"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">DofConstraints::const_iterator libMesh::DofMap::constraint_rows_begin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>An iterator pointing to the first DoF constraint row. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01010">1010</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>.</p>
<div class="fragment"><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  { <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.begin(); }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5d8722d80a7bbdc6e4c3873c03d0e237"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">DofConstraints::const_iterator libMesh::DofMap::constraint_rows_end </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>An iterator pointing just past the last DoF constraint row. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01016">1016</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>.</p>
<div class="fragment"><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;  { <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end(); }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a167ad5d7c58f7ef60da5e365764962c1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::set&lt;GhostingFunctor *&gt;::const_iterator libMesh::DofMap::coupling_functors_begin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Beginning of range of coupling functors. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00344">344</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01964">_coupling_functors</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01544">add_neighbors_to_send_list()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00238">libMesh::SparsityPattern::Build::operator()()</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l04643">scatter_constraints()</a>.</p>
<div class="fragment"><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  { <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">_coupling_functors</a>.begin(); }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aef1ebc9176a3f7ec9607ba4b26808991"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">libMesh::DofMap::_coupling_functors</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt; _coupling_functors</div><div class="ttdoc">The list of all GhostingFunctor objects to be used when coupling degrees of freedom in matrix sparsit...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01964">dof_map.h:1964</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a13a2755e548a51040ee833c1aca2520b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::set&lt;GhostingFunctor *&gt;::const_iterator libMesh::DofMap::coupling_functors_end </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>End of range of coupling functors. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00350">350</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01964">_coupling_functors</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01544">add_neighbors_to_send_list()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00238">libMesh::SparsityPattern::Build::operator()()</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l04643">scatter_constraints()</a>.</p>
<div class="fragment"><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  { <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">_coupling_functors</a>.end(); }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aef1ebc9176a3f7ec9607ba4b26808991"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">libMesh::DofMap::_coupling_functors</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt; _coupling_functors</div><div class="ttdoc">The list of all GhostingFunctor objects to be used when coupling degrees of freedom in matrix sparsit...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01964">dof_map.h:1964</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7892d89bda5e4d39308dcb4e9a982bfc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::create_dof_constraints </td>
          <td>(</td>
          <td class="paramtype">const MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a>&#160;</td>
          <td class="paramname"><em>time</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rebuilds the raw degree of freedom and <a class="el" href="classlibMesh_1_1DofObject.html" title="The DofObject defines an abstract base class for objects that have degrees of freedom associated with...">DofObject</a> constraints. </p>
<p>A time is specified for use in building time-dependent Dirichlet constraints. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l01736">1736</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02034">_adjoint_constraint_values</a>, <a class="el" href="dof__map_8h_source.html#l02064">_adjoint_dirichlet_boundaries</a>, <a class="el" href="dof__map_8h_source.html#l02058">_dirichlet_boundaries</a>, <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>, <a class="el" href="dof__map_8h_source.html#l02041">_node_constraints</a>, <a class="el" href="dof__map_8h_source.html#l02050">_periodic_boundaries</a>, <a class="el" href="dof__map_8h_source.html#l02032">_primal_constraint_values</a>, <a class="el" href="dof__map_8h_source.html#l02086">_verify_dirichlet_bc_consistency</a>, <a class="el" href="dof__map__constraints_8C_source.html#l05532">check_dirichlet_bcid_consistency()</a>, <a class="el" href="dof__map_8h_source.html#l00621">n_variables()</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l01898">process_mesh_constraint_rows()</a>.</p>
<div class="fragment"><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;{</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;  parallel_object_only();</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;create_dof_constraints()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;  libmesh_assert (mesh.is_prepared());</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;  <span class="comment">// The user might have set boundary conditions after the mesh was</span></div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  <span class="comment">// prepared; we should double-check that those boundary conditions</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;  <span class="comment">// are still consistent.</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;<span class="preprocessor"></span>  MeshTools::libmesh_assert_valid_boundary_ids(mesh);</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;  <span class="comment">// In a distributed mesh we might have constraint rows on some</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;  <span class="comment">// processors but not all; if we have constraint rows on *any*</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  <span class="comment">// processor then we need to process them.</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;  <span class="keywordtype">bool</span> constraint_rows_empty = mesh.get_constraint_rows().empty();</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;  this-&gt;comm().min(constraint_rows_empty);</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;  <span class="comment">// We might get constraint equations from AMR hanging nodes in</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;  <span class="comment">// 2D/3D, or from spline constraint rows or boundary conditions in</span></div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;  <span class="comment">// any dimension</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> possible_local_constraints = <span class="keyword">false</span></div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    || !mesh.n_elem()</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    || !constraint_rows_empty</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_AMR</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;<span class="preprocessor"></span>    || mesh.mesh_dimension() &gt; 1</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef LIBMESH_ENABLE_PERIODIC</span></div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;<span class="preprocessor"></span>    || !<a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>-&gt;empty()</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef LIBMESH_ENABLE_DIRICHLET</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;<span class="preprocessor"></span>    || !<a class="code" href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">_dirichlet_boundaries</a>-&gt;empty()</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;<span class="preprocessor"></span>    ;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;  <span class="comment">// Even if we don&#39;t have constraints, another processor might.</span></div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;  <span class="keywordtype">bool</span> possible_global_constraints = possible_local_constraints;</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;<span class="preprocessor">#if defined(LIBMESH_ENABLE_PERIODIC) || defined(LIBMESH_ENABLE_DIRICHLET) || defined(LIBMESH_ENABLE_AMR)</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;<span class="preprocessor"></span>  libmesh_assert(this-&gt;comm().verify(mesh.is_serial()));</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;  this-&gt;comm().max(possible_global_constraints);</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;  <span class="comment">// Recalculate dof constraints from scratch.  (Or just clear them,</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;  <span class="comment">// if the user has just deleted their last dirichlet/periodic/user</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;  <span class="comment">// constraint)</span></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;  <span class="comment">// Note: any _stashed_dof_constraints are not cleared as it</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;  <span class="comment">// may be the user&#39;s intention to restore them later.</span></div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_CONSTRAINTS</span></div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;<span class="preprocessor"></span>  <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.clear();</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.clear();</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.clear();</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;<span class="preprocessor"></span>  <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>.clear();</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;  <span class="keywordflow">if</span> (!possible_global_constraints)</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;  <span class="comment">// Here we build the hanging node constraints.  This is done</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;  <span class="comment">// by enforcing the condition u_a = u_b along hanging sides.</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;  <span class="comment">// u_a = u_b is collocated at the nodes of side a, which gives</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;  <span class="comment">// one row of the constraint matrix.</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;  <span class="comment">// Processors only compute their local constraints</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;  ConstElemRange range (mesh.local_elements_begin(),</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;                        mesh.local_elements_end());</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;  <span class="comment">// Global computation fails if we&#39;re using a FEMFunctionBase BC on a</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  <span class="comment">// ReplicatedMesh in parallel</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;  <span class="comment">// ConstElemRange range (mesh.elements_begin(),</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;  <span class="comment">//                       mesh.elements_end());</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;  <span class="comment">// compute_periodic_constraints requires a point_locator() from our</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;  <span class="comment">// Mesh, but point_locator() construction is parallel and threaded.</span></div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;  <span class="comment">// Rather than nest threads within threads we&#39;ll make sure it&#39;s</span></div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;  <span class="comment">// preconstructed.</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_PERIODIC</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">bool</span> need_point_locator = !<a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>-&gt;empty() &amp;&amp; !range.empty();</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;  this-&gt;comm().max(need_point_locator);</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;  <span class="keywordflow">if</span> (need_point_locator)</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;    mesh.sub_point_locator();</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;<span class="preprocessor"></span>  Threads::parallel_for (range,</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;                         ComputeNodeConstraints (<a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>,</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;#ifdef LIBMESH_ENABLE_PERIODIC</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;                                                 *<a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>,</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;#endif</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;                                                 mesh));</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;<span class="preprocessor">#endif // LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;  <span class="comment">// Look at all the variables in the system.  Reset the element</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;  <span class="comment">// range at each iteration -- there is no need to reconstruct it.</span></div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> n_vars = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aee89c467613b296c215421d60d5ae961">n_variables</a>();</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> variable_number=0; variable_number&lt;n_vars;</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;       ++variable_number, range.reset())</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    Threads::parallel_for (range,</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                           ComputeConstraints (<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>,</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;                                               *<span class="keyword">this</span>,</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;#ifdef LIBMESH_ENABLE_PERIODIC</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;                                               *<a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>,</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;#endif</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;                                               mesh,</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;                                               variable_number));</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_DIRICHLET</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">_dirichlet_boundaries</a>-&gt;empty())</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    {</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;      <span class="comment">// Sanity check that the boundary ids associated with the</span></div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;      <span class="comment">// DirichletBoundary objects are actually present in the</span></div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;      <span class="comment">// mesh. We do this check by default, but in cases where you</span></div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;      <span class="comment">// intentionally add &quot;inconsistent but valid&quot; DirichletBoundary</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;      <span class="comment">// objects in parallel, this check can deadlock since it does a</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;      <span class="comment">// collective communication internally. In that case it is</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;      <span class="comment">// possible to disable this check by setting the flag to false.</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#a126ef1ca10f48a41d48010b3296ddef7">_verify_dirichlet_bc_consistency</a>)</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; dirichlet : *<a class="code" href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">_dirichlet_boundaries</a>)</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7346f3c1d26e6084479657e6b706d245">check_dirichlet_bcid_consistency</a>(mesh, *dirichlet);</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;      <span class="comment">// Threaded loop over local over elems applying all Dirichlet BCs</span></div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;      Threads::parallel_for</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;        (range,</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;         ConstrainDirichlet(*<span class="keyword">this</span>, mesh, time, *_dirichlet_boundaries,</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;                            AddPrimalConstraint(*<span class="keyword">this</span>)));</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;      <span class="comment">// Threaded loop over local over elems per QOI applying all adjoint</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;      <span class="comment">// Dirichlet BCs.  Note that the ConstElemRange is reset before each</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;      <span class="comment">// execution of Threads::parallel_for().</span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> qoi_index : index_range(<a class="code" href="classlibMesh_1_1DofMap.html#a376604ef648f92ce79ed7d2c810b55f3">_adjoint_dirichlet_boundaries</a>))</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;        {</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;          <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1DirichletBoundaries.html">DirichletBoundaries</a> &amp; adb_q =</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;            *(<a class="code" href="classlibMesh_1_1DofMap.html#a376604ef648f92ce79ed7d2c810b55f3">_adjoint_dirichlet_boundaries</a>[qoi_index]);</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;          <span class="keywordflow">if</span> (!adb_q.empty())</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;            Threads::parallel_for</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;              (range.reset(),</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;               ConstrainDirichlet(*<span class="keyword">this</span>, mesh, time, adb_q,</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;                                  AddAdjointConstraint(*<span class="keyword">this</span>, qoi_index)));</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;        }</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    }</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;<span class="preprocessor">#endif // LIBMESH_ENABLE_DIRICHLET</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;  <span class="comment">// Handle spline node constraints last, so we can try to move</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;  <span class="comment">// existing constraints onto the spline basis if necessary.</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;  <span class="keywordflow">if</span> (!constraint_rows_empty)</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a4b79bfce2f7aefdd722b9bd8b34a9a11">process_mesh_constraint_rows</a>(mesh);</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a4b79bfce2f7aefdd722b9bd8b34a9a11"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a4b79bfce2f7aefdd722b9bd8b34a9a11">libMesh::DofMap::process_mesh_constraint_rows</a></div><div class="ttdeci">void process_mesh_constraint_rows(const MeshBase &amp;mesh)</div><div class="ttdoc">Adds any spline constraints from the Mesh to our DoF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l01898">dof_map_constraints.C:1898</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7346f3c1d26e6084479657e6b706d245"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7346f3c1d26e6084479657e6b706d245">libMesh::DofMap::check_dirichlet_bcid_consistency</a></div><div class="ttdeci">void check_dirichlet_bcid_consistency(const MeshBase &amp;mesh, const DirichletBoundary &amp;boundary) const </div><div class="ttdoc">Check that all the ids in dirichlet_bcids are actually present in the mesh. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l05532">dof_map_constraints.C:5532</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2e9be7e72291d4fd6e841ae7733a5ff0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">libMesh::DofMap::_dirichlet_boundaries</a></div><div class="ttdeci">std::unique_ptr&lt; DirichletBoundaries &gt; _dirichlet_boundaries</div><div class="ttdoc">Data structure containing Dirichlet functions. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02058">dof_map.h:2058</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02034">dof_map.h:2034</a></div></div>
<div class="ttc" id="classlibMesh_1_1DirichletBoundaries_html"><div class="ttname"><a href="classlibMesh_1_1DirichletBoundaries.html">libMesh::DirichletBoundaries</a></div><div class="ttdoc">We&amp;#39;re using a class instead of a typedef to allow forward declarations and future flexibility...</div><div class="ttdef"><b>Definition:</b> <a href="dirichlet__boundaries_8h_source.html#l00214">dirichlet_boundaries.h:214</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a376604ef648f92ce79ed7d2c810b55f3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a376604ef648f92ce79ed7d2c810b55f3">libMesh::DofMap::_adjoint_dirichlet_boundaries</a></div><div class="ttdeci">std::vector&lt; std::unique_ptr&lt; DirichletBoundaries &gt; &gt; _adjoint_dirichlet_boundaries</div><div class="ttdoc">Data structure containing Dirichlet functions. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02064">dof_map.h:2064</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aee89c467613b296c215421d60d5ae961"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aee89c467613b296c215421d60d5ae961">libMesh::DofMap::n_variables</a></div><div class="ttdeci">unsigned int n_variables() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00621">dof_map.h:621</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab91693b08a22cfe1af7781287157ac8a"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">libMesh::DofMap::_periodic_boundaries</a></div><div class="ttdeci">std::unique_ptr&lt; PeriodicBoundaries &gt; _periodic_boundaries</div><div class="ttdoc">Data structure containing periodic boundaries. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02050">dof_map.h:2050</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a126ef1ca10f48a41d48010b3296ddef7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a126ef1ca10f48a41d48010b3296ddef7">libMesh::DofMap::_verify_dirichlet_bc_consistency</a></div><div class="ttdeci">bool _verify_dirichlet_bc_consistency</div><div class="ttdoc">Flag which determines whether we should do some additional checking of the consistency of the Dirichl...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02086">dof_map.h:2086</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02032">dof_map.h:2032</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8856db766d722a0edaa9f5c5d94d40f7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">libMesh::DofMap::_node_constraints</a></div><div class="ttdeci">NodeConstraints _node_constraints</div><div class="ttdoc">Data structure containing DofObject constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02041">dof_map.h:2041</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac341c27edd859113d774716d5ad18d9f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">DefaultCoupling&amp; libMesh::DofMap::default_algebraic_ghosting </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Default algebraic ghosting functor. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00418">418</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01941">_default_evaluating</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01852">add_default_ghosting()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l01844">remove_default_ghosting()</a>.</p>
<div class="fragment"><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;{ <span class="keywordflow">return</span> *<a class="code" href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">_default_evaluating</a>; }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a4eb9c9ed9c530781aac48df4fc0cf27b"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a4eb9c9ed9c530781aac48df4fc0cf27b">libMesh::DofMap::_default_evaluating</a></div><div class="ttdeci">std::unique_ptr&lt; DefaultCoupling &gt; _default_evaluating</div><div class="ttdoc">The default algebraic GhostingFunctor, used to implement standard libMesh send_list construction...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01941">dof_map.h:1941</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa387f2af29a1998bc1236a20a9870b64"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">DefaultCoupling&amp; libMesh::DofMap::default_coupling </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Default coupling functor. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00356">356</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01933">_default_coupling</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01852">add_default_ghosting()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l01844">remove_default_ghosting()</a>.</p>
<div class="fragment"><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;{ <span class="keywordflow">return</span> *<a class="code" href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">_default_coupling</a>; }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_abb069d1433ad6f8eeb4d5ebf44ae4dc8"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">libMesh::DofMap::_default_coupling</a></div><div class="ttdeci">std::unique_ptr&lt; DefaultCoupling &gt; _default_coupling</div><div class="ttdoc">The default coupling GhostingFunctor, used to implement standard libMesh sparsity pattern constructio...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01933">dof_map.h:1933</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5c0a2d3d3c531f9f069b0d623d4ace0f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::ReferenceCounter::disable_print_counter_info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="reference__counter_8C_source.html">reference_counter.C</a> 第 <a class="el" href="reference__counter_8C_source.html#l00100">100</a> 行定义.</p>

<p>参考 <a class="el" href="reference__counter_8h_source.html#l00143">libMesh::ReferenceCounter::_enable_print_counter</a>.</p>
<div class="fragment"><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;{</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="classlibMesh_1_1ReferenceCounter.html#a8f75e8a4a280f2c41636f2ae1307a311">_enable_print_counter</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1ReferenceCounter_html_a8f75e8a4a280f2c41636f2ae1307a311"><div class="ttname"><a href="classlibMesh_1_1ReferenceCounter.html#a8f75e8a4a280f2c41636f2ae1307a311">libMesh::ReferenceCounter::_enable_print_counter</a></div><div class="ttdeci">static bool _enable_print_counter</div><div class="ttdoc">Flag to control whether reference count information is printed when print_info is called...</div><div class="ttdef"><b>Definition:</b> <a href="reference__counter_8h_source.html#l00143">reference_counter.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a04d8855d5a13cb4aff4e997ab34c847e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::size_t libMesh::DofMap::distribute_dofs </td>
          <td>(</td>
          <td class="paramtype">MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Distribute dofs on the current mesh. </p>
<p>Also builds the send list for processor <code>proc_id</code>, which defaults to 0 for ease of use in serial applications. </p>
<dl class="section return"><dt>返回</dt><dd>The total number of DOFs for the System, summed across all procs. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l00927">927</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01951">_algebraic_ghosting_functors</a>, <a class="el" href="dof__map_8h_source.html#l01964">_coupling_functors</a>, <a class="el" href="dof__map_8h_source.html#l01881">_end_df</a>, <a class="el" href="dof__map_8h_source.html#l02011">_end_old_df</a>, <a class="el" href="dof__map_8h_source.html#l01876">_first_df</a>, <a class="el" href="dof__map_8h_source.html#l02006">_first_old_df</a>, <a class="el" href="dof__map_8h_source.html#l02017">_first_old_scalar_df</a>, <a class="el" href="dof__map_8h_source.html#l01887">_first_scalar_df</a>, <a class="el" href="dof__map_8h_source.html#l01988">_n_dfs</a>, <a class="el" href="dof__map_8h_source.html#l02001">_n_old_dfs</a>, <a class="el" href="dof__map_8C_source.html#l01544">add_neighbors_to_send_list()</a>, <a class="el" href="dof__map_8h_source.html#l00485">clear_send_list()</a>, <a class="el" href="dof__map_8C_source.html#l01196">distribute_local_dofs_node_major()</a>, <a class="el" href="dof__map_8C_source.html#l01299">distribute_local_dofs_var_major()</a>, <a class="el" href="dof__object_8h_source.html#l01025">libMesh::DofObject::dof_number()</a>, <a class="el" href="dof__map_8C_source.html#l00348">elem_ptr()</a>, <a class="el" href="dof__map_8h_source.html#l00711">end_dof()</a>, <a class="el" href="dof__map_8h_source.html#l00687">first_dof()</a>, <a class="el" href="dof__object_8h_source.html#l00477">libMesh::DofObject::invalid_id</a>, <a class="el" href="dof__map_8C_source.html#l00835">invalidate_dofs()</a>, <a class="el" href="dof__object_8h_source.html#l00995">libMesh::DofObject::n_comp()</a>, <a class="el" href="dof__map_8h_source.html#l00659">n_dofs()</a>, <a class="el" href="dof__map_8h_source.html#l00664">n_SCALAR_dofs()</a>, <a class="el" href="dof__map_8h_source.html#l00621">n_variables()</a>, <a class="el" href="dof__object_8h_source.html#l00960">libMesh::DofObject::n_vars()</a>, <a class="el" href="dof__map_8C_source.html#l00341">node_ptr()</a>, <a class="el" href="libmesh_8C_source.html#l00872">libMesh::on_command_line()</a>, <a class="el" href="dof__object_8h_source.html#l00898">libMesh::DofObject::processor_id()</a>, <a class="el" href="dof__map_8C_source.html#l00506">reinit()</a>, <a class="el" href="dof__map_8C_source.html#l00356">set_nonlocal_dof_objects()</a>, <a class="el" href="dof__map_8h_source.html#l02093">sys_number()</a>, <a class="el" href="variable_8h_source.html#l00140">libMesh::Variable::type()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02111">variable()</a>.</p>
<div class="fragment"><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;{</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  parallel_object_only();</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  <span class="comment">// Log how long it takes to distribute the degrees of freedom</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;distribute_dofs()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  libmesh_assert (mesh.is_prepared());</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> proc_id = this-&gt;processor_id();</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> n_proc  = this-&gt;n_processors();</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  <span class="comment">//  libmesh_assert_greater (this-&gt;n_variables(), 0);</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  libmesh_assert_less (proc_id, n_proc);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  <span class="comment">// re-init in case the mesh has changed</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#abf4ed8e608b51a7a4e95935bf42ebbb1">reinit</a>(mesh);</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <span class="comment">// By default distribute variables in a</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <span class="comment">// var-major fashion, but allow run-time</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <span class="comment">// specification</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <span class="keywordtype">bool</span> node_major_dofs = <a class="code" href="namespacelibMesh.html#adc9fb0dafe70b50cd0848a8142cf57c0">libMesh::on_command_line</a> (<span class="stringliteral">&quot;--node-major-dofs&quot;</span>);</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <span class="comment">// The DOF counter, will be incremented as we encounter</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  <span class="comment">// new degrees of freedom</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> next_free_dof = 0;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  <span class="comment">// Clear the send list before we rebuild it</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7f04c34ba9909c7d788196575c619aff">clear_send_list</a>();</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  <span class="comment">// Set temporary DOF indices on this processor</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <span class="keywordflow">if</span> (node_major_dofs)</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a5fa08b142ac3e34a8213017252b96d30">distribute_local_dofs_node_major</a> (next_free_dof, mesh);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af781ec4ff23b34cd4332a357f1647fdd">distribute_local_dofs_var_major</a> (next_free_dof, mesh);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  <span class="comment">// Get DOF counts on all processors</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  std::vector&lt;dof_id_type&gt; dofs_on_proc(n_proc, 0);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  this-&gt;comm().allgather(next_free_dof, dofs_on_proc);</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <span class="comment">// Resize and fill the _first_df and _end_df arrays</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_AMR</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="preprocessor"></span>  <a class="code" href="classlibMesh_1_1DofMap.html#ab91d708f5167f50c0392b2fd5dea2559">_first_old_df</a> = <a class="code" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a>;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab96f5b260e5925063553da996bb3b428">_end_old_df</a> = <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a>.resize(n_proc);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>.resize (n_proc);</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  <span class="comment">// Get DOF offsets</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a>[0] = 0;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> i=1; i &lt; n_proc; ++i)</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a>[i] = <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>[i-1] = <a class="code" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a>[i-1] + dofs_on_proc[i-1];</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>[n_proc-1] = <a class="code" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a>[n_proc-1] + dofs_on_proc[n_proc-1];</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  <span class="comment">// Clear all the current DOF indices</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  <span class="comment">// (distribute_dofs expects them cleared!)</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9cbe9d7dc9f93f266817f997562bfa7c">invalidate_dofs</a>(mesh);</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;  next_free_dof = <a class="code" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a>[proc_id];</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  <span class="comment">// Set permanent DOF indices on this processor</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  <span class="keywordflow">if</span> (node_major_dofs)</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a5fa08b142ac3e34a8213017252b96d30">distribute_local_dofs_node_major</a> (next_free_dof, mesh);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af781ec4ff23b34cd4332a357f1647fdd">distribute_local_dofs_var_major</a> (next_free_dof, mesh);</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  libmesh_assert_equal_to (next_free_dof, <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>[proc_id]);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;  <span class="comment">//------------------------------------------------------------</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <span class="comment">// At this point, all n_comp and dof_number values on local</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  <span class="comment">// DofObjects should be correct, but a DistributedMesh might have</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  <span class="comment">// incorrect values on non-local DofObjects.  Let&#39;s request the</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  <span class="comment">// correct values from each other processor.</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  <span class="keywordflow">if</span> (this-&gt;n_processors() &gt; 1)</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    {</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7bad83b3b5e37a8afe4ea251d72df300">set_nonlocal_dof_objects</a>(mesh.nodes_begin(),</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                                     mesh.nodes_end(),</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                                     mesh, &amp;<a class="code" href="classlibMesh_1_1DofMap.html#a8f4c45c1d3d4de70b46e63063153c12a">DofMap::node_ptr</a>);</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7bad83b3b5e37a8afe4ea251d72df300">set_nonlocal_dof_objects</a>(mesh.elements_begin(),</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                                     mesh.elements_end(),</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                                     mesh, &amp;<a class="code" href="classlibMesh_1_1DofMap.html#ad3218b71187390e1b03182c32a547149">DofMap::elem_ptr</a>);</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    }</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="preprocessor"></span>  {</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      sys_num = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">sys_number</a>();</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="comment">// Processors should all agree on DoF ids for the newly numbered</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="comment">// system.</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    MeshTools::libmesh_assert_valid_dof_ids(mesh, sys_num);</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="comment">// DoF processor ids should match DofObject processor ids</span></div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; node : mesh.node_ptr_range())</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;      {</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        DofObject <span class="keyword">const</span> * <span class="keyword">const</span> dofobj = node;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> obj_proc_id = dofobj-&gt;processor_id();</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> v : make_range(dofobj-&gt;n_vars(sys_num)))</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> c : make_range(dofobj-&gt;n_comp(sys_num,v)))</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            {</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> dofid = dofobj-&gt;dof_number(sys_num,v,c);</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;              libmesh_assert_greater_equal (dofid, this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#afe4e2d426832365090b199b7083c0a77">first_dof</a>(obj_proc_id));</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;              libmesh_assert_less (dofid, this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a92230d3049a3a7a97b8ba2f34b3ec677">end_dof</a>(obj_proc_id));</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;            }</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      }</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : mesh.element_ptr_range())</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      {</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        DofObject <span class="keyword">const</span> * <span class="keyword">const</span> dofobj = elem;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> obj_proc_id = dofobj-&gt;processor_id();</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> v : make_range(dofobj-&gt;n_vars(sys_num)))</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> c : make_range(dofobj-&gt;n_comp(sys_num,v)))</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;            {</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> dofid = dofobj-&gt;dof_number(sys_num,v,c);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;              libmesh_assert_greater_equal (dofid, this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#afe4e2d426832365090b199b7083c0a77">first_dof</a>(obj_proc_id));</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;              libmesh_assert_less (dofid, this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a92230d3049a3a7a97b8ba2f34b3ec677">end_dof</a>(obj_proc_id));</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;            }</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      }</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  }</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  <span class="comment">// Set the total number of degrees of freedom, then start finding</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  <span class="comment">// SCALAR degrees of freedom</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_AMR</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="preprocessor"></span>  <a class="code" href="classlibMesh_1_1DofMap.html#abbca79dca4f02ab917e89aeac3113808">_n_old_dfs</a> = <a class="code" href="classlibMesh_1_1DofMap.html#a0964620ae8054b969297d1d9087b7b05">_n_dfs</a>;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a92da14cf60e82ed600bfe67ca3422765">_first_old_scalar_df</a> = <a class="code" href="classlibMesh_1_1DofMap.html#af1fc10139391d71da470387d9e4adbb5">_first_scalar_df</a>;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="preprocessor"></span>  <a class="code" href="classlibMesh_1_1DofMap.html#a0964620ae8054b969297d1d9087b7b05">_n_dfs</a> = <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>[n_proc-1];</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#af1fc10139391d71da470387d9e4adbb5">_first_scalar_df</a>.clear();</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#af1fc10139391d71da470387d9e4adbb5">_first_scalar_df</a>.resize(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aee89c467613b296c215421d60d5ae961">n_variables</a>(), <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> current_SCALAR_dof_index = <a class="code" href="classlibMesh_1_1DofMap.html#a77f8d984574b1bf8886057799e9b0134">n_dofs</a>() - <a class="code" href="classlibMesh_1_1DofMap.html#a39feeb5bedb05e160b5190e26d433605">n_SCALAR_dofs</a>();</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  <span class="comment">// Calculate and cache the initial DoF indices for SCALAR variables.</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  <span class="comment">// This is an O(N_vars) calculation so we want to do it once per</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  <span class="comment">// renumbering rather than once per SCALAR_dof_indices() call</span></div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> v : make_range(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aee89c467613b296c215421d60d5ae961">n_variables</a>()))</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab36a0dc3c2c457fa8c01c1b0ba37facc">variable</a>(v).type().family == SCALAR)</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;      {</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        <a class="code" href="classlibMesh_1_1DofMap.html#af1fc10139391d71da470387d9e4adbb5">_first_scalar_df</a>[v] = current_SCALAR_dof_index;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        current_SCALAR_dof_index += this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab36a0dc3c2c457fa8c01c1b0ba37facc">variable</a>(v).<a class="code" href="classlibMesh_1_1Variable.html#a8dcb07137d70a83fcf5b412e08e2783e">type</a>().order.get_order();</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;      }</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  <span class="comment">// Allow our GhostingFunctor objects to reinit if necessary</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; gf : <a class="code" href="classlibMesh_1_1DofMap.html#a378d58f5e860f781a52adb61464c9378">_algebraic_ghosting_functors</a>)</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    {</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;      libmesh_assert(gf);</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      gf-&gt;dofmap_reinit();</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    }</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; gf : <a class="code" href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">_coupling_functors</a>)</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    {</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      libmesh_assert(gf);</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      gf-&gt;dofmap_reinit();</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    }</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <span class="comment">// Note that in the add_neighbors_to_send_list nodes on processor</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  <span class="comment">// boundaries that are shared by multiple elements are added for</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  <span class="comment">// each element.</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aed8eba054300e64164af4a8257bae8d8">add_neighbors_to_send_list</a>(mesh);</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  <span class="comment">// Here we used to clean up that data structure; now System and</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  <span class="comment">// EquationSystems call that for us, after we&#39;ve added constraint</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <span class="comment">// dependencies to the send_list too.</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  <span class="comment">// this-&gt;sort_send_list ();</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  <span class="comment">// Return total number of DOFs across all procs. We compute and</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  <span class="comment">// return this as a std::size_t so that we can detect situations in</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  <span class="comment">// which the total number of DOFs across all procs would exceed the</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <span class="comment">// capability of the underlying NumericVector representation to</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <span class="comment">// index into it correctly (std::size_t is the largest unsigned</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  <span class="comment">// type, so no NumericVector representation can exceed it).</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  <span class="keywordflow">return</span> std::accumulate(dofs_on_proc.begin(), dofs_on_proc.end(), <span class="keyword">static_cast&lt;</span>std::size_t<span class="keyword">&gt;</span>(0));</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad3218b71187390e1b03182c32a547149"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad3218b71187390e1b03182c32a547149">libMesh::DofMap::elem_ptr</a></div><div class="ttdeci">DofObject * elem_ptr(MeshBase &amp;mesh, dof_id_type i) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l00348">dof_map.C:348</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a5fa08b142ac3e34a8213017252b96d30"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a5fa08b142ac3e34a8213017252b96d30">libMesh::DofMap::distribute_local_dofs_node_major</a></div><div class="ttdeci">void distribute_local_dofs_node_major(dof_id_type &amp;next_free_dof, MeshBase &amp;mesh)</div><div class="ttdoc">Distributes the global degrees of freedom for dofs on this processor. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01196">dof_map.C:1196</a></div></div>
<div class="ttc" id="classlibMesh_1_1Variable_html_a8dcb07137d70a83fcf5b412e08e2783e"><div class="ttname"><a href="classlibMesh_1_1Variable.html#a8dcb07137d70a83fcf5b412e08e2783e">libMesh::Variable::type</a></div><div class="ttdeci">const FEType &amp; type() const </div><div class="ttdef"><b>Definition:</b> <a href="variable_8h_source.html#l00140">variable.h:140</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8f4c45c1d3d4de70b46e63063153c12a"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8f4c45c1d3d4de70b46e63063153c12a">libMesh::DofMap::node_ptr</a></div><div class="ttdeci">DofObject * node_ptr(MeshBase &amp;mesh, dof_id_type i) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l00341">dof_map.C:341</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7f04c34ba9909c7d788196575c619aff"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7f04c34ba9909c7d788196575c619aff">libMesh::DofMap::clear_send_list</a></div><div class="ttdeci">void clear_send_list()</div><div class="ttdoc">Clears the _send_list vector. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00485">dof_map.h:485</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a378d58f5e860f781a52adb61464c9378"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a378d58f5e860f781a52adb61464c9378">libMesh::DofMap::_algebraic_ghosting_functors</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt; _algebraic_ghosting_functors</div><div class="ttdoc">The list of all GhostingFunctor objects to be used when distributing ghosted vectors. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01951">dof_map.h:1951</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab96f5b260e5925063553da996bb3b428"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab96f5b260e5925063553da996bb3b428">libMesh::DofMap::_end_old_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _end_old_df</div><div class="ttdoc">Last old DOF index (plus 1) on processor p. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02011">dof_map.h:2011</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9cbe9d7dc9f93f266817f997562bfa7c"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9cbe9d7dc9f93f266817f997562bfa7c">libMesh::DofMap::invalidate_dofs</a></div><div class="ttdeci">void invalidate_dofs(MeshBase &amp;mesh) const </div><div class="ttdoc">Invalidates all active DofObject dofs for this system. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l00835">dof_map.C:835</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab36a0dc3c2c457fa8c01c1b0ba37facc"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab36a0dc3c2c457fa8c01c1b0ba37facc">libMesh::DofMap::variable</a></div><div class="ttdeci">const Variable &amp; variable(const unsigned int c) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02111">dof_map.h:2111</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a77f8d984574b1bf8886057799e9b0134"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a77f8d984574b1bf8886057799e9b0134">libMesh::DofMap::n_dofs</a></div><div class="ttdeci">dof_id_type n_dofs() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00659">dof_map.h:659</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab91d708f5167f50c0392b2fd5dea2559"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab91d708f5167f50c0392b2fd5dea2559">libMesh::DofMap::_first_old_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_old_df</div><div class="ttdoc">First old DOF index on processor p. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02006">dof_map.h:2006</a></div></div>
<div class="ttc" id="namespacelibMesh_html_af18245d4f872c36a41fc74086bda3e80"><div class="ttname"><a href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">libMesh::processor_id_type</a></div><div class="ttdeci">uint8_t processor_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00104">id_types.h:104</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af1fc10139391d71da470387d9e4adbb5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af1fc10139391d71da470387d9e4adbb5">libMesh::DofMap::_first_scalar_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_scalar_df</div><div class="ttdoc">First DOF index for SCALAR variable v, or garbage for non-SCALAR variable v. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01887">dof_map.h:1887</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aed8eba054300e64164af4a8257bae8d8"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aed8eba054300e64164af4a8257bae8d8">libMesh::DofMap::add_neighbors_to_send_list</a></div><div class="ttdeci">void add_neighbors_to_send_list(MeshBase &amp;mesh)</div><div class="ttdoc">Adds entries to the _send_list vector corresponding to DoFs on elements neighboring the current proce...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01544">dof_map.C:1544</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a92da14cf60e82ed600bfe67ca3422765"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a92da14cf60e82ed600bfe67ca3422765">libMesh::DofMap::_first_old_scalar_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_old_scalar_df</div><div class="ttdoc">First old DOF index for SCALAR variable v, or garbage for non-SCALAR variable v. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02017">dof_map.h:2017</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7bad83b3b5e37a8afe4ea251d72df300"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7bad83b3b5e37a8afe4ea251d72df300">libMesh::DofMap::set_nonlocal_dof_objects</a></div><div class="ttdeci">void set_nonlocal_dof_objects(iterator_type objects_begin, iterator_type objects_end, MeshBase &amp;mesh, dofobject_accessor objects)</div><div class="ttdoc">Helper function for distributing dofs in parallel. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l00356">dof_map.C:356</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_adf3b0ebe7fcc0c41bced4c9f17bf4822"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">libMesh::DofObject::invalid_id</a></div><div class="ttdeci">static const dof_id_type invalid_id</div><div class="ttdoc">An invalid id to distinguish an uninitialized DofObject. </div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00477">dof_object.h:477</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_abf4ed8e608b51a7a4e95935bf42ebbb1"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#abf4ed8e608b51a7a4e95935bf42ebbb1">libMesh::DofMap::reinit</a></div><div class="ttdeci">void reinit(MeshBase &amp;mesh)</div><div class="ttdoc">Reinitialize the underlying data structures conformal to the current mesh. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l00506">dof_map.C:506</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a244e7a1cd82d5e6ae8780c93205ec1fa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02093">dof_map.h:2093</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a92230d3049a3a7a97b8ba2f34b3ec677"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a92230d3049a3a7a97b8ba2f34b3ec677">libMesh::DofMap::end_dof</a></div><div class="ttdeci">dof_id_type end_dof() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00711">dof_map.h:711</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aee89c467613b296c215421d60d5ae961"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aee89c467613b296c215421d60d5ae961">libMesh::DofMap::n_variables</a></div><div class="ttdeci">unsigned int n_variables() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00621">dof_map.h:621</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_abbca79dca4f02ab917e89aeac3113808"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#abbca79dca4f02ab917e89aeac3113808">libMesh::DofMap::_n_old_dfs</a></div><div class="ttdeci">dof_id_type _n_old_dfs</div><div class="ttdoc">Total number of degrees of freedom on old dof objects. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02001">dof_map.h:2001</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aef1ebc9176a3f7ec9607ba4b26808991"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">libMesh::DofMap::_coupling_functors</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt; _coupling_functors</div><div class="ttdoc">The list of all GhostingFunctor objects to be used when coupling degrees of freedom in matrix sparsit...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01964">dof_map.h:1964</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af43f96a9e11b3f4221306fdfd4511aaa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">libMesh::DofMap::_end_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _end_df</div><div class="ttdoc">Last DOF index (plus 1) on processor p. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01881">dof_map.h:1881</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a39feeb5bedb05e160b5190e26d433605"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a39feeb5bedb05e160b5190e26d433605">libMesh::DofMap::n_SCALAR_dofs</a></div><div class="ttdeci">dof_id_type n_SCALAR_dofs() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00664">dof_map.h:664</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab72062de06b72df985ac5bf16837a7da"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">libMesh::DofMap::_first_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_df</div><div class="ttdoc">First DOF index on processor p. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01876">dof_map.h:1876</a></div></div>
<div class="ttc" id="namespacelibMesh_html_adc9fb0dafe70b50cd0848a8142cf57c0"><div class="ttname"><a href="namespacelibMesh.html#adc9fb0dafe70b50cd0848a8142cf57c0">libMesh::on_command_line</a></div><div class="ttdeci">bool on_command_line(std::string arg)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh_8C_source.html#l00872">libmesh.C:872</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af781ec4ff23b34cd4332a357f1647fdd"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af781ec4ff23b34cd4332a357f1647fdd">libMesh::DofMap::distribute_local_dofs_var_major</a></div><div class="ttdeci">void distribute_local_dofs_var_major(dof_id_type &amp;next_free_dof, MeshBase &amp;mesh)</div><div class="ttdoc">Distributes the global degrees of freedom, for dofs on this processor. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01299">dof_map.C:1299</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_afe4e2d426832365090b199b7083c0a77"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#afe4e2d426832365090b199b7083c0a77">libMesh::DofMap::first_dof</a></div><div class="ttdeci">dof_id_type first_dof() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00687">dof_map.h:687</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a0964620ae8054b969297d1d9087b7b05"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a0964620ae8054b969297d1d9087b7b05">libMesh::DofMap::_n_dfs</a></div><div class="ttdeci">dof_id_type _n_dfs</div><div class="ttdoc">Total number of degrees of freedom. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01988">dof_map.h:1988</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5fa08b142ac3e34a8213017252b96d30"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::distribute_local_dofs_node_major </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &amp;&#160;</td>
          <td class="paramname"><em>next_free_dof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Distributes the global degrees of freedom for dofs on this processor. </p>
<p>In this format all the degrees of freedom at a node/element are in contiguous blocks. Starts at index <code>next_free_dof</code>, and increments it to the post-final index. If <code>build_send_list</code> is <code>true</code>, builds the send list. If <code>false</code>, clears and reserves the send list.</p>
<dl class="section note"><dt>注解</dt><dd>The degrees of freedom for a given variable are not in contiguous blocks, as in the case of <code>distribute_local_dofs_var_major</code>. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l01196">1196</a> 行定义.</p>

<p>参考 <a class="el" href="variable_8h_source.html#l00157">libMesh::Variable::active_on_subdomain()</a>, <a class="el" href="dof__map_8C_source.html#l01418">assert_no_nodes_missed()</a>, <a class="el" href="dof__map_8C_source.html#l01394">distribute_scalar_dofs()</a>, <a class="el" href="dof__object_8h_source.html#l00477">libMesh::DofObject::invalid_id</a>, <a class="el" href="dof__map_8h_source.html#l00613">n_variable_groups()</a>, <a class="el" href="variable_8h_source.html#l00256">libMesh::VariableGroup::n_variables()</a>, <a class="el" href="dof__map_8h_source.html#l02093">sys_number()</a>, <a class="el" href="variable_8h_source.html#l00140">libMesh::Variable::type()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02101">variable_group()</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00927">distribute_dofs()</a>.</p>
<div class="fragment"><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;{</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sys_num       = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">sys_number</a>();</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_var_groups  = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a6058ea4ca2ef36bd90f44bcb052a1d1e">n_variable_groups</a>();</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  <span class="comment">// Our numbering here must be kept consistent with the numbering</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  <span class="comment">// scheme assumed by DofMap::local_variable_indices!</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  <span class="comment">//-------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  <span class="comment">// First count and assign temporary numbers to local dofs</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : mesh.active_local_element_ptr_range())</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    {</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;      <span class="comment">// Only number dofs connected to active</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;      <span class="comment">// elements on this processor.</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_nodes = elem-&gt;n_nodes();</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      <span class="comment">// First number the nodal DOFS</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=0; n&lt;n_nodes; n++)</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        {</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;          Node &amp; node = elem-&gt;node_ref(n);</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> vg=0; vg&lt;n_var_groups; vg++)</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;            {</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;              <span class="keyword">const</span> VariableGroup &amp; vg_description(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab59bc8ca645e02067744580fdf4c9616">variable_group</a>(vg));</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;              <span class="keywordflow">if</span> ((vg_description.type().family != SCALAR) &amp;&amp;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                  (vg_description.active_on_subdomain(elem-&gt;subdomain_id())))</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                {</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                  <span class="comment">// assign dof numbers (all at once) if this is</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                  <span class="comment">// our node and if they aren&#39;t already there</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                  <span class="keywordflow">if</span> ((node.n_comp_group(sys_num,vg) &gt; 0) &amp;&amp;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                      (node.processor_id() == this-&gt;processor_id()) &amp;&amp;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                      (node.vg_dof_base(sys_num,vg) ==</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                       <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>))</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                    {</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                      node.set_vg_dof_base(sys_num, vg,</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                                           next_free_dof);</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                      next_free_dof += (vg_description.n_variables()*</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                                        node.n_comp_group(sys_num,vg));</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                      <span class="comment">//node.debug_buffer();</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                    }</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                }</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;            }</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        }</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;      <span class="comment">// Now number the element DOFS</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> vg=0; vg&lt;n_var_groups; vg++)</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        {</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;          <span class="keyword">const</span> VariableGroup &amp; vg_description(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab59bc8ca645e02067744580fdf4c9616">variable_group</a>(vg));</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;          <span class="keywordflow">if</span> ((vg_description.type().family != SCALAR) &amp;&amp;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;              (vg_description.active_on_subdomain(elem-&gt;subdomain_id())))</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;            <span class="keywordflow">if</span> (elem-&gt;n_comp_group(sys_num,vg) &gt; 0)</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;              {</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                libmesh_assert_equal_to (elem-&gt;vg_dof_base(sys_num,vg),</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                                         <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                elem-&gt;set_vg_dof_base(sys_num,</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                                      vg,</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                                      next_free_dof);</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                next_free_dof += (vg_description.n_variables()*</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                                  elem-&gt;n_comp(sys_num,vg));</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;              }</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;        }</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    } <span class="comment">// done looping over elements</span></div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  <span class="comment">// we may have missed assigning DOFs to nodes that we own</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  <span class="comment">// but to which we have no connected elements matching our</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;  <span class="comment">// variable restriction criterion.  this will happen, for example,</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;  <span class="comment">// if variable V is restricted to subdomain S.  We may not own</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;  <span class="comment">// any elements which live in S, but we may own nodes which are</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  <span class="comment">// *connected* to elements which do.  in this scenario these nodes</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  <span class="comment">// will presently have unnumbered DOFs. we need to take care of</span></div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;  <span class="comment">// them here since we own them and no other processor will touch them.</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; node : mesh.local_node_ptr_range())</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> vg=0; vg&lt;n_var_groups; vg++)</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;      {</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        <span class="keyword">const</span> VariableGroup &amp; vg_description(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab59bc8ca645e02067744580fdf4c9616">variable_group</a>(vg));</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        <span class="keywordflow">if</span> (node-&gt;n_comp_group(sys_num,vg))</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;          <span class="keywordflow">if</span> (node-&gt;vg_dof_base(sys_num,vg) == <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>)</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;            {</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;              node-&gt;set_vg_dof_base (sys_num,</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                                     vg,</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                                     next_free_dof);</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;              next_free_dof += (vg_description.n_variables()*</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                                node-&gt;n_comp(sys_num,vg));</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;            }</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;      }</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a0e7b566e7d6125d46b18f34d9727f376">distribute_scalar_dofs</a>(next_free_dof);</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="preprocessor"></span>  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a6abf52a43c1480656cfc1c77428d08b8">assert_no_nodes_missed</a>(mesh);</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="preprocessor">#endif // DEBUG</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="preprocessor"></span>}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab59bc8ca645e02067744580fdf4c9616"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab59bc8ca645e02067744580fdf4c9616">libMesh::DofMap::variable_group</a></div><div class="ttdeci">const VariableGroup &amp; variable_group(const unsigned int c) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02101">dof_map.h:2101</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a6abf52a43c1480656cfc1c77428d08b8"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a6abf52a43c1480656cfc1c77428d08b8">libMesh::DofMap::assert_no_nodes_missed</a></div><div class="ttdeci">void assert_no_nodes_missed(MeshBase &amp;mesh)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01418">dof_map.C:1418</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_adf3b0ebe7fcc0c41bced4c9f17bf4822"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">libMesh::DofObject::invalid_id</a></div><div class="ttdeci">static const dof_id_type invalid_id</div><div class="ttdoc">An invalid id to distinguish an uninitialized DofObject. </div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00477">dof_object.h:477</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a6058ea4ca2ef36bd90f44bcb052a1d1e"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a6058ea4ca2ef36bd90f44bcb052a1d1e">libMesh::DofMap::n_variable_groups</a></div><div class="ttdeci">unsigned int n_variable_groups() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00613">dof_map.h:613</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a244e7a1cd82d5e6ae8780c93205ec1fa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02093">dof_map.h:2093</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a0e7b566e7d6125d46b18f34d9727f376"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a0e7b566e7d6125d46b18f34d9727f376">libMesh::DofMap::distribute_scalar_dofs</a></div><div class="ttdeci">void distribute_scalar_dofs(dof_id_type &amp;next_free_dof)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01394">dof_map.C:1394</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af781ec4ff23b34cd4332a357f1647fdd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::distribute_local_dofs_var_major </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &amp;&#160;</td>
          <td class="paramname"><em>next_free_dof</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Distributes the global degrees of freedom, for dofs on this processor. </p>
<p>In this format the local degrees of freedom are in a contiguous block for each variable in the system. Starts at index next_free_dof, and increments it to the post-final index. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l01299">1299</a> 行定义.</p>

<p>参考 <a class="el" href="variable_8h_source.html#l00157">libMesh::Variable::active_on_subdomain()</a>, <a class="el" href="dof__map_8C_source.html#l01418">assert_no_nodes_missed()</a>, <a class="el" href="dof__map_8C_source.html#l01394">distribute_scalar_dofs()</a>, <a class="el" href="dof__object_8h_source.html#l00477">libMesh::DofObject::invalid_id</a>, <a class="el" href="dof__map_8h_source.html#l00613">n_variable_groups()</a>, <a class="el" href="variable_8h_source.html#l00256">libMesh::VariableGroup::n_variables()</a>, <a class="el" href="dof__map_8h_source.html#l02093">sys_number()</a>, <a class="el" href="variable_8h_source.html#l00140">libMesh::Variable::type()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02101">variable_group()</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00927">distribute_dofs()</a>.</p>
<div class="fragment"><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;{</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sys_num      = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">sys_number</a>();</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_var_groups = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a6058ea4ca2ef36bd90f44bcb052a1d1e">n_variable_groups</a>();</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;  <span class="comment">// Our numbering here must be kept consistent with the numbering</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  <span class="comment">// scheme assumed by DofMap::local_variable_indices!</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;  <span class="comment">//-------------------------------------------------------------------------</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  <span class="comment">// First count and assign temporary numbers to local dofs</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> vg=0; vg&lt;n_var_groups; vg++)</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    {</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;      <span class="keyword">const</span> VariableGroup &amp; vg_description(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab59bc8ca645e02067744580fdf4c9616">variable_group</a>(vg));</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_vars_in_group = vg_description.n_variables();</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      <span class="comment">// Skip the SCALAR dofs</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;      <span class="keywordflow">if</span> (vg_description.type().family == SCALAR)</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : mesh.active_local_element_ptr_range())</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;        {</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;          <span class="comment">// Only number dofs connected to active elements on this</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;          <span class="comment">// processor and only variables which are active on on this</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;          <span class="comment">// element&#39;s subdomain.</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;          <span class="keywordflow">if</span> (!vg_description.active_on_subdomain(elem-&gt;subdomain_id()))</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_nodes = elem-&gt;n_nodes();</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;          <span class="comment">// First number the nodal DOFS</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=0; n&lt;n_nodes; n++)</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;            {</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;              Node &amp; node = elem-&gt;node_ref(n);</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;              <span class="comment">// assign dof numbers (all at once) if this is</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;              <span class="comment">// our node and if they aren&#39;t already there</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;              <span class="keywordflow">if</span> ((node.n_comp_group(sys_num,vg) &gt; 0) &amp;&amp;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                  (node.processor_id() == this-&gt;processor_id()) &amp;&amp;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                  (node.vg_dof_base(sys_num,vg) ==</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                   <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>))</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                {</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                  node.set_vg_dof_base(sys_num, vg, next_free_dof);</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                  next_free_dof += (n_vars_in_group*</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;                                    node.n_comp_group(sys_num,vg));</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                }</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;            }</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;          <span class="comment">// Now number the element DOFS</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;          <span class="keywordflow">if</span> (elem-&gt;n_comp_group(sys_num,vg) &gt; 0)</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;            {</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;              libmesh_assert_equal_to (elem-&gt;vg_dof_base(sys_num,vg),</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                                       <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;              elem-&gt;set_vg_dof_base(sys_num,</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                                    vg,</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                                    next_free_dof);</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;              next_free_dof += (n_vars_in_group*</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                                elem-&gt;n_comp_group(sys_num,vg));</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;            }</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        } <span class="comment">// end loop on elements</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;      <span class="comment">// we may have missed assigning DOFs to nodes that we own</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;      <span class="comment">// but to which we have no connected elements matching our</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;      <span class="comment">// variable restriction criterion.  this will happen, for example,</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      <span class="comment">// if variable V is restricted to subdomain S.  We may not own</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      <span class="comment">// any elements which live in S, but we may own nodes which are</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      <span class="comment">// *connected* to elements which do.  in this scenario these nodes</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;      <span class="comment">// will presently have unnumbered DOFs. we need to take care of</span></div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;      <span class="comment">// them here since we own them and no other processor will touch them.</span></div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; node : mesh.local_node_ptr_range())</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;        <span class="keywordflow">if</span> (node-&gt;n_comp_group(sys_num,vg))</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;          <span class="keywordflow">if</span> (node-&gt;vg_dof_base(sys_num,vg) == <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>)</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;            {</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;              node-&gt;set_vg_dof_base (sys_num,</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                                     vg,</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                                     next_free_dof);</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;              next_free_dof += (n_vars_in_group*</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                                node-&gt;n_comp_group(sys_num,vg));</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;            }</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    } <span class="comment">// end loop on variable groups</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a0e7b566e7d6125d46b18f34d9727f376">distribute_scalar_dofs</a>(next_free_dof);</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;<span class="preprocessor"></span>  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a6abf52a43c1480656cfc1c77428d08b8">assert_no_nodes_missed</a>(mesh);</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;<span class="preprocessor"></span>}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab59bc8ca645e02067744580fdf4c9616"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab59bc8ca645e02067744580fdf4c9616">libMesh::DofMap::variable_group</a></div><div class="ttdeci">const VariableGroup &amp; variable_group(const unsigned int c) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02101">dof_map.h:2101</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a6abf52a43c1480656cfc1c77428d08b8"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a6abf52a43c1480656cfc1c77428d08b8">libMesh::DofMap::assert_no_nodes_missed</a></div><div class="ttdeci">void assert_no_nodes_missed(MeshBase &amp;mesh)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01418">dof_map.C:1418</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_adf3b0ebe7fcc0c41bced4c9f17bf4822"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">libMesh::DofObject::invalid_id</a></div><div class="ttdeci">static const dof_id_type invalid_id</div><div class="ttdoc">An invalid id to distinguish an uninitialized DofObject. </div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00477">dof_object.h:477</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a6058ea4ca2ef36bd90f44bcb052a1d1e"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a6058ea4ca2ef36bd90f44bcb052a1d1e">libMesh::DofMap::n_variable_groups</a></div><div class="ttdeci">unsigned int n_variable_groups() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00613">dof_map.h:613</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a244e7a1cd82d5e6ae8780c93205ec1fa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02093">dof_map.h:2093</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a0e7b566e7d6125d46b18f34d9727f376"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a0e7b566e7d6125d46b18f34d9727f376">libMesh::DofMap::distribute_scalar_dofs</a></div><div class="ttdeci">void distribute_scalar_dofs(dof_id_type &amp;next_free_dof)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01394">dof_map.C:1394</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0e7b566e7d6125d46b18f34d9727f376"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::distribute_scalar_dofs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &amp;&#160;</td>
          <td class="paramname"><em>next_free_dof</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l01394">1394</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01994">_n_SCALAR_dofs</a>, <a class="el" href="dof__map_8h_source.html#l00613">n_variable_groups()</a>, <a class="el" href="variable_8h_source.html#l00256">libMesh::VariableGroup::n_variables()</a>, <a class="el" href="variable_8h_source.html#l00140">libMesh::Variable::type()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02101">variable_group()</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01196">distribute_local_dofs_node_major()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l01299">distribute_local_dofs_var_major()</a>.</p>
<div class="fragment"><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;{</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">_n_SCALAR_dofs</a> = 0;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> vg : make_range(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a6058ea4ca2ef36bd90f44bcb052a1d1e">n_variable_groups</a>()))</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    {</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;      <span class="keyword">const</span> VariableGroup &amp; vg_description(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab59bc8ca645e02067744580fdf4c9616">variable_group</a>(vg));</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      <span class="keywordflow">if</span> (vg_description.type().family == SCALAR)</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;        {</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">_n_SCALAR_dofs</a> += (vg_description.n_variables()*</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                                   vg_description.type().order.get_order());</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;        }</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    }</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;  <span class="comment">// Only increment next_free_dof if we&#39;re on the processor</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;  <span class="comment">// that holds this SCALAR variable</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;  <span class="keywordflow">if</span> (this-&gt;processor_id() == (this-&gt;n_processors()-1))</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    next_free_dof += <a class="code" href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">_n_SCALAR_dofs</a>;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab59bc8ca645e02067744580fdf4c9616"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab59bc8ca645e02067744580fdf4c9616">libMesh::DofMap::variable_group</a></div><div class="ttdeci">const VariableGroup &amp; variable_group(const unsigned int c) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02101">dof_map.h:2101</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8dbee781954d22ad785846b3a2a45193"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">libMesh::DofMap::_n_SCALAR_dofs</a></div><div class="ttdeci">dof_id_type _n_SCALAR_dofs</div><div class="ttdoc">The total number of SCALAR dofs associated to all SCALAR variables. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01994">dof_map.h:1994</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a6058ea4ca2ef36bd90f44bcb052a1d1e"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a6058ea4ca2ef36bd90f44bcb052a1d1e">libMesh::DofMap::n_variable_groups</a></div><div class="ttdeci">unsigned int n_variable_groups() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00613">dof_map.h:613</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0d323b6fcb736454a9f6074ebda9ec28"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::dof_indices </td>
          <td>(</td>
          <td class="paramtype">const Elem *const&#160;</td>
          <td class="paramname"><em>elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>di</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fills the vector <code>di</code> with the global degree of freedom indices for the element. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l01992">1992</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8C_source.html#l02381">_dof_indices()</a>, <a class="el" href="variable_8h_source.html#l00157">libMesh::Variable::active_on_subdomain()</a>, <a class="el" href="dof__map_8h_source.html#l00613">n_variable_groups()</a>, <a class="el" href="variable_8h_source.html#l00256">libMesh::VariableGroup::n_variables()</a>, <a class="el" href="variable_8h_source.html#l00294">libMesh::VariableGroup::number()</a>, <a class="el" href="dof__map_8C_source.html#l02544">SCALAR_dof_indices()</a>, <a class="el" href="variable_8h_source.html#l00140">libMesh::Variable::type()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02101">variable_group()</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01544">add_neighbors_to_send_list()</a>, <a class="el" href="dof__map_8C_source.html#l02225">dof_indices()</a>, <a class="el" href="dof__map_8C_source.html#l02609">is_evaluable()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03381">max_constraint_error()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l01898">process_mesh_constraint_rows()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l04643">scatter_constraints()</a> , 以及 <a class="el" href="sparsity__pattern_8C_source.html#l00092">libMesh::SparsityPattern::Build::sorted_connected_dofs()</a>.</p>
<div class="fragment"><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;{</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;  <span class="comment">// We now allow elem==nullptr to request just SCALAR dofs</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;  <span class="comment">// libmesh_assert(elem);</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;  <span class="comment">// If we are asking for current indices on an element, it ought to</span></div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;  <span class="comment">// be an active element (or a Side proxy, which also thinks it&#39;s</span></div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;  <span class="comment">// active)</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;  libmesh_assert(!elem || elem-&gt;active());</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;dof_indices()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;  <span class="comment">// Clear the DOF indices vector</span></div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;  di.clear();</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_var_groups  = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a6058ea4ca2ef36bd90f44bcb052a1d1e">n_variable_groups</a>();</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;<span class="preprocessor"></span>  <span class="comment">// Check that sizes match in DEBUG mode</span></div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;  std::size_t tot_size = 0;</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;  <span class="keywordflow">if</span> (elem &amp;&amp; elem-&gt;type() == TRI3SUBDIVISION)</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    {</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;      <span class="comment">// Subdivision surface FE require the 1-ring around elem</span></div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;      <span class="keyword">const</span> Tri3Subdivision * sd_elem = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span>Tri3Subdivision *<span class="keyword">&gt;</span>(elem);</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;      <span class="comment">// Ghost subdivision elements have no real dofs</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;      <span class="keywordflow">if</span> (!sd_elem-&gt;is_ghost())</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;        {</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;          <span class="comment">// Determine the nodes contributing to element elem</span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;          std::vector&lt;const Node *&gt; elem_nodes;</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;          MeshTools::Subdivision::find_one_ring(sd_elem, elem_nodes);</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;          <span class="comment">// Get the dof numbers</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vg=0; vg&lt;n_var_groups; vg++)</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;            {</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;              <span class="keyword">const</span> VariableGroup &amp; var = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab59bc8ca645e02067744580fdf4c9616">variable_group</a>(vg);</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vars_in_group = var.n_variables();</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;              <span class="keywordflow">if</span> (var.type().family == SCALAR &amp;&amp;</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;                  var.active_on_subdomain(elem-&gt;subdomain_id()))</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;                {</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vig=0; vig != vars_in_group; ++vig)</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;                    {</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;<span class="preprocessor"></span>                      tot_size += var.type().order;</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;<span class="preprocessor"></span>                      std::vector&lt;dof_id_type&gt; di_new;</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;                      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a347faeed226256bbb37de75dda07b8a3">SCALAR_dof_indices</a>(di_new,var.number(vig));</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;                      di.insert( di.end(), di_new.begin(), di_new.end());</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;                    }</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;                }</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vig=0; vig != vars_in_group; ++vig)</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;                  {</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;                    <a class="code" href="classlibMesh_1_1DofMap.html#ab71695347ecade298eba425d3150ffc6">_dof_indices</a>(*elem, elem-&gt;p_level(), di, vg, vig,</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;                                 elem_nodes.data(),</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;                                 cast_int&lt;unsigned int&gt;(elem_nodes.size())</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;#ifdef DEBUG</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;                                 , var.number(vig), tot_size</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;<span class="preprocessor"></span>                                 );</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;                  }</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;            }</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;        }</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;    }</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;  <span class="comment">// Get the dof numbers for each variable</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_nodes = elem ? elem-&gt;n_nodes() : 0;</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vg=0; vg&lt;n_var_groups; vg++)</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    {</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;      <span class="keyword">const</span> VariableGroup &amp; var = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab59bc8ca645e02067744580fdf4c9616">variable_group</a>(vg);</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vars_in_group = var.n_variables();</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;      <span class="keywordflow">if</span> (var.type().family == SCALAR &amp;&amp;</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;          (!elem ||</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;           var.active_on_subdomain(elem-&gt;subdomain_id())))</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;        {</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vig=0; vig != vars_in_group; ++vig)</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;            {</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;<span class="preprocessor"></span>              tot_size += var.type().order;</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;<span class="preprocessor"></span>              std::vector&lt;dof_id_type&gt; di_new;</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;              this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a347faeed226256bbb37de75dda07b8a3">SCALAR_dof_indices</a>(di_new,var.number(vig));</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;              di.insert( di.end(), di_new.begin(), di_new.end());</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;            }</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;        }</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (elem)</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vig=0; vig != vars_in_group; ++vig)</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;          {</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;            <a class="code" href="classlibMesh_1_1DofMap.html#ab71695347ecade298eba425d3150ffc6">_dof_indices</a>(*elem, elem-&gt;p_level(), di, vg, vig,</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;                         elem-&gt;get_nodes(), n_nodes</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;<span class="preprocessor"></span>                         , var.number(vig), tot_size</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;<span class="preprocessor"></span>                     );</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;          }</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    }</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;<span class="preprocessor"></span>  libmesh_assert_equal_to (tot_size, di.size());</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;<span class="preprocessor"></span>}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab71695347ecade298eba425d3150ffc6"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab71695347ecade298eba425d3150ffc6">libMesh::DofMap::_dof_indices</a></div><div class="ttdeci">void _dof_indices(const Elem &amp;elem, int p_level, std::vector&lt; dof_id_type &gt; &amp;di, const unsigned int vg, const unsigned int vig, const Node *const *nodes, unsigned int n_nodes#ifdef DEBUG, const unsigned int v, std::size_t &amp;tot_size#endif) const </div><div class="ttdoc">Helper function that gets the dof indices on the current element for a non-SCALAR type variable...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l02381">dof_map.C:2381</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab59bc8ca645e02067744580fdf4c9616"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab59bc8ca645e02067744580fdf4c9616">libMesh::DofMap::variable_group</a></div><div class="ttdeci">const VariableGroup &amp; variable_group(const unsigned int c) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02101">dof_map.h:2101</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a6058ea4ca2ef36bd90f44bcb052a1d1e"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a6058ea4ca2ef36bd90f44bcb052a1d1e">libMesh::DofMap::n_variable_groups</a></div><div class="ttdeci">unsigned int n_variable_groups() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00613">dof_map.h:613</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a347faeed226256bbb37de75dda07b8a3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a347faeed226256bbb37de75dda07b8a3">libMesh::DofMap::SCALAR_dof_indices</a></div><div class="ttdeci">void SCALAR_dof_indices(std::vector&lt; dof_id_type &gt; &amp;di, const unsigned int vn, const bool old_dofs=false) const </div><div class="ttdoc">Fills the vector di with the global degree of freedom indices corresponding to the SCALAR variable vn...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l02544">dof_map.C:2544</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a46ac4c9d94a25c31fe9670fcffdfa0a1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::dof_indices </td>
          <td>(</td>
          <td class="paramtype">const Elem *const&#160;</td>
          <td class="paramname"><em>elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>di</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>vn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>p_level</em> = <code>-12345</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fills the vector <code>di</code> with the global degree of freedom indices for the element. </p>
<p>For one variable, and potentially for a non-default element p refinement level </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l02102">2102</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8C_source.html#l02381">_dof_indices()</a>, <a class="el" href="dof__map_8h_source.html#l01849">_variable_group_numbers</a>, <a class="el" href="variable_8h_source.html#l00157">libMesh::Variable::active_on_subdomain()</a>, <a class="el" href="variable_8h_source.html#l00294">libMesh::VariableGroup::number()</a>, <a class="el" href="dof__map_8C_source.html#l02544">SCALAR_dof_indices()</a>, <a class="el" href="variable_8h_source.html#l00140">libMesh::Variable::type()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02101">variable_group()</a>.</p>
<div class="fragment"><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;{</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;  <span class="comment">// We now allow elem==nullptr to request just SCALAR dofs</span></div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;  <span class="comment">// libmesh_assert(elem);</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;dof_indices()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;  <span class="comment">// Clear the DOF indices vector</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;  di.clear();</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;  <span class="comment">// Use the default p refinement level?</span></div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;  <span class="keywordflow">if</span> (p_level == -12345)</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;    p_level = elem ? elem-&gt;p_level() : 0;</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vg = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a04bedd57c80ef97a7d9a0a3e2fe8a248">_variable_group_numbers</a>[vn];</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;  <span class="keyword">const</span> VariableGroup &amp; var = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab59bc8ca645e02067744580fdf4c9616">variable_group</a>(vg);</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vig = vn - var.number();</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;<span class="preprocessor"></span>  <span class="comment">// Check that sizes match in DEBUG mode</span></div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;  std::size_t tot_size = 0;</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;  <span class="keywordflow">if</span> (elem &amp;&amp; elem-&gt;type() == TRI3SUBDIVISION)</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    {</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;      <span class="comment">// Subdivision surface FE require the 1-ring around elem</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;      <span class="keyword">const</span> Tri3Subdivision * sd_elem = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span>Tri3Subdivision *<span class="keyword">&gt;</span>(elem);</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;      <span class="comment">// Ghost subdivision elements have no real dofs</span></div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;      <span class="keywordflow">if</span> (!sd_elem-&gt;is_ghost())</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;        {</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;          <span class="comment">// Determine the nodes contributing to element elem</span></div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;          std::vector&lt;const Node *&gt; elem_nodes;</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;          MeshTools::Subdivision::find_one_ring(sd_elem, elem_nodes);</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;          <a class="code" href="classlibMesh_1_1DofMap.html#ab71695347ecade298eba425d3150ffc6">_dof_indices</a>(*elem, p_level, di, vg, vig, elem_nodes.data(),</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;                       cast_int&lt;unsigned int&gt;(elem_nodes.size())</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;#ifdef DEBUG</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;                       , vn, tot_size</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;#endif</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;                       );</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;        }</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    }</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;  <span class="comment">// Get the dof numbers</span></div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;  <span class="keywordflow">if</span> (var.type().family == SCALAR &amp;&amp;</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;      (!elem ||</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;       var.active_on_subdomain(elem-&gt;subdomain_id())))</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;    {</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;<span class="preprocessor"></span>      tot_size += var.type().order;</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;<span class="preprocessor"></span>      std::vector&lt;dof_id_type&gt; di_new;</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a347faeed226256bbb37de75dda07b8a3">SCALAR_dof_indices</a>(di_new,vn);</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;      di.insert( di.end(), di_new.begin(), di_new.end());</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    }</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (elem)</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#ab71695347ecade298eba425d3150ffc6">_dof_indices</a>(*elem, p_level, di, vg, vig, elem-&gt;get_nodes(),</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;                 elem-&gt;n_nodes()</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;<span class="preprocessor"></span>                 , vn, tot_size</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;<span class="preprocessor"></span>                 );</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;<span class="preprocessor"></span>  libmesh_assert_equal_to (tot_size, di.size());</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;<span class="preprocessor"></span>}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab71695347ecade298eba425d3150ffc6"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab71695347ecade298eba425d3150ffc6">libMesh::DofMap::_dof_indices</a></div><div class="ttdeci">void _dof_indices(const Elem &amp;elem, int p_level, std::vector&lt; dof_id_type &gt; &amp;di, const unsigned int vg, const unsigned int vig, const Node *const *nodes, unsigned int n_nodes#ifdef DEBUG, const unsigned int v, std::size_t &amp;tot_size#endif) const </div><div class="ttdoc">Helper function that gets the dof indices on the current element for a non-SCALAR type variable...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l02381">dof_map.C:2381</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab59bc8ca645e02067744580fdf4c9616"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab59bc8ca645e02067744580fdf4c9616">libMesh::DofMap::variable_group</a></div><div class="ttdeci">const VariableGroup &amp; variable_group(const unsigned int c) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02101">dof_map.h:2101</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a347faeed226256bbb37de75dda07b8a3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a347faeed226256bbb37de75dda07b8a3">libMesh::DofMap::SCALAR_dof_indices</a></div><div class="ttdeci">void SCALAR_dof_indices(std::vector&lt; dof_id_type &gt; &amp;di, const unsigned int vn, const bool old_dofs=false) const </div><div class="ttdoc">Fills the vector di with the global degree of freedom indices corresponding to the SCALAR variable vn...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l02544">dof_map.C:2544</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a04bedd57c80ef97a7d9a0a3e2fe8a248"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a04bedd57c80ef97a7d9a0a3e2fe8a248">libMesh::DofMap::_variable_group_numbers</a></div><div class="ttdeci">std::vector&lt; unsigned int &gt; _variable_group_numbers</div><div class="ttdoc">The variable group number for each variable. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01849">dof_map.h:1849</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad1b251eccf3b1be48e48f6de23dd98bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::dof_indices </td>
          <td>(</td>
          <td class="paramtype">const Node *const&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>di</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fills the vector <code>di</code> with the global degree of freedom indices for the <code>node</code>. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l02177">2177</a> 行定义.</p>

<p>参考 <a class="el" href="dof__object_8h_source.html#l00477">libMesh::DofObject::invalid_id</a>, <a class="el" href="dof__map_8h_source.html#l00613">n_variable_groups()</a>, <a class="el" href="variable_8h_source.html#l00256">libMesh::VariableGroup::n_variables()</a>, <a class="el" href="variable_8h_source.html#l00294">libMesh::VariableGroup::number()</a>, <a class="el" href="dof__map_8C_source.html#l02544">SCALAR_dof_indices()</a>, <a class="el" href="dof__map_8h_source.html#l02093">sys_number()</a>, <a class="el" href="variable_8h_source.html#l00140">libMesh::Variable::type()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02101">variable_group()</a>.</p>
<div class="fragment"><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;{</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;  <span class="comment">// We allow node==nullptr to request just SCALAR dofs</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;  <span class="comment">// libmesh_assert(elem);</span></div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;dof_indices(Node)&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;  <span class="comment">// Clear the DOF indices vector</span></div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;  di.clear();</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_var_groups  = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a6058ea4ca2ef36bd90f44bcb052a1d1e">n_variable_groups</a>();</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sys_num = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">sys_number</a>();</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;  <span class="comment">// Get the dof numbers</span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vg=0; vg&lt;n_var_groups; vg++)</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;    {</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;      <span class="keyword">const</span> VariableGroup &amp; var = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab59bc8ca645e02067744580fdf4c9616">variable_group</a>(vg);</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vars_in_group = var.n_variables();</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;      <span class="keywordflow">if</span> (var.type().family == SCALAR)</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;        {</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vig=0; vig != vars_in_group; ++vig)</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;            {</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;              std::vector&lt;dof_id_type&gt; di_new;</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;              this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a347faeed226256bbb37de75dda07b8a3">SCALAR_dof_indices</a>(di_new,var.number(vig));</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;              di.insert( di.end(), di_new.begin(), di_new.end());</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;            }</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;        }</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;        {</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> n_comp = node-&gt;n_comp_group(sys_num,vg);</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vig=0; vig != vars_in_group; ++vig)</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;            {</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i != n_comp; ++i)</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;                {</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;                  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> d =</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;                    node-&gt;dof_number(sys_num, vg, vig, i, n_comp);</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;                  libmesh_assert_not_equal_to</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;                    (d, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;                  di.push_back(d);</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;                }</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;            }</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;        }</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    }</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab59bc8ca645e02067744580fdf4c9616"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab59bc8ca645e02067744580fdf4c9616">libMesh::DofMap::variable_group</a></div><div class="ttdeci">const VariableGroup &amp; variable_group(const unsigned int c) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02101">dof_map.h:2101</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_adf3b0ebe7fcc0c41bced4c9f17bf4822"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">libMesh::DofObject::invalid_id</a></div><div class="ttdeci">static const dof_id_type invalid_id</div><div class="ttdoc">An invalid id to distinguish an uninitialized DofObject. </div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00477">dof_object.h:477</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a6058ea4ca2ef36bd90f44bcb052a1d1e"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a6058ea4ca2ef36bd90f44bcb052a1d1e">libMesh::DofMap::n_variable_groups</a></div><div class="ttdeci">unsigned int n_variable_groups() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00613">dof_map.h:613</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a244e7a1cd82d5e6ae8780c93205ec1fa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02093">dof_map.h:2093</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a347faeed226256bbb37de75dda07b8a3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a347faeed226256bbb37de75dda07b8a3">libMesh::DofMap::SCALAR_dof_indices</a></div><div class="ttdeci">void SCALAR_dof_indices(std::vector&lt; dof_id_type &gt; &amp;di, const unsigned int vn, const bool old_dofs=false) const </div><div class="ttdoc">Fills the vector di with the global degree of freedom indices corresponding to the SCALAR variable vn...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l02544">dof_map.C:2544</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3803d572c6076f4a583aa13090e4d4e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::dof_indices </td>
          <td>(</td>
          <td class="paramtype">const Node *const&#160;</td>
          <td class="paramname"><em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>di</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>vn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fills the vector <code>di</code> with the global degree of freedom indices for the <code>node</code>, for one variable <code>vn</code>. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l02225">2225</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01849">_variable_group_numbers</a>, <a class="el" href="dof__map_8C_source.html#l01992">dof_indices()</a>, <a class="el" href="dof__object_8h_source.html#l00477">libMesh::DofObject::invalid_id</a>, <a class="el" href="libmesh_8h_source.html#l00254">libMesh::invalid_uint</a>, <a class="el" href="variable_8h_source.html#l00294">libMesh::VariableGroup::number()</a>, <a class="el" href="dof__map_8C_source.html#l02544">SCALAR_dof_indices()</a>, <a class="el" href="dof__map_8h_source.html#l02093">sys_number()</a>, <a class="el" href="variable_8h_source.html#l00140">libMesh::Variable::type()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02101">variable_group()</a>.</p>
<div class="fragment"><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;{</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;  <span class="keywordflow">if</span> (vn == <a class="code" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a>)</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;    {</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a0d323b6fcb736454a9f6074ebda9ec28">dof_indices</a>(node, di);</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;    }</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;  <span class="comment">// We allow node==nullptr to request just SCALAR dofs</span></div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;  <span class="comment">// libmesh_assert(elem);</span></div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;dof_indices(Node)&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;  <span class="comment">// Clear the DOF indices vector</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;  di.clear();</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sys_num = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">sys_number</a>();</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;  <span class="comment">// Get the dof numbers</span></div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vg = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a04bedd57c80ef97a7d9a0a3e2fe8a248">_variable_group_numbers</a>[vn];</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;  <span class="keyword">const</span> VariableGroup &amp; var = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab59bc8ca645e02067744580fdf4c9616">variable_group</a>(vg);</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;  <span class="keywordflow">if</span> (var.type().family == SCALAR)</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    {</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;      std::vector&lt;dof_id_type&gt; di_new;</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a347faeed226256bbb37de75dda07b8a3">SCALAR_dof_indices</a>(di_new,vn);</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;      di.insert( di.end(), di_new.begin(), di_new.end());</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;    }</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;    {</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vig = vn - var.number();</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> n_comp = node-&gt;n_comp_group(sys_num,vg);</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i != n_comp; ++i)</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;        {</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> d =</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;            node-&gt;dof_number(sys_num, vg, vig, i, n_comp);</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;          libmesh_assert_not_equal_to</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;            (d, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;          di.push_back(d);</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;        }</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;    }</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_a5588f6411946120c9d917450ab73e2e2"><div class="ttname"><a href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a></div><div class="ttdeci">const unsigned int invalid_uint</div><div class="ttdoc">A number which is used quite often to represent an invalid or uninitialized value for an unsigned int...</div><div class="ttdef"><b>Definition:</b> <a href="libmesh_8h_source.html#l00254">libmesh.h:254</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab59bc8ca645e02067744580fdf4c9616"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab59bc8ca645e02067744580fdf4c9616">libMesh::DofMap::variable_group</a></div><div class="ttdeci">const VariableGroup &amp; variable_group(const unsigned int c) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02101">dof_map.h:2101</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_adf3b0ebe7fcc0c41bced4c9f17bf4822"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">libMesh::DofObject::invalid_id</a></div><div class="ttdeci">static const dof_id_type invalid_id</div><div class="ttdoc">An invalid id to distinguish an uninitialized DofObject. </div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00477">dof_object.h:477</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a244e7a1cd82d5e6ae8780c93205ec1fa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02093">dof_map.h:2093</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a347faeed226256bbb37de75dda07b8a3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a347faeed226256bbb37de75dda07b8a3">libMesh::DofMap::SCALAR_dof_indices</a></div><div class="ttdeci">void SCALAR_dof_indices(std::vector&lt; dof_id_type &gt; &amp;di, const unsigned int vn, const bool old_dofs=false) const </div><div class="ttdoc">Fills the vector di with the global degree of freedom indices corresponding to the SCALAR variable vn...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l02544">dof_map.C:2544</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a04bedd57c80ef97a7d9a0a3e2fe8a248"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a04bedd57c80ef97a7d9a0a3e2fe8a248">libMesh::DofMap::_variable_group_numbers</a></div><div class="ttdeci">std::vector&lt; unsigned int &gt; _variable_group_numbers</div><div class="ttdoc">The variable group number for each variable. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01849">dof_map.h:1849</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a0d323b6fcb736454a9f6074ebda9ec28"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a0d323b6fcb736454a9f6074ebda9ec28">libMesh::DofMap::dof_indices</a></div><div class="ttdeci">void dof_indices(const Elem *const elem, std::vector&lt; dof_id_type &gt; &amp;di) const </div><div class="ttdoc">Fills the vector di with the global degree of freedom indices for the element. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01992">dof_map.C:1992</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acbf22d6eef2a9f7067da340663339055"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::dof_indices </td>
          <td>(</td>
          <td class="paramtype">const Elem &amp;&#160;</td>
          <td class="paramname"><em>elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>di</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>vn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Appends to the vector <code>di</code> the global degree of freedom indices for <code>elem.node_ref(n)</code>, for one variable <code>vn</code>. </p>
<p>On hanging nodes with both vertex and non-vertex DoFs, only those indices which are directly supported on <code>elem</code> are included. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l02271">2271</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8C_source.html#l02296">_node_dof_indices()</a>.</p>
<div class="fragment"><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;{</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a5da0a54ecad33de039c252ddcc6ecb88">_node_dof_indices</a>(elem, n, elem.node_ref(n), di, vn);</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a5da0a54ecad33de039c252ddcc6ecb88"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a5da0a54ecad33de039c252ddcc6ecb88">libMesh::DofMap::_node_dof_indices</a></div><div class="ttdeci">void _node_dof_indices(const Elem &amp;elem, unsigned int n, const DofObject &amp;obj, std::vector&lt; dof_id_type &gt; &amp;di, const unsigned int vn) const </div><div class="ttdoc">Helper function that implements the element-nodal versions of dof_indices and old_dof_indices. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l02296">dof_map.C:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8e2e96a2b0e37592427bab97460d2767"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> libMesh::DofMap::dof_owner </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td>
          <td class="paramname"><em>dof</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The processor id that owns the dof index <code>dof</code> </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00717">717</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01881">_end_df</a>.</p>
<div class="fragment"><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  { std::vector&lt;dof_id_type&gt;::const_iterator ub =</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      std::upper_bound(<a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>.begin(), <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>.end(), dof);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    libmesh_assert (ub != <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>.end());</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="keywordflow">return</span> cast_int&lt;processor_id_type&gt;(ub - <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>.begin());</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af43f96a9e11b3f4221306fdfd4511aaa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">libMesh::DofMap::_end_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _end_df</div><div class="ttdoc">Last DOF index (plus 1) on processor p. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01881">dof_map.h:1881</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad3218b71187390e1b03182c32a547149"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1DofObject.html">DofObject</a> * libMesh::DofMap::elem_ptr </td>
          <td>(</td>
          <td class="paramtype">MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The Elem pointer with index <code>i</code> from the <code>mesh</code>. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l00348">348</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00927">distribute_dofs()</a>.</p>
<div class="fragment"><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;{</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="keywordflow">return</span> mesh.elem_ptr(i);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a86837c50216b2ddb800b3836d2a08c09"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::ReferenceCounter::enable_print_counter_info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Methods to enable/disable the reference counter output from <a class="el" href="classlibMesh_1_1ReferenceCounter.html#a13ce734a14ffd1dbb6496dab702da8e1" title="Prints the reference information, by default to libMesh::out. ">print_info()</a> </p>

<p>在文件 <a class="el" href="reference__counter_8C_source.html">reference_counter.C</a> 第 <a class="el" href="reference__counter_8C_source.html#l00094">94</a> 行定义.</p>

<p>参考 <a class="el" href="reference__counter_8h_source.html#l00143">libMesh::ReferenceCounter::_enable_print_counter</a>.</p>
<div class="fragment"><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;{</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <a class="code" href="classlibMesh_1_1ReferenceCounter.html#a8f75e8a4a280f2c41636f2ae1307a311">_enable_print_counter</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1ReferenceCounter_html_a8f75e8a4a280f2c41636f2ae1307a311"><div class="ttname"><a href="classlibMesh_1_1ReferenceCounter.html#a8f75e8a4a280f2c41636f2ae1307a311">libMesh::ReferenceCounter::_enable_print_counter</a></div><div class="ttdeci">static bool _enable_print_counter</div><div class="ttdoc">Flag to control whether reference count information is printed when print_info is called...</div><div class="ttdef"><b>Definition:</b> <a href="reference__counter_8h_source.html#l00143">reference_counter.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a265de993749f5bab70c3f9c860defd49"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::end_dof </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a>&#160;</td>
          <td class="paramname"><em>proc</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The first dof index that is after all indices local to processor <code>proc</code>.</dd></dl>
<p>Analogous to the end() member function of STL containers. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00708">708</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01881">_end_df</a>.</p>

<p>参考自 <a class="el" href="sparsity__pattern_8C_source.html#l00111">libMesh::SparsityPattern::Build::handle_vi_vj()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00363">libMesh::SparsityPattern::Build::join()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00238">libMesh::SparsityPattern::Build::operator()()</a> , 以及 <a class="el" href="sparsity__pattern_8C_source.html#l00469">libMesh::SparsityPattern::Build::parallel_sync()</a>.</p>
<div class="fragment"><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  { libmesh_assert_less (proc, <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>.size()); <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>[proc]; }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af43f96a9e11b3f4221306fdfd4511aaa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">libMesh::DofMap::_end_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _end_df</div><div class="ttdoc">Last DOF index (plus 1) on processor p. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01881">dof_map.h:1881</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a92230d3049a3a7a97b8ba2f34b3ec677"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::end_dof </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00711">711</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00927">distribute_dofs()</a>, <a class="el" href="dof__map_8h_source.html#l00831">local_index()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l01724">n_local_constrained_dofs()</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l01898">process_mesh_constraint_rows()</a>.</p>
<div class="fragment"><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  { <span class="keywordflow">return</span> this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a92230d3049a3a7a97b8ba2f34b3ec677">end_dof</a>(this-&gt;processor_id()); }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a92230d3049a3a7a97b8ba2f34b3ec677"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a92230d3049a3a7a97b8ba2f34b3ec677">libMesh::DofMap::end_dof</a></div><div class="ttdeci">dof_id_type end_dof() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00711">dof_map.h:711</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6801d9d76f5c6958889614ce566d49d0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::end_old_dof </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a>&#160;</td>
          <td class="paramname"><em>proc</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The first old dof index that is after all indices local to processor <code>proc</code>.</dd></dl>
<p>Analogous to the end() member function of STL containers. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00731">731</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02011">_end_old_df</a>.</p>
<div class="fragment"><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  { libmesh_assert_less (proc, <a class="code" href="classlibMesh_1_1DofMap.html#ab96f5b260e5925063553da996bb3b428">_end_old_df</a>.size()); <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#ab96f5b260e5925063553da996bb3b428">_end_old_df</a>[proc]; }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab96f5b260e5925063553da996bb3b428"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab96f5b260e5925063553da996bb3b428">libMesh::DofMap::_end_old_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _end_old_df</div><div class="ttdoc">Last old DOF index (plus 1) on processor p. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02011">dof_map.h:2011</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9279162157eed83c6f739a4a675a3499"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::end_old_dof </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00734">734</a> 行定义.</p>
<div class="fragment"><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  { <span class="keywordflow">return</span> this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9279162157eed83c6f739a4a675a3499">end_old_dof</a>(this-&gt;processor_id()); }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9279162157eed83c6f739a4a675a3499"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9279162157eed83c6f739a4a675a3499">libMesh::DofMap::end_old_dof</a></div><div class="ttdeci">dof_id_type end_old_dof() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00734">dof_map.h:734</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acef530b92074c6876bcb892f5f7fc1a5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::enforce_adjoint_constraints_exactly </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Heterogeneously constrains the numeric vector <code>v</code>, which represents an adjoint solution defined on the mesh for quantity fo interest <code>q</code>. </p>
<p>For homogeneous constraints, use <code>enforce_constraints_exactly</code> instead </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l03285">3285</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02034">_adjoint_constraint_values</a>, <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>, <a class="el" href="numeric__vector_8C_source.html#l00050">libMesh::NumericVector&lt; T &gt;::build()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#a42ea91bba70b3e7b27dad2a636ad31ae">libMesh::NumericVector&lt; T &gt;::close()</a>, <a class="el" href="numeric__vector_8h_source.html#l00180">libMesh::NumericVector&lt; T &gt;::closed()</a>, <a class="el" href="numeric__vector_8h_source.html#l01012">libMesh::NumericVector&lt; T &gt;::get()</a>, <a class="el" href="dof__map_8h_source.html#l00511">get_send_list()</a>, <a class="el" href="dof__map_8h_source.html#l00831">local_index()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#acf9a23a820fdd20bf1a0213de8166287">libMesh::NumericVector&lt; T &gt;::local_size()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#a7348b5b027adf716016354847e0df0b6">libMesh::NumericVector&lt; T &gt;::localize()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l01714">n_constrained_dofs()</a>, <a class="el" href="dof__map_8h_source.html#l00659">n_dofs()</a>, <a class="el" href="dof__map_8h_source.html#l00669">n_local_dofs()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#a083d7b5e0efa633986bcd2b38bc0b053">libMesh::NumericVector&lt; T &gt;::set()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#a90f2918648bb3c65d88978bd5d0a19bf">libMesh::NumericVector&lt; T &gt;::size()</a> , 以及 <a class="el" href="numeric__vector_8h_source.html#l00166">libMesh::NumericVector&lt; T &gt;::type()</a>.</p>
<div class="fragment"><div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;{</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;  parallel_object_only();</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;  <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ad83df6befb2ac64f657f874731ab03f1">n_constrained_dofs</a>())</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;enforce_adjoint_constraints_exactly()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;  <a class="code" href="classlibMesh_1_1NumericVector.html">NumericVector&lt;Number&gt;</a> * v_local  = <span class="keyword">nullptr</span>; <span class="comment">// will be initialized below</span></div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;  <a class="code" href="classlibMesh_1_1NumericVector.html">NumericVector&lt;Number&gt;</a> * v_global = <span class="keyword">nullptr</span>; <span class="comment">// will be initialized below</span></div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;  std::unique_ptr&lt;NumericVector&lt;Number&gt;&gt; v_built;</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;  <span class="keywordflow">if</span> (v.<a class="code" href="classlibMesh_1_1NumericVector.html#a3b6bc13960a5d0022beea138c4e86dc4">type</a>() == SERIAL)</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;    {</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;      v_built = <a class="code" href="classlibMesh_1_1NumericVector.html#adba4a30965537656bb3b0c6f924ff040">NumericVector&lt;Number&gt;::build</a>(this-&gt;comm());</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;      v_built-&gt;init(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a77f8d984574b1bf8886057799e9b0134">n_dofs</a>(), this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8e8912a9fc6b900604ff23807edadd3b">n_local_dofs</a>(), <span class="keyword">true</span>, PARALLEL);</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;      v_built-&gt;close();</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> i=v_built-&gt;first_local_index();</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;           i&lt;v_built-&gt;last_local_index(); i++)</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;        v_built-&gt;set(i, v(i));</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;      v_built-&gt;close();</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;      v_global = v_built.<a class="code" href="classlibMesh_1_1NumericVector.html#a8eac3a527f0194feae3a9dd80c878df1">get</a>();</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;      v_local = &amp;v;</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;      libmesh_assert (v_local-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#afa69111a678b5552c7fe586c91a6585f">closed</a>());</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;    }</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (v.<a class="code" href="classlibMesh_1_1NumericVector.html#a3b6bc13960a5d0022beea138c4e86dc4">type</a>() == PARALLEL)</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;    {</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;      v_built = <a class="code" href="classlibMesh_1_1NumericVector.html#adba4a30965537656bb3b0c6f924ff040">NumericVector&lt;Number&gt;::build</a>(this-&gt;comm());</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;      v_built-&gt;init (v.<a class="code" href="classlibMesh_1_1NumericVector.html#a90f2918648bb3c65d88978bd5d0a19bf">size</a>(), v.<a class="code" href="classlibMesh_1_1NumericVector.html#acf9a23a820fdd20bf1a0213de8166287">local_size</a>(),</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;                     this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a31c127241d3271719ede3d0a6902e9e4">get_send_list</a>(), <span class="keyword">true</span>, GHOSTED);</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;      v.<a class="code" href="classlibMesh_1_1NumericVector.html#a7348b5b027adf716016354847e0df0b6">localize</a>(*v_built, this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a31c127241d3271719ede3d0a6902e9e4">get_send_list</a>());</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;      v_built-&gt;close();</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;      v_local = v_built.<a class="code" href="classlibMesh_1_1NumericVector.html#a8eac3a527f0194feae3a9dd80c878df1">get</a>();</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;      v_global = &amp;v;</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;    }</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (v.<a class="code" href="classlibMesh_1_1NumericVector.html#a3b6bc13960a5d0022beea138c4e86dc4">type</a>() == GHOSTED)</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;    {</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;      v_local = &amp;v;</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;      v_global = &amp;v;</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;    }</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;  <span class="keywordflow">else</span> <span class="comment">// unknown v.type()</span></div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;    libmesh_error_msg(<span class="stringliteral">&quot;ERROR: Unknown v.type() == &quot;</span> &lt;&lt; v.<a class="code" href="classlibMesh_1_1NumericVector.html#a3b6bc13960a5d0022beea138c4e86dc4">type</a>());</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;  <span class="comment">// We should never hit these asserts because we should error-out in</span></div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;  <span class="comment">// else clause above.  Just to be sure we don&#39;t try to use v_local</span></div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;  <span class="comment">// and v_global uninitialized...</span></div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;  libmesh_assert(v_local);</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;  libmesh_assert(v_global);</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;  <span class="comment">// Do we have any non_homogeneous constraints?</span></div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;  <span class="keyword">const</span> AdjointDofConstraintValues::const_iterator</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;    adjoint_constraint_map_it = <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.find(q);</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;  <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a> * constraint_map =</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;    (adjoint_constraint_map_it == <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.end()) ?</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;    <span class="keyword">nullptr</span> : &amp;adjoint_constraint_map_it-&gt;second;</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;  for (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; [constrained_dof, constraint_row] : <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>)</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;    {</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;      <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">local_index</a>(constrained_dof))</div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;      <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> exact_value = 0;</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;      <span class="keywordflow">if</span> (constraint_map)</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;        {</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;          <span class="keyword">const</span> DofConstraintValueMap::const_iterator</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;            adjoint_constraint_it =</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;            constraint_map-&gt;find(constrained_dof);</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;          <span class="keywordflow">if</span> (adjoint_constraint_it != constraint_map-&gt;end())</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;            exact_value = adjoint_constraint_it-&gt;second;</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;        }</div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; j : constraint_row)</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;        exact_value += j.second * (*v_local)(j.first);</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;      v_global-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a083d7b5e0efa633986bcd2b38bc0b053">set</a>(constrained_dof, exact_value);</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;    }</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;  <span class="comment">// If the old vector was serial, we probably need to send our values</span></div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;  <span class="comment">// to other processors</span></div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;  <span class="keywordflow">if</span> (v.<a class="code" href="classlibMesh_1_1NumericVector.html#a3b6bc13960a5d0022beea138c4e86dc4">type</a>() == SERIAL)</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;    {</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;<span class="preprocessor"></span>      v_global-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a42ea91bba70b3e7b27dad2a636ad31ae">close</a>();</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;<span class="preprocessor"></span>      v_global-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a7348b5b027adf716016354847e0df0b6">localize</a> (v);</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;    }</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;  v.<a class="code" href="classlibMesh_1_1NumericVector.html#a42ea91bba70b3e7b27dad2a636ad31ae">close</a>();</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_afa69111a678b5552c7fe586c91a6585f"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#afa69111a678b5552c7fe586c91a6585f">libMesh::NumericVector::closed</a></div><div class="ttdeci">virtual bool closed() const </div><div class="ttdoc">检查向量是否已经关闭并准备好进行计算。 </div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8h_source.html#l00180">numeric_vector.h:180</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad83df6befb2ac64f657f874731ab03f1"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad83df6befb2ac64f657f874731ab03f1">libMesh::DofMap::n_constrained_dofs</a></div><div class="ttdeci">dof_id_type n_constrained_dofs() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l01714">dof_map_constraints.C:1714</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a90f2918648bb3c65d88978bd5d0a19bf"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a90f2918648bb3c65d88978bd5d0a19bf">libMesh::NumericVector::size</a></div><div class="ttdeci">virtual numeric_index_type size() const =0</div><div class="ttdoc">获取向量的大小。 </div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html">libMesh::NumericVector</a></div><div class="ttdoc">提供了不同线性代数库的向量存储方案的统一接口。 </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00067">dof_map.h:67</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab6d9ab04643e9028f7f0c9b4d18e0455"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">libMesh::DofMap::local_index</a></div><div class="ttdeci">bool local_index(dof_id_type dof_index) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00831">dof_map.h:831</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a77f8d984574b1bf8886057799e9b0134"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a77f8d984574b1bf8886057799e9b0134">libMesh::DofMap::n_dofs</a></div><div class="ttdeci">dof_id_type n_dofs() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00659">dof_map.h:659</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02034">dof_map.h:2034</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a42ea91bba70b3e7b27dad2a636ad31ae"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a42ea91bba70b3e7b27dad2a636ad31ae">libMesh::NumericVector::close</a></div><div class="ttdeci">virtual void close()=0</div><div class="ttdoc">调用 NumericVector 的内部组装函数，确保值在处理器之间一致。 </div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_adba4a30965537656bb3b0c6f924ff040"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#adba4a30965537656bb3b0c6f924ff040">libMesh::NumericVector::build</a></div><div class="ttdeci">static std::unique_ptr&lt; NumericVector&lt; T &gt; &gt; build(const Parallel::Communicator &amp;comm, const SolverPackage solver_package=libMesh::default_solver_package())</div><div class="ttdoc">构建一个 NumericVector 对象。 </div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8C_source.html#l00050">numeric_vector.C:50</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofConstraintValueMap_html"><div class="ttname"><a href="classlibMesh_1_1DofConstraintValueMap.html">libMesh::DofConstraintValueMap</a></div><div class="ttdoc">Storage for DofConstraint right hand sides for a particular problem. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00110">dof_map.h:110</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a8eac3a527f0194feae3a9dd80c878df1"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a8eac3a527f0194feae3a9dd80c878df1">libMesh::NumericVector::get</a></div><div class="ttdeci">virtual void get(const std::vector&lt; numeric_index_type &gt; &amp;index, T *values) const </div><div class="ttdoc">一次访问多个组件。 values 将 *不会* 重新分配空间；它应该已经具有足够的空间。 默认实现对每个索引调用 operator() ，但某些实现可能在此处提供更快的方法。 ...</div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8h_source.html#l01012">numeric_vector.h:1012</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_acf9a23a820fdd20bf1a0213de8166287"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#acf9a23a820fdd20bf1a0213de8166287">libMesh::NumericVector::local_size</a></div><div class="ttdeci">virtual numeric_index_type local_size() const =0</div><div class="ttdoc">获取向量的本地大小，即 index_stop - index_start。 </div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8e8912a9fc6b900604ff23807edadd3b"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8e8912a9fc6b900604ff23807edadd3b">libMesh::DofMap::n_local_dofs</a></div><div class="ttdeci">dof_id_type n_local_dofs() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00669">dof_map.h:669</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a3b6bc13960a5d0022beea138c4e86dc4"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a3b6bc13960a5d0022beea138c4e86dc4">libMesh::NumericVector::type</a></div><div class="ttdeci">ParallelType type() const </div><div class="ttdoc">获取向量的类型。 </div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8h_source.html#l00166">numeric_vector.h:166</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a083d7b5e0efa633986bcd2b38bc0b053"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a083d7b5e0efa633986bcd2b38bc0b053">libMesh::NumericVector::set</a></div><div class="ttdeci">virtual void set(const numeric_index_type i, const T value)=0</div><div class="ttdoc">设置 v(i) = value 。 请注意，此方法的库实现是线程安全的， 例如，将在写入向量之前锁定 _numeric_vector_mutex 。 </div></div>
<div class="ttc" id="namespacelibMesh_html_a8b17bf24a15bc292850c3a3894e2e8f9"><div class="ttname"><a href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">libMesh::Number</a></div><div class="ttdeci">Real Number</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00214">libmesh_common.h:214</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a31c127241d3271719ede3d0a6902e9e4"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a31c127241d3271719ede3d0a6902e9e4">libMesh::DofMap::get_send_list</a></div><div class="ttdeci">const std::vector&lt; dof_id_type &gt; &amp; get_send_list() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00511">dof_map.h:511</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a7348b5b027adf716016354847e0df0b6"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a7348b5b027adf716016354847e0df0b6">libMesh::NumericVector::localize</a></div><div class="ttdeci">virtual void localize(std::vector&lt; T &gt; &amp;v_local) const =0</div><div class="ttdoc">创建全局向量的副本并存储在本地向量 v_local 中。 </div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a447d1cb12f905ae3d8ede821fe8a9743"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::enforce_constraints_exactly </td>
          <td>(</td>
          <td class="paramtype">const System &amp;&#160;</td>
          <td class="paramname"><em>system</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *&#160;</td>
          <td class="paramname"><em>v</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>homogeneous</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constrains the numeric vector <code>v</code>, which represents a solution defined on the mesh. </p>
<p>This may need to be used after a linear solve, if your linear solver's solutions do not satisfy your DoF constraints to a tight enough tolerance.</p>
<p>If <code>v</code> == nullptr, the system solution vector is constrained</p>
<p>If <code>homogeneous</code> == true, heterogeneous constraints are enforced as if they were homogeneous. This might be appropriate for e.g. a vector representing a difference between two heterogeneously-constrained solutions. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l03113">3113</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>, <a class="el" href="dof__map_8h_source.html#l02032">_primal_constraint_values</a>, <a class="el" href="numeric__vector_8C_source.html#l00050">libMesh::NumericVector&lt; T &gt;::build()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#a42ea91bba70b3e7b27dad2a636ad31ae">libMesh::NumericVector&lt; T &gt;::close()</a>, <a class="el" href="numeric__vector_8h_source.html#l00180">libMesh::NumericVector&lt; T &gt;::closed()</a>, <a class="el" href="numeric__vector_8h_source.html#l01012">libMesh::NumericVector&lt; T &gt;::get()</a>, <a class="el" href="dof__map_8h_source.html#l00511">get_send_list()</a>, <a class="el" href="dof__map_8h_source.html#l00831">local_index()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#acf9a23a820fdd20bf1a0213de8166287">libMesh::NumericVector&lt; T &gt;::local_size()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#a7348b5b027adf716016354847e0df0b6">libMesh::NumericVector&lt; T &gt;::localize()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l01714">n_constrained_dofs()</a>, <a class="el" href="dof__map_8h_source.html#l00659">n_dofs()</a>, <a class="el" href="dof__map_8h_source.html#l00669">n_local_dofs()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#a083d7b5e0efa633986bcd2b38bc0b053">libMesh::NumericVector&lt; T &gt;::set()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#a90f2918648bb3c65d88978bd5d0a19bf">libMesh::NumericVector&lt; T &gt;::size()</a> , 以及 <a class="el" href="numeric__vector_8h_source.html#l00166">libMesh::NumericVector&lt; T &gt;::type()</a>.</p>
<div class="fragment"><div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;{</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;  parallel_object_only();</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;  <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ad83df6befb2ac64f657f874731ab03f1">n_constrained_dofs</a>())</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;enforce_constraints_exactly()&quot;</span>,<span class="stringliteral">&quot;DofMap&quot;</span>);</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;  <span class="keywordflow">if</span> (!v)</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;    v = system.solution.<a class="code" href="classlibMesh_1_1NumericVector.html#a8eac3a527f0194feae3a9dd80c878df1">get</a>();</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;  <a class="code" href="classlibMesh_1_1NumericVector.html">NumericVector&lt;Number&gt;</a> * v_local  = <span class="keyword">nullptr</span>; <span class="comment">// will be initialized below</span></div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;  <a class="code" href="classlibMesh_1_1NumericVector.html">NumericVector&lt;Number&gt;</a> * v_global = <span class="keyword">nullptr</span>; <span class="comment">// will be initialized below</span></div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;  std::unique_ptr&lt;NumericVector&lt;Number&gt;&gt; v_built;</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;  <span class="keywordflow">if</span> (v-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a3b6bc13960a5d0022beea138c4e86dc4">type</a>() == SERIAL)</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;    {</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;      v_built = <a class="code" href="classlibMesh_1_1NumericVector.html#adba4a30965537656bb3b0c6f924ff040">NumericVector&lt;Number&gt;::build</a>(this-&gt;comm());</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;      v_built-&gt;init(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a77f8d984574b1bf8886057799e9b0134">n_dofs</a>(), this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8e8912a9fc6b900604ff23807edadd3b">n_local_dofs</a>(), <span class="keyword">true</span>, PARALLEL);</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;      v_built-&gt;close();</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> i=v_built-&gt;first_local_index();</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;           i&lt;v_built-&gt;last_local_index(); i++)</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;        v_built-&gt;set(i, (*v)(i));</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;      v_built-&gt;close();</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;      v_global = v_built.<a class="code" href="classlibMesh_1_1NumericVector.html#a8eac3a527f0194feae3a9dd80c878df1">get</a>();</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;      v_local = v;</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;      libmesh_assert (v_local-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#afa69111a678b5552c7fe586c91a6585f">closed</a>());</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;    }</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (v-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a3b6bc13960a5d0022beea138c4e86dc4">type</a>() == PARALLEL)</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;    {</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;      v_built = <a class="code" href="classlibMesh_1_1NumericVector.html#adba4a30965537656bb3b0c6f924ff040">NumericVector&lt;Number&gt;::build</a>(this-&gt;comm());</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;      v_built-&gt;init (v-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a90f2918648bb3c65d88978bd5d0a19bf">size</a>(), v-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#acf9a23a820fdd20bf1a0213de8166287">local_size</a>(),</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;                     this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a31c127241d3271719ede3d0a6902e9e4">get_send_list</a>(), <span class="keyword">true</span>,</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;                     GHOSTED);</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;      v-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a7348b5b027adf716016354847e0df0b6">localize</a>(*v_built, this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a31c127241d3271719ede3d0a6902e9e4">get_send_list</a>());</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;      v_built-&gt;close();</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;      v_local = v_built.<a class="code" href="classlibMesh_1_1NumericVector.html#a8eac3a527f0194feae3a9dd80c878df1">get</a>();</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;      v_global = v;</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;    }</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (v-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a3b6bc13960a5d0022beea138c4e86dc4">type</a>() == GHOSTED)</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;    {</div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;      v_local = v;</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;      v_global = v;</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;    }</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;  <span class="keywordflow">else</span> <span class="comment">// unknown v-&gt;type()</span></div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;    libmesh_error_msg(<span class="stringliteral">&quot;ERROR: Unsupported NumericVector type == &quot;</span> &lt;&lt; Utility::enum_to_string(v-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a3b6bc13960a5d0022beea138c4e86dc4">type</a>()));</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;  <span class="comment">// We should never hit these asserts because we should error-out in</span></div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;  <span class="comment">// else clause above.  Just to be sure we don&#39;t try to use v_local</span></div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;  <span class="comment">// and v_global uninitialized...</span></div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;  libmesh_assert(v_local);</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;  libmesh_assert(v_global);</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;  libmesh_assert_equal_to (<span class="keyword">this</span>, &amp;(system.get_dof_map()));</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; [constrained_dof, constraint_row] : <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>)</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;    {</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;      <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">local_index</a>(constrained_dof))</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;      <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> exact_value = 0;</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;      <span class="keywordflow">if</span> (!homogeneous)</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;        {</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;          DofConstraintValueMap::const_iterator rhsit =</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;            <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.find(constrained_dof);</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;          <span class="keywordflow">if</span> (rhsit != <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.end())</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;            exact_value = rhsit-&gt;second;</div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;        }</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; [dof, val] : constraint_row)</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;        exact_value += val * (*v_local)(dof);</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;      v_global-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a083d7b5e0efa633986bcd2b38bc0b053">set</a>(constrained_dof, exact_value);</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;    }</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;  <span class="comment">// If the old vector was serial, we probably need to send our values</span></div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;  <span class="comment">// to other processors</span></div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;  <span class="keywordflow">if</span> (v-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a3b6bc13960a5d0022beea138c4e86dc4">type</a>() == SERIAL)</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;    {</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;<span class="preprocessor"></span>      v_global-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a42ea91bba70b3e7b27dad2a636ad31ae">close</a>();</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;<span class="preprocessor"></span>      v_global-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a7348b5b027adf716016354847e0df0b6">localize</a> (*v);</div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;    }</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;  v-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a42ea91bba70b3e7b27dad2a636ad31ae">close</a>();</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_afa69111a678b5552c7fe586c91a6585f"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#afa69111a678b5552c7fe586c91a6585f">libMesh::NumericVector::closed</a></div><div class="ttdeci">virtual bool closed() const </div><div class="ttdoc">检查向量是否已经关闭并准备好进行计算。 </div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8h_source.html#l00180">numeric_vector.h:180</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad83df6befb2ac64f657f874731ab03f1"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad83df6befb2ac64f657f874731ab03f1">libMesh::DofMap::n_constrained_dofs</a></div><div class="ttdeci">dof_id_type n_constrained_dofs() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l01714">dof_map_constraints.C:1714</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a90f2918648bb3c65d88978bd5d0a19bf"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a90f2918648bb3c65d88978bd5d0a19bf">libMesh::NumericVector::size</a></div><div class="ttdeci">virtual numeric_index_type size() const =0</div><div class="ttdoc">获取向量的大小。 </div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html">libMesh::NumericVector</a></div><div class="ttdoc">提供了不同线性代数库的向量存储方案的统一接口。 </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00067">dof_map.h:67</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab6d9ab04643e9028f7f0c9b4d18e0455"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">libMesh::DofMap::local_index</a></div><div class="ttdeci">bool local_index(dof_id_type dof_index) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00831">dof_map.h:831</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a77f8d984574b1bf8886057799e9b0134"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a77f8d984574b1bf8886057799e9b0134">libMesh::DofMap::n_dofs</a></div><div class="ttdeci">dof_id_type n_dofs() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00659">dof_map.h:659</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a42ea91bba70b3e7b27dad2a636ad31ae"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a42ea91bba70b3e7b27dad2a636ad31ae">libMesh::NumericVector::close</a></div><div class="ttdeci">virtual void close()=0</div><div class="ttdoc">调用 NumericVector 的内部组装函数，确保值在处理器之间一致。 </div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_adba4a30965537656bb3b0c6f924ff040"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#adba4a30965537656bb3b0c6f924ff040">libMesh::NumericVector::build</a></div><div class="ttdeci">static std::unique_ptr&lt; NumericVector&lt; T &gt; &gt; build(const Parallel::Communicator &amp;comm, const SolverPackage solver_package=libMesh::default_solver_package())</div><div class="ttdoc">构建一个 NumericVector 对象。 </div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8C_source.html#l00050">numeric_vector.C:50</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a8eac3a527f0194feae3a9dd80c878df1"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a8eac3a527f0194feae3a9dd80c878df1">libMesh::NumericVector::get</a></div><div class="ttdeci">virtual void get(const std::vector&lt; numeric_index_type &gt; &amp;index, T *values) const </div><div class="ttdoc">一次访问多个组件。 values 将 *不会* 重新分配空间；它应该已经具有足够的空间。 默认实现对每个索引调用 operator() ，但某些实现可能在此处提供更快的方法。 ...</div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8h_source.html#l01012">numeric_vector.h:1012</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02032">dof_map.h:2032</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_acf9a23a820fdd20bf1a0213de8166287"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#acf9a23a820fdd20bf1a0213de8166287">libMesh::NumericVector::local_size</a></div><div class="ttdeci">virtual numeric_index_type local_size() const =0</div><div class="ttdoc">获取向量的本地大小，即 index_stop - index_start。 </div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8e8912a9fc6b900604ff23807edadd3b"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8e8912a9fc6b900604ff23807edadd3b">libMesh::DofMap::n_local_dofs</a></div><div class="ttdeci">dof_id_type n_local_dofs() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00669">dof_map.h:669</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a3b6bc13960a5d0022beea138c4e86dc4"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a3b6bc13960a5d0022beea138c4e86dc4">libMesh::NumericVector::type</a></div><div class="ttdeci">ParallelType type() const </div><div class="ttdoc">获取向量的类型。 </div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8h_source.html#l00166">numeric_vector.h:166</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a083d7b5e0efa633986bcd2b38bc0b053"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a083d7b5e0efa633986bcd2b38bc0b053">libMesh::NumericVector::set</a></div><div class="ttdeci">virtual void set(const numeric_index_type i, const T value)=0</div><div class="ttdoc">设置 v(i) = value 。 请注意，此方法的库实现是线程安全的， 例如，将在写入向量之前锁定 _numeric_vector_mutex 。 </div></div>
<div class="ttc" id="namespacelibMesh_html_a8b17bf24a15bc292850c3a3894e2e8f9"><div class="ttname"><a href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">libMesh::Number</a></div><div class="ttdeci">Real Number</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00214">libmesh_common.h:214</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a31c127241d3271719ede3d0a6902e9e4"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a31c127241d3271719ede3d0a6902e9e4">libMesh::DofMap::get_send_list</a></div><div class="ttdeci">const std::vector&lt; dof_id_type &gt; &amp; get_send_list() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00511">dof_map.h:511</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a7348b5b027adf716016354847e0df0b6"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a7348b5b027adf716016354847e0df0b6">libMesh::NumericVector::localize</a></div><div class="ttdeci">virtual void localize(std::vector&lt; T &gt; &amp;v_local) const =0</div><div class="ttdoc">创建全局向量的副本并存储在本地向量 v_local 中。 </div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac68494bc83127a4fb0dfd6c6c9755783"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::enforce_constraints_on_jacobian </td>
          <td>(</td>
          <td class="paramtype">const NonlinearImplicitSystem &amp;&#160;</td>
          <td class="paramname"><em>system</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *&#160;</td>
          <td class="paramname"><em>jac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l03260">3260</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>, <a class="el" href="dof__map_8h_source.html#l00831">local_index()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l01714">n_constrained_dofs()</a> , 以及 <a class="el" href="classlibMesh_1_1SparseMatrix.html#ae363ff83d354c71a13b9559be471274b">libMesh::SparseMatrix&lt; T &gt;::set()</a>.</p>
<div class="fragment"><div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;{</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;  parallel_object_only();</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;  <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ad83df6befb2ac64f657f874731ab03f1">n_constrained_dofs</a>())</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;  <span class="keywordflow">if</span> (!jac)</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;    jac = system.matrix;</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;  libmesh_assert_equal_to (<span class="keyword">this</span>, &amp;(system.get_dof_map()));</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; [constrained_dof, constraint_row] : <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>)</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;    {</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;      <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">local_index</a>(constrained_dof))</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; j : constraint_row)</div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;        jac-&gt;<a class="code" href="classlibMesh_1_1SparseMatrix.html#ae363ff83d354c71a13b9559be471274b">set</a>(constrained_dof, j.first, -j.second);</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;      jac-&gt;<a class="code" href="classlibMesh_1_1SparseMatrix.html#ae363ff83d354c71a13b9559be471274b">set</a>(constrained_dof, constrained_dof, 1);</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;    }</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad83df6befb2ac64f657f874731ab03f1"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad83df6befb2ac64f657f874731ab03f1">libMesh::DofMap::n_constrained_dofs</a></div><div class="ttdeci">dof_id_type n_constrained_dofs() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l01714">dof_map_constraints.C:1714</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab6d9ab04643e9028f7f0c9b4d18e0455"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">libMesh::DofMap::local_index</a></div><div class="ttdeci">bool local_index(dof_id_type dof_index) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00831">dof_map.h:831</a></div></div>
<div class="ttc" id="classlibMesh_1_1SparseMatrix_html_ae363ff83d354c71a13b9559be471274b"><div class="ttname"><a href="classlibMesh_1_1SparseMatrix.html#ae363ff83d354c71a13b9559be471274b">libMesh::SparseMatrix::set</a></div><div class="ttdeci">virtual void set(const numeric_index_type i, const numeric_index_type j, const T value)=0</div><div class="ttdoc">设置元素 (i,j) 为 value . </div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afc1ba7620d261bdf02941e041b955997"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::enforce_constraints_on_residual </td>
          <td>(</td>
          <td class="paramtype">const NonlinearImplicitSystem &amp;&#160;</td>
          <td class="paramname"><em>system</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; const *&#160;</td>
          <td class="paramname"><em>solution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>homogeneous</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l03203">3203</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>, <a class="el" href="dof__map_8h_source.html#l02032">_primal_constraint_values</a>, <a class="el" href="numeric__vector_8C_source.html#l00050">libMesh::NumericVector&lt; T &gt;::build()</a>, <a class="el" href="numeric__vector_8h_source.html#l01012">libMesh::NumericVector&lt; T &gt;::get()</a>, <a class="el" href="dof__map_8h_source.html#l00511">get_send_list()</a>, <a class="el" href="dof__map_8h_source.html#l00831">local_index()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#acf9a23a820fdd20bf1a0213de8166287">libMesh::NumericVector&lt; T &gt;::local_size()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#a7348b5b027adf716016354847e0df0b6">libMesh::NumericVector&lt; T &gt;::localize()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l01714">n_constrained_dofs()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#a083d7b5e0efa633986bcd2b38bc0b053">libMesh::NumericVector&lt; T &gt;::set()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#a90f2918648bb3c65d88978bd5d0a19bf">libMesh::NumericVector&lt; T &gt;::size()</a> , 以及 <a class="el" href="numeric__vector_8h_source.html#l00166">libMesh::NumericVector&lt; T &gt;::type()</a>.</p>
<div class="fragment"><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;{</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;  parallel_object_only();</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;  <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ad83df6befb2ac64f657f874731ab03f1">n_constrained_dofs</a>())</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;  <span class="keywordflow">if</span> (!rhs)</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;    rhs = system.rhs;</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;  <span class="keywordflow">if</span> (!solution)</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;    solution = system.solution.<a class="code" href="classlibMesh_1_1NumericVector.html#a8eac3a527f0194feae3a9dd80c878df1">get</a>();</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;  <a class="code" href="classlibMesh_1_1NumericVector.html">NumericVector&lt;Number&gt;</a> <span class="keyword">const</span> * solution_local  = <span class="keyword">nullptr</span>; <span class="comment">// will be initialized below</span></div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;  std::unique_ptr&lt;NumericVector&lt;Number&gt;&gt; solution_built;</div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;  <span class="keywordflow">if</span> (solution-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a3b6bc13960a5d0022beea138c4e86dc4">type</a>() == SERIAL || solution-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a3b6bc13960a5d0022beea138c4e86dc4">type</a>() == GHOSTED)</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;      solution_local = solution;</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (solution-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a3b6bc13960a5d0022beea138c4e86dc4">type</a>() == PARALLEL)</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;    {</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;      solution_built = <a class="code" href="classlibMesh_1_1NumericVector.html#adba4a30965537656bb3b0c6f924ff040">NumericVector&lt;Number&gt;::build</a>(this-&gt;comm());</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;      solution_built-&gt;init (solution-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a90f2918648bb3c65d88978bd5d0a19bf">size</a>(), solution-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#acf9a23a820fdd20bf1a0213de8166287">local_size</a>(),</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;                            this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a31c127241d3271719ede3d0a6902e9e4">get_send_list</a>(), <span class="keyword">true</span>, GHOSTED);</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;      solution-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a7348b5b027adf716016354847e0df0b6">localize</a>(*solution_built, this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a31c127241d3271719ede3d0a6902e9e4">get_send_list</a>());</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;      solution_built-&gt;close();</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;      solution_local = solution_built.<a class="code" href="classlibMesh_1_1NumericVector.html#a8eac3a527f0194feae3a9dd80c878df1">get</a>();</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;    }</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;  <span class="keywordflow">else</span> <span class="comment">// unknown solution-&gt;type()</span></div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;    libmesh_error_msg(<span class="stringliteral">&quot;ERROR: Unsupported NumericVector type == &quot;</span> &lt;&lt; Utility::enum_to_string(solution-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a3b6bc13960a5d0022beea138c4e86dc4">type</a>()));</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;  <span class="comment">// We should never hit these asserts because we should error-out in</span></div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;  <span class="comment">// else clause above.  Just to be sure we don&#39;t try to use solution_local</span></div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;  libmesh_assert(solution_local);</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;  libmesh_assert_equal_to (<span class="keyword">this</span>, &amp;(system.get_dof_map()));</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;</div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; [constrained_dof, constraint_row] : <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>)</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;    {</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;      <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">local_index</a>(constrained_dof))</div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;      <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> exact_value = 0;</div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; [dof, val] : constraint_row)</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;        exact_value -= val * (*solution_local)(dof);</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;      exact_value += (*solution_local)(constrained_dof);</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;      <span class="keywordflow">if</span> (!homogeneous)</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;        {</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;          DofConstraintValueMap::const_iterator rhsit =</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;            <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.find(constrained_dof);</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;          <span class="keywordflow">if</span> (rhsit != <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.end())</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;            exact_value += rhsit-&gt;second;</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;        }</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;      rhs-&gt;<a class="code" href="classlibMesh_1_1NumericVector.html#a083d7b5e0efa633986bcd2b38bc0b053">set</a>(constrained_dof, exact_value);</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;    }</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad83df6befb2ac64f657f874731ab03f1"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad83df6befb2ac64f657f874731ab03f1">libMesh::DofMap::n_constrained_dofs</a></div><div class="ttdeci">dof_id_type n_constrained_dofs() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l01714">dof_map_constraints.C:1714</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a90f2918648bb3c65d88978bd5d0a19bf"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a90f2918648bb3c65d88978bd5d0a19bf">libMesh::NumericVector::size</a></div><div class="ttdeci">virtual numeric_index_type size() const =0</div><div class="ttdoc">获取向量的大小。 </div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html">libMesh::NumericVector</a></div><div class="ttdoc">提供了不同线性代数库的向量存储方案的统一接口。 </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00067">dof_map.h:67</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab6d9ab04643e9028f7f0c9b4d18e0455"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">libMesh::DofMap::local_index</a></div><div class="ttdeci">bool local_index(dof_id_type dof_index) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00831">dof_map.h:831</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_adba4a30965537656bb3b0c6f924ff040"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#adba4a30965537656bb3b0c6f924ff040">libMesh::NumericVector::build</a></div><div class="ttdeci">static std::unique_ptr&lt; NumericVector&lt; T &gt; &gt; build(const Parallel::Communicator &amp;comm, const SolverPackage solver_package=libMesh::default_solver_package())</div><div class="ttdoc">构建一个 NumericVector 对象。 </div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8C_source.html#l00050">numeric_vector.C:50</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a8eac3a527f0194feae3a9dd80c878df1"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a8eac3a527f0194feae3a9dd80c878df1">libMesh::NumericVector::get</a></div><div class="ttdeci">virtual void get(const std::vector&lt; numeric_index_type &gt; &amp;index, T *values) const </div><div class="ttdoc">一次访问多个组件。 values 将 *不会* 重新分配空间；它应该已经具有足够的空间。 默认实现对每个索引调用 operator() ，但某些实现可能在此处提供更快的方法。 ...</div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8h_source.html#l01012">numeric_vector.h:1012</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02032">dof_map.h:2032</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_acf9a23a820fdd20bf1a0213de8166287"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#acf9a23a820fdd20bf1a0213de8166287">libMesh::NumericVector::local_size</a></div><div class="ttdeci">virtual numeric_index_type local_size() const =0</div><div class="ttdoc">获取向量的本地大小，即 index_stop - index_start。 </div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a3b6bc13960a5d0022beea138c4e86dc4"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a3b6bc13960a5d0022beea138c4e86dc4">libMesh::NumericVector::type</a></div><div class="ttdeci">ParallelType type() const </div><div class="ttdoc">获取向量的类型。 </div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8h_source.html#l00166">numeric_vector.h:166</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a083d7b5e0efa633986bcd2b38bc0b053"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a083d7b5e0efa633986bcd2b38bc0b053">libMesh::NumericVector::set</a></div><div class="ttdeci">virtual void set(const numeric_index_type i, const T value)=0</div><div class="ttdoc">设置 v(i) = value 。 请注意，此方法的库实现是线程安全的， 例如，将在写入向量之前锁定 _numeric_vector_mutex 。 </div></div>
<div class="ttc" id="namespacelibMesh_html_a8b17bf24a15bc292850c3a3894e2e8f9"><div class="ttname"><a href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">libMesh::Number</a></div><div class="ttdeci">Real Number</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00214">libmesh_common.h:214</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a31c127241d3271719ede3d0a6902e9e4"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a31c127241d3271719ede3d0a6902e9e4">libMesh::DofMap::get_send_list</a></div><div class="ttdeci">const std::vector&lt; dof_id_type &gt; &amp; get_send_list() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00511">dof_map.h:511</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a7348b5b027adf716016354847e0df0b6"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a7348b5b027adf716016354847e0df0b6">libMesh::NumericVector::localize</a></div><div class="ttdeci">virtual void localize(std::vector&lt; T &gt; &amp;v_local) const =0</div><div class="ttdoc">创建全局向量的副本并存储在本地向量 v_local 中。 </div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4b5809663dddaec5f98739ba049f0a8d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::extract_local_vector </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>Ug</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>dof_indices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseVectorBase.html">DenseVectorBase</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>Ue</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Builds the local element vector <code>Ue</code> from the global vector <code>Ug</code>, accounting for any constrained degrees of freedom. </p>
<p>For an element without constrained degrees of freedom this is the trivial mapping <img class="formulaInl" alt="$ Ue[i] = Ug[dof_indices[i]] $" src="form_65.png"/></p>
<dl class="section note"><dt>注解</dt><dd>The user must ensure that the element vector <code>Ue</code> is properly sized when calling this method. This is because there is no <code>resize()</code> method in the <code>DenseVectorBase&lt;&gt;</code> class. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l01910">1910</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map__constraints_8C_source.html#l03569">build_constraint_matrix_and_vector()</a>, <a class="el" href="classlibMesh_1_1DenseVectorBase.html#a35567e09039c62b9914def1fd063a73c">libMesh::DenseVectorBase&lt; T &gt;::el()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#adb02fab0dbedac070aa31d587732c7ba">libMesh::NumericVector&lt; T &gt;::first_local_index()</a>, <a class="el" href="dof__map_8h_source.html#l02179">is_constrained_dof()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#a18d730bed9ae74b3fb5edc8261d83a96">libMesh::NumericVector&lt; T &gt;::last_local_index()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00115">libMesh::DenseMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00122">libMesh::DenseMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="classlibMesh_1_1DenseVectorBase.html#a4ec1ad50c02f01beea21df4c29ed9736">libMesh::DenseVectorBase&lt; T &gt;::size()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#a90f2918648bb3c65d88978bd5d0a19bf">libMesh::NumericVector&lt; T &gt;::size()</a> , 以及 <a class="el" href="classlibMesh_1_1DenseVectorBase.html#a0c6c65a9c9b15317741c781903f45f83">libMesh::DenseVectorBase&lt; T &gt;::zero()</a>.</p>
<div class="fragment"><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;{</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_original_dofs = dof_indices_in.size();</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_AMR</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;  <span class="comment">// Trivial mapping</span></div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;  libmesh_assert_equal_to (dof_indices_in.size(), Ue.size());</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;  <span class="keywordtype">bool</span> has_constrained_dofs = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> il=0; il != n_original_dofs; ++il)</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    {</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> ig = dof_indices_in[il];</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;      <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">is_constrained_dof</a> (ig)) has_constrained_dofs = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;      libmesh_assert_less (ig, Ug.size());</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;      Ue.el(il) = Ug(ig);</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    }</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;  <span class="comment">// If the element has any constrained DOFs then we need</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;  <span class="comment">// to account for them in the mapping.  This will handle</span></div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;  <span class="comment">// the case that the input vector is not constrained.</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;  <span class="keywordflow">if</span> (has_constrained_dofs)</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    {</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;      <span class="comment">// Copy the input DOF indices.</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;      std::vector&lt;dof_id_type&gt; constrained_dof_indices(dof_indices_in);</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;      DenseMatrix&lt;Number&gt; C;</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;      DenseVector&lt;Number&gt; H;</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ad2ed5b18088aa8e52795beaf93cde513">build_constraint_matrix_and_vector</a> (C, H, constrained_dof_indices);</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;      libmesh_assert_equal_to (dof_indices_in.size(), C.m());</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;      libmesh_assert_equal_to (constrained_dof_indices.size(), C.n());</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;      <span class="comment">// zero-out Ue</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;      Ue.zero();</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;      <span class="comment">// compute Ue = C Ug, with proper mapping.</span></div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i != n_original_dofs; i++)</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;        {</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;          Ue.el(i) = H(i);</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_constrained =</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;            cast_int&lt;unsigned int&gt;(constrained_dof_indices.size());</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j&lt;n_constrained; j++)</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;            {</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> jg = constrained_dof_indices[j];</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;              <span class="comment">//          If Ug is a serial or ghosted vector, then this assert is</span></div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;              <span class="comment">//          overzealous.  If Ug is a parallel vector, then this assert</span></div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;              <span class="comment">//          is redundant.</span></div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;              <span class="comment">//    libmesh_assert ((jg &gt;= Ug.first_local_index()) &amp;&amp;</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;              <span class="comment">//    (jg &lt;  Ug.last_local_index()));</span></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;              Ue.el(i) += C(i,j)*Ug(jg);</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;            }</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;        }</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    }</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;  <span class="comment">// Trivial mapping</span></div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;  libmesh_assert_equal_to (n_original_dofs, Ue.size());</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> il=0; il&lt;n_original_dofs; il++)</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    {</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> ig = dof_indices_in[il];</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;      libmesh_assert ((ig &gt;= Ug.first_local_index()) &amp;&amp; (ig &lt;  Ug.last_local_index()));</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;      Ue.el(il) = Ug(ig);</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;    }</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;<span class="preprocessor"></span>}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad2ed5b18088aa8e52795beaf93cde513"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad2ed5b18088aa8e52795beaf93cde513">libMesh::DofMap::build_constraint_matrix_and_vector</a></div><div class="ttdeci">void build_constraint_matrix_and_vector(DenseMatrix&lt; Number &gt; &amp;C, DenseVector&lt; Number &gt; &amp;H, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, int qoi_index=-1, const bool called_recursively=false) const </div><div class="ttdoc">Build the constraint matrix C and the forcing vector H associated with the element degree of freedom ...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l03569">dof_map_constraints.C:3569</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9846273ba4930ef0364bc1fc954af914"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02179">dof_map.h:2179</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7ab53c009c0cba6ca266a97841e19828"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::find_connected_dof_objects </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; const <a class="el" href="classlibMesh_1_1DofObject.html">DofObject</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>objs</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Finds all the DofObjects associated with the set in <code>objs</code>. </p>
<p>This will account for off-element couplings via hanging nodes. </p>

</div>
</div>
<a class="anchor" id="a3894dde74bae40ba948e3be6656bfb72"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::find_connected_dofs </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>elem_dofs</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Finds all the DOFS associated with the element DOFs elem_dofs. </p>
<p>This will account for off-element couplings via hanging nodes. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l02852">2852</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02179">is_constrained_dof()</a>.</p>

<p>参考自 <a class="el" href="sparsity__pattern_8C_source.html#l00092">libMesh::SparsityPattern::Build::sorted_connected_dofs()</a>.</p>
<div class="fragment"><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;{</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;  <span class="keyword">typedef</span> std::set&lt;dof_id_type&gt; RCSet;</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;  <span class="comment">// First insert the DOFS we already depend on into the set.</span></div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;  RCSet dof_set (elem_dofs.begin(), elem_dofs.end());</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;  <span class="keywordtype">bool</span> done = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;  <span class="comment">// Next insert any dofs those might be constrained in terms</span></div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;  <span class="comment">// of.  Note that in this case we may not be done:  Those may</span></div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;  <span class="comment">// in turn depend on others.  So, we need to repeat this process</span></div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;  <span class="comment">// in that case until the system depends only on unconstrained</span></div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;  <span class="comment">// degrees of freedom.</span></div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; dof : elem_dofs)</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">is_constrained_dof</a>(dof))</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;      {</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;        <span class="comment">// If the DOF is constrained</span></div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;        DofConstraints::const_iterator</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;          pos = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(dof);</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;        libmesh_assert (pos != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end());</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;        <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; constraint_row = pos-&gt;second;</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;        <span class="comment">// adaptive p refinement currently gives us lots of empty constraint</span></div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;        <span class="comment">// rows - we should optimize those DoFs away in the future.  [RHS]</span></div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;        <span class="comment">//libmesh_assert (!constraint_row.empty());</span></div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;        <span class="comment">// Add the DOFs this dof is constrained in terms of.</span></div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;        <span class="comment">// note that these dofs might also be constrained, so</span></div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;        <span class="comment">// we will need to call this function recursively.</span></div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; pr : constraint_row)</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;          <span class="keywordflow">if</span> (!dof_set.count (pr.first))</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;            {</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;              dof_set.insert (pr.first);</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;              done = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;            }</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;      }</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;  <span class="comment">// If not done then we need to do more work</span></div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;  <span class="comment">// (obviously :-) )!</span></div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;  <span class="keywordflow">if</span> (!done)</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;    {</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;      <span class="comment">// Fill the vector with the contents of the set</span></div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;      elem_dofs.clear();</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;      elem_dofs.insert (elem_dofs.end(),</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;                        dof_set.begin(), dof_set.end());</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;      <span class="comment">// May need to do this recursively.  It is possible</span></div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;      <span class="comment">// that we just replaced a constrained DOF with another</span></div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;      <span class="comment">// constrained DOF.</span></div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a3894dde74bae40ba948e3be6656bfb72">find_connected_dofs</a> (elem_dofs);</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;    } <span class="comment">// end if (!done)</span></div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9846273ba4930ef0364bc1fc954af914"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02179">dof_map.h:2179</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdoc">A row of the Dof constraint matrix. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00090">dof_map.h:90</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a3894dde74bae40ba948e3be6656bfb72"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a3894dde74bae40ba948e3be6656bfb72">libMesh::DofMap::find_connected_dofs</a></div><div class="ttdeci">void find_connected_dofs(std::vector&lt; dof_id_type &gt; &amp;elem_dofs) const </div><div class="ttdoc">Finds all the DOFS associated with the element DOFs elem_dofs. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l02852">dof_map.C:2852</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2cc5678707a3bcb0f64b1cb5c73c813c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::first_dof </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a>&#160;</td>
          <td class="paramname"><em>proc</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The first dof index that is local to partition <code>proc</code>. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00684">684</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01876">_first_df</a>.</p>

<p>参考自 <a class="el" href="sparsity__pattern_8C_source.html#l00111">libMesh::SparsityPattern::Build::handle_vi_vj()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00363">libMesh::SparsityPattern::Build::join()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00238">libMesh::SparsityPattern::Build::operator()()</a> , 以及 <a class="el" href="sparsity__pattern_8C_source.html#l00469">libMesh::SparsityPattern::Build::parallel_sync()</a>.</p>
<div class="fragment"><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  { libmesh_assert_less (proc, <a class="code" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a>.size()); <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a>[proc]; }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab72062de06b72df985ac5bf16837a7da"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">libMesh::DofMap::_first_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_df</div><div class="ttdoc">First DOF index on processor p. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01876">dof_map.h:1876</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afe4e2d426832365090b199b7083c0a77"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::first_dof </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00687">687</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00927">distribute_dofs()</a>, <a class="el" href="dof__map_8h_source.html#l00831">local_index()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l01724">n_local_constrained_dofs()</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l01898">process_mesh_constraint_rows()</a>.</p>
<div class="fragment"><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  { <span class="keywordflow">return</span> this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#afe4e2d426832365090b199b7083c0a77">first_dof</a>(this-&gt;processor_id()); }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_afe4e2d426832365090b199b7083c0a77"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#afe4e2d426832365090b199b7083c0a77">libMesh::DofMap::first_dof</a></div><div class="ttdeci">dof_id_type first_dof() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00687">dof_map.h:687</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae2e51e61ac671b5abf4773535ca5d3b1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::first_old_dof </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a>&#160;</td>
          <td class="paramname"><em>proc</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The first old dof index that is local to partition <code>proc</code>. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00694">694</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02006">_first_old_df</a>.</p>
<div class="fragment"><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;  { libmesh_assert_less (proc, <a class="code" href="classlibMesh_1_1DofMap.html#ab91d708f5167f50c0392b2fd5dea2559">_first_old_df</a>.size()); <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#ab91d708f5167f50c0392b2fd5dea2559">_first_old_df</a>[proc]; }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab91d708f5167f50c0392b2fd5dea2559"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab91d708f5167f50c0392b2fd5dea2559">libMesh::DofMap::_first_old_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_old_df</div><div class="ttdoc">First old DOF index on processor p. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02006">dof_map.h:2006</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8f178534a18c87d8c2c76e1f60a1a08f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::first_old_dof </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00697">697</a> 行定义.</p>
<div class="fragment"><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  { <span class="keywordflow">return</span> this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8f178534a18c87d8c2c76e1f60a1a08f">first_old_dof</a>(this-&gt;processor_id()); }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8f178534a18c87d8c2c76e1f60a1a08f"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8f178534a18c87d8c2c76e1f60a1a08f">libMesh::DofMap::first_old_dof</a></div><div class="ttdeci">dof_id_type first_old_dof() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00697">dof_map.h:697</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2ad8b64590135362f5ac09c581f828bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::gather_constraints </td>
          <td>(</td>
          <td class="paramtype">MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::set&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>unexpanded_dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>look_for_constrainees</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Helper function for querying about constraint equations on other processors. </p>
<p>If any id in <code>requested_dof_ids</code> is constrained on another processor, its constraint will be added on this processor as well. If <code>look_for_constrainees</code> is true, then constraints will also be returned if the id appears as a constraining value not just if it appears as a constrained value.</p>
<p>This function operates recursively: if the constraint for a constrained dof is newly added locally, then any other dofs which constrain it are queried to see if they are in turn constrained, and so on. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l05055">5055</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02034">_adjoint_constraint_values</a>, <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>, <a class="el" href="dof__map_8h_source.html#l01881">_end_df</a>, <a class="el" href="dof__map_8h_source.html#l02032">_primal_constraint_values</a>, <a class="el" href="dof__object_8h_source.html#l00477">libMesh::DofObject::invalid_id</a>, <a class="el" href="dof__map_8h_source.html#l00831">local_index()</a> , 以及 <a class="el" href="libmesh__common_8h_source.html#l00143">libMesh::Real</a>.</p>

<p>参考自 <a class="el" href="dof__map__constraints_8C_source.html#l03708">allgather_recursive_constraints()</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l04643">scatter_constraints()</a>.</p>
<div class="fragment"><div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;{</div>
<div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;  <span class="keyword">typedef</span> std::set&lt;dof_id_type&gt; DoF_RCSet;</div>
<div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;</div>
<div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;  <span class="comment">// If we have heterogeneous adjoint constraints we need to</span></div>
<div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;  <span class="comment">// communicate those too.</span></div>
<div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> max_qoi_num =</div>
<div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.empty() ?</div>
<div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;    0 : <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.rbegin()-&gt;first+1;</div>
<div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;</div>
<div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;  <span class="comment">// We have to keep recursing while the unexpanded set is</span></div>
<div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;  <span class="comment">// nonempty on *any* processor</span></div>
<div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;  <span class="keywordtype">bool</span> unexpanded_set_nonempty = !unexpanded_dofs.empty();</div>
<div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;  this-&gt;comm().max(unexpanded_set_nonempty);</div>
<div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;</div>
<div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;  <span class="keywordflow">while</span> (unexpanded_set_nonempty)</div>
<div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;    {</div>
<div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;      <span class="comment">// Let&#39;s make sure we don&#39;t lose sync in this loop.</span></div>
<div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;      parallel_object_only();</div>
<div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;</div>
<div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;      <span class="comment">// Request sets</span></div>
<div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;      DoF_RCSet   dof_request_set;</div>
<div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;</div>
<div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;      <span class="comment">// Request sets to send to each processor</span></div>
<div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;      std::map&lt;processor_id_type, std::vector&lt;dof_id_type&gt;&gt;</div>
<div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;        requested_dof_ids;</div>
<div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;</div>
<div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;      <span class="comment">// And the sizes of each</span></div>
<div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;      std::map&lt;processor_id_type, dof_id_type&gt;</div>
<div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;        dof_ids_on_proc;</div>
<div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;</div>
<div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;      <span class="comment">// Fill (and thereby sort and uniq!) the main request sets</span></div>
<div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; unexpanded_dof : unexpanded_dofs)</div>
<div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;        {</div>
<div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;          DofConstraints::const_iterator</div>
<div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;            pos = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(unexpanded_dof);</div>
<div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;</div>
<div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;          <span class="comment">// If we were asked for a DoF and we don&#39;t already have a</span></div>
<div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;          <span class="comment">// constraint for it, then we need to check for one.</span></div>
<div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;          <span class="keywordflow">if</span> (pos == <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end())</div>
<div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;            {</div>
<div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;              <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">local_index</a>(unexpanded_dof) &amp;&amp;</div>
<div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;                  !<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.count(unexpanded_dof) )</div>
<div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;                dof_request_set.insert(unexpanded_dof);</div>
<div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;            }</div>
<div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;          <span class="comment">// If we were asked for a DoF and we already have a</span></div>
<div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;          <span class="comment">// constraint for it, then we need to check if the</span></div>
<div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;          <span class="comment">// constraint is recursive.</span></div>
<div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;            {</div>
<div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; row = pos-&gt;second;</div>
<div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;              <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; j : row)</div>
<div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;                {</div>
<div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;                  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constraining_dof = j.first;</div>
<div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;</div>
<div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;                  <span class="comment">// If it&#39;s non-local and we haven&#39;t already got a</span></div>
<div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;                  <span class="comment">// constraint for it, we might need to ask for one</span></div>
<div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;                  <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">local_index</a>(constraining_dof) &amp;&amp;</div>
<div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;                      !<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.count(constraining_dof))</div>
<div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;                    dof_request_set.insert(constraining_dof);</div>
<div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;                }</div>
<div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;            }</div>
<div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;        }</div>
<div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;</div>
<div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;      <span class="comment">// Clear the unexpanded constraint set; we&#39;re about to expand it</span></div>
<div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;      unexpanded_dofs.clear();</div>
<div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;</div>
<div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;      <span class="comment">// Count requests by processor</span></div>
<div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;      <a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> proc_id = 0;</div>
<div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; i : dof_request_set)</div>
<div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;        {</div>
<div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;          <span class="keywordflow">while</span> (i &gt;= <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>[proc_id])</div>
<div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;            proc_id++;</div>
<div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;          dof_ids_on_proc[proc_id]++;</div>
<div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;        }</div>
<div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;</div>
<div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; pair : dof_ids_on_proc)</div>
<div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;        {</div>
<div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;          requested_dof_ids[pair.first].reserve(pair.second);</div>
<div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;        }</div>
<div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;</div>
<div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;      <span class="comment">// Prepare each processor&#39;s request set</span></div>
<div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;      proc_id = 0;</div>
<div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; i : dof_request_set)</div>
<div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;        {</div>
<div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;          <span class="keywordflow">while</span> (i &gt;= <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>[proc_id])</div>
<div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;            proc_id++;</div>
<div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;          requested_dof_ids[proc_id].push_back(i);</div>
<div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;        }</div>
<div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;</div>
<div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;      <span class="keyword">typedef</span> std::vector&lt;std::pair&lt;dof_id_type, Real&gt;&gt; row_datum;</div>
<div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;</div>
<div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;      <span class="keyword">typedef</span> std::vector&lt;Number&gt; rhss_datum;</div>
<div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;</div>
<div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;      <span class="keyword">auto</span> row_gather_functor =</div>
<div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;        [<span class="keyword">this</span>]</div>
<div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;        (<a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a>,</div>
<div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;         <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; ids,</div>
<div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;         std::vector&lt;row_datum&gt; &amp; data)</div>
<div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;        {</div>
<div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;          <span class="comment">// Fill those requests</span></div>
<div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;          <span class="keyword">const</span> std::size_t query_size = ids.size();</div>
<div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;</div>
<div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;          data.resize(query_size);</div>
<div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;          <span class="keywordflow">for</span> (std::size_t i=0; i != query_size; ++i)</div>
<div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;            {</div>
<div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;              <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained = ids[i];</div>
<div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.count(constrained))</div>
<div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;                {</div>
<div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;                  <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; row = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>[constrained];</div>
<div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;                  std::size_t row_size = row.size();</div>
<div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;                  data[i].reserve(row_size);</div>
<div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;                  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; j : row)</div>
<div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;                    {</div>
<div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;                      data[i].push_back(j);</div>
<div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;</div>
<div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;                      <span class="comment">// We should never have an invalid constraining</span></div>
<div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;                      <span class="comment">// dof id</span></div>
<div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;                      libmesh_assert(j.first != <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div>
<div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;</div>
<div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;                      <span class="comment">// We should never have a 0 constraint</span></div>
<div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;                      <span class="comment">// coefficient; that&#39;s implicit via sparse</span></div>
<div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;                      <span class="comment">// constraint storage</span></div>
<div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;                      <span class="comment">//</span></div>
<div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;                      <span class="comment">// But we can&#39;t easily control how users add</span></div>
<div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;                      <span class="comment">// constraints, so we can&#39;t safely assert that</span></div>
<div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;                      <span class="comment">// we&#39;re being efficient here.</span></div>
<div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;                      <span class="comment">//</span></div>
<div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;                      <span class="comment">// libmesh_assert(j.second);</span></div>
<div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;                    }</div>
<div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;                }</div>
<div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;                {</div>
<div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;                  <span class="comment">// We have to distinguish &quot;constraint with no</span></div>
<div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;                  <span class="comment">// constraining dofs&quot; (e.g. due to Dirichlet</span></div>
<div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;                  <span class="comment">// constraint equations) from &quot;no constraint&quot;.</span></div>
<div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;                  <span class="comment">// We&#39;ll use invalid_id for the latter.</span></div>
<div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;                  data[i].emplace_back(<a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>, <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a>(0));</div>
<div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;                }</div>
<div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;            }</div>
<div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;        };</div>
<div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;</div>
<div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;      <span class="keyword">auto</span> rhss_gather_functor =</div>
<div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;        [<span class="keyword">this</span>,</div>
<div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;         max_qoi_num]</div>
<div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;        (<a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a>,</div>
<div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;         <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; ids,</div>
<div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;         std::vector&lt;rhss_datum&gt; &amp; data)</div>
<div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;        {</div>
<div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;          <span class="comment">// Fill those requests</span></div>
<div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;          <span class="keyword">const</span> std::size_t query_size = ids.size();</div>
<div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;</div>
<div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;          data.resize(query_size);</div>
<div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;          <span class="keywordflow">for</span> (std::size_t i=0; i != query_size; ++i)</div>
<div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;            {</div>
<div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;              <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained = ids[i];</div>
<div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;              data[i].clear();</div>
<div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.count(constrained))</div>
<div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;                {</div>
<div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;                  DofConstraintValueMap::const_iterator rhsit =</div>
<div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;                    <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.find(constrained);</div>
<div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;                  data[i].push_back</div>
<div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;                    ((rhsit == <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.end()) ?</div>
<div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;                     0 : rhsit-&gt;second);</div>
<div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;</div>
<div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q != max_qoi_num; ++q)</div>
<div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;                    {</div>
<div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;                      AdjointDofConstraintValues::const_iterator adjoint_map_it =</div>
<div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;                        <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.find(q);</div>
<div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;</div>
<div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;                      <span class="keywordflow">if</span> (adjoint_map_it == <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.end())</div>
<div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;                        {</div>
<div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;                          data[i].push_back(0);</div>
<div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;                          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;                        }</div>
<div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;</div>
<div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;                      <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a> &amp; constraint_map =</div>
<div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;                        adjoint_map_it-&gt;second;</div>
<div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;</div>
<div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;                      DofConstraintValueMap::const_iterator adj_rhsit =</div>
<div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;                        constraint_map.find(constrained);</div>
<div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;                      data[i].push_back</div>
<div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;                        ((adj_rhsit == constraint_map.end()) ?</div>
<div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;                         0 : adj_rhsit-&gt;second);</div>
<div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;                    }</div>
<div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;                }</div>
<div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;            }</div>
<div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;        };</div>
<div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;</div>
<div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;      <span class="keyword">auto</span> row_action_functor =</div>
<div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;        [<span class="keyword">this</span>,</div>
<div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;         &amp; unexpanded_dofs]</div>
<div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;        (<a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a>,</div>
<div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;         <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; ids,</div>
<div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;         <span class="keyword">const</span> std::vector&lt;row_datum&gt; &amp; data)</div>
<div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;        {</div>
<div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;          <span class="comment">// Add any new constraint rows we&#39;ve found</span></div>
<div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;          <span class="keyword">const</span> std::size_t query_size = ids.size();</div>
<div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;</div>
<div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;          <span class="keywordflow">for</span> (std::size_t i=0; i != query_size; ++i)</div>
<div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;            {</div>
<div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained = ids[i];</div>
<div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;</div>
<div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;              <span class="comment">// An empty row is an constraint with an empty row; for</span></div>
<div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;              <span class="comment">// no constraint we use a &quot;no row&quot; placeholder</span></div>
<div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;              <span class="keywordflow">if</span> (data[i].empty())</div>
<div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;                {</div>
<div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;                  <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; row = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>[constrained];</div>
<div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;                  row.clear();</div>
<div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;                }</div>
<div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (data[i][0].first != <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>)</div>
<div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;                {</div>
<div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;                  <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; row = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>[constrained];</div>
<div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;                  row.clear();</div>
<div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;                  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; pair : data[i])</div>
<div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;                    {</div>
<div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;                      libmesh_assert_less(pair.first, this-&gt;n_dofs());</div>
<div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;                      row[pair.first] = pair.second;</div>
<div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;                    }</div>
<div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;</div>
<div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;                  <span class="comment">// And prepare to check for more recursive constraints</span></div>
<div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;                  unexpanded_dofs.insert(constrained);</div>
<div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;                }</div>
<div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;            }</div>
<div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;        };</div>
<div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;</div>
<div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;      <span class="keyword">auto</span> rhss_action_functor =</div>
<div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;        [<span class="keyword">this</span>,</div>
<div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;         max_qoi_num]</div>
<div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;        (<a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a>,</div>
<div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;         <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; ids,</div>
<div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;         <span class="keyword">const</span> std::vector&lt;rhss_datum&gt; &amp; data)</div>
<div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;        {</div>
<div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;          <span class="comment">// Add rhs data for any new constraint rows we&#39;ve found</span></div>
<div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;          <span class="keyword">const</span> std::size_t query_size = ids.size();</div>
<div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;</div>
<div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;          <span class="keywordflow">for</span> (std::size_t i=0; i != query_size; ++i)</div>
<div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;            {</div>
<div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;              <span class="keywordflow">if</span> (!data[i].empty())</div>
<div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;                {</div>
<div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;                  <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained = ids[i];</div>
<div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;                  <span class="keywordflow">if</span> (data[i][0] != <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>(0))</div>
<div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;                    <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>[constrained] = data[i][0];</div>
<div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;                    <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.erase(constrained);</div>
<div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;</div>
<div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q != max_qoi_num; ++q)</div>
<div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;                    {</div>
<div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;                      AdjointDofConstraintValues::iterator adjoint_map_it =</div>
<div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;                        <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.find(q);</div>
<div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;</div>
<div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;                      <span class="keywordflow">if</span> ((adjoint_map_it == <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.end()) &amp;&amp;</div>
<div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;                          data[i][q+1] == <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>(0))</div>
<div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;</div>
<div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;                      <span class="keywordflow">if</span> (adjoint_map_it == <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.end())</div>
<div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;                        adjoint_map_it = <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.emplace</div>
<div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;                          (q, <a class="code" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a>()).first;</div>
<div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;</div>
<div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;                      <a class="code" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a> &amp; constraint_map =</div>
<div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;                        adjoint_map_it-&gt;second;</div>
<div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;</div>
<div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;                      <span class="keywordflow">if</span> (data[i][q+1] != <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>(0))</div>
<div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;                        constraint_map[constrained] =</div>
<div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;                          data[i][q+1];</div>
<div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;                      <span class="keywordflow">else</span></div>
<div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;                        constraint_map.erase(constrained);</div>
<div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;                    }</div>
<div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;                }</div>
<div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;            }</div>
<div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;</div>
<div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;        };</div>
<div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;</div>
<div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;      <span class="comment">// Now request constraint rows from other processors</span></div>
<div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;      row_datum * row_ex = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;      Parallel::pull_parallel_vector_data</div>
<div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;        (this-&gt;comm(), requested_dof_ids, row_gather_functor,</div>
<div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;         row_action_functor, row_ex);</div>
<div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;</div>
<div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;      <span class="comment">// And request constraint right hand sides from other procesors</span></div>
<div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;      rhss_datum * rhs_ex = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;      Parallel::pull_parallel_vector_data</div>
<div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;        (this-&gt;comm(), requested_dof_ids, rhss_gather_functor,</div>
<div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;         rhss_action_functor, rhs_ex);</div>
<div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;</div>
<div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;      <span class="comment">// We have to keep recursing while the unexpanded set is</span></div>
<div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;      <span class="comment">// nonempty on *any* processor</span></div>
<div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;      unexpanded_set_nonempty = !unexpanded_dofs.empty();</div>
<div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;      this-&gt;comm().max(unexpanded_set_nonempty);</div>
<div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;    }</div>
<div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab6d9ab04643e9028f7f0c9b4d18e0455"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">libMesh::DofMap::local_index</a></div><div class="ttdeci">bool local_index(dof_id_type dof_index) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00831">dof_map.h:831</a></div></div>
<div class="ttc" id="namespacelibMesh_html_af18245d4f872c36a41fc74086bda3e80"><div class="ttname"><a href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">libMesh::processor_id_type</a></div><div class="ttdeci">uint8_t processor_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00104">id_types.h:104</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02034">dof_map.h:2034</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_adf3b0ebe7fcc0c41bced4c9f17bf4822"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">libMesh::DofObject::invalid_id</a></div><div class="ttdeci">static const dof_id_type invalid_id</div><div class="ttdoc">An invalid id to distinguish an uninitialized DofObject. </div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00477">dof_object.h:477</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofConstraintValueMap_html"><div class="ttname"><a href="classlibMesh_1_1DofConstraintValueMap.html">libMesh::DofConstraintValueMap</a></div><div class="ttdoc">Storage for DofConstraint right hand sides for a particular problem. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00110">dof_map.h:110</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aef28359fb4851abec08fc99cfbac118d"><div class="ttname"><a href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">libMesh::Real</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef LIBMESH_DEFAULT_SCALAR_TYPE Real</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00143">libmesh_common.h:143</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02032">dof_map.h:2032</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdoc">A row of the Dof constraint matrix. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00090">dof_map.h:90</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af43f96a9e11b3f4221306fdfd4511aaa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">libMesh::DofMap::_end_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _end_df</div><div class="ttdoc">Last DOF index (plus 1) on processor p. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01881">dof_map.h:1881</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a8b17bf24a15bc292850c3a3894e2e8f9"><div class="ttname"><a href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">libMesh::Number</a></div><div class="ttdeci">Real Number</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00214">libmesh_common.h:214</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acb79ba461e1294d3d2bda7c87ee96e93"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classlibMesh_1_1DirichletBoundaries.html">DirichletBoundaries</a> * libMesh::DofMap::get_adjoint_dirichlet_boundaries </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>q</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l05480">5480</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02064">_adjoint_dirichlet_boundaries</a>.</p>
<div class="fragment"><div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;{</div>
<div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;  libmesh_assert_greater(<a class="code" href="classlibMesh_1_1DofMap.html#a376604ef648f92ce79ed7d2c810b55f3">_adjoint_dirichlet_boundaries</a>.size(),q);</div>
<div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a376604ef648f92ce79ed7d2c810b55f3">_adjoint_dirichlet_boundaries</a>[q].get();</div>
<div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a376604ef648f92ce79ed7d2c810b55f3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a376604ef648f92ce79ed7d2c810b55f3">libMesh::DofMap::_adjoint_dirichlet_boundaries</a></div><div class="ttdeci">std::vector&lt; std::unique_ptr&lt; DirichletBoundaries &gt; &gt; _adjoint_dirichlet_boundaries</div><div class="ttdoc">Data structure containing Dirichlet functions. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02064">dof_map.h:2064</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af8e870d5119711e35e9aecf9b487a4ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1DirichletBoundaries.html">DirichletBoundaries</a> * libMesh::DofMap::get_adjoint_dirichlet_boundaries </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>q</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l05488">5488</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02064">_adjoint_dirichlet_boundaries</a>.</p>
<div class="fragment"><div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;{</div>
<div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> old_size = cast_int&lt;unsigned int&gt;</div>
<div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;    (<a class="code" href="classlibMesh_1_1DofMap.html#a376604ef648f92ce79ed7d2c810b55f3">_adjoint_dirichlet_boundaries</a>.size());</div>
<div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = old_size; i &lt;= q; ++i)</div>
<div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a376604ef648f92ce79ed7d2c810b55f3">_adjoint_dirichlet_boundaries</a>.push_back(std::make_unique&lt;DirichletBoundaries&gt;());</div>
<div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;</div>
<div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a376604ef648f92ce79ed7d2c810b55f3">_adjoint_dirichlet_boundaries</a>[q].get();</div>
<div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a376604ef648f92ce79ed7d2c810b55f3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a376604ef648f92ce79ed7d2c810b55f3">libMesh::DofMap::_adjoint_dirichlet_boundaries</a></div><div class="ttdeci">std::vector&lt; std::unique_ptr&lt; DirichletBoundaries &gt; &gt; _adjoint_dirichlet_boundaries</div><div class="ttdoc">Data structure containing Dirichlet functions. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02064">dof_map.h:2064</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa80551b7b77842fbbdba05173010e57e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classlibMesh_1_1DirichletBoundaries.html">DirichletBoundaries</a>* libMesh::DofMap::get_dirichlet_boundaries </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01482">1482</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02058">_dirichlet_boundaries</a>.</p>
<div class="fragment"><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;  {</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">_dirichlet_boundaries</a>.get();</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;  }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2e9be7e72291d4fd6e841ae7733a5ff0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">libMesh::DofMap::_dirichlet_boundaries</a></div><div class="ttdeci">std::unique_ptr&lt; DirichletBoundaries &gt; _dirichlet_boundaries</div><div class="ttdoc">Data structure containing Dirichlet functions. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02058">dof_map.h:2058</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae079c07a133ed49ebf98cefbf348c197"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1DirichletBoundaries.html">DirichletBoundaries</a>* libMesh::DofMap::get_dirichlet_boundaries </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01487">1487</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02058">_dirichlet_boundaries</a>.</p>
<div class="fragment"><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;  {</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">_dirichlet_boundaries</a>.get();</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;  }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2e9be7e72291d4fd6e841ae7733a5ff0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">libMesh::DofMap::_dirichlet_boundaries</a></div><div class="ttdeci">std::unique_ptr&lt; DirichletBoundaries &gt; _dirichlet_boundaries</div><div class="ttdoc">Data structure containing Dirichlet functions. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02058">dof_map.h:2058</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a924e4fba899cb386b81281a362cd8a4b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classlibMesh_1_1DofConstraints.html">DofConstraints</a>&amp; libMesh::DofMap::get_dof_constraints </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Provide a const accessor to the <a class="el" href="classlibMesh_1_1DofConstraints.html" title="The constraint matrix storage format. ">DofConstraints</a> map. </p>
<p>This allows the user to quickly search the data structure rather than just iterating over it. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01023">1023</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>.</p>
<div class="fragment"><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>; }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a103b37125ae9eaaadf6f7854df17faa2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string libMesh::ReferenceCounter::get_info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets a string containing the reference information. </p>

<p>在文件 <a class="el" href="reference__counter_8C_source.html">reference_counter.C</a> 第 <a class="el" href="reference__counter_8C_source.html#l00047">47</a> 行定义.</p>

<p>参考 <a class="el" href="reference__counter_8h_source.html#l00124">libMesh::ReferenceCounter::_counts</a>.</p>

<p>参考自 <a class="el" href="reference__counter_8C_source.html#l00081">libMesh::ReferenceCounter::print_info()</a>.</p>
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#if defined(LIBMESH_ENABLE_REFERENCE_COUNTING) &amp;&amp; defined(DEBUG)</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  std::ostringstream oss;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  oss &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; ---------------------------------------------------------------------------- \n&quot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      &lt;&lt; <span class="stringliteral">&quot;| Reference count information                                                |\n&quot;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      &lt;&lt; <span class="stringliteral">&quot; ---------------------------------------------------------------------------- \n&quot;</span>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; [name, cd] : <a class="code" href="classlibMesh_1_1ReferenceCounter.html#a7c913252d05560f8bc7c75a63547c4c3">_counts</a>)</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    oss &lt;&lt; <span class="stringliteral">&quot;| &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; reference count information:\n&quot;</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;|  Creations:    &quot;</span> &lt;&lt; cd.first    &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;|  Destructions: &quot;</span> &lt;&lt; cd.second &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  oss &lt;&lt; <span class="stringliteral">&quot; ---------------------------------------------------------------------------- \n&quot;</span>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordflow">return</span> oss.str();</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor"></span>}</div>
<div class="ttc" id="classlibMesh_1_1ReferenceCounter_html_a7c913252d05560f8bc7c75a63547c4c3"><div class="ttname"><a href="classlibMesh_1_1ReferenceCounter.html#a7c913252d05560f8bc7c75a63547c4c3">libMesh::ReferenceCounter::_counts</a></div><div class="ttdeci">static Counts _counts</div><div class="ttdoc">Actually holds the data. </div><div class="ttdef"><b>Definition:</b> <a href="reference__counter_8h_source.html#l00124">reference_counter.h:124</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4e4f1eeb9c6c7a7196d96d969bfb0e32"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string libMesh::DofMap::get_info </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets summary info about the sparsity bandwidth and constraints. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l02922">2922</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>, <a class="el" href="dof__map_8h_source.html#l01871">_matrices</a>, <a class="el" href="dof__map_8h_source.html#l02041">_node_constraints</a>, <a class="el" href="dof__map_8h_source.html#l02032">_primal_constraint_values</a>, <a class="el" href="dof__map_8h_source.html#l01983">_sp</a> , 以及 <a class="el" href="dof__map_8h_source.html#l00831">local_index()</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l02915">print_info()</a>.</p>
<div class="fragment"><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;{</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;  std::ostringstream os;</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;  <span class="comment">// If we didn&#39;t calculate the exact sparsity pattern, the threaded</span></div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;  <span class="comment">// sparsity pattern assembly may have just given us an upper bound</span></div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;  <span class="comment">// on sparsity.</span></div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> * may_equal = <span class="stringliteral">&quot; &lt;= &quot;</span>;</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;  <span class="comment">// If we calculated the exact sparsity pattern, then we can report</span></div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;  <span class="comment">// exact bandwidth figures:</span></div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; mat : <a class="code" href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">_matrices</a>)</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;    <span class="keywordflow">if</span> (mat-&gt;need_full_sparsity_pattern())</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;      may_equal = <span class="stringliteral">&quot; = &quot;</span>;</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;  <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> max_n_nz = 0, max_n_oz = 0;</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">double</span> avg_n_nz = 0, avg_n_oz = 0;</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>)</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;    {</div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; val : <a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>-&gt;get_n_nz())</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;        {</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;          max_n_nz = std::max(max_n_nz, val);</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;          avg_n_nz += val;</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;        }</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;      std::size_t n_nz_size = <a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>-&gt;get_n_nz().size();</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;      this-&gt;comm().max(max_n_nz);</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;      this-&gt;comm().sum(avg_n_nz);</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;      this-&gt;comm().sum(n_nz_size);</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;      avg_n_nz /= std::max(n_nz_size,std::size_t(1));</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; val : <a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>-&gt;get_n_oz())</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;        {</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;          max_n_oz = std::max(max_n_oz, val);</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;          avg_n_oz += val;</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;        }</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;      std::size_t n_oz_size = <a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>-&gt;get_n_oz().size();</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;      this-&gt;comm().max(max_n_oz);</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;      this-&gt;comm().sum(avg_n_oz);</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;      this-&gt;comm().sum(n_oz_size);</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;      avg_n_oz /= std::max(n_oz_size,std::size_t(1));</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;    }</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;    DofMap Sparsity\n      Average  On-Processor Bandwidth&quot;</span></div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;     &lt;&lt; may_equal &lt;&lt; avg_n_nz &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;      Average Off-Processor Bandwidth&quot;</span></div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;     &lt;&lt; may_equal &lt;&lt; avg_n_oz &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;      Maximum  On-Processor Bandwidth&quot;</span></div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;     &lt;&lt; may_equal &lt;&lt; max_n_nz &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;      Maximum Off-Processor Bandwidth&quot;</span></div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;     &lt;&lt; may_equal &lt;&lt; max_n_oz &lt;&lt; std::endl;</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_CONSTRAINTS</span></div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;  std::size_t n_constraints = 0, max_constraint_length = 0,</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;    n_rhss = 0;</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">double</span> avg_constraint_length = 0.;</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; [constrained_dof, row] : <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>)</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;    {</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;      <span class="comment">// Only count local constraints, then sum later</span></div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;      <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">local_index</a>(constrained_dof))</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;      std::size_t rowsize = row.size();</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;      max_constraint_length = std::max(max_constraint_length,</div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;                                       rowsize);</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;      avg_constraint_length += rowsize;</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;      n_constraints++;</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.count(constrained_dof))</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;        n_rhss++;</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;    }</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;  this-&gt;comm().sum(n_constraints);</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;  this-&gt;comm().sum(n_rhss);</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;  this-&gt;comm().sum(avg_constraint_length);</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;  this-&gt;comm().max(max_constraint_length);</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;    DofMap Constraints\n      Number of DoF Constraints = &quot;</span></div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;     &lt;&lt; n_constraints;</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;  <span class="keywordflow">if</span> (n_rhss)</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;    os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;      Number of Heterogenous Constraints= &quot;</span> &lt;&lt; n_rhss;</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;  <span class="keywordflow">if</span> (n_constraints)</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;    {</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;      avg_constraint_length /= n_constraints;</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;      os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;      Average DoF Constraint Length= &quot;</span> &lt;&lt; avg_constraint_length;</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;    }</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;<span class="preprocessor"></span>  std::size_t n_node_constraints = 0, max_node_constraint_length = 0,</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;    n_node_rhss = 0;</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;  <span class="keywordtype">long</span> <span class="keywordtype">double</span> avg_node_constraint_length = 0.;</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; [node, pr] : <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>)</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;    {</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;      <span class="comment">// Only count local constraints, then sum later</span></div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;      <span class="keywordflow">if</span> (node-&gt;processor_id() != this-&gt;processor_id())</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">NodeConstraintRow</a> &amp; row = pr.first;</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;      std::size_t rowsize = row.size();</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;      max_node_constraint_length = std::max(max_node_constraint_length,</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;                                            rowsize);</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;      avg_node_constraint_length += rowsize;</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;      n_node_constraints++;</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;      <span class="keywordflow">if</span> (pr.second != Point(0))</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;        n_node_rhss++;</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;    }</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;  this-&gt;comm().sum(n_node_constraints);</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;  this-&gt;comm().sum(n_node_rhss);</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;  this-&gt;comm().sum(avg_node_constraint_length);</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;  this-&gt;comm().max(max_node_constraint_length);</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;\n      Number of Node Constraints = &quot;</span> &lt;&lt; n_node_constraints;</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;  <span class="keywordflow">if</span> (n_node_rhss)</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;    os &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;       &lt;&lt; <span class="stringliteral">&quot;      Number of Heterogenous Node Constraints= &quot;</span> &lt;&lt; n_node_rhss;</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;  <span class="keywordflow">if</span> (n_node_constraints)</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;    {</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;      avg_node_constraint_length /= n_node_constraints;</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;\n      Maximum Node Constraint Length= &quot;</span> &lt;&lt; max_node_constraint_length</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;         &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;      Average Node Constraint Length= &quot;</span> &lt;&lt; avg_node_constraint_length;</div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;    }</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;<span class="preprocessor">#endif // LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;  os &lt;&lt; std::endl;</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;<span class="preprocessor">#endif // LIBMESH_ENABLE_CONSTRAINTS</span></div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;  <span class="keywordflow">return</span> os.str();</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab14c66a56c0815c857dc662bea96f124"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">libMesh::DofMap::_sp</a></div><div class="ttdeci">std::unique_ptr&lt; SparsityPattern::Build &gt; _sp</div><div class="ttdoc">The sparsity pattern of the global matrix. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01983">dof_map.h:1983</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab6d9ab04643e9028f7f0c9b4d18e0455"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">libMesh::DofMap::local_index</a></div><div class="ttdeci">bool local_index(dof_id_type dof_index) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00831">dof_map.h:831</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aacf8838eb951b139f05e56e338ac2195"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">libMesh::DofMap::_matrices</a></div><div class="ttdeci">std::vector&lt; SparseMatrix&lt; Number &gt; * &gt; _matrices</div><div class="ttdoc">Additional matrices handled by this object. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01871">dof_map.h:1871</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02032">dof_map.h:2032</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a0d8f16f2dd1d9a0c1780943811e37c1c"><div class="ttname"><a href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">libMesh::NodeConstraintRow</a></div><div class="ttdeci">std::map&lt; const Node *, Real, std::less&lt; const Node * &gt;, Threads::scalable_allocator&lt; std::pair&lt; const Node *const, Real &gt; &gt; &gt; NodeConstraintRow</div><div class="ttdoc">A row of the Node constraint mapping. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00138">dof_map.h:138</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8856db766d722a0edaa9f5c5d94d40f7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">libMesh::DofMap::_node_constraints</a></div><div class="ttdeci">NodeConstraints _node_constraints</div><div class="ttdoc">Data structure containing DofObject constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02041">dof_map.h:2041</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abe6b1771bcaadff20add06bd0b1bd21d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string libMesh::DofMap::get_local_constraints </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>print_nonlocal</em> = <code>false</code></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gets a string reporting all DoF and Node constraints local to this processor. </p>
<p>If <code>print_nonlocal</code> is true, then nonlocal constraints which are locally known are included. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l02288">2288</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02034">_adjoint_constraint_values</a>, <a class="el" href="dof__map_8h_source.html#l02064">_adjoint_dirichlet_boundaries</a>, <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>, <a class="el" href="dof__map_8h_source.html#l02041">_node_constraints</a>, <a class="el" href="dof__map_8h_source.html#l02032">_primal_constraint_values</a> , 以及 <a class="el" href="dof__map_8h_source.html#l00831">local_index()</a>.</p>

<p>参考自 <a class="el" href="dof__map__constraints_8C_source.html#l02262">print_dof_constraints()</a>.</p>
<div class="fragment"><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;{</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;  std::ostringstream os;</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span> (print_nonlocal)</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;All &quot;</span>;</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;Local &quot;</span>;</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;Node Constraints:&quot;</span></div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;     &lt;&lt; std::endl;</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; [node, pr] : <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>)</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;    {</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;      <span class="comment">// Skip non-local nodes if requested</span></div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;      <span class="keywordflow">if</span> (!print_nonlocal &amp;&amp;</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;          node-&gt;processor_id() != this-&gt;processor_id())</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">NodeConstraintRow</a> &amp; row = pr.first;</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;      <span class="keyword">const</span> Point &amp; offset = pr.second;</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;Constraints for Node id &quot;</span> &lt;&lt; node-&gt;id()</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;: \t&quot;</span>;</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; [cnode, val] : row)</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; cnode-&gt;id() &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; val &lt;&lt; <span class="stringliteral">&quot;)\t&quot;</span>;</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;rhs: &quot;</span> &lt;&lt; offset;</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;      os &lt;&lt; std::endl;</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;    }</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;<span class="preprocessor">#endif // LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;  <span class="keywordflow">if</span> (print_nonlocal)</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;All &quot;</span>;</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;Local &quot;</span>;</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;  os &lt;&lt; <span class="stringliteral">&quot;DoF Constraints:&quot;</span></div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;     &lt;&lt; std::endl;</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; [i, row] : <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>)</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;    {</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;      <span class="comment">// Skip non-local dofs if requested</span></div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;      <span class="keywordflow">if</span> (!print_nonlocal &amp;&amp; !this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">local_index</a>(i))</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;      DofConstraintValueMap::const_iterator rhsit =</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;        <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.find(i);</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> rhs = (rhsit == <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.end()) ?</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;        0 : rhsit-&gt;second;</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;Constraints for DoF &quot;</span> &lt;&lt; i</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;: \t&quot;</span>;</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;      for (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : row)</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;        os &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; item.first &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; item.second &lt;&lt; <span class="stringliteral">&quot;)\t&quot;</span>;</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;rhs: &quot;</span> &lt;&lt; rhs;</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;      os &lt;&lt; std::endl;</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;    }</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> qoi_index = 0,</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;       n_qois = cast_int&lt;unsigned int&gt;(<a class="code" href="classlibMesh_1_1DofMap.html#a376604ef648f92ce79ed7d2c810b55f3">_adjoint_dirichlet_boundaries</a>.size());</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;       qoi_index != n_qois; ++qoi_index)</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;    {</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;Adjoint &quot;</span> &lt;&lt; qoi_index &lt;&lt; <span class="stringliteral">&quot; DoF rhs values:&quot;</span></div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;         &lt;&lt; std::endl;</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;      AdjointDofConstraintValues::const_iterator adjoint_map_it =</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;        <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.find(qoi_index);</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;      <span class="keywordflow">if</span> (adjoint_map_it != <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.end())</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> [i, rhs] : adjoint_map_it-&gt;second)</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;          {</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;            <span class="comment">// Skip non-local dofs if requested</span></div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;            <span class="keywordflow">if</span> (!print_nonlocal &amp;&amp; !this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">local_index</a>(i))</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;              <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;            os &lt;&lt; <span class="stringliteral">&quot;RHS for DoF &quot;</span> &lt;&lt; i</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; rhs;</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;            os &lt;&lt; std::endl;</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;          }</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;    }</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;  <span class="keywordflow">return</span> os.str();</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab6d9ab04643e9028f7f0c9b4d18e0455"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">libMesh::DofMap::local_index</a></div><div class="ttdeci">bool local_index(dof_id_type dof_index) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00831">dof_map.h:831</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02034">dof_map.h:2034</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a376604ef648f92ce79ed7d2c810b55f3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a376604ef648f92ce79ed7d2c810b55f3">libMesh::DofMap::_adjoint_dirichlet_boundaries</a></div><div class="ttdeci">std::vector&lt; std::unique_ptr&lt; DirichletBoundaries &gt; &gt; _adjoint_dirichlet_boundaries</div><div class="ttdoc">Data structure containing Dirichlet functions. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02064">dof_map.h:2064</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02032">dof_map.h:2032</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a0d8f16f2dd1d9a0c1780943811e37c1c"><div class="ttname"><a href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">libMesh::NodeConstraintRow</a></div><div class="ttdeci">std::map&lt; const Node *, Real, std::less&lt; const Node * &gt;, Threads::scalable_allocator&lt; std::pair&lt; const Node *const, Real &gt; &gt; &gt; NodeConstraintRow</div><div class="ttdoc">A row of the Node constraint mapping. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00138">dof_map.h:138</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a8b17bf24a15bc292850c3a3894e2e8f9"><div class="ttname"><a href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">libMesh::Number</a></div><div class="ttdeci">Real Number</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00214">libmesh_common.h:214</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8856db766d722a0edaa9f5c5d94d40f7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">libMesh::DofMap::_node_constraints</a></div><div class="ttdeci">NodeConstraints _node_constraints</div><div class="ttdoc">Data structure containing DofObject constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02041">dof_map.h:2041</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac9cdb6dfd5b60e06a971d96d92eee54e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt;<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&gt;&amp; libMesh::DofMap::get_n_nz </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>A constant reference to the <code>_n_nz</code> list for this processor.</dd></dl>
<p>The vector contains the bandwidth of the on-processor coupling for each row of the global matrix that the current processor owns. This information can be used to preallocate space for a parallel sparse matrix. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00520">520</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01983">_sp</a>.</p>
<div class="fragment"><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  {</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    libmesh_assert(<a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>-&gt;get_n_nz();</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab14c66a56c0815c857dc662bea96f124"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">libMesh::DofMap::_sp</a></div><div class="ttdeci">std::unique_ptr&lt; SparsityPattern::Build &gt; _sp</div><div class="ttdoc">The sparsity pattern of the global matrix. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01983">dof_map.h:1983</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a355cfed88fa20ed5d74349531f17a18b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt;<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&gt;&amp; libMesh::DofMap::get_n_oz </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>A constant reference to the <code>_n_oz</code> list for this processor.</dd></dl>
<p>The vector contains the bandwidth of the off-processor coupling for each row of the global matrix that the current processor owns. This information can be used to preallocate space for a parallel sparse matrix. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00533">533</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01983">_sp</a>.</p>
<div class="fragment"><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    libmesh_assert(<a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>-&gt;get_n_oz();</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab14c66a56c0815c857dc662bea96f124"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">libMesh::DofMap::_sp</a></div><div class="ttdeci">std::unique_ptr&lt; SparsityPattern::Build &gt; _sp</div><div class="ttdoc">The sparsity pattern of the global matrix. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01983">dof_map.h:1983</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad8fbe12a80566efce1259ea93601dc2a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1PeriodicBoundaries.html">PeriodicBoundaries</a>* libMesh::DofMap::get_periodic_boundaries </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01429">1429</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02050">_periodic_boundaries</a>.</p>
<div class="fragment"><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;  {</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>.get();</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;  }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab91693b08a22cfe1af7781287157ac8a"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">libMesh::DofMap::_periodic_boundaries</a></div><div class="ttdeci">std::unique_ptr&lt; PeriodicBoundaries &gt; _periodic_boundaries</div><div class="ttdoc">Data structure containing periodic boundaries. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02050">dof_map.h:2050</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0e1f4efb4c68ffaf232b69a7f5499da8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classlibMesh_1_1PeriodicBoundaries.html">PeriodicBoundaries</a>* libMesh::DofMap::get_periodic_boundaries </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01434">1434</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02050">_periodic_boundaries</a>.</p>
<div class="fragment"><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;  {</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>.get();</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;  }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab91693b08a22cfe1af7781287157ac8a"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">libMesh::DofMap::_periodic_boundaries</a></div><div class="ttdeci">std::unique_ptr&lt; PeriodicBoundaries &gt; _periodic_boundaries</div><div class="ttdoc">Data structure containing periodic boundaries. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02050">dof_map.h:2050</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4b140935368fe85cf0ead6d5a0452c0b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a> &amp; libMesh::DofMap::get_primal_constraint_values </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>A reference to the set of right-hand-side values in primal constraint equations </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02224">2224</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02032">_primal_constraint_values</a>.</p>
<div class="fragment"><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;{</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>;</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02032">dof_map.h:2032</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a31c127241d3271719ede3d0a6902e9e4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt;<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&gt;&amp; libMesh::DofMap::get_send_list </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>A constant reference to the <code>_send_list</code> for this processor.</dd></dl>
<p>The <code>_send_list</code> contains the global indices of all the variables in the global solution vector that influence the current processor. This information can be used for gathers at each solution step to retrieve solution values needed for computation. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00511">511</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01893">_send_list</a>.</p>

<p>参考自 <a class="el" href="dof__map__constraints_8C_source.html#l03285">enforce_adjoint_constraints_exactly()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03113">enforce_constraints_exactly()</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l03203">enforce_constraints_on_residual()</a>.</p>
<div class="fragment"><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>; }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2b3873478d701811b9562b514fc2c369"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">libMesh::DofMap::_send_list</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _send_list</div><div class="ttdoc">A list containing all the global DOF indices that affect the solution on my processor. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01893">dof_map.h:1893</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acfe552841b3b6ae8ad0817adc08961ae"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classlibMesh_1_1SparsityPattern_1_1Build.html">SparsityPattern::Build</a>* libMesh::DofMap::get_sparsity_pattern </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>A constant pointer to the sparsity pattern stored here, once that has been computed. Returns null if no sparsity pattern has yet been computed.</dd></dl>
<p>If need_full_sparsity_pattern is false, the "sparsity pattern" may only own n_nz and n_oz lists. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00548">548</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01983">_sp</a>.</p>

<p>参考自 <a class="el" href="sparse__matrix_8C_source.html#l00058">libMesh::SparseMatrix&lt; T &gt;::attach_dof_map()</a>.</p>
<div class="fragment"><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  {</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>.get();</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab14c66a56c0815c857dc662bea96f124"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">libMesh::DofMap::_sp</a></div><div class="ttdeci">std::unique_ptr&lt; SparsityPattern::Build &gt; _sp</div><div class="ttdoc">The sparsity pattern of the global matrix. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01983">dof_map.h:1983</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a96c57f4ed89dab22d3b1257c595d1dcd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::has_adjoint_dirichlet_boundaries </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>q</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l05470">5470</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02064">_adjoint_dirichlet_boundaries</a>.</p>
<div class="fragment"><div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;{</div>
<div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#a376604ef648f92ce79ed7d2c810b55f3">_adjoint_dirichlet_boundaries</a>.size() &gt; q)</div>
<div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;</div>
<div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a376604ef648f92ce79ed7d2c810b55f3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a376604ef648f92ce79ed7d2c810b55f3">libMesh::DofMap::_adjoint_dirichlet_boundaries</a></div><div class="ttdeci">std::vector&lt; std::unique_ptr&lt; DirichletBoundaries &gt; &gt; _adjoint_dirichlet_boundaries</div><div class="ttdoc">Data structure containing Dirichlet functions. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02064">dof_map.h:2064</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8cd39b3d232f88b53e993010177ecb29"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::has_blocked_representation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd><code>true</code> if the variables are capable of being stored in a blocked form. Presently, this means that there can only be one variable group, and that the group has more than one variable. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00634">634</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l00613">n_variable_groups()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l00621">n_variables()</a>.</p>

<p>参考自 <a class="el" href="dof__map_8h_source.html#l00651">block_size()</a>.</p>
<div class="fragment"><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  {</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <span class="keywordflow">return</span> ((this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a6058ea4ca2ef36bd90f44bcb052a1d1e">n_variable_groups</a>() == 1) &amp;&amp; (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aee89c467613b296c215421d60d5ae961">n_variables</a>() &gt; 1));</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a6058ea4ca2ef36bd90f44bcb052a1d1e"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a6058ea4ca2ef36bd90f44bcb052a1d1e">libMesh::DofMap::n_variable_groups</a></div><div class="ttdeci">unsigned int n_variable_groups() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00613">dof_map.h:613</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aee89c467613b296c215421d60d5ae961"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aee89c467613b296c215421d60d5ae961">libMesh::DofMap::n_variables</a></div><div class="ttdeci">unsigned int n_variables() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00621">dof_map.h:621</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6ea2b1a9e7e0ee6a436f478693e98257"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> libMesh::DofMap::has_heterogeneous_adjoint_constraint </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>qoi_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td>
          <td class="paramname"><em>dof</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The heterogeneous constraint value if the degree of freedom <code>dof</code> has a heterogeneous constraint for adjoint solution <code>qoi_num</code>, zero otherwise. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02203">2203</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02034">_adjoint_constraint_values</a>.</p>

<p>参考自 <a class="el" href="dof__map_8h_source.html#l01099">has_heterogenous_adjoint_constraint()</a>.</p>
<div class="fragment"><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;{</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;  AdjointDofConstraintValues::const_iterator it =</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.find(qoi_num);</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;  <span class="keywordflow">if</span> (it != <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.end())</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;    {</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;      DofConstraintValueMap::const_iterator rhsit =</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;        it-&gt;second.find(dof);</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;      <span class="keywordflow">if</span> (rhsit == it-&gt;second.end())</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;        <span class="keywordflow">return</span> rhsit-&gt;second;</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    }</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02034">dof_map.h:2034</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae298edab0dbe71a35cc29e55990e4580"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::has_heterogeneous_adjoint_constraints </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>qoi_num</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd><code>true</code> if the system has any heterogeneous constraints for adjoint solution <code>qoi_num</code>, <code>false</code> otherwise. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02189">2189</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02034">_adjoint_constraint_values</a>.</p>

<p>参考自 <a class="el" href="dof__map_8h_source.html#l01083">has_heterogenous_adjoint_constraints()</a>.</p>
<div class="fragment"><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;{</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;  AdjointDofConstraintValues::const_iterator it =</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.find(qoi_num);</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;  <span class="keywordflow">if</span> (it == <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.end())</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;  <span class="keywordflow">if</span> (it-&gt;second.empty())</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02034">dof_map.h:2034</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8f0d4a9dfa8ec0f5a69d7535d89afb73"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> libMesh::DofMap::has_heterogenous_adjoint_constraint </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>qoi_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td>
          <td class="paramname"><em>dof</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Backwards compatibility with misspelling. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01099">1099</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02203">has_heterogeneous_adjoint_constraint()</a>.</p>
<div class="fragment"><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  {</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a6ea2b1a9e7e0ee6a436f478693e98257">has_heterogeneous_adjoint_constraint</a> (qoi_num, dof);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a6ea2b1a9e7e0ee6a436f478693e98257"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a6ea2b1a9e7e0ee6a436f478693e98257">libMesh::DofMap::has_heterogeneous_adjoint_constraint</a></div><div class="ttdeci">Number has_heterogeneous_adjoint_constraint(const unsigned int qoi_num, const dof_id_type dof) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02203">dof_map.h:2203</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a313fa92f3f5e620f78746a94298b1008"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::has_heterogenous_adjoint_constraints </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>qoi_num</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Backwards compatibility with misspelling. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01083">1083</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02189">has_heterogeneous_adjoint_constraints()</a>.</p>
<div class="fragment"><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  {</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ae298edab0dbe71a35cc29e55990e4580">has_heterogeneous_adjoint_constraints</a> (qoi_num);</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ae298edab0dbe71a35cc29e55990e4580"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ae298edab0dbe71a35cc29e55990e4580">libMesh::DofMap::has_heterogeneous_adjoint_constraints</a></div><div class="ttdeci">bool has_heterogeneous_adjoint_constraints(const unsigned int qoi_num) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02189">dof_map.h:2189</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a05f3a8cb72bf066c64f9cc19b5d0d139"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::heterogeneously_constrain_element_jacobian_and_residual </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>elem_dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>solution_local</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constrains the element Jacobian and residual. </p>
<p>The element Jacobian is square, and the elem_dofs should correspond to the global DOF indices of both the rows and columns of the element matrix.</p>
<p>The residual-constraining version of this method creates linear systems in which heterogeneously constrained degrees of freedom create non-zero residual terms when not at their correct offset values, as would be appropriate for finding a solution to a nonlinear problem in a quasi-Newton solve.</p>
<p>Note the sign difference from the linear heterogeneous constraint method: Solving u:=u_in-J has the opposite sign convention from u:=K, and we apply heterogeneous constraints accordingly.</p>
<p>The <code>solution</code> vector passed in should be a serialized or ghosted primal solution </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l02635">2635</a> 行定义.</p>

<p>参考 <a class="el" href="dense__matrix__impl_8h_source.html#l00096">libMesh::DenseMatrix&lt; T &gt;::left_multiply_transpose()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00115">libMesh::DenseMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00122">libMesh::DenseMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="dense__matrix__impl_8h_source.html#l00188">libMesh::DenseMatrix&lt; T &gt;::right_multiply()</a>, <a class="el" href="dense__vector_8h_source.html#l00111">libMesh::DenseVector&lt; T &gt;::size()</a>, <a class="el" href="numeric__vector_8h_source.html#l00166">libMesh::NumericVector&lt; T &gt;::type()</a> , 以及 <a class="el" href="dense__matrix__impl_8h_source.html#l00392">libMesh::DenseMatrix&lt; T &gt;::vector_mult_transpose()</a>.</p>
<div class="fragment"><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;{</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;  libmesh_assert_equal_to (elem_dofs.size(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>());</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;  libmesh_assert_equal_to (elem_dofs.size(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>());</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;  libmesh_assert_equal_to (elem_dofs.size(), rhs.<a class="code" href="classlibMesh_1_1DenseVector.html#a06832d76a4df1deb9e45afb9555521d0">size</a>());</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;  libmesh_assert (solution_local.<a class="code" href="classlibMesh_1_1NumericVector.html#a3b6bc13960a5d0022beea138c4e86dc4">type</a>() == SERIAL ||</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;                  solution_local.<a class="code" href="classlibMesh_1_1NumericVector.html#a3b6bc13960a5d0022beea138c4e86dc4">type</a>() == GHOSTED);</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;  <span class="comment">// check for easy return</span></div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.empty())</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;  <span class="comment">// The constrained matrix is built up as C^T K C.</span></div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;  <span class="comment">// The constrained RHS is built up as C^T F</span></div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;  <span class="comment">// Asymmetric residual terms are added if we do not have x = Cx+h</span></div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;  <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> C;</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;  <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> H;</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ad2ed5b18088aa8e52795beaf93cde513">build_constraint_matrix_and_vector</a> (C, H, elem_dofs);</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;hetero_cnstrn_elem_jac_res()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;  <span class="comment">// It is possible that the matrix is not constrained at all.</span></div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;  <span class="keywordflow">if</span> ((C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>() != matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>()) ||</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;      (C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>() != elem_dofs.size()))</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;  <span class="comment">// Compute the matrix-vector product C^T F</span></div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;  <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> old_rhs(rhs);</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;  C.<a class="code" href="classlibMesh_1_1DenseMatrix.html#ace7e590c10044121b6b348c3301e545a">vector_mult_transpose</a>(rhs, old_rhs);</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;  <span class="comment">// Compute the matrix-matrix-matrix product C^T K C</span></div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;  matrix.<a class="code" href="classlibMesh_1_1DenseMatrix.html#aea84b08f2ffc1a36a5a87969287ac865">left_multiply_transpose</a>  (C);</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;  matrix.<a class="code" href="classlibMesh_1_1DenseMatrix.html#aec22afa33a0cc7c64dc20cbb519b8eb0">right_multiply</a> (C);</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;  libmesh_assert_equal_to (matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>());</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;  libmesh_assert_equal_to (matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>(), elem_dofs.size());</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;  libmesh_assert_equal_to (matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>(), elem_dofs.size());</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0,</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;       n_elem_dofs = cast_int&lt;unsigned int&gt;(elem_dofs.size());</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;       i != n_elem_dofs; i++)</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;    {</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> dof_id = elem_dofs[i];</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;      <span class="keyword">const</span> DofConstraints::const_iterator</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;        pos = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(dof_id);</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;      <span class="keywordflow">if</span> (pos != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end())</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;        {</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> j : make_range(matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>()))</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;            matrix(i,j) = 0.;</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;          <span class="comment">// If the DOF is constrained</span></div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;          matrix(i,i) = 1.;</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;          <span class="comment">// This will put a nonsymmetric entry in the constraint</span></div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;          <span class="comment">// row to ensure that the linear system produces the</span></div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;          <span class="comment">// correct value for the constrained DOF.</span></div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; constraint_row = pos-&gt;second;</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : constraint_row)</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j != n_elem_dofs; j++)</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;              <span class="keywordflow">if</span> (elem_dofs[j] == item.first)</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;                matrix(i,j) = -item.second;</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;          <span class="keyword">const</span> DofConstraintValueMap::const_iterator valpos =</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;            <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.find(dof_id);</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;          <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &amp; rhs_val = rhs(i);</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;          rhs_val = (valpos == <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.end()) ?</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;            0 : -valpos-&gt;second;</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;          for (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; [constraining_dof, coef] : constraint_row)</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;            rhs_val -= coef * solution_local(constraining_dof);</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;          rhs_val += solution_local(dof_id);</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;        }</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;    }</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a4fb8c524109fd5dff8c98855437544ee"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">libMesh::DenseMatrixBase::n</a></div><div class="ttdeci">unsigned int n() const </div><div class="ttdoc">返回矩阵的列维度。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00122">dense_matrix_base.h:122</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad2ed5b18088aa8e52795beaf93cde513"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad2ed5b18088aa8e52795beaf93cde513">libMesh::DofMap::build_constraint_matrix_and_vector</a></div><div class="ttdeci">void build_constraint_matrix_and_vector(DenseMatrix&lt; Number &gt; &amp;C, DenseVector&lt; Number &gt; &amp;H, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, int qoi_index=-1, const bool called_recursively=false) const </div><div class="ttdoc">Build the constraint matrix C and the forcing vector H associated with the element degree of freedom ...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l03569">dof_map_constraints.C:3569</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_ace7e590c10044121b6b348c3301e545a"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#ace7e590c10044121b6b348c3301e545a">libMesh::DenseMatrix::vector_mult_transpose</a></div><div class="ttdeci">void vector_mult_transpose(DenseVector&lt; T &gt; &amp;dest, const DenseVector&lt; T &gt; &amp;arg) const </div><div class="ttdoc">执行矩阵-向量乘法，dest := (*this)^T * arg。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00392">dense_matrix_impl.h:392</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a68bd665fb9252382cc9a28df4099d76a"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">libMesh::DenseMatrixBase::m</a></div><div class="ttdeci">unsigned int m() const </div><div class="ttdoc">返回矩阵的行维度。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00115">dense_matrix_base.h:115</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_aec22afa33a0cc7c64dc20cbb519b8eb0"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#aec22afa33a0cc7c64dc20cbb519b8eb0">libMesh::DenseMatrix::right_multiply</a></div><div class="ttdeci">virtual void right_multiply(const DenseMatrixBase&lt; T &gt; &amp;M2) overridefinal</div><div class="ttdoc">右乘以矩阵 M2。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00188">dense_matrix_impl.h:188</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_aea84b08f2ffc1a36a5a87969287ac865"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#aea84b08f2ffc1a36a5a87969287ac865">libMesh::DenseMatrix::left_multiply_transpose</a></div><div class="ttdeci">void left_multiply_transpose(const DenseMatrix&lt; T &gt; &amp;A)</div><div class="ttdoc">用矩阵 A 的转置左乘。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00096">dense_matrix_impl.h:96</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02032">dof_map.h:2032</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdoc">A row of the Dof constraint matrix. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00090">dof_map.h:90</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a3b6bc13960a5d0022beea138c4e86dc4"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a3b6bc13960a5d0022beea138c4e86dc4">libMesh::NumericVector::type</a></div><div class="ttdeci">ParallelType type() const </div><div class="ttdoc">获取向量的类型。 </div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8h_source.html#l00166">numeric_vector.h:166</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseVector_html"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html">libMesh::DenseVector</a></div><div class="ttdoc">定义用于有限元计算的稠密向量类。该类基本上是为了补充 DenseMatrix 类而设计的。 它相对于 std::vector 具有额外的功能，使其在有限元中特别有用，特别是对于方程组。 所有重写的虚拟函...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00064">dof_map.h:64</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a8b17bf24a15bc292850c3a3894e2e8f9"><div class="ttname"><a href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">libMesh::Number</a></div><div class="ttdeci">Real Number</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00214">libmesh_common.h:214</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html">libMesh::DenseMatrix</a></div><div class="ttdoc">定义用于有限元类型计算的密集矩阵。 用于在求和成全局矩阵之前存储单元刚度矩阵。所有被覆盖的虚函数都记录在dense_matrix_base.h中。 </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00065">dof_map.h:65</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseVector_html_a06832d76a4df1deb9e45afb9555521d0"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html#a06832d76a4df1deb9e45afb9555521d0">libMesh::DenseVector::size</a></div><div class="ttdeci">virtual unsigned int size() const overridefinal</div><div class="ttdef"><b>Definition:</b> <a href="dense__vector_8h_source.html#l00111">dense_vector.h:111</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a41e6fec77b9c1b0a7628420b61966749"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::heterogeneously_constrain_element_matrix_and_vector </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>elem_dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>asymmetric_constraint_rows</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qoi_index</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constrains the element matrix and vector. </p>
<p>This method requires the element matrix to be square, in which case the elem_dofs correspond to the global DOF indices of both the rows and columns of the element matrix. For this case the rows and columns of the matrix necessarily correspond to variables of the same approximation order.</p>
<p>The heterogeneous version of this method creates linear systems in which heterogeneously constrained degrees of freedom will solve to their correct offset values, as would be appropriate for finding a solution to a linear problem in a single algebraic solve. The non-heterogeneous version of this method creates linear systems in which even heterogeneously constrained degrees of freedom are solved without offset values taken into account, as would be appropriate for finding linearized updates to a solution in which heterogeneous constraints are already satisfied.</p>
<p>By default, the constraints for the primal solution of this system are used. If a non-negative <code>qoi_index</code> is passed in, then the constraints for the corresponding adjoint solution are used instead. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l02529">2529</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02034">_adjoint_constraint_values</a>, <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>, <a class="el" href="dof__map_8h_source.html#l02032">_primal_constraint_values</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03569">build_constraint_matrix_and_vector()</a>, <a class="el" href="dof__map_8h_source.html#l02179">is_constrained_dof()</a>, <a class="el" href="dense__matrix__impl_8h_source.html#l00096">libMesh::DenseMatrix&lt; T &gt;::left_multiply_transpose()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00115">libMesh::DenseMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00122">libMesh::DenseMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="dense__matrix__impl_8h_source.html#l00188">libMesh::DenseMatrix&lt; T &gt;::right_multiply()</a>, <a class="el" href="dense__vector_8h_source.html#l00111">libMesh::DenseVector&lt; T &gt;::size()</a>, <a class="el" href="dense__matrix__impl_8h_source.html#l00326">libMesh::DenseMatrix&lt; T &gt;::vector_mult()</a> , 以及 <a class="el" href="dense__matrix__impl_8h_source.html#l00392">libMesh::DenseMatrix&lt; T &gt;::vector_mult_transpose()</a>.</p>

<p>参考自 <a class="el" href="dof__map_8h_source.html#l01234">heterogenously_constrain_element_matrix_and_vector()</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l01898">process_mesh_constraint_rows()</a>.</p>
<div class="fragment"><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;{</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;  libmesh_assert_equal_to (elem_dofs.size(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>());</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;  libmesh_assert_equal_to (elem_dofs.size(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>());</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;  libmesh_assert_equal_to (elem_dofs.size(), rhs.<a class="code" href="classlibMesh_1_1DenseVector.html#a06832d76a4df1deb9e45afb9555521d0">size</a>());</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;  <span class="comment">// check for easy return</span></div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.empty())</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;  <span class="comment">// The constrained matrix is built up as C^T K C.</span></div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;  <span class="comment">// The constrained RHS is built up as C^T (F - K H)</span></div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;  <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> C;</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;  <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> H;</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ad2ed5b18088aa8e52795beaf93cde513">build_constraint_matrix_and_vector</a> (C, H, elem_dofs, qoi_index);</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;hetero_cnstrn_elem_mat_vec()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;  <span class="comment">// It is possible that the matrix is not constrained at all.</span></div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;  <span class="keywordflow">if</span> ((C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>() == matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>()) &amp;&amp;</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;      (C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>() == elem_dofs.size())) <span class="comment">// It the matrix is constrained</span></div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;    {</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;      <span class="comment">// We may have rhs values to use later</span></div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;      <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a> * rhs_values = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;      <span class="keywordflow">if</span> (qoi_index &lt; 0)</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;        rhs_values = &amp;<a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>;</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;        {</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;          <span class="keyword">const</span> AdjointDofConstraintValues::const_iterator</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;            it = <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.find(qoi_index);</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;          <span class="keywordflow">if</span> (it != <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.end())</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;            rhs_values = &amp;it-&gt;second;</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;        }</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;      <span class="comment">// Compute matrix/vector product K H</span></div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;      <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> KH;</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;      matrix.<a class="code" href="classlibMesh_1_1DenseMatrix.html#a493649f63f70ca2adeaee645e26a4677">vector_mult</a>(KH, H);</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;      <span class="comment">// Compute the matrix-vector product C^T (F - KH)</span></div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;      <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> F_minus_KH(rhs);</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;      F_minus_KH -= KH;</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;      C.<a class="code" href="classlibMesh_1_1DenseMatrix.html#ace7e590c10044121b6b348c3301e545a">vector_mult_transpose</a>(rhs, F_minus_KH);</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;      <span class="comment">// Compute the matrix-matrix-matrix product C^T K C</span></div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;      matrix.<a class="code" href="classlibMesh_1_1DenseMatrix.html#aea84b08f2ffc1a36a5a87969287ac865">left_multiply_transpose</a>  (C);</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;      matrix.<a class="code" href="classlibMesh_1_1DenseMatrix.html#aec22afa33a0cc7c64dc20cbb519b8eb0">right_multiply</a> (C);</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;      libmesh_assert_equal_to (matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>());</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;      libmesh_assert_equal_to (matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>(), elem_dofs.size());</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;      libmesh_assert_equal_to (matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>(), elem_dofs.size());</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0,</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;           n_elem_dofs = cast_int&lt;unsigned int&gt;(elem_dofs.size());</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;           i != n_elem_dofs; i++)</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;        {</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> dof_id = elem_dofs[i];</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;          <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">is_constrained_dof</a>(dof_id))</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;            {</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;              <span class="keywordflow">for</span> (<span class="keyword">auto</span> j : make_range(matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>()))</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;                matrix(i,j) = 0.;</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;              <span class="comment">// If the DOF is constrained</span></div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;              matrix(i,i) = 1.;</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;              <span class="comment">// This will put a nonsymmetric entry in the constraint</span></div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;              <span class="comment">// row to ensure that the linear system produces the</span></div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;              <span class="comment">// correct value for the constrained DOF.</span></div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;              <span class="keywordflow">if</span> (asymmetric_constraint_rows)</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;                {</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;                  DofConstraints::const_iterator</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;                    pos = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(dof_id);</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;                  libmesh_assert (pos != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end());</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;                  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; constraint_row = pos-&gt;second;</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;                  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : constraint_row)</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0; j != n_elem_dofs; j++)</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;                      <span class="keywordflow">if</span> (elem_dofs[j] == item.first)</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;                        matrix(i,j) = -item.second;</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;                  <span class="keywordflow">if</span> (rhs_values)</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;                    {</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;                      <span class="keyword">const</span> DofConstraintValueMap::const_iterator valpos =</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;                        rhs_values-&gt;find(dof_id);</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;                      rhs(i) = (valpos == rhs_values-&gt;end()) ?</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;                        0 : valpos-&gt;second;</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;                    }</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;                }</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;                rhs(i) = 0.;</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;            }</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;        }</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;    } <span class="comment">// end if is constrained...</span></div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a4fb8c524109fd5dff8c98855437544ee"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">libMesh::DenseMatrixBase::n</a></div><div class="ttdeci">unsigned int n() const </div><div class="ttdoc">返回矩阵的列维度。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00122">dense_matrix_base.h:122</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad2ed5b18088aa8e52795beaf93cde513"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad2ed5b18088aa8e52795beaf93cde513">libMesh::DofMap::build_constraint_matrix_and_vector</a></div><div class="ttdeci">void build_constraint_matrix_and_vector(DenseMatrix&lt; Number &gt; &amp;C, DenseVector&lt; Number &gt; &amp;H, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, int qoi_index=-1, const bool called_recursively=false) const </div><div class="ttdoc">Build the constraint matrix C and the forcing vector H associated with the element degree of freedom ...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l03569">dof_map_constraints.C:3569</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_ace7e590c10044121b6b348c3301e545a"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#ace7e590c10044121b6b348c3301e545a">libMesh::DenseMatrix::vector_mult_transpose</a></div><div class="ttdeci">void vector_mult_transpose(DenseVector&lt; T &gt; &amp;dest, const DenseVector&lt; T &gt; &amp;arg) const </div><div class="ttdoc">执行矩阵-向量乘法，dest := (*this)^T * arg。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00392">dense_matrix_impl.h:392</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02034">dof_map.h:2034</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9846273ba4930ef0364bc1fc954af914"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02179">dof_map.h:2179</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a68bd665fb9252382cc9a28df4099d76a"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">libMesh::DenseMatrixBase::m</a></div><div class="ttdeci">unsigned int m() const </div><div class="ttdoc">返回矩阵的行维度。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00115">dense_matrix_base.h:115</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_aec22afa33a0cc7c64dc20cbb519b8eb0"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#aec22afa33a0cc7c64dc20cbb519b8eb0">libMesh::DenseMatrix::right_multiply</a></div><div class="ttdeci">virtual void right_multiply(const DenseMatrixBase&lt; T &gt; &amp;M2) overridefinal</div><div class="ttdoc">右乘以矩阵 M2。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00188">dense_matrix_impl.h:188</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofConstraintValueMap_html"><div class="ttname"><a href="classlibMesh_1_1DofConstraintValueMap.html">libMesh::DofConstraintValueMap</a></div><div class="ttdoc">Storage for DofConstraint right hand sides for a particular problem. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00110">dof_map.h:110</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_aea84b08f2ffc1a36a5a87969287ac865"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#aea84b08f2ffc1a36a5a87969287ac865">libMesh::DenseMatrix::left_multiply_transpose</a></div><div class="ttdeci">void left_multiply_transpose(const DenseMatrix&lt; T &gt; &amp;A)</div><div class="ttdoc">用矩阵 A 的转置左乘。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00096">dense_matrix_impl.h:96</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02032">dof_map.h:2032</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdoc">A row of the Dof constraint matrix. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00090">dof_map.h:90</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseVector_html"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html">libMesh::DenseVector</a></div><div class="ttdoc">定义用于有限元计算的稠密向量类。该类基本上是为了补充 DenseMatrix 类而设计的。 它相对于 std::vector 具有额外的功能，使其在有限元中特别有用，特别是对于方程组。 所有重写的虚拟函...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00064">dof_map.h:64</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_a493649f63f70ca2adeaee645e26a4677"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#a493649f63f70ca2adeaee645e26a4677">libMesh::DenseMatrix::vector_mult</a></div><div class="ttdeci">void vector_mult(DenseVector&lt; T &gt; &amp;dest, const DenseVector&lt; T &gt; &amp;arg) const </div><div class="ttdoc">执行矩阵-向量乘法，dest := (*this) * arg。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00326">dense_matrix_impl.h:326</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html">libMesh::DenseMatrix</a></div><div class="ttdoc">定义用于有限元类型计算的密集矩阵。 用于在求和成全局矩阵之前存储单元刚度矩阵。所有被覆盖的虚函数都记录在dense_matrix_base.h中。 </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00065">dof_map.h:65</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseVector_html_a06832d76a4df1deb9e45afb9555521d0"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html#a06832d76a4df1deb9e45afb9555521d0">libMesh::DenseVector::size</a></div><div class="ttdeci">virtual unsigned int size() const overridefinal</div><div class="ttdef"><b>Definition:</b> <a href="dense__vector_8h_source.html#l00111">dense_vector.h:111</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aca6a247a0b3e914b3093b7c28014c46f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::heterogeneously_constrain_element_residual </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>elem_dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>solution_local</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constrains the element residual. </p>
<p>The element Jacobian is square, and the elem_dofs should correspond to the global DOF indices of both the rows and columns of the element matrix.</p>
<p>The residual-constraining version of this method creates linear systems in which heterogeneously constrained degrees of freedom create non-zero residual terms when not at their correct offset values, as would be appropriate for finding a solution to a nonlinear problem in a quasi-Newton solve.</p>
<p>The <code>solution</code> vector passed in should be a serialized or ghosted primal solution </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l02720">2720</a> 行定义.</p>

<p>参考 <a class="el" href="dense__matrix__base_8h_source.html#l00115">libMesh::DenseMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00122">libMesh::DenseMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="dense__vector_8h_source.html#l00111">libMesh::DenseVector&lt; T &gt;::size()</a>, <a class="el" href="numeric__vector_8h_source.html#l00166">libMesh::NumericVector&lt; T &gt;::type()</a> , 以及 <a class="el" href="dense__matrix__impl_8h_source.html#l00392">libMesh::DenseMatrix&lt; T &gt;::vector_mult_transpose()</a>.</p>
<div class="fragment"><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;{</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;  libmesh_assert_equal_to (elem_dofs.size(), rhs.<a class="code" href="classlibMesh_1_1DenseVector.html#a06832d76a4df1deb9e45afb9555521d0">size</a>());</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;  libmesh_assert (solution_local.<a class="code" href="classlibMesh_1_1NumericVector.html#a3b6bc13960a5d0022beea138c4e86dc4">type</a>() == SERIAL ||</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;                  solution_local.<a class="code" href="classlibMesh_1_1NumericVector.html#a3b6bc13960a5d0022beea138c4e86dc4">type</a>() == GHOSTED);</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;  <span class="comment">// check for easy return</span></div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.empty())</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;  <span class="comment">// The constrained RHS is built up as C^T F</span></div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;  <span class="comment">// Asymmetric residual terms are added if we do not have x = Cx+h</span></div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;  <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> C;</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;  <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> H;</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ad2ed5b18088aa8e52795beaf93cde513">build_constraint_matrix_and_vector</a> (C, H, elem_dofs);</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;hetero_cnstrn_elem_res()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;  <span class="comment">// It is possible that the element is not constrained at all.</span></div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;  <span class="keywordflow">if</span> ((C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>() != rhs.<a class="code" href="classlibMesh_1_1DenseVector.html#a06832d76a4df1deb9e45afb9555521d0">size</a>()) ||</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;      (C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>() != elem_dofs.size()))</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;  <span class="comment">// Compute the matrix-vector product C^T F</span></div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;  <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> old_rhs(rhs);</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;  C.<a class="code" href="classlibMesh_1_1DenseMatrix.html#ace7e590c10044121b6b348c3301e545a">vector_mult_transpose</a>(rhs, old_rhs);</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0,</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;       n_elem_dofs = cast_int&lt;unsigned int&gt;(elem_dofs.size());</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;       i != n_elem_dofs; i++)</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;    {</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> dof_id = elem_dofs[i];</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;      <span class="keyword">const</span> DofConstraints::const_iterator</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;        pos = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(dof_id);</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;      <span class="keywordflow">if</span> (pos != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end())</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;        {</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;          <span class="comment">// This will put a nonsymmetric entry in the constraint</span></div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;          <span class="comment">// row to ensure that the linear system produces the</span></div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;          <span class="comment">// correct value for the constrained DOF.</span></div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; constraint_row = pos-&gt;second;</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;          <span class="keyword">const</span> DofConstraintValueMap::const_iterator valpos =</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;            <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.find(dof_id);</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;          <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &amp; rhs_val = rhs(i);</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;          rhs_val = (valpos == <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.end()) ?</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;            0 : -valpos-&gt;second;</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;          for (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; [constraining_dof, coef] : constraint_row)</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;            rhs_val -= coef * solution_local(constraining_dof);</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;          rhs_val += solution_local(dof_id);</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;        }</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;    }</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a4fb8c524109fd5dff8c98855437544ee"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">libMesh::DenseMatrixBase::n</a></div><div class="ttdeci">unsigned int n() const </div><div class="ttdoc">返回矩阵的列维度。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00122">dense_matrix_base.h:122</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad2ed5b18088aa8e52795beaf93cde513"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad2ed5b18088aa8e52795beaf93cde513">libMesh::DofMap::build_constraint_matrix_and_vector</a></div><div class="ttdeci">void build_constraint_matrix_and_vector(DenseMatrix&lt; Number &gt; &amp;C, DenseVector&lt; Number &gt; &amp;H, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, int qoi_index=-1, const bool called_recursively=false) const </div><div class="ttdoc">Build the constraint matrix C and the forcing vector H associated with the element degree of freedom ...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l03569">dof_map_constraints.C:3569</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_ace7e590c10044121b6b348c3301e545a"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#ace7e590c10044121b6b348c3301e545a">libMesh::DenseMatrix::vector_mult_transpose</a></div><div class="ttdeci">void vector_mult_transpose(DenseVector&lt; T &gt; &amp;dest, const DenseVector&lt; T &gt; &amp;arg) const </div><div class="ttdoc">执行矩阵-向量乘法，dest := (*this)^T * arg。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00392">dense_matrix_impl.h:392</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a68bd665fb9252382cc9a28df4099d76a"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">libMesh::DenseMatrixBase::m</a></div><div class="ttdeci">unsigned int m() const </div><div class="ttdoc">返回矩阵的行维度。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00115">dense_matrix_base.h:115</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02032">dof_map.h:2032</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdoc">A row of the Dof constraint matrix. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00090">dof_map.h:90</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a3b6bc13960a5d0022beea138c4e86dc4"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a3b6bc13960a5d0022beea138c4e86dc4">libMesh::NumericVector::type</a></div><div class="ttdeci">ParallelType type() const </div><div class="ttdoc">获取向量的类型。 </div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8h_source.html#l00166">numeric_vector.h:166</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseVector_html"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html">libMesh::DenseVector</a></div><div class="ttdoc">定义用于有限元计算的稠密向量类。该类基本上是为了补充 DenseMatrix 类而设计的。 它相对于 std::vector 具有额外的功能，使其在有限元中特别有用，特别是对于方程组。 所有重写的虚拟函...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00064">dof_map.h:64</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a8b17bf24a15bc292850c3a3894e2e8f9"><div class="ttname"><a href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">libMesh::Number</a></div><div class="ttdeci">Real Number</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00214">libmesh_common.h:214</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html">libMesh::DenseMatrix</a></div><div class="ttdoc">定义用于有限元类型计算的密集矩阵。 用于在求和成全局矩阵之前存储单元刚度矩阵。所有被覆盖的虚函数都记录在dense_matrix_base.h中。 </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00065">dof_map.h:65</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseVector_html_a06832d76a4df1deb9e45afb9555521d0"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html#a06832d76a4df1deb9e45afb9555521d0">libMesh::DenseVector::size</a></div><div class="ttdeci">virtual unsigned int size() const overridefinal</div><div class="ttdef"><b>Definition:</b> <a href="dense__vector_8h_source.html#l00111">dense_vector.h:111</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adb5c11b2b264f019b221f737cf16a819"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::heterogeneously_constrain_element_vector </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>elem_dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>asymmetric_constraint_rows</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qoi_index</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constrains the element vector. </p>
<p>This method requires the element matrix to be square and not-yet-constrained, in which case the elem_dofs correspond to the global DOF indices of both the rows and columns of the element matrix.</p>
<p>The heterogeneous version of this method creates linear systems in which heterogeneously constrained degrees of freedom will solve to their correct offset values, as would be appropriate for finding a solution to a linear problem in a single algebraic solve. The non-heterogeneous version of this method creates linear systems in which even heterogeneously constrained degrees of freedom are solved without offset values taken into account, as would be appropriate for finding linearized updates to a solution in which heterogeneous constraints are already satisfied.</p>
<p>Note the sign difference from the nonlinear heterogeneous constraint method: Solving u:=K has the opposite sign convention from u:=u_in-J, and we apply heterogeneous constraints accordingly.</p>
<p>By default, the constraints for the primal solution of this system are used. If a non-negative <code>qoi_index</code> is passed in, then the constraints for the corresponding adjoint solution are used instead. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l02836">2836</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02034">_adjoint_constraint_values</a>, <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>, <a class="el" href="dof__map_8h_source.html#l02032">_primal_constraint_values</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03569">build_constraint_matrix_and_vector()</a>, <a class="el" href="dof__map_8h_source.html#l02179">is_constrained_dof()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00115">libMesh::DenseMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00122">libMesh::DenseMatrixBase&lt; T &gt;::n()</a>, <a class="el" href="dense__vector_8h_source.html#l00111">libMesh::DenseVector&lt; T &gt;::size()</a>, <a class="el" href="dense__matrix__impl_8h_source.html#l00326">libMesh::DenseMatrix&lt; T &gt;::vector_mult()</a> , 以及 <a class="el" href="dense__matrix__impl_8h_source.html#l00392">libMesh::DenseMatrix&lt; T &gt;::vector_mult_transpose()</a>.</p>

<p>参考自 <a class="el" href="dof__map_8h_source.html#l01278">heterogenously_constrain_element_vector()</a>.</p>
<div class="fragment"><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;{</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;  libmesh_assert_equal_to (elem_dofs.size(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>());</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;  libmesh_assert_equal_to (elem_dofs.size(), matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>());</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;  libmesh_assert_equal_to (elem_dofs.size(), rhs.<a class="code" href="classlibMesh_1_1DenseVector.html#a06832d76a4df1deb9e45afb9555521d0">size</a>());</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;  <span class="comment">// check for easy return</span></div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.empty())</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;  <span class="comment">// The constrained matrix is built up as C^T K C.</span></div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;  <span class="comment">// The constrained RHS is built up as C^T (F - K H)</span></div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;  <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> C;</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;  <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> H;</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ad2ed5b18088aa8e52795beaf93cde513">build_constraint_matrix_and_vector</a> (C, H, elem_dofs, qoi_index);</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;hetero_cnstrn_elem_vec()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;  <span class="comment">// It is possible that the matrix is not constrained at all.</span></div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;  <span class="keywordflow">if</span> ((C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>() == matrix.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>()) &amp;&amp;</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;      (C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>() == elem_dofs.size())) <span class="comment">// It the matrix is constrained</span></div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;    {</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;      <span class="comment">// We may have rhs values to use later</span></div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;      <span class="keyword">const</span> <a class="code" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a> * rhs_values = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;      <span class="keywordflow">if</span> (qoi_index &lt; 0)</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;        rhs_values = &amp;<a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>;</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;        {</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;          <span class="keyword">const</span> AdjointDofConstraintValues::const_iterator</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;            it = <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.find(qoi_index);</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;          <span class="keywordflow">if</span> (it != <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.end())</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;            rhs_values = &amp;it-&gt;second;</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;        }</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;      <span class="comment">// Compute matrix/vector product K H</span></div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;      <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> KH;</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;      matrix.<a class="code" href="classlibMesh_1_1DenseMatrix.html#a493649f63f70ca2adeaee645e26a4677">vector_mult</a>(KH, H);</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;      <span class="comment">// Compute the matrix-vector product C^T (F - KH)</span></div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;      <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> F_minus_KH(rhs);</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;      F_minus_KH -= KH;</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;      C.<a class="code" href="classlibMesh_1_1DenseMatrix.html#ace7e590c10044121b6b348c3301e545a">vector_mult_transpose</a>(rhs, F_minus_KH);</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0,</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;           n_elem_dofs = cast_int&lt;unsigned int&gt;(elem_dofs.size());</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;           i != n_elem_dofs; i++)</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;        {</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> dof_id = elem_dofs[i];</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;          <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">is_constrained_dof</a>(dof_id))</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;            {</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;              <span class="comment">// This will put a nonsymmetric entry in the constraint</span></div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;              <span class="comment">// row to ensure that the linear system produces the</span></div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;              <span class="comment">// correct value for the constrained DOF.</span></div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;              <span class="keywordflow">if</span> (asymmetric_constraint_rows &amp;&amp; rhs_values)</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;                {</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;                  <span class="keyword">const</span> DofConstraintValueMap::const_iterator valpos =</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;                    rhs_values-&gt;find(dof_id);</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;                  rhs(i) = (valpos == rhs_values-&gt;end()) ?</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;                    0 : valpos-&gt;second;</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;                }</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;                rhs(i) = 0.;</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;            }</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;        }</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;    } <span class="comment">// end if is constrained...</span></div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a4fb8c524109fd5dff8c98855437544ee"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">libMesh::DenseMatrixBase::n</a></div><div class="ttdeci">unsigned int n() const </div><div class="ttdoc">返回矩阵的列维度。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00122">dense_matrix_base.h:122</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad2ed5b18088aa8e52795beaf93cde513"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad2ed5b18088aa8e52795beaf93cde513">libMesh::DofMap::build_constraint_matrix_and_vector</a></div><div class="ttdeci">void build_constraint_matrix_and_vector(DenseMatrix&lt; Number &gt; &amp;C, DenseVector&lt; Number &gt; &amp;H, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, int qoi_index=-1, const bool called_recursively=false) const </div><div class="ttdoc">Build the constraint matrix C and the forcing vector H associated with the element degree of freedom ...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l03569">dof_map_constraints.C:3569</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_ace7e590c10044121b6b348c3301e545a"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#ace7e590c10044121b6b348c3301e545a">libMesh::DenseMatrix::vector_mult_transpose</a></div><div class="ttdeci">void vector_mult_transpose(DenseVector&lt; T &gt; &amp;dest, const DenseVector&lt; T &gt; &amp;arg) const </div><div class="ttdoc">执行矩阵-向量乘法，dest := (*this)^T * arg。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00392">dense_matrix_impl.h:392</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02034">dof_map.h:2034</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9846273ba4930ef0364bc1fc954af914"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02179">dof_map.h:2179</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a68bd665fb9252382cc9a28df4099d76a"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">libMesh::DenseMatrixBase::m</a></div><div class="ttdeci">unsigned int m() const </div><div class="ttdoc">返回矩阵的行维度。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00115">dense_matrix_base.h:115</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofConstraintValueMap_html"><div class="ttname"><a href="classlibMesh_1_1DofConstraintValueMap.html">libMesh::DofConstraintValueMap</a></div><div class="ttdoc">Storage for DofConstraint right hand sides for a particular problem. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00110">dof_map.h:110</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02032">dof_map.h:2032</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseVector_html"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html">libMesh::DenseVector</a></div><div class="ttdoc">定义用于有限元计算的稠密向量类。该类基本上是为了补充 DenseMatrix 类而设计的。 它相对于 std::vector 具有额外的功能，使其在有限元中特别有用，特别是对于方程组。 所有重写的虚拟函...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00064">dof_map.h:64</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html_a493649f63f70ca2adeaee645e26a4677"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html#a493649f63f70ca2adeaee645e26a4677">libMesh::DenseMatrix::vector_mult</a></div><div class="ttdeci">void vector_mult(DenseVector&lt; T &gt; &amp;dest, const DenseVector&lt; T &gt; &amp;arg) const </div><div class="ttdoc">执行矩阵-向量乘法，dest := (*this) * arg。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__impl_8h_source.html#l00326">dense_matrix_impl.h:326</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html">libMesh::DenseMatrix</a></div><div class="ttdoc">定义用于有限元类型计算的密集矩阵。 用于在求和成全局矩阵之前存储单元刚度矩阵。所有被覆盖的虚函数都记录在dense_matrix_base.h中。 </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00065">dof_map.h:65</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseVector_html_a06832d76a4df1deb9e45afb9555521d0"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html#a06832d76a4df1deb9e45afb9555521d0">libMesh::DenseVector::size</a></div><div class="ttdeci">virtual unsigned int size() const overridefinal</div><div class="ttdef"><b>Definition:</b> <a href="dense__vector_8h_source.html#l00111">dense_vector.h:111</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5d15c198fea09321f4627a0fc27538cf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::heterogenously_constrain_element_matrix_and_vector </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>elem_dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>asymmetric_constraint_rows</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qoi_index</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01234">1234</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map__constraints_8C_source.html#l02529">heterogeneously_constrain_element_matrix_and_vector()</a>.</p>
<div class="fragment"><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;  {</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a41e6fec77b9c1b0a7628420b61966749">heterogeneously_constrain_element_matrix_and_vector</a></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;      (matrix, rhs, elem_dofs, asymmetric_constraint_rows, qoi_index);</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a41e6fec77b9c1b0a7628420b61966749"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a41e6fec77b9c1b0a7628420b61966749">libMesh::DofMap::heterogeneously_constrain_element_matrix_and_vector</a></div><div class="ttdeci">void heterogeneously_constrain_element_matrix_and_vector(DenseMatrix&lt; Number &gt; &amp;matrix, DenseVector&lt; Number &gt; &amp;rhs, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, bool asymmetric_constraint_rows=true, int qoi_index=-1) const </div><div class="ttdoc">Constrains the element matrix and vector. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l02529">dof_map_constraints.C:2529</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa86c932ce47e056bd16607889f5c730e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::heterogenously_constrain_element_vector </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DenseVector.html">DenseVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>elem_dofs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>asymmetric_constraint_rows</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qoi_index</em> = <code>-1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01278">1278</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map__constraints_8C_source.html#l02836">heterogeneously_constrain_element_vector()</a>.</p>
<div class="fragment"><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  {</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="keywordflow">return</span> this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#adb5c11b2b264f019b221f737cf16a819">heterogeneously_constrain_element_vector</a></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;      (matrix, rhs, elem_dofs, asymmetric_constraint_rows, qoi_index);</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_adb5c11b2b264f019b221f737cf16a819"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#adb5c11b2b264f019b221f737cf16a819">libMesh::DofMap::heterogeneously_constrain_element_vector</a></div><div class="ttdeci">void heterogeneously_constrain_element_vector(const DenseMatrix&lt; Number &gt; &amp;matrix, DenseVector&lt; Number &gt; &amp;rhs, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, bool asymmetric_constraint_rows=true, int qoi_index=-1) const </div><div class="ttdoc">Constrains the element vector. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l02836">dof_map_constraints.C:2836</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af0cd2f1fbd46c66dade1e750436ee7ab"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::ReferenceCounter::increment_constructor_count </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">noexcept</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Increments the construction counter. </p>
<p>Should be called in the constructor of any derived class that will be reference counted. </p>

<p>在文件 <a class="el" href="reference__counter_8h_source.html">reference_counter.h</a> 第 <a class="el" href="reference__counter_8h_source.html#l00183">183</a> 行定义.</p>

<p>参考 <a class="el" href="namespacelibMesh.html#ab0817b8542b150bfa3fb23393df99f28">libMesh::err</a>.</p>

<p>参考自 <a class="el" href="reference__counted__object_8h_source.html#l00074">libMesh::ReferenceCountedObject&lt; SparseMatrix&lt; T &gt; &gt;::ReferenceCountedObject()</a>.</p>
<div class="fragment"><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;{</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  libmesh_try</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    Threads::spin_mutex::scoped_lock lock(Threads::spin_mtx);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    std::pair&lt;unsigned int, unsigned int&gt; &amp; p = <a class="code" href="classlibMesh_1_1ReferenceCounter.html#a7c913252d05560f8bc7c75a63547c4c3">_counts</a>[name];</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    p.first++;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  libmesh_catch (...)</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keyword">auto</span> stream = <a class="code" href="namespacelibMesh.html#ab0817b8542b150bfa3fb23393df99f28">libMesh::err</a>.get();</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    stream-&gt;exceptions(stream-&gt;goodbit); <span class="comment">// stream must not throw</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="namespacelibMesh.html#ab0817b8542b150bfa3fb23393df99f28">libMesh::err</a> &lt;&lt; <span class="stringliteral">&quot;Encountered unrecoverable error while calling &quot;</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;ReferenceCounter::increment_constructor_count() &quot;</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;for a(n) &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; object.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    std::terminate();</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_ab0817b8542b150bfa3fb23393df99f28"><div class="ttname"><a href="namespacelibMesh.html#ab0817b8542b150bfa3fb23393df99f28">libMesh::err</a></div><div class="ttdeci">OStreamProxy err</div></div>
<div class="ttc" id="classlibMesh_1_1ReferenceCounter_html_a7c913252d05560f8bc7c75a63547c4c3"><div class="ttname"><a href="classlibMesh_1_1ReferenceCounter.html#a7c913252d05560f8bc7c75a63547c4c3">libMesh::ReferenceCounter::_counts</a></div><div class="ttdeci">static Counts _counts</div><div class="ttdoc">Actually holds the data. </div><div class="ttdef"><b>Definition:</b> <a href="reference__counter_8h_source.html#l00124">reference_counter.h:124</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a769ddb2e2299db1aafcdfb33dfb830d8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::ReferenceCounter::increment_destructor_count </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">noexcept</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Increments the destruction counter. </p>
<p>Should be called in the destructor of any derived class that will be reference counted. </p>

<p>在文件 <a class="el" href="reference__counter_8h_source.html">reference_counter.h</a> 第 <a class="el" href="reference__counter_8h_source.html#l00207">207</a> 行定义.</p>

<p>参考 <a class="el" href="namespacelibMesh.html#ab0817b8542b150bfa3fb23393df99f28">libMesh::err</a>.</p>

<p>参考自 <a class="el" href="reference__counted__object_8h_source.html#l00127">libMesh::ReferenceCountedObject&lt; SparseMatrix&lt; T &gt; &gt;::~ReferenceCountedObject()</a>.</p>
<div class="fragment"><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;{</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  libmesh_try</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    Threads::spin_mutex::scoped_lock lock(Threads::spin_mtx);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    std::pair&lt;unsigned int, unsigned int&gt; &amp; p = <a class="code" href="classlibMesh_1_1ReferenceCounter.html#a7c913252d05560f8bc7c75a63547c4c3">_counts</a>[name];</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    p.second++;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  libmesh_catch (...)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keyword">auto</span> stream = <a class="code" href="namespacelibMesh.html#ab0817b8542b150bfa3fb23393df99f28">libMesh::err</a>.get();</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    stream-&gt;exceptions(stream-&gt;goodbit); <span class="comment">// stream must not throw</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="namespacelibMesh.html#ab0817b8542b150bfa3fb23393df99f28">libMesh::err</a> &lt;&lt; <span class="stringliteral">&quot;Encountered unrecoverable error while calling &quot;</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;ReferenceCounter::increment_destructor_count() &quot;</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;for a(n) &quot;</span> &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot; object.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    std::terminate();</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_ab0817b8542b150bfa3fb23393df99f28"><div class="ttname"><a href="namespacelibMesh.html#ab0817b8542b150bfa3fb23393df99f28">libMesh::err</a></div><div class="ttdeci">OStreamProxy err</div></div>
<div class="ttc" id="classlibMesh_1_1ReferenceCounter_html_a7c913252d05560f8bc7c75a63547c4c3"><div class="ttname"><a href="classlibMesh_1_1ReferenceCounter.html#a7c913252d05560f8bc7c75a63547c4c3">libMesh::ReferenceCounter::_counts</a></div><div class="ttdeci">static Counts _counts</div><div class="ttdoc">Actually holds the data. </div><div class="ttdef"><b>Definition:</b> <a href="reference__counter_8h_source.html#l00124">reference_counter.h:124</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9cbe9d7dc9f93f266817f997562bfa7c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::invalidate_dofs </td>
          <td>(</td>
          <td class="paramtype">MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Invalidates all active <a class="el" href="classlibMesh_1_1DofObject.html" title="The DofObject defines an abstract base class for objects that have degrees of freedom associated with...">DofObject</a> dofs for this system. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l00835">835</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02093">sys_number()</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00927">distribute_dofs()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l00506">reinit()</a>.</p>
<div class="fragment"><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;{</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sys_num = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">sys_number</a>();</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  <span class="comment">// All the nodes</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; node : mesh.node_ptr_range())</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    node-&gt;invalidate_dofs(sys_num);</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <span class="comment">// All the active elements.</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : mesh.active_element_ptr_range())</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    elem-&gt;invalidate_dofs(sys_num);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a244e7a1cd82d5e6ae8780c93205ec1fa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02093">dof_map.h:2093</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a42a8ae63f7d7c5cfeb14b93bb78a3a3f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::is_attached </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Matrices should not be attached more than once. </p>
<p>We can test for an already-attached matrix if necessary using <code>is_attached</code> </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l00333">333</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01871">_matrices</a>.</p>
<div class="fragment"><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;{</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordflow">return</span> (std::find(<a class="code" href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">_matrices</a>.begin(), <a class="code" href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">_matrices</a>.end(),</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                    &amp;matrix) != <a class="code" href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">_matrices</a>.end());</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aacf8838eb951b139f05e56e338ac2195"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aacf8838eb951b139f05e56e338ac2195">libMesh::DofMap::_matrices</a></div><div class="ttdeci">std::vector&lt; SparseMatrix&lt; Number &gt; * &gt; _matrices</div><div class="ttdoc">Additional matrices handled by this object. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01871">dof_map.h:1871</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9846273ba4930ef0364bc1fc954af914"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::is_constrained_dof </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td>
          <td class="paramname"><em>dof</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd><code>true</code> if the degree of freedom dof is constrained, <code>false</code> otherwise. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02179">2179</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>.</p>

<p>参考自 <a class="el" href="dof__map__constraints_8C_source.html#l02218">add_adjoint_constraint_row()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l02183">add_constraint_row()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03708">allgather_recursive_constraints()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03459">build_constraint_matrix()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03569">build_constraint_matrix_and_vector()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03048">constrain_element_dyad_matrix()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l02380">constrain_element_matrix()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l02450">constrain_element_matrix_and_vector()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03006">constrain_element_vector()</a>, <a class="el" href="dof__map_8C_source.html#l01910">extract_local_vector()</a>, <a class="el" href="dof__map_8C_source.html#l02852">find_connected_dofs()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l02529">heterogeneously_constrain_element_matrix_and_vector()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l02836">heterogeneously_constrain_element_vector()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03381">max_constraint_error()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l01898">process_mesh_constraint_rows()</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l04643">scatter_constraints()</a>.</p>
<div class="fragment"><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;{</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.count(dof))</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa074902e46e34c42cab1888d111911f3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::is_constrained_node </td>
          <td>(</td>
          <td class="paramtype">const Node *&#160;</td>
          <td class="paramname"><em>node</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd><code>true</code> if the Node is constrained, false otherwise. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02163">2163</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02041">_node_constraints</a>.</p>

<p>参考自 <a class="el" href="dof__map__constraints_8C_source.html#l03708">allgather_recursive_constraints()</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l04643">scatter_constraints()</a>.</p>
<div class="fragment"><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;{</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>.count(node))</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8856db766d722a0edaa9f5c5d94d40f7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">libMesh::DofMap::_node_constraints</a></div><div class="ttdeci">NodeConstraints _node_constraints</div><div class="ttdoc">Data structure containing DofObject constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02041">dof_map.h:2041</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5829342d4c6136d3b802d1fc0ccf4af2"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DofObjectSubclass &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">template LIBMESH_EXPORT bool libMesh::DofMap::is_evaluable&lt; Node &gt; </td>
          <td>(</td>
          <td class="paramtype">const DofObjectSubclass &amp;&#160;</td>
          <td class="paramname"><em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>var_num</em> = <code><a class="el" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd><code>true</code> iff our solutions can be locally evaluated on <code>obj</code> (which should be an Elem or a Node) for variable number <code>var_num</code> (for all variables, if <code>var_num</code> is invalid_uint) </dd></dl>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l02609">2609</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8C_source.html#l02596">all_semilocal_indices()</a>, <a class="el" href="dof__map_8C_source.html#l01992">dof_indices()</a> , 以及 <a class="el" href="libmesh_8h_source.html#l00254">libMesh::invalid_uint</a>.</p>
<div class="fragment"><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;{</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;  <span class="comment">// Everything is evaluable on a local object</span></div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;  <span class="keywordflow">if</span> (obj.processor_id() == this-&gt;processor_id())</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;  std::vector&lt;dof_id_type&gt; di;</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;  <span class="keywordflow">if</span> (var_num == <a class="code" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a>)</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a0d323b6fcb736454a9f6074ebda9ec28">dof_indices</a>(&amp;obj, di);</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a0d323b6fcb736454a9f6074ebda9ec28">dof_indices</a>(&amp;obj, di, var_num);</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;  <span class="keywordflow">return</span> this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a275eef27e02119cb8b20507ccda4d04d">all_semilocal_indices</a>(di);</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_a5588f6411946120c9d917450ab73e2e2"><div class="ttname"><a href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a></div><div class="ttdeci">const unsigned int invalid_uint</div><div class="ttdoc">A number which is used quite often to represent an invalid or uninitialized value for an unsigned int...</div><div class="ttdef"><b>Definition:</b> <a href="libmesh_8h_source.html#l00254">libmesh.h:254</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a275eef27e02119cb8b20507ccda4d04d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a275eef27e02119cb8b20507ccda4d04d">libMesh::DofMap::all_semilocal_indices</a></div><div class="ttdeci">bool all_semilocal_indices(const std::vector&lt; dof_id_type &gt; &amp;dof_indices) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l02596">dof_map.C:2596</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a0d323b6fcb736454a9f6074ebda9ec28"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a0d323b6fcb736454a9f6074ebda9ec28">libMesh::DofMap::dof_indices</a></div><div class="ttdeci">void dof_indices(const Elem *const elem, std::vector&lt; dof_id_type &gt; &amp;di) const </div><div class="ttdoc">Fills the vector di with the global degree of freedom indices for the element. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01992">dof_map.C:1992</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2a1ee7c34e87faace0226676ae7b48a5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::is_periodic_boundary </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#a3f4d8a52b5ef6ff6156ca209e12b5564">boundary_id_type</a>&#160;</td>
          <td class="paramname"><em>boundaryid</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd><code>true</code> if the boundary given by <code>boundaryid</code> is periodic, false otherwise </dd></dl>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l00219">219</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02050">_periodic_boundaries</a>.</p>
<div class="fragment"><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;{</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>-&gt;count(boundaryid) != 0)</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab91693b08a22cfe1af7781287157ac8a"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">libMesh::DofMap::_periodic_boundaries</a></div><div class="ttdeci">std::unique_ptr&lt; PeriodicBoundaries &gt; _periodic_boundaries</div><div class="ttdoc">Data structure containing periodic boundaries. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02050">dof_map.h:2050</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab6d9ab04643e9028f7f0c9b4d18e0455"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::local_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td>
          <td class="paramname"><em>dof_index</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd><code>true</code> if degree of freedom index <code>dof_index</code> is a local index. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00831">831</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l00711">end_dof()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l00687">first_dof()</a>.</p>

<p>参考自 <a class="el" href="dof__map__constraints_8C_source.html#l05349">add_constraints_to_send_list()</a>, <a class="el" href="dof__map_8C_source.html#l01544">add_neighbors_to_send_list()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03285">enforce_adjoint_constraints_exactly()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03113">enforce_constraints_exactly()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03260">enforce_constraints_on_jacobian()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03203">enforce_constraints_on_residual()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l05055">gather_constraints()</a>, <a class="el" href="dof__map_8C_source.html#l02922">get_info()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l02288">get_local_constraints()</a>, <a class="el" href="dof__map_8C_source.html#l01109">local_variable_indices()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00469">libMesh::SparsityPattern::Build::parallel_sync()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l01898">process_mesh_constraint_rows()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l02580">semilocal_index()</a>.</p>
<div class="fragment"><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  { <span class="keywordflow">return</span> (dof_index &gt;= this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#afe4e2d426832365090b199b7083c0a77">first_dof</a>()) &amp;&amp; (dof_index &lt; this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a92230d3049a3a7a97b8ba2f34b3ec677">end_dof</a>()); }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a92230d3049a3a7a97b8ba2f34b3ec677"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a92230d3049a3a7a97b8ba2f34b3ec677">libMesh::DofMap::end_dof</a></div><div class="ttdeci">dof_id_type end_dof() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00711">dof_map.h:711</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_afe4e2d426832365090b199b7083c0a77"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#afe4e2d426832365090b199b7083c0a77">libMesh::DofMap::first_dof</a></div><div class="ttdeci">dof_id_type first_dof() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00687">dof_map.h:687</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa3ddb5b24d39d8098a008348e006cdbf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::local_variable_indices </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>var_num</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fills an array of those dof indices which belong to the given variable number and live on the current processor. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l01109">1109</a> 行定义.</p>

<p>参考 <a class="el" href="variable_8h_source.html#l00157">libMesh::Variable::active_on_subdomain()</a>, <a class="el" href="dof__map_8h_source.html#l00831">local_index()</a>, <a class="el" href="dof__map_8C_source.html#l02544">SCALAR_dof_indices()</a>, <a class="el" href="dof__map_8h_source.html#l02093">sys_number()</a>, <a class="el" href="dof__map_8h_source.html#l02111">variable()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02141">variable_type()</a>.</p>
<div class="fragment"><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;{</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  <span class="comment">// Count dofs in the *exact* order that distribute_dofs numbered</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  <span class="comment">// them, so that we can assume ascending indices and use push_back</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  <span class="comment">// instead of find+insert.</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sys_num       = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">sys_number</a>();</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  <span class="comment">// If this isn&#39;t a SCALAR variable, we need to find all its field</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  <span class="comment">// dofs on the mesh</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a0c010bb250d4cd8d65794452f46d141a">variable_type</a>(var_num).family != SCALAR)</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    {</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      <span class="keyword">const</span> Variable &amp; var(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab36a0dc3c2c457fa8c01c1b0ba37facc">variable</a>(var_num));</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : mesh.active_local_element_ptr_range())</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        {</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;          <span class="keywordflow">if</span> (!var.active_on_subdomain(elem-&gt;subdomain_id()))</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;          <span class="comment">// Only count dofs connected to active</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;          <span class="comment">// elements on this processor.</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_nodes = elem-&gt;n_nodes();</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;          <span class="comment">// First get any new nodal DOFS</span></div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=0; n&lt;n_nodes; n++)</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;            {</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;              <span class="keyword">const</span> Node &amp; node = elem-&gt;node_ref(n);</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;              <span class="keywordflow">if</span> (node.processor_id() != this-&gt;processor_id())</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_comp = node.n_comp(sys_num, var_num);</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;n_comp; i++)</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                {</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> index = node.dof_number(sys_num,var_num,i);</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                  libmesh_assert (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">local_index</a>(index));</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                  <span class="keywordflow">if</span> (idx.empty() || index &gt; idx.back())</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                    idx.push_back(index);</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                }</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;            }</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;          <span class="comment">// Next get any new element DOFS</span></div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_comp = elem-&gt;n_comp(sys_num, var_num);</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;n_comp; i++)</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;            {</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> index = elem-&gt;dof_number(sys_num,var_num,i);</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;              <span class="keywordflow">if</span> (idx.empty() || index &gt; idx.back())</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;                idx.push_back(index);</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            }</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        } <span class="comment">// done looping over elements</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      <span class="comment">// we may have missed assigning DOFs to nodes that we own</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      <span class="comment">// but to which we have no connected elements matching our</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      <span class="comment">// variable restriction criterion.  this will happen, for example,</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      <span class="comment">// if variable V is restricted to subdomain S.  We may not own</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      <span class="comment">// any elements which live in S, but we may own nodes which are</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      <span class="comment">// *connected* to elements which do.  in this scenario these nodes</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      <span class="comment">// will presently have unnumbered DOFs. we need to take care of</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      <span class="comment">// them here since we own them and no other processor will touch them.</span></div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; node : mesh.local_node_ptr_range())</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;        {</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;          libmesh_assert(node);</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_comp = node-&gt;n_comp(sys_num, var_num);</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;n_comp; i++)</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;            {</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> index = node-&gt;dof_number(sys_num,var_num,i);</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;              <span class="keywordflow">if</span> (idx.empty() || index &gt; idx.back())</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                idx.push_back(index);</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;            }</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;        }</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    }</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  <span class="comment">// Otherwise, count up the SCALAR dofs, if we&#39;re on the processor</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  <span class="comment">// that holds this SCALAR variable</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this-&gt;processor_id() == (this-&gt;n_processors()-1))</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    {</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      std::vector&lt;dof_id_type&gt; di_scalar;</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a347faeed226256bbb37de75dda07b8a3">SCALAR_dof_indices</a>(di_scalar,var_num);</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;      idx.insert( idx.end(), di_scalar.begin(), di_scalar.end());</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    }</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a0c010bb250d4cd8d65794452f46d141a"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a0c010bb250d4cd8d65794452f46d141a">libMesh::DofMap::variable_type</a></div><div class="ttdeci">const FEType &amp; variable_type(const unsigned int c) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02141">dof_map.h:2141</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab6d9ab04643e9028f7f0c9b4d18e0455"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">libMesh::DofMap::local_index</a></div><div class="ttdeci">bool local_index(dof_id_type dof_index) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00831">dof_map.h:831</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab36a0dc3c2c457fa8c01c1b0ba37facc"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab36a0dc3c2c457fa8c01c1b0ba37facc">libMesh::DofMap::variable</a></div><div class="ttdeci">const Variable &amp; variable(const unsigned int c) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02111">dof_map.h:2111</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a244e7a1cd82d5e6ae8780c93205ec1fa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02093">dof_map.h:2093</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a347faeed226256bbb37de75dda07b8a3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a347faeed226256bbb37de75dda07b8a3">libMesh::DofMap::SCALAR_dof_indices</a></div><div class="ttdeci">void SCALAR_dof_indices(std::vector&lt; dof_id_type &gt; &amp;di, const unsigned int vn, const bool old_dofs=false) const </div><div class="ttdoc">Fills the vector di with the global degree of freedom indices corresponding to the SCALAR variable vn...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l02544">dof_map.C:2544</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1b82ea6d41b2d2b4a8ffee27047dae97"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a>, <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &gt; libMesh::DofMap::max_constraint_error </td>
          <td>(</td>
          <td class="paramtype">const System &amp;&#160;</td>
          <td class="paramname"><em>system</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *&#160;</td>
          <td class="paramname"><em>v</em> = <code>nullptr</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tests the constrained degrees of freedom on the numeric vector <code>v</code>, which represents a solution defined on the mesh, returning a pair whose first entry is the maximum absolute error on a constrained DoF and whose second entry is the maximum relative error. </p>
<p>Useful for debugging purposes.</p>
<p>If <code>v</code> == nullptr, the system solution vector is tested. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l03381">3381</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>, <a class="el" href="dof__map_8h_source.html#l02032">_primal_constraint_values</a>, <a class="el" href="type__vector_8h_source.html#l00112">std::abs()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03459">build_constraint_matrix()</a>, <a class="el" href="numeric__vector_8h_source.html#l00180">libMesh::NumericVector&lt; T &gt;::closed()</a>, <a class="el" href="dof__map_8C_source.html#l01992">dof_indices()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#adb02fab0dbedac070aa31d587732c7ba">libMesh::NumericVector&lt; T &gt;::first_local_index()</a>, <a class="el" href="numeric__vector_8h_source.html#l01012">libMesh::NumericVector&lt; T &gt;::get()</a>, <a class="el" href="dof__map_8h_source.html#l02179">is_constrained_dof()</a>, <a class="el" href="classlibMesh_1_1NumericVector.html#a18d730bed9ae74b3fb5edc8261d83a96">libMesh::NumericVector&lt; T &gt;::last_local_index()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00115">libMesh::DenseMatrixBase&lt; T &gt;::m()</a>, <a class="el" href="dense__matrix__base_8h_source.html#l00122">libMesh::DenseMatrixBase&lt; T &gt;::n()</a> , 以及 <a class="el" href="libmesh__common_8h_source.html#l00143">libMesh::Real</a>.</p>
<div class="fragment"><div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;{</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;  <span class="keywordflow">if</span> (!v)</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;    v = system.solution.<a class="code" href="classlibMesh_1_1NumericVector.html#a8eac3a527f0194feae3a9dd80c878df1">get</a>();</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;  <a class="code" href="classlibMesh_1_1NumericVector.html">NumericVector&lt;Number&gt;</a> &amp; vec = *v;</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;  <span class="comment">// We&#39;ll assume the vector is closed</span></div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;  libmesh_assert (vec.<a class="code" href="classlibMesh_1_1NumericVector.html#afa69111a678b5552c7fe586c91a6585f">closed</a>());</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;  <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> max_absolute_error = 0., max_relative_error = 0.;</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;  <span class="keyword">const</span> MeshBase &amp; mesh = system.get_mesh();</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;  libmesh_assert_equal_to (<span class="keyword">this</span>, &amp;(system.get_dof_map()));</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;  <span class="comment">// indices on each element</span></div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;  std::vector&lt;dof_id_type&gt; local_dof_indices;</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; elem : mesh.active_local_element_ptr_range())</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;    {</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a0d323b6fcb736454a9f6074ebda9ec28">dof_indices</a>(elem, local_dof_indices);</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;      std::vector&lt;dof_id_type&gt; raw_dof_indices = local_dof_indices;</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;      <span class="comment">// Constraint matrix for each element</span></div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;      <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> C;</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ad9a7484991ea22915a82b4f0852df055">build_constraint_matrix</a> (C, local_dof_indices);</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;      <span class="comment">// Continue if the element is unconstrained</span></div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;      <span class="keywordflow">if</span> (!C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>())</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;      libmesh_assert_equal_to (C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>(), raw_dof_indices.size());</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;      libmesh_assert_equal_to (C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>(), local_dof_indices.size());</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : make_range(C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">m</a>()))</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;        {</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;          <span class="comment">// Recalculate any constrained dof owned by this processor</span></div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;          <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> global_dof = raw_dof_indices[i];</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;          <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">is_constrained_dof</a>(global_dof) &amp;&amp;</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;              global_dof &gt;= vec.<a class="code" href="classlibMesh_1_1NumericVector.html#adb02fab0dbedac070aa31d587732c7ba">first_local_index</a>() &amp;&amp;</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;              global_dof &lt; vec.<a class="code" href="classlibMesh_1_1NumericVector.html#a18d730bed9ae74b3fb5edc8261d83a96">last_local_index</a>())</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;            {</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;<span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;<span class="preprocessor"></span>              DofConstraints::const_iterator</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;                pos = <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.find(global_dof);</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;              libmesh_assert (pos != <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.end());</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;              <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> exact_value = 0;</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;              DofConstraintValueMap::const_iterator rhsit =</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;                <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.find(global_dof);</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;              <span class="keywordflow">if</span> (rhsit != <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.end())</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;                exact_value = rhsit-&gt;second;</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;              for (<span class="keyword">auto</span> j : make_range(C.<a class="code" href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">n</a>()))</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;                {</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;                  <span class="keywordflow">if</span> (local_dof_indices[j] != global_dof)</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;                    exact_value += C(i,j) *</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;                      vec(local_dof_indices[j]);</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;                }</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;              max_absolute_error = std::max(max_absolute_error,</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;                                            <a class="code" href="namespacestd.html#aea71d536ca6ae5ef192477c8e9c9b197">std::abs</a>(vec(global_dof) - exact_value));</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;              max_relative_error = std::max(max_relative_error,</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;                                            <a class="code" href="namespacestd.html#aea71d536ca6ae5ef192477c8e9c9b197">std::abs</a>(vec(global_dof) - exact_value)</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;                                            / <a class="code" href="namespacestd.html#aea71d536ca6ae5ef192477c8e9c9b197">std::abs</a>(exact_value));</div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;            }</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;        }</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;    }</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;  <span class="keywordflow">return</span> std::pair&lt;Real, Real&gt;(max_absolute_error, max_relative_error);</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_afa69111a678b5552c7fe586c91a6585f"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#afa69111a678b5552c7fe586c91a6585f">libMesh::NumericVector::closed</a></div><div class="ttdeci">virtual bool closed() const </div><div class="ttdoc">检查向量是否已经关闭并准备好进行计算。 </div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8h_source.html#l00180">numeric_vector.h:180</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a4fb8c524109fd5dff8c98855437544ee"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a4fb8c524109fd5dff8c98855437544ee">libMesh::DenseMatrixBase::n</a></div><div class="ttdeci">unsigned int n() const </div><div class="ttdoc">返回矩阵的列维度。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00122">dense_matrix_base.h:122</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html">libMesh::NumericVector</a></div><div class="ttdoc">提供了不同线性代数库的向量存储方案的统一接口。 </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00067">dof_map.h:67</a></div></div>
<div class="ttc" id="namespacestd_html_aea71d536ca6ae5ef192477c8e9c9b197"><div class="ttname"><a href="namespacestd.html#aea71d536ca6ae5ef192477c8e9c9b197">std::abs</a></div><div class="ttdeci">ADRealEigenVector&lt; T, D, asd &gt; abs(const ADRealEigenVector&lt; T, D, asd &gt; &amp;)</div><div class="ttdoc">计算自动微分实数向量的绝对值。 </div><div class="ttdef"><b>Definition:</b> <a href="type__vector_8h_source.html#l00112">type_vector.h:112</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9846273ba4930ef0364bc1fc954af914"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02179">dof_map.h:2179</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrixBase_html_a68bd665fb9252382cc9a28df4099d76a"><div class="ttname"><a href="classlibMesh_1_1DenseMatrixBase.html#a68bd665fb9252382cc9a28df4099d76a">libMesh::DenseMatrixBase::m</a></div><div class="ttdeci">unsigned int m() const </div><div class="ttdoc">返回矩阵的行维度。 </div><div class="ttdef"><b>Definition:</b> <a href="dense__matrix__base_8h_source.html#l00115">dense_matrix_base.h:115</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad9a7484991ea22915a82b4f0852df055"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad9a7484991ea22915a82b4f0852df055">libMesh::DofMap::build_constraint_matrix</a></div><div class="ttdeci">void build_constraint_matrix(DenseMatrix&lt; Number &gt; &amp;C, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, const bool called_recursively=false) const </div><div class="ttdoc">Build the constraint matrix C associated with the element degree of freedom indices elem_dofs...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l03459">dof_map_constraints.C:3459</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_adb02fab0dbedac070aa31d587732c7ba"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#adb02fab0dbedac070aa31d587732c7ba">libMesh::NumericVector::first_local_index</a></div><div class="ttdeci">virtual numeric_index_type first_local_index() const =0</div><div class="ttdoc">获取实际存储在该处理器上的第一个向量元素的索引。 </div></div>
<div class="ttc" id="namespacelibMesh_html_aef28359fb4851abec08fc99cfbac118d"><div class="ttname"><a href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">libMesh::Real</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef LIBMESH_DEFAULT_SCALAR_TYPE Real</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00143">libmesh_common.h:143</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a8eac3a527f0194feae3a9dd80c878df1"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a8eac3a527f0194feae3a9dd80c878df1">libMesh::NumericVector::get</a></div><div class="ttdeci">virtual void get(const std::vector&lt; numeric_index_type &gt; &amp;index, T *values) const </div><div class="ttdoc">一次访问多个组件。 values 将 *不会* 重新分配空间；它应该已经具有足够的空间。 默认实现对每个索引调用 operator() ，但某些实现可能在此处提供更快的方法。 ...</div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8h_source.html#l01012">numeric_vector.h:1012</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02032">dof_map.h:2032</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a8b17bf24a15bc292850c3a3894e2e8f9"><div class="ttname"><a href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">libMesh::Number</a></div><div class="ttdeci">Real Number</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00214">libmesh_common.h:214</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html">libMesh::DenseMatrix</a></div><div class="ttdoc">定义用于有限元类型计算的密集矩阵。 用于在求和成全局矩阵之前存储单元刚度矩阵。所有被覆盖的虚函数都记录在dense_matrix_base.h中。 </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00065">dof_map.h:65</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a18d730bed9ae74b3fb5edc8261d83a96"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a18d730bed9ae74b3fb5edc8261d83a96">libMesh::NumericVector::last_local_index</a></div><div class="ttdeci">virtual numeric_index_type last_local_index() const =0</div><div class="ttdoc">获取实际存储在该处理器上的最后一个向量元素的索引+1。 </div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a0d323b6fcb736454a9f6074ebda9ec28"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a0d323b6fcb736454a9f6074ebda9ec28">libMesh::DofMap::dof_indices</a></div><div class="ttdeci">void dof_indices(const Elem *const elem, std::vector&lt; dof_id_type &gt; &amp;di) const </div><div class="ttdoc">Fills the vector di with the global degree of freedom indices for the element. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01992">dof_map.C:1992</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aaba8d0fe4f60763e0a52f7ae1d4b7153"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::merge_ghost_functor_outputs </td>
          <td>(</td>
          <td class="paramtype">GhostingFunctor::map_type &amp;&#160;</td>
          <td class="paramname"><em>elements_to_ghost</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DofMap.html#abddb472d25fdb74e211e214710c48534">CouplingMatricesSet</a> &amp;&#160;</td>
          <td class="paramname"><em>temporary_coupling_matrices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::set&lt; GhostingFunctor * &gt;::iterator &amp;&#160;</td>
          <td class="paramname"><em>gf_begin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::set&lt; GhostingFunctor * &gt;::iterator &amp;&#160;</td>
          <td class="paramname"><em>gf_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const MeshBase::const_element_iterator &amp;&#160;</td>
          <td class="paramname"><em>elems_begin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const MeshBase::const_element_iterator &amp;&#160;</td>
          <td class="paramname"><em>elems_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a>&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l01440">1440</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01544">add_neighbors_to_send_list()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00238">libMesh::SparsityPattern::Build::operator()()</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l04643">scatter_constraints()</a>.</p>
<div class="fragment"><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;{</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; gf : as_range(gf_begin, gf_end))</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    {</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;      GhostingFunctor::map_type more_elements_to_ghost;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;      libmesh_assert(gf);</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;      (*gf)(elems_begin, elems_end, p, more_elements_to_ghost);</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;      <span class="comment">// A GhostingFunctor should only return active elements, but</span></div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;      <span class="comment">// I forgot to *document* that, so let&#39;s go as easy as we</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;      <span class="comment">// can on functors that return inactive elements.</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="preprocessor">#if defined(LIBMESH_ENABLE_DEPRECATED) &amp;&amp; defined(LIBMESH_ENABLE_AMR)</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;<span class="preprocessor"></span>      std::vector&lt;std::pair&lt;const Elem*, const CouplingMatrix*&gt;&gt; children_to_couple;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = more_elements_to_ghost.begin();</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;           it != more_elements_to_ghost.end();)</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;        {</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;          <span class="keyword">const</span> Elem * elem = it-&gt;first;</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;          <span class="keywordflow">if</span> (!elem-&gt;active())</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;            {</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;              libmesh_deprecated();</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;              std::vector&lt;const Elem*&gt; children_to_ghost;</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;              elem-&gt;active_family_tree(children_to_ghost,</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;                                       <span class="comment">/*reset=*/</span> <span class="keyword">false</span>);</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;              <span class="keywordflow">for</span> (<span class="keyword">const</span> Elem * child : children_to_ghost)</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;                <span class="keywordflow">if</span> (child-&gt;processor_id() != p)</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;                  children_to_couple.emplace_back(child, it-&gt;second);</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;              it = more_elements_to_ghost.erase(it);</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;            }</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;            ++it;</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;        }</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;      more_elements_to_ghost.insert(children_to_couple.begin(),</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                                    children_to_couple.end());</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; [elem, elem_cm] : more_elements_to_ghost)</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;        {</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;          <span class="comment">// At this point we should only have active elements, even</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;          <span class="comment">// if we had to fix up gf output to get here.</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;          libmesh_assert(elem-&gt;active());</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;          GhostingFunctor::map_type::iterator existing_it =</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;            elements_to_ghost.find (elem);</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;          <span class="keywordflow">if</span> (existing_it == elements_to_ghost.end())</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;            elements_to_ghost.emplace(elem, elem_cm);</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;            {</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;              <span class="keywordflow">if</span> (existing_it-&gt;second)</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                {</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                  <span class="keywordflow">if</span> (elem_cm)</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                    {</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                      <span class="comment">// If this isn&#39;t already a temporary</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                      <span class="comment">// then we need to make one so we&#39;ll</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                      <span class="comment">// have a non-const matrix to merge</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                      <span class="keywordflow">if</span> (temporary_coupling_matrices.empty() ||</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                          !temporary_coupling_matrices.count(existing_it-&gt;second))</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                        {</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                          <span class="comment">// Make copy. This just calls the</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                          <span class="comment">// compiler-generated copy constructor</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                          <span class="comment">// because the CouplingMatrix class does not</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                          <span class="comment">// define a custom copy constructor.</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                          <span class="keyword">auto</span> result_pr = temporary_coupling_matrices.insert(std::make_unique&lt;CouplingMatrix&gt;(*existing_it-&gt;second));</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                          existing_it-&gt;second = result_pr.first-&gt;get();</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                        }</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                      <span class="comment">// Merge elem_cm into existing CouplingMatrix</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                      <span class="keyword">const_cast&lt;</span>CouplingMatrix &amp;<span class="keyword">&gt;</span>(*existing_it-&gt;second) &amp;= *elem_cm;</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                    }</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;                  <span class="keywordflow">else</span> <span class="comment">// elem_cm == nullptr</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                    {</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                      <span class="comment">// Any existing_it matrix merged with a full</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                      <span class="comment">// matrix (symbolized as nullptr) gives another</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                      <span class="comment">// full matrix (symbolizable as nullptr).</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;                      <span class="comment">// So if existing_it-&gt;second is a temporary then</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;                      <span class="comment">// we don&#39;t need it anymore; we might as well</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                      <span class="comment">// remove it to keep the set of temporaries</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                      <span class="comment">// small.</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                      <span class="keyword">auto</span> temp_it = temporary_coupling_matrices.find(existing_it-&gt;second);</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                      <span class="keywordflow">if</span> (temp_it != temporary_coupling_matrices.end())</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                        temporary_coupling_matrices.erase(temp_it);</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                      existing_it-&gt;second = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                    }</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                }</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;              <span class="comment">// else we have a nullptr already, then we have a full</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;              <span class="comment">// coupling matrix, already, and merging with anything</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;              <span class="comment">// else won&#39;t change that, so we&#39;re done.</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;            }</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        }</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    }</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad83df6befb2ac64f657f874731ab03f1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::n_constrained_dofs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The total number of constrained degrees of freedom in the problem. </dd></dl>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l01714">1714</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map__constraints_8C_source.html#l01724">n_local_constrained_dofs()</a>.</p>

<p>参考自 <a class="el" href="dof__map__constraints_8C_source.html#l03285">enforce_adjoint_constraints_exactly()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03113">enforce_constraints_exactly()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03260">enforce_constraints_on_jacobian()</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l03203">enforce_constraints_on_residual()</a>.</p>
<div class="fragment"><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;{</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;  parallel_object_only();</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> nc_dofs = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#abd5ddb7a400e9f4afc942fcaff084860">n_local_constrained_dofs</a>();</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;  this-&gt;comm().sum(nc_dofs);</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;  <span class="keywordflow">return</span> nc_dofs;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_abd5ddb7a400e9f4afc942fcaff084860"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#abd5ddb7a400e9f4afc942fcaff084860">libMesh::DofMap::n_local_constrained_dofs</a></div><div class="ttdeci">dof_id_type n_local_constrained_dofs() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l01724">dof_map_constraints.C:1724</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2dc427af82815a5265de4e9c8ccd0fc6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::n_constrained_nodes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The total number of constrained Nodes in the mesh. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00908">908</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02041">_node_constraints</a>.</p>
<div class="fragment"><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  { <span class="keywordflow">return</span> cast_int&lt;dof_id_type&gt;(<a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>.size()); }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8856db766d722a0edaa9f5c5d94d40f7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">libMesh::DofMap::_node_constraints</a></div><div class="ttdeci">NodeConstraints _node_constraints</div><div class="ttdoc">Data structure containing DofObject constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02041">dof_map.h:2041</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a77f8d984574b1bf8886057799e9b0134"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::n_dofs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The total number of degrees of freedom in the problem. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00659">659</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01988">_n_dfs</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l02381">_dof_indices()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l02183">add_constraint_row()</a>, <a class="el" href="dof__map_8C_source.html#l01544">add_neighbors_to_send_list()</a>, <a class="el" href="dof__map_8C_source.html#l00927">distribute_dofs()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03285">enforce_adjoint_constraints_exactly()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03113">enforce_constraints_exactly()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00363">libMesh::SparsityPattern::Build::join()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00469">libMesh::SparsityPattern::Build::parallel_sync()</a>, <a class="el" href="dof__map_8C_source.html#l01692">prepare_send_list()</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l01898">process_mesh_constraint_rows()</a>.</p>
<div class="fragment"><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a0964620ae8054b969297d1d9087b7b05">_n_dfs</a>; }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a0964620ae8054b969297d1d9087b7b05"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a0964620ae8054b969297d1d9087b7b05">libMesh::DofMap::_n_dfs</a></div><div class="ttdeci">dof_id_type _n_dfs</div><div class="ttdoc">Total number of degrees of freedom. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01988">dof_map.h:1988</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a765ac72717810e0a86f04ab8a938cd22"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::n_dofs_on_processor </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a>&#160;</td>
          <td class="paramname"><em>proc</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The number of degrees of freedom on partition <code>proc</code>. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00675">675</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01881">_end_df</a> , 以及 <a class="el" href="dof__map_8h_source.html#l01876">_first_df</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00064">build_sparsity()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00363">libMesh::SparsityPattern::Build::join()</a>, <a class="el" href="dof__map_8h_source.html#l00669">n_local_dofs()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00238">libMesh::SparsityPattern::Build::operator()()</a> , 以及 <a class="el" href="sparsity__pattern_8C_source.html#l00469">libMesh::SparsityPattern::Build::parallel_sync()</a>.</p>
<div class="fragment"><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    libmesh_assert_less (proc, <a class="code" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a>.size());</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keywordflow">return</span> cast_int&lt;dof_id_type&gt;(<a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>[proc] - <a class="code" href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">_first_df</a>[proc]);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af43f96a9e11b3f4221306fdfd4511aaa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">libMesh::DofMap::_end_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _end_df</div><div class="ttdoc">Last DOF index (plus 1) on processor p. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01881">dof_map.h:1881</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab72062de06b72df985ac5bf16837a7da"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab72062de06b72df985ac5bf16837a7da">libMesh::DofMap::_first_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_df</div><div class="ttdoc">First DOF index on processor p. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01876">dof_map.h:1876</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abd5ddb7a400e9f4afc942fcaff084860"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::n_local_constrained_dofs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The number of constrained degrees of freedom on this processor. </dd></dl>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l01724">1724</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>, <a class="el" href="dof__map_8h_source.html#l00711">end_dof()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l00687">first_dof()</a>.</p>

<p>参考自 <a class="el" href="dof__map__constraints_8C_source.html#l01714">n_constrained_dofs()</a>.</p>
<div class="fragment"><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;{</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;  <span class="keyword">const</span> DofConstraints::const_iterator lower =</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.lower_bound(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#afe4e2d426832365090b199b7083c0a77">first_dof</a>()),</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    upper =</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.lower_bound(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a92230d3049a3a7a97b8ba2f34b3ec677">end_dof</a>());</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;  <span class="keywordflow">return</span> cast_int&lt;dof_id_type&gt;(std::distance(lower, upper));</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a92230d3049a3a7a97b8ba2f34b3ec677"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a92230d3049a3a7a97b8ba2f34b3ec677">libMesh::DofMap::end_dof</a></div><div class="ttdeci">dof_id_type end_dof() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00711">dof_map.h:711</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_afe4e2d426832365090b199b7083c0a77"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#afe4e2d426832365090b199b7083c0a77">libMesh::DofMap::first_dof</a></div><div class="ttdeci">dof_id_type first_dof() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00687">dof_map.h:687</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8e8912a9fc6b900604ff23807edadd3b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::n_local_dofs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The number of degrees of freedom on this processor. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00669">669</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l00675">n_dofs_on_processor()</a>.</p>

<p>参考自 <a class="el" href="dof__map__constraints_8C_source.html#l03285">enforce_adjoint_constraints_exactly()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03113">enforce_constraints_exactly()</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l01898">process_mesh_constraint_rows()</a>.</p>
<div class="fragment"><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  { <span class="keywordflow">return</span> this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a765ac72717810e0a86f04ab8a938cd22">n_dofs_on_processor</a> (this-&gt;processor_id()); }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a765ac72717810e0a86f04ab8a938cd22"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a765ac72717810e0a86f04ab8a938cd22">libMesh::DofMap::n_dofs_on_processor</a></div><div class="ttdeci">dof_id_type n_dofs_on_processor(const processor_id_type proc) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00675">dof_map.h:675</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a50e74641afc6e2870c9e1ce412f8c44f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned int libMesh::ReferenceCounter::n_objects </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prints the number of outstanding (created, but not yet destroyed) objects. </p>

<p>在文件 <a class="el" href="reference__counter_8h_source.html">reference_counter.h</a> 第 <a class="el" href="reference__counter_8h_source.html#l00085">85</a> 行定义.</p>

<p>参考 <a class="el" href="reference__counter_8h_source.html#l00132">libMesh::ReferenceCounter::_n_objects</a>.</p>

<p>参考自 <a class="el" href="libmesh_8C_source.html#l00668">libMesh::LibMeshInit::~LibMeshInit()</a>.</p>
<div class="fragment"><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  { <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1ReferenceCounter.html#ad2c30f0f71dcd00f00faa8e46aa3e043">_n_objects</a>; }</div>
<div class="ttc" id="classlibMesh_1_1ReferenceCounter_html_ad2c30f0f71dcd00f00faa8e46aa3e043"><div class="ttname"><a href="classlibMesh_1_1ReferenceCounter.html#ad2c30f0f71dcd00f00faa8e46aa3e043">libMesh::ReferenceCounter::_n_objects</a></div><div class="ttdeci">static Threads::atomic&lt; unsigned int &gt; _n_objects</div><div class="ttdoc">The number of objects. </div><div class="ttdef"><b>Definition:</b> <a href="reference__counter_8h_source.html#l00132">reference_counter.h:132</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1a5ccf3ea5ac20cd67ee29805c42d6c5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::n_old_dofs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The total number of degrees of freedom on old_dof_objects </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01539">1539</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02001">_n_old_dfs</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l02544">SCALAR_dof_indices()</a>.</p>
<div class="fragment"><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#abbca79dca4f02ab917e89aeac3113808">_n_old_dfs</a>; }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_abbca79dca4f02ab917e89aeac3113808"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#abbca79dca4f02ab917e89aeac3113808">libMesh::DofMap::_n_old_dfs</a></div><div class="ttdeci">dof_id_type _n_old_dfs</div><div class="ttdoc">Total number of degrees of freedom on old dof objects. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02001">dof_map.h:2001</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a39feeb5bedb05e160b5190e26d433605"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::n_SCALAR_dofs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The number of SCALAR dofs. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00664">664</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01994">_n_SCALAR_dofs</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00927">distribute_dofs()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l02544">SCALAR_dof_indices()</a>.</p>
<div class="fragment"><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">_n_SCALAR_dofs</a>; }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8dbee781954d22ad785846b3a2a45193"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">libMesh::DofMap::_n_SCALAR_dofs</a></div><div class="ttdeci">dof_id_type _n_SCALAR_dofs</div><div class="ttdoc">The total number of SCALAR dofs associated to all SCALAR variables. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01994">dof_map.h:1994</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6058ea4ca2ef36bd90f44bcb052a1d1e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int libMesh::DofMap::n_variable_groups </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The number of variables in the global solution vector. Defaults to 1, should be 1 for a scalar equation, 3 for 2D incompressible Navier Stokes (u,v,p), etc... </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00613">613</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01844">_variable_groups</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01196">distribute_local_dofs_node_major()</a>, <a class="el" href="dof__map_8C_source.html#l01299">distribute_local_dofs_var_major()</a>, <a class="el" href="dof__map_8C_source.html#l01394">distribute_scalar_dofs()</a>, <a class="el" href="dof__map_8C_source.html#l01992">dof_indices()</a>, <a class="el" href="dof__map_8h_source.html#l00634">has_blocked_representation()</a>, <a class="el" href="dof__map_8C_source.html#l02630">old_dof_indices()</a>, <a class="el" href="dof__map_8C_source.html#l00506">reinit()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l00356">set_nonlocal_dof_objects()</a>.</p>
<div class="fragment"><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  { <span class="keywordflow">return</span> cast_int&lt;unsigned int&gt;(<a class="code" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a>.size()); }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad840cf4659b6b1a2f781d29225e82743"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">libMesh::DofMap::_variable_groups</a></div><div class="ttdeci">std::vector&lt; VariableGroup &gt; _variable_groups</div><div class="ttdoc">The finite element type for each variable group. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01844">dof_map.h:1844</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aee89c467613b296c215421d60d5ae961"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int libMesh::DofMap::n_variables </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The number of variables in the global solution vector. Defaults to 1, should be 1 for a scalar equation, 3 for 2D incompressible Navier Stokes (u,v,p), etc... </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l00621">621</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01839">_variables</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01544">add_neighbors_to_send_list()</a>, <a class="el" href="dof__map_8h_source.html#l00651">block_size()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l01736">create_dof_constraints()</a>, <a class="el" href="dof__map_8C_source.html#l00927">distribute_dofs()</a>, <a class="el" href="dof__map_8h_source.html#l00634">has_blocked_representation()</a>, <a class="el" href="sparsity__pattern_8C_source.html#l00238">libMesh::SparsityPattern::Build::operator()()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l01898">process_mesh_constraint_rows()</a>, <a class="el" href="dof__map_8C_source.html#l00506">reinit()</a>, <a class="el" href="dof__map_8C_source.html#l01760">use_coupled_neighbor_dofs()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02347">var_group_from_var_number()</a>.</p>
<div class="fragment"><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  { <span class="keywordflow">return</span> cast_int&lt;unsigned int&gt;(<a class="code" href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">_variables</a>.size()); }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a5232a8054e580a408f394ba1574c63df"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">libMesh::DofMap::_variables</a></div><div class="ttdeci">std::vector&lt; Variable &gt; _variables</div><div class="ttdoc">The finite element type for each variable. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01839">dof_map.h:1839</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5ad33eaeee9257b3935f06f602cdffd6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">NodeConstraints::const_iterator libMesh::DofMap::node_constraint_rows_begin </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>An iterator pointing to the first Node constraint row. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01058">1058</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02041">_node_constraints</a>.</p>
<div class="fragment"><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  { <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>.begin(); }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8856db766d722a0edaa9f5c5d94d40f7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">libMesh::DofMap::_node_constraints</a></div><div class="ttdeci">NodeConstraints _node_constraints</div><div class="ttdoc">Data structure containing DofObject constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02041">dof_map.h:2041</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7733ca0e62963ab432b59141869d212f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">NodeConstraints::const_iterator libMesh::DofMap::node_constraint_rows_end </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>An iterator pointing just past the last Node constraint row. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01064">1064</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02041">_node_constraints</a>.</p>
<div class="fragment"><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  { <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>.end(); }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8856db766d722a0edaa9f5c5d94d40f7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">libMesh::DofMap::_node_constraints</a></div><div class="ttdeci">NodeConstraints _node_constraints</div><div class="ttdoc">Data structure containing DofObject constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02041">dof_map.h:2041</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8f4c45c1d3d4de70b46e63063153c12a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1DofObject.html">DofObject</a> * libMesh::DofMap::node_ptr </td>
          <td>(</td>
          <td class="paramtype">MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The Node pointer with index <code>i</code> from the <code>mesh</code>. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l00341">341</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00927">distribute_dofs()</a>.</p>
<div class="fragment"><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;{</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="keywordflow">return</span> mesh.node_ptr(i);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a28da2b029b6461593a746fb946d17ab1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::old_dof_indices </td>
          <td>(</td>
          <td class="paramtype">const Elem &amp;&#160;</td>
          <td class="paramname"><em>elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>di</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>vn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Appends to the vector <code>di</code> the old global degree of freedom indices for <code>elem.node_ref(n)</code>, for one variable <code>vn</code>. </p>
<p>On hanging nodes with both vertex and non-vertex DoFs, only those indices which are directly supported on <code>elem</code> are included. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l02283">2283</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8C_source.html#l02296">_node_dof_indices()</a> , 以及 <a class="el" href="dof__object_8h_source.html#l00104">libMesh::DofObject::get_old_dof_object_ref()</a>.</p>
<div class="fragment"><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;{</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;  <span class="keyword">const</span> DofObject &amp; old_obj = elem.node_ref(n).get_old_dof_object_ref();</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a5da0a54ecad33de039c252ddcc6ecb88">_node_dof_indices</a>(elem, n, old_obj, di, vn);</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a5da0a54ecad33de039c252ddcc6ecb88"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a5da0a54ecad33de039c252ddcc6ecb88">libMesh::DofMap::_node_dof_indices</a></div><div class="ttdeci">void _node_dof_indices(const Elem &amp;elem, unsigned int n, const DofObject &amp;obj, std::vector&lt; dof_id_type &gt; &amp;di, const unsigned int vn) const </div><div class="ttdoc">Helper function that implements the element-nodal versions of dof_indices and old_dof_indices. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l02296">dof_map.C:2296</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a82797eed62ab734a8442ffb4c497f5ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::old_dof_indices </td>
          <td>(</td>
          <td class="paramtype">const Elem *const&#160;</td>
          <td class="paramname"><em>elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>di</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>vn</em> = <code><a class="el" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>After a mesh is refined and repartitioned it is possible that the <code>_send_list</code> will need to be augmented. </p>
<p>This is the case when an element is refined and its children end up on different processors than the parent. These children will need values from the parent when projecting the solution onto the refined mesh, hence the parent's DOF indices need to be included in the <code>_send_list</code>. Fills the vector di with the global degree of freedom indices for the element using the <code>DofMap::old_dof_object</code>. If no variable number is specified then all variables are returned. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l02630">2630</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02022">_dont_p_refine</a>, <a class="el" href="variable_8h_source.html#l00157">libMesh::Variable::active_on_subdomain()</a>, <a class="el" href="dof__object_8h_source.html#l01025">libMesh::DofObject::dof_number()</a>, <a class="el" href="dof__object_8h_source.html#l00104">libMesh::DofObject::get_old_dof_object_ref()</a>, <a class="el" href="dof__object_8h_source.html#l00477">libMesh::DofObject::invalid_id</a>, <a class="el" href="libmesh_8h_source.html#l00254">libMesh::invalid_uint</a>, <a class="el" href="dof__object_8h_source.html#l01008">libMesh::DofObject::n_comp_group()</a>, <a class="el" href="dof__object_8h_source.html#l00930">libMesh::DofObject::n_systems()</a>, <a class="el" href="dof__map_8h_source.html#l00613">n_variable_groups()</a>, <a class="el" href="variable_8h_source.html#l00256">libMesh::VariableGroup::n_variables()</a>, <a class="el" href="variable_8h_source.html#l00294">libMesh::VariableGroup::number()</a>, <a class="el" href="dof__map_8C_source.html#l02544">SCALAR_dof_indices()</a>, <a class="el" href="dof__map_8h_source.html#l02093">sys_number()</a>, <a class="el" href="variable_8h_source.html#l00140">libMesh::Variable::type()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02101">variable_group()</a>.</p>
<div class="fragment"><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;{</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;old_dof_indices()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;  libmesh_assert(elem);</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;  <span class="keyword">const</span> ElemType type              = elem-&gt;type();</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sys_num       = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">sys_number</a>();</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_var_groups  = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a6058ea4ca2ef36bd90f44bcb052a1d1e">n_variable_groups</a>();</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_INFINITE_ELEMENTS</span></div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;<span class="preprocessor"></span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> is_inf                = elem-&gt;infinite();</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;  <span class="comment">// If we have dof indices stored on the elem, and there&#39;s no chance</span></div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;  <span class="comment">// that we only have those indices because we were just p refined,</span></div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;  <span class="comment">// then we should have old dof indices too.</span></div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;  libmesh_assert(!elem-&gt;has_dofs(sys_num) ||</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;                 elem-&gt;p_refinement_flag() == Elem::JUST_REFINED ||</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;                 elem-&gt;get_old_dof_object());</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;  <span class="comment">// Clear the DOF indices vector.</span></div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;  di.clear();</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;  <span class="comment">// Determine the nodes contributing to element elem</span></div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;  std::vector&lt;const Node *&gt; elem_nodes;</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;  <span class="keyword">const</span> Node * <span class="keyword">const</span> * nodes_ptr;</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_nodes;</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;  <span class="keywordflow">if</span> (elem-&gt;type() == TRI3SUBDIVISION)</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;    {</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;      <span class="comment">// Subdivision surface FE require the 1-ring around elem</span></div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;      <span class="keyword">const</span> Tri3Subdivision * sd_elem = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span>Tri3Subdivision *<span class="keyword">&gt;</span>(elem);</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;      MeshTools::Subdivision::find_one_ring(sd_elem, elem_nodes);</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;      nodes_ptr = elem_nodes.data();</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;      n_nodes = cast_int&lt;unsigned int&gt;(elem_nodes.size());</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;    }</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;    {</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;      <span class="comment">// All other FE use only the nodes of elem itself</span></div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;      nodes_ptr = elem-&gt;get_nodes();</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;      n_nodes = elem-&gt;n_nodes();</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;    }</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;  <span class="comment">// Get the dof numbers</span></div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vg=0; vg&lt;n_var_groups; vg++)</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;    {</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;      <span class="keyword">const</span> VariableGroup &amp; var = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab59bc8ca645e02067744580fdf4c9616">variable_group</a>(vg);</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vars_in_group = var.n_variables();</div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vig=0; vig&lt;vars_in_group; vig++)</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;        {</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = var.number(vig);</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;          <span class="keywordflow">if</span> ((vn == v) || (vn == <a class="code" href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a>))</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;            {</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;              <span class="keywordflow">if</span> (var.type().family == SCALAR &amp;&amp;</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;                  (!elem ||</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;                   var.active_on_subdomain(elem-&gt;subdomain_id())))</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;                {</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;                  <span class="comment">// We asked for this variable, so add it to the vector.</span></div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;                  std::vector&lt;dof_id_type&gt; di_new;</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;                  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a347faeed226256bbb37de75dda07b8a3">SCALAR_dof_indices</a>(di_new,v,<span class="keyword">true</span>);</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;                  di.insert( di.end(), di_new.begin(), di_new.end());</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;                }</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;                <span class="keywordflow">if</span> (var.active_on_subdomain(elem-&gt;subdomain_id()))</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;                  { <span class="comment">// Do this for all the variables if one was not specified</span></div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;                    <span class="comment">// or just for the specified variable</span></div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;                    FEType fe_type = var.type();</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">bool</span> add_p_level =</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_AMR</span></div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;<span class="preprocessor"></span>                        !<a class="code" href="classlibMesh_1_1DofMap.html#a82dd81ff9e21bdc2d9c80f80c692a9ea">_dont_p_refine</a>.count(vg);</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;<span class="preprocessor"></span>                        <span class="keyword">false</span>;</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;<span class="preprocessor"></span>                    <span class="comment">// Increase the polynomial order on p refined elements,</span></div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;                    <span class="comment">// but make sure you get the right polynomial order for</span></div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;                    <span class="comment">// the OLD degrees of freedom</span></div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;                    <span class="keywordtype">int</span> p_adjustment = 0;</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;                    <span class="keywordflow">if</span> (elem-&gt;p_refinement_flag() == Elem::JUST_REFINED)</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;                      {</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;                        libmesh_assert_greater (elem-&gt;p_level(), 0);</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;                        p_adjustment = -1;</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;                      }</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (elem-&gt;p_refinement_flag() == Elem::JUST_COARSENED)</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;                      {</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;                        p_adjustment = 1;</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;                      }</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;                    p_adjustment *= add_p_level;</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;                    <span class="comment">// Compute the net amount of &quot;extra&quot; order, including Elem::p_level()</span></div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;                    <span class="keywordtype">int</span> extra_order = int(add_p_level*elem-&gt;p_level()) + p_adjustment;</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">bool</span> extra_hanging_dofs =</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;                      FEInterface::extra_hanging_dofs(fe_type);</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;                    <span class="keyword">const</span> FEInterface::n_dofs_at_node_ptr ndan =</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;                      FEInterface::n_dofs_at_node_function(fe_type, elem);</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;                    <span class="comment">// Get the node-based DOF numbers</span></div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=0; n&lt;n_nodes; n++)</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;                      {</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;                        <span class="keyword">const</span> Node * node = nodes_ptr[n];</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;                        <span class="keyword">const</span> DofObject &amp; old_dof_obj = node-&gt;get_old_dof_object_ref();</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;                        <span class="comment">// There is a potential problem with h refinement.  Imagine a</span></div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;                        <span class="comment">// quad9 that has a linear FE on it.  Then, on the hanging side,</span></div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;                        <span class="comment">// it can falsely identify a DOF at the mid-edge node. This is why</span></div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;                        <span class="comment">// we call FEInterface instead of node-&gt;n_comp() directly.</span></div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nc =</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_INFINITE_ELEMENTS</span></div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;<span class="preprocessor"></span>                          is_inf ?</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;                          FEInterface::n_dofs_at_node(var.type(), extra_order, elem, n) :</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;#endif</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;                          ndan (type, static_cast&lt;Order&gt;(var.type().order + extra_order), n);</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">int</span> n_comp = old_dof_obj.n_comp_group(sys_num,vg);</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;                        <span class="comment">// If this is a non-vertex on a hanging node with extra</span></div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;                        <span class="comment">// degrees of freedom, we use the non-vertex dofs (which</span></div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;                        <span class="comment">// come in reverse order starting from the end, to</span></div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;                        <span class="comment">// simplify p refinement)</span></div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;                        <span class="keywordflow">if</span> (extra_hanging_dofs &amp;&amp; !elem-&gt;is_vertex(n))</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;                          {</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">int</span> dof_offset = n_comp - nc;</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;                            <span class="comment">// We should never have fewer dofs than necessary on a</span></div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;                            <span class="comment">// node unless we&#39;re getting indices on a parent element</span></div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;                            <span class="comment">// or a just-coarsened element</span></div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;                            <span class="keywordflow">if</span> (dof_offset &lt; 0)</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;                              {</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;                                libmesh_assert(!elem-&gt;active() || elem-&gt;refinement_flag() ==</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;                                               Elem::JUST_COARSENED);</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;                                di.resize(di.size() + nc, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;                              }</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;                            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;                              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=n_comp-1; i&gt;=dof_offset; i--)</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;                                {</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> d =</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;                                    old_dof_obj.dof_number(sys_num, vg, vig, i, n_comp);</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;                                  <span class="comment">// On a newly-expanded subdomain, we</span></div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;                                  <span class="comment">// may have some DoFs that didn&#39;t</span></div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;                                  <span class="comment">// exist in the old system, in which</span></div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;                                  <span class="comment">// case we can&#39;t assert this:</span></div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;                                  <span class="comment">// libmesh_assert_not_equal_to (d, DofObject::invalid_id);</span></div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;                                  di.push_back(d);</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;                                }</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;                          }</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;                        <span class="comment">// If this is a vertex or an element without extra hanging</span></div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;                        <span class="comment">// dofs, our dofs come in forward order coming from the</span></div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;                        <span class="comment">// beginning.  But we still might not have all</span></div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;                        <span class="comment">// those dofs on the old_dof_obj, in cases</span></div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;                        <span class="comment">// where a subdomain-restricted variable just</span></div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;                        <span class="comment">// had its subdomain expanded.</span></div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;                          {</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;                            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> old_nc =</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;                              std::min(static_cast&lt;unsigned int&gt;(n_comp), nc);</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i != old_nc; ++i)</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;                              {</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;                                <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> d =</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;                                  old_dof_obj.dof_number(sys_num, vg, vig, i, n_comp);</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;                                libmesh_assert_not_equal_to (d, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;                                di.push_back(d);</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;                              }</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=old_nc; i != nc; ++i)</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;                              di.push_back(<a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;                          }</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;                      }</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;                    <span class="comment">// If there are any element-based DOF numbers, get them</span></div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nc =</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;                      FEInterface::n_dofs_per_elem(fe_type, extra_order, elem);</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;                    <span class="keywordflow">if</span> (nc != 0)</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;                      {</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;                        <span class="keyword">const</span> DofObject &amp; old_dof_obj = elem-&gt;get_old_dof_object_ref();</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_comp =</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;                          old_dof_obj.n_comp_group(sys_num,vg);</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;                        <span class="keywordflow">if</span> (old_dof_obj.n_systems() &gt; sys_num &amp;&amp;</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;                            nc &lt;= n_comp)</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;                          {</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;nc; i++)</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;                              {</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;                                <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> d =</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;                                  old_dof_obj.dof_number(sys_num, vg, vig, i, n_comp);</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;                                di.push_back(d);</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;                              }</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;                          }</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;                          {</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;                            <span class="comment">// We should never have fewer dofs than</span></div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;                            <span class="comment">// necessary on an element unless we&#39;re</span></div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;                            <span class="comment">// getting indices on a parent element, a</span></div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;                            <span class="comment">// just-coarsened element ... or a</span></div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;                            <span class="comment">// subdomain-restricted variable with a</span></div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;                            <span class="comment">// just-expanded subdomain</span></div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;                            <span class="comment">// libmesh_assert(!elem-&gt;active() || fe_type.family == LAGRANGE ||</span></div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;                            <span class="comment">//                 elem-&gt;refinement_flag() == Elem::JUST_COARSENED);</span></div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;                            di.resize(di.size() + nc, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;                          }</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;                      }</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;                  }</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;            }</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;        } <span class="comment">// end loop over variables within group</span></div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;    } <span class="comment">// end loop over variable groups</span></div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_a5588f6411946120c9d917450ab73e2e2"><div class="ttname"><a href="namespacelibMesh.html#a5588f6411946120c9d917450ab73e2e2">libMesh::invalid_uint</a></div><div class="ttdeci">const unsigned int invalid_uint</div><div class="ttdoc">A number which is used quite often to represent an invalid or uninitialized value for an unsigned int...</div><div class="ttdef"><b>Definition:</b> <a href="libmesh_8h_source.html#l00254">libmesh.h:254</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab59bc8ca645e02067744580fdf4c9616"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab59bc8ca645e02067744580fdf4c9616">libMesh::DofMap::variable_group</a></div><div class="ttdeci">const VariableGroup &amp; variable_group(const unsigned int c) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02101">dof_map.h:2101</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_adf3b0ebe7fcc0c41bced4c9f17bf4822"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">libMesh::DofObject::invalid_id</a></div><div class="ttdeci">static const dof_id_type invalid_id</div><div class="ttdoc">An invalid id to distinguish an uninitialized DofObject. </div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00477">dof_object.h:477</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a6058ea4ca2ef36bd90f44bcb052a1d1e"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a6058ea4ca2ef36bd90f44bcb052a1d1e">libMesh::DofMap::n_variable_groups</a></div><div class="ttdeci">unsigned int n_variable_groups() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00613">dof_map.h:613</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a244e7a1cd82d5e6ae8780c93205ec1fa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02093">dof_map.h:2093</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a347faeed226256bbb37de75dda07b8a3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a347faeed226256bbb37de75dda07b8a3">libMesh::DofMap::SCALAR_dof_indices</a></div><div class="ttdeci">void SCALAR_dof_indices(std::vector&lt; dof_id_type &gt; &amp;di, const unsigned int vn, const bool old_dofs=false) const </div><div class="ttdoc">Fills the vector di with the global degree of freedom indices corresponding to the SCALAR variable vn...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l02544">dof_map.C:2544</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a82dd81ff9e21bdc2d9c80f80c692a9ea"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a82dd81ff9e21bdc2d9c80f80c692a9ea">libMesh::DofMap::_dont_p_refine</a></div><div class="ttdeci">std::unordered_set&lt; unsigned int &gt; _dont_p_refine</div><div class="ttdoc">A container of variable groups that we should not p-refine. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02022">dof_map.h:2022</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a47865aeb6379c68169e926dd0ecc2b71"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::prepare_send_list </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Takes the <code>_send_list</code> vector (which may have duplicate entries) and sorts it. </p>
<p>The duplicate entries are then removed, resulting in a sorted <code>_send_list</code> with unique entries. Also calls any user-provided methods for adding to the send list. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l01692">1692</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01915">_augment_send_list</a>, <a class="el" href="dof__map_8h_source.html#l01925">_extra_send_list_context</a>, <a class="el" href="dof__map_8h_source.html#l01920">_extra_send_list_function</a>, <a class="el" href="dof__map_8h_source.html#l01893">_send_list</a>, <a class="el" href="classlibMesh_1_1DofMap_1_1AugmentSendList.html#af71fdda1b5ff26602fd804381349d5ff">libMesh::DofMap::AugmentSendList::augment_send_list()</a>, <a class="el" href="dof__map_8h_source.html#l00659">n_dofs()</a> , 以及 <a class="el" href="namespacelibMesh.html#a08e2b5dd30d71db9e43c52a5a631fdae">libMesh::out</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01734">reinit_send_list()</a>.</p>
<div class="fragment"><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;{</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;prepare_send_list()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;  <span class="comment">// Return immediately if there&#39;s no ghost data</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;  <span class="keywordflow">if</span> (this-&gt;n_processors() == 1)</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;  <span class="comment">// Check to see if we have any extra stuff to add to the send_list</span></div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#af1bdebf08fdd914c71545e45624e3c8f">_extra_send_list_function</a>)</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    {</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#a409a5dccf85edf7260f6186482cb9c9c">_augment_send_list</a>)</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        {</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;          libmesh_here();</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;          <a class="code" href="namespacelibMesh.html#a08e2b5dd30d71db9e43c52a5a631fdae">libMesh::out</a> &lt;&lt; <span class="stringliteral">&quot;WARNING:  You have specified both an extra send list function and object.\n&quot;</span></div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                       &lt;&lt; <span class="stringliteral">&quot;          Are you sure this is what you meant to do??&quot;</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;                       &lt;&lt; std::endl;</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;        }</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;      <a class="code" href="classlibMesh_1_1DofMap.html#af1bdebf08fdd914c71545e45624e3c8f">_extra_send_list_function</a>(<a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>, <a class="code" href="classlibMesh_1_1DofMap.html#a6c450ba54bc8caffac28eed88a98a17d">_extra_send_list_context</a>);</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    }</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#a409a5dccf85edf7260f6186482cb9c9c">_augment_send_list</a>)</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a409a5dccf85edf7260f6186482cb9c9c">_augment_send_list</a>-&gt;<a class="code" href="classlibMesh_1_1DofMap_1_1AugmentSendList.html#af71fdda1b5ff26602fd804381349d5ff">augment_send_list</a> (<a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>);</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;  <span class="comment">// First sort the send list.  After this</span></div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;  <span class="comment">// duplicated elements will be adjacent in the</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;  <span class="comment">// vector</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;  std::sort(<a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>.begin(), <a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>.end());</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;  <span class="comment">// Now use std::unique to remove duplicate entries</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;  std::vector&lt;dof_id_type&gt;::iterator new_end =</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    std::unique (<a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>.begin(), <a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>.end());</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;  <span class="comment">// Remove the end of the send_list.  Use the &quot;swap trick&quot;</span></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;  <span class="comment">// from Effective STL</span></div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  std::vector&lt;dof_id_type&gt; (<a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>.begin(), new_end).swap (<a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>);</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;  <span class="comment">// Make sure the send list has nothing invalid in it.</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;  libmesh_assert(<a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>.empty() || <a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>.back() &lt; this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a77f8d984574b1bf8886057799e9b0134">n_dofs</a>());</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2b3873478d701811b9562b514fc2c369"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">libMesh::DofMap::_send_list</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _send_list</div><div class="ttdoc">A list containing all the global DOF indices that affect the solution on my processor. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01893">dof_map.h:1893</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_1_1AugmentSendList_html_af71fdda1b5ff26602fd804381349d5ff"><div class="ttname"><a href="classlibMesh_1_1DofMap_1_1AugmentSendList.html#af71fdda1b5ff26602fd804381349d5ff">libMesh::DofMap::AugmentSendList::augment_send_list</a></div><div class="ttdeci">virtual void augment_send_list(std::vector&lt; dof_id_type &gt; &amp;send_list)=0</div><div class="ttdoc">User-defined function to augment the send list. </div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a77f8d984574b1bf8886057799e9b0134"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a77f8d984574b1bf8886057799e9b0134">libMesh::DofMap::n_dofs</a></div><div class="ttdeci">dof_id_type n_dofs() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00659">dof_map.h:659</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a409a5dccf85edf7260f6186482cb9c9c"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a409a5dccf85edf7260f6186482cb9c9c">libMesh::DofMap::_augment_send_list</a></div><div class="ttdeci">AugmentSendList * _augment_send_list</div><div class="ttdoc">Function object to call to add extra entries to the send list. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01915">dof_map.h:1915</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a08e2b5dd30d71db9e43c52a5a631fdae"><div class="ttname"><a href="namespacelibMesh.html#a08e2b5dd30d71db9e43c52a5a631fdae">libMesh::out</a></div><div class="ttdeci">OStreamProxy out</div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a6c450ba54bc8caffac28eed88a98a17d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a6c450ba54bc8caffac28eed88a98a17d">libMesh::DofMap::_extra_send_list_context</a></div><div class="ttdeci">void * _extra_send_list_context</div><div class="ttdoc">A pointer associated with the extra send list that can optionally be passed in. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01925">dof_map.h:1925</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af1bdebf08fdd914c71545e45624e3c8f"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af1bdebf08fdd914c71545e45624e3c8f">libMesh::DofMap::_extra_send_list_function</a></div><div class="ttdeci">void(* _extra_send_list_function)(std::vector&lt; dof_id_type &gt; &amp;, void *)</div><div class="ttdoc">A function pointer to a function to call to add extra entries to the send list. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01920">dof_map.h:1920</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4025cf112c6862b2d1de87c21b2a6c5d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::print_dof_constraints </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em> = <code><a class="el" href="namespacelibMesh.html#a08e2b5dd30d71db9e43c52a5a631fdae">libMesh::out</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>print_nonlocal</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints (from processor 0) all DoF and Node constraints. </p>
<p>If <code>print_nonlocal</code> is true, then each constraint is printed once for each processor that knows about it, which may be useful for <code>DistributedMesh</code> debugging. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l02262">2262</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map__constraints_8C_source.html#l02288">get_local_constraints()</a>.</p>
<div class="fragment"><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;{</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;  parallel_object_only();</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;  std::string local_constraints =</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#abe6b1771bcaadff20add06bd0b1bd21d">get_local_constraints</a>(print_nonlocal);</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;  <span class="keywordflow">if</span> (this-&gt;processor_id())</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;    {</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;      this-&gt;comm().send(0, local_constraints);</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;    }</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;    {</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;Processor 0:\n&quot;</span>;</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;      os &lt;&lt; local_constraints;</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> p : IntRange&lt;processor_id_type&gt;(1, this-&gt;n_processors()))</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;        {</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;          this-&gt;comm().receive(p, local_constraints);</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;          os &lt;&lt; <span class="stringliteral">&quot;Processor &quot;</span> &lt;&lt; p &lt;&lt; <span class="stringliteral">&quot;:\n&quot;</span>;</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;          os &lt;&lt; local_constraints;</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;        }</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;    }</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_abe6b1771bcaadff20add06bd0b1bd21d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#abe6b1771bcaadff20add06bd0b1bd21d">libMesh::DofMap::get_local_constraints</a></div><div class="ttdeci">std::string get_local_constraints(bool print_nonlocal=false) const </div><div class="ttdoc">Gets a string reporting all DoF and Node constraints local to this processor. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l02288">dof_map_constraints.C:2288</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a13ce734a14ffd1dbb6496dab702da8e1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::ReferenceCounter::print_info </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>out_stream</em> = <code><a class="el" href="namespacelibMesh.html#a08e2b5dd30d71db9e43c52a5a631fdae">libMesh::out</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Prints the reference information, by default to <code><a class="el" href="namespacelibMesh.html#a08e2b5dd30d71db9e43c52a5a631fdae">libMesh::out</a></code>. </p>

<p>在文件 <a class="el" href="reference__counter_8C_source.html">reference_counter.C</a> 第 <a class="el" href="reference__counter_8C_source.html#l00081">81</a> 行定义.</p>

<p>参考 <a class="el" href="reference__counter_8h_source.html#l00143">libMesh::ReferenceCounter::_enable_print_counter</a> , 以及 <a class="el" href="reference__counter_8C_source.html#l00047">libMesh::ReferenceCounter::get_info()</a>.</p>

<p>参考自 <a class="el" href="libmesh_8C_source.html#l00668">libMesh::LibMeshInit::~LibMeshInit()</a>.</p>
<div class="fragment"><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;{</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1ReferenceCounter.html#a8f75e8a4a280f2c41636f2ae1307a311">_enable_print_counter</a>)</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    out_stream &lt;&lt; <a class="code" href="classlibMesh_1_1ReferenceCounter.html#a103b37125ae9eaaadf6f7854df17faa2">ReferenceCounter::get_info</a>();</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1ReferenceCounter_html_a103b37125ae9eaaadf6f7854df17faa2"><div class="ttname"><a href="classlibMesh_1_1ReferenceCounter.html#a103b37125ae9eaaadf6f7854df17faa2">libMesh::ReferenceCounter::get_info</a></div><div class="ttdeci">static std::string get_info()</div><div class="ttdoc">Gets a string containing the reference information. </div><div class="ttdef"><b>Definition:</b> <a href="reference__counter_8C_source.html#l00047">reference_counter.C:47</a></div></div>
<div class="ttc" id="classlibMesh_1_1ReferenceCounter_html_a8f75e8a4a280f2c41636f2ae1307a311"><div class="ttname"><a href="classlibMesh_1_1ReferenceCounter.html#a8f75e8a4a280f2c41636f2ae1307a311">libMesh::ReferenceCounter::_enable_print_counter</a></div><div class="ttdeci">static bool _enable_print_counter</div><div class="ttdoc">Flag to control whether reference count information is printed when print_info is called...</div><div class="ttdef"><b>Definition:</b> <a href="reference__counter_8h_source.html#l00143">reference_counter.h:143</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0b01b32e3e5a146cbda0a64e9e39f451"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::print_info </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em> = <code><a class="el" href="namespacelibMesh.html#a08e2b5dd30d71db9e43c52a5a631fdae">libMesh::out</a></code></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints summary info about the sparsity bandwidth and constraints. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l02915">2915</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8C_source.html#l02922">get_info()</a>.</p>
<div class="fragment"><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;{</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;  os &lt;&lt; this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a4e4f1eeb9c6c7a7196d96d969bfb0e32">get_info</a>();</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a4e4f1eeb9c6c7a7196d96d969bfb0e32"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a4e4f1eeb9c6c7a7196d96d969bfb0e32">libMesh::DofMap::get_info</a></div><div class="ttdeci">std::string get_info() const </div><div class="ttdoc">Gets summary info about the sparsity bandwidth and constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l02922">dof_map.C:2922</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae07a8531f8f6a082a473c2e4b17a9ea2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::process_constraints </td>
          <td>(</td>
          <td class="paramtype">MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Postprocesses any constrained degrees of freedom to be constrained only in terms of unconstrained dofs, then adds unconstrained dofs to the send_list and prepares that for use. </p>
<p>This should be run after both system (create_dof_constraints) and user constraints have all been added. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l04372">4372</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02034">_adjoint_constraint_values</a>, <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>, <a class="el" href="dof__map_8h_source.html#l01828">_error_on_constraint_loop</a>, <a class="el" href="dof__map_8h_source.html#l02032">_primal_constraint_values</a>, <a class="el" href="dof__map__constraints_8C_source.html#l05349">add_constraints_to_send_list()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03708">allgather_recursive_constraints()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l04545">check_for_constraint_loops()</a>, <a class="el" href="libmesh__common_8h_source.html#l00143">libMesh::Real</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l04643">scatter_constraints()</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01734">reinit_send_list()</a>.</p>
<div class="fragment"><div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;{</div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;  <span class="comment">// We&#39;ve computed our local constraints, but they may depend on</span></div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;  <span class="comment">// non-local constraints that we&#39;ll need to take into account.</span></div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a21fda1ca99f13ac340a05a8e41ecc8e9">allgather_recursive_constraints</a>(mesh);</div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;</div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#aef749fe651254903abfc12d9b81e2a16">_error_on_constraint_loop</a>)</div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;  {</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;    <span class="comment">// Optionally check for constraint loops and throw an error</span></div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;    <span class="comment">// if they&#39;re detected. We always do this check below in dbg/devel</span></div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;    <span class="comment">// mode but here we optionally do it in opt mode as well.</span></div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#ab905c6911894def0c2cd5e8163adec15">check_for_constraint_loops</a>();</div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;  }</div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;</div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;  <span class="comment">// Adjoints will be constrained where the primal is</span></div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;  <span class="comment">// Therefore, we will expand the adjoint_constraint_values</span></div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;  <span class="comment">// map whenever the primal_constraint_values map is expanded</span></div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;</div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;  <span class="comment">// First, figure out the total number of QoIs</span></div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> max_qoi_num =</div>
<div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.empty() ?</div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;    0 : <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.rbegin()-&gt;first+1;</div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;</div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;  <span class="comment">// Create a set containing the DOFs we already depend on</span></div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;  <span class="keyword">typedef</span> std::set&lt;dof_id_type&gt; RCSet;</div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;  RCSet unexpanded_set;</div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;</div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; i : <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>)</div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;    unexpanded_set.insert(i.first);</div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;</div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;  <span class="keywordflow">while</span> (!unexpanded_set.empty())</div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;    <span class="keywordflow">for</span> (RCSet::iterator i = unexpanded_set.begin();</div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;         i != unexpanded_set.end(); <span class="comment">/* nothing */</span>)</div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;      {</div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;        <span class="comment">// If the DOF is constrained</span></div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;        DofConstraints::iterator</div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;          pos = _dof_constraints.find(*i);</div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;</div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;        libmesh_assert (pos != _dof_constraints.end());</div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;</div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;        <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; constraint_row = pos-&gt;second;</div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;</div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;        DofConstraintValueMap::iterator rhsit =</div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;          <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.find(*i);</div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;        <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> constraint_rhs = (rhsit == <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.end()) ?</div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;          0 : rhsit-&gt;second;</div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;</div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;        <span class="comment">// A vector of DofConstraintValueMaps for each adjoint variable</span></div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;        std::vector&lt;DofConstraintValueMap::iterator&gt; adjoint_rhs_iterators;</div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;        adjoint_rhs_iterators.resize(max_qoi_num);</div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;</div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;        <span class="comment">// Another to hold the adjoint constraint rhs</span></div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;        std::vector&lt;Number&gt; adjoint_constraint_rhs(max_qoi_num, 0.0);</div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;</div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;        <span class="comment">// Find and gather recursive constraints for each adjoint variable</span></div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; adjoint_map : <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>)</div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;          {</div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;            <span class="keyword">const</span> std::size_t q = adjoint_map.first;</div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;            adjoint_rhs_iterators[q] = adjoint_map.second.find(*i);</div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;</div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;            adjoint_constraint_rhs[q] =</div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;              (adjoint_rhs_iterators[q] == adjoint_map.second.end()) ?</div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;              0 : adjoint_rhs_iterators[q]-&gt;second;</div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;          }</div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;</div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;        std::vector&lt;dof_id_type&gt; constraints_to_expand;</div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;</div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : constraint_row)</div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;          <span class="keywordflow">if</span> (item.first != *i &amp;&amp; this-&gt;is_constrained_dof(item.first))</div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;            {</div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;              unexpanded_set.insert(item.first);</div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;              constraints_to_expand.push_back(item.first);</div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;            }</div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;</div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; expandable : constraints_to_expand)</div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;          {</div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> this_coef = constraint_row[expandable];</div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;</div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;            DofConstraints::const_iterator</div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;              subpos = _dof_constraints.find(expandable);</div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;</div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;            libmesh_assert (subpos != _dof_constraints.end());</div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;</div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;            <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; subconstraint_row = subpos-&gt;second;</div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;</div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; item : subconstraint_row)</div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;              {</div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;                <span class="comment">// Assert that the constraint does not form a cycle.</span></div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;                libmesh_assert(item.first != expandable);</div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;                constraint_row[item.first] += item.second * this_coef;</div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;              }</div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;</div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;            DofConstraintValueMap::const_iterator subrhsit =</div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;              <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.find(expandable);</div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;            <span class="keywordflow">if</span> (subrhsit != <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.end())</div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;              constraint_rhs += subrhsit-&gt;second * this_coef;</div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;</div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;            <span class="comment">// Find and gather recursive constraints for each adjoint variable</span></div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;            for (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; adjoint_map : _adjoint_constraint_values)</div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;              {</div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;                <span class="keyword">const</span> std::size_t q = adjoint_map.first;</div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;</div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;                DofConstraintValueMap::const_iterator adjoint_subrhsit =</div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;                  adjoint_map.second.find(expandable);</div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;</div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;                <span class="keywordflow">if</span> (adjoint_subrhsit != adjoint_map.second.end())</div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;                adjoint_constraint_rhs[q] += adjoint_subrhsit-&gt;second * this_coef;</div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;              }</div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;</div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;            constraint_row.erase(expandable);</div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;          }</div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;</div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;        <span class="keywordflow">if</span> (rhsit == <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.end())</div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;          {</div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;            <span class="keywordflow">if</span> (constraint_rhs != <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>(0))</div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;              <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>[*i] = constraint_rhs;</div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;              <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.erase(*i);</div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;          }</div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;          {</div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;            <span class="keywordflow">if</span> (constraint_rhs != <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>(0))</div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;              rhsit-&gt;second = constraint_rhs;</div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;              <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.erase(rhsit);</div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;          }</div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;</div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;        <span class="comment">// Finally fill in the adjoint constraints for each adjoint variable if possible</span></div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; adjoint_map : _adjoint_constraint_values)</div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;          {</div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;            <span class="keyword">const</span> std::size_t q = adjoint_map.first;</div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;</div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;            <span class="keywordflow">if</span>(adjoint_rhs_iterators[q] == adjoint_map.second.end())</div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;              {</div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;                <span class="keywordflow">if</span> (adjoint_constraint_rhs[q] != <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>(0))</div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;                   (adjoint_map.second)[*i] = adjoint_constraint_rhs[q];</div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;                  adjoint_map.second.erase(*i);</div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;              }</div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;              {</div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;                <span class="keywordflow">if</span> (adjoint_constraint_rhs[q] != <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>(0))</div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;                  adjoint_rhs_iterators[q]-&gt;second = adjoint_constraint_rhs[q];</div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;                  adjoint_map.second.erase(adjoint_rhs_iterators[q]);</div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;              }</div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;          }</div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;</div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;        <span class="keywordflow">if</span> (constraints_to_expand.empty())</div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;          i = unexpanded_set.erase(i);</div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;          ++i;</div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;      }</div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;</div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;  <span class="comment">// In parallel we can&#39;t guarantee that nodes/dofs which constrain</span></div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;  <span class="comment">// others are on processors which are aware of that constraint, yet</span></div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;  <span class="comment">// we need such awareness for sparsity pattern generation.  So send</span></div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;  <span class="comment">// other processors any constraints they might need to know about.</span></div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a3db4816e2bba5ce9617e7bee6329de19">scatter_constraints</a>(mesh);</div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;</div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;  <span class="comment">// Now that we have our root constraint dependencies sorted out, add</span></div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;  <span class="comment">// them to the send_list</span></div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a0783b9a05a297be8f1c3e630301e0604">add_constraints_to_send_list</a>();</div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a3db4816e2bba5ce9617e7bee6329de19"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a3db4816e2bba5ce9617e7bee6329de19">libMesh::DofMap::scatter_constraints</a></div><div class="ttdeci">void scatter_constraints(MeshBase &amp;)</div><div class="ttdoc">Sends constraint equations to constraining processors. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l04643">dof_map_constraints.C:4643</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aef749fe651254903abfc12d9b81e2a16"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aef749fe651254903abfc12d9b81e2a16">libMesh::DofMap::_error_on_constraint_loop</a></div><div class="ttdeci">bool _error_on_constraint_loop</div><div class="ttdoc">This flag indicates whether or not we do an opt-mode check for the presence of constraint loops...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01828">dof_map.h:1828</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02034">dof_map.h:2034</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab905c6911894def0c2cd5e8163adec15"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab905c6911894def0c2cd5e8163adec15">libMesh::DofMap::check_for_constraint_loops</a></div><div class="ttdeci">void check_for_constraint_loops()</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l04545">dof_map_constraints.C:4545</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a21fda1ca99f13ac340a05a8e41ecc8e9"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a21fda1ca99f13ac340a05a8e41ecc8e9">libMesh::DofMap::allgather_recursive_constraints</a></div><div class="ttdeci">void allgather_recursive_constraints(MeshBase &amp;)</div><div class="ttdoc">Gathers constraint equation dependencies from other processors. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l03708">dof_map_constraints.C:3708</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aef28359fb4851abec08fc99cfbac118d"><div class="ttname"><a href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">libMesh::Real</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef LIBMESH_DEFAULT_SCALAR_TYPE Real</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00143">libmesh_common.h:143</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a0783b9a05a297be8f1c3e630301e0604"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a0783b9a05a297be8f1c3e630301e0604">libMesh::DofMap::add_constraints_to_send_list</a></div><div class="ttdeci">void add_constraints_to_send_list()</div><div class="ttdoc">Adds entries to the _send_list vector corresponding to DoFs which are dependencies for constraint equ...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l05349">dof_map_constraints.C:5349</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02032">dof_map.h:2032</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdoc">A row of the Dof constraint matrix. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00090">dof_map.h:90</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a8b17bf24a15bc292850c3a3894e2e8f9"><div class="ttname"><a href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">libMesh::Number</a></div><div class="ttdeci">Real Number</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00214">libmesh_common.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4b79bfce2f7aefdd722b9bd8b34a9a11"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::process_mesh_constraint_rows </td>
          <td>(</td>
          <td class="paramtype">const MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Adds any spline constraints from the Mesh to our DoF constraints. </p>
<p>If any Dirichlet constraints exist on spline-constrained nodes, l2-projects those constraints onto the spline basis. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l01898">1898</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02034">_adjoint_constraint_values</a>, <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>, <a class="el" href="dof__map_8h_source.html#l02050">_periodic_boundaries</a>, <a class="el" href="dof__map_8h_source.html#l02032">_primal_constraint_values</a>, <a class="el" href="dof__map__constraints_8C_source.html#l02183">add_constraint_row()</a>, <a class="el" href="sparse__matrix_8C_source.html#l00151">libMesh::SparseMatrix&lt; T &gt;::build()</a>, <a class="el" href="numeric__vector_8C_source.html#l00050">libMesh::NumericVector&lt; T &gt;::build()</a>, <a class="el" href="dof__map_8C_source.html#l00064">build_sparsity()</a>, <a class="el" href="dof__map_8C_source.html#l01992">dof_indices()</a>, <a class="el" href="dof__map_8h_source.html#l00711">end_dof()</a>, <a class="el" href="dof__map_8h_source.html#l00687">first_dof()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l02529">heterogeneously_constrain_element_matrix_and_vector()</a>, <a class="el" href="dof__map_8h_source.html#l02179">is_constrained_dof()</a>, <a class="el" href="dof__map_8h_source.html#l00831">local_index()</a>, <a class="el" href="dof__map_8h_source.html#l00659">n_dofs()</a>, <a class="el" href="dof__map_8h_source.html#l00669">n_local_dofs()</a>, <a class="el" href="dof__map_8h_source.html#l00621">n_variables()</a>, <a class="el" href="dof__map_8h_source.html#l02093">sys_number()</a>, <a class="el" href="libmesh__common_8h_source.html#l00150">libMesh::TOLERANCE</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02141">variable_type()</a>.</p>

<p>参考自 <a class="el" href="dof__map__constraints_8C_source.html#l01736">create_dof_constraints()</a>.</p>
<div class="fragment"><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;{</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;  <span class="comment">// If we already have simple Dirichlet constraints (with right hand</span></div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;  <span class="comment">// sides but with no coupling between DoFs) on spline-constrained FE</span></div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;  <span class="comment">// nodes, then we&#39;ll need a solve to compute the corresponding</span></div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;  <span class="comment">// constraints on the relevant spline nodes.  (If we already have</span></div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;  <span class="comment">// constraints with coupling between DoFs on spline-constrained FE</span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;  <span class="comment">// nodes, then we&#39;ll need to go sit down and cry until we figure out</span></div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;  <span class="comment">// how to handle that.)</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> &amp; constraint_rows = mesh.get_constraint_rows();</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;  <span class="comment">// This routine is too expensive to use unless we really might</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;  <span class="comment">// need it</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">bool</span> constraint_rows_empty = constraint_rows.empty();</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;  this-&gt;comm().min(constraint_rows_empty);</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;  libmesh_assert(!constraint_rows_empty);</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;  <span class="comment">// This is fairly new code, still a bit experimental.</span></div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;  libmesh_experimental();</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;  <span class="comment">// We can&#39;t handle periodic boundary conditions on spline meshes</span></div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;  <span class="comment">// yet.</span></div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_PERIODIC</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;<span class="preprocessor"></span>  libmesh_error_msg_if (!<a class="code" href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">_periodic_boundaries</a>-&gt;empty(),</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;                        <span class="stringliteral">&quot;Periodic boundary conditions are not yet implemented for spline meshes&quot;</span>);</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;  <span class="comment">// We can handle existing Dirichlet constraints, but we&#39;ll need</span></div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;  <span class="comment">// to do solves to project them down onto the spline basis.</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;  std::unique_ptr&lt;SparsityPattern::Build&gt; sp;</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;  std::unique_ptr&lt;SparseMatrix&lt;Number&gt;&gt; mat;</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_adjoint_rhs =</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>.size();</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;  <span class="comment">// [0] for primal rhs, [q+1] for adjoint qoi q</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;  std::vector&lt;std::unique_ptr&lt;NumericVector&lt;Number&gt;&gt;&gt;</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    solve_rhs(n_adjoint_rhs+1);</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;  <span class="comment">// Keep track of which spline DoFs will be Dirichlet.</span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;  <span class="comment">// We use a set here to make it easier to find what processors</span></div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;  <span class="comment">// to send the DoFs to later.</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;  std::set&lt;dof_id_type&gt; my_dirichlet_spline_dofs;</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;  <span class="comment">// And keep track of which non-spline Dofs were Dirichlet</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;  std::unordered_set&lt;dof_id_type&gt; was_previously_constrained;</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sys_num = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">sys_number</a>();</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; node_row : constraint_rows)</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;    {</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;      <span class="keyword">const</span> Node * node = node_row.first;</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;      libmesh_assert(node == mesh.node_ptr(node-&gt;id()));</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;      <span class="comment">// Each processor only computes its own (and in distributed</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;      <span class="comment">// cases, is only guaranteed to have the dependency data to</span></div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;      <span class="comment">// compute its own) constraints here.</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;      <span class="keywordflow">if</span> (node-&gt;processor_id() != mesh.processor_id())</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> var_num : IntRange&lt;unsigned int&gt;(0, this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aee89c467613b296c215421d60d5ae961">n_variables</a>()))</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;        {</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;          <span class="keyword">const</span> FEFamily &amp; fe_family = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a0c010bb250d4cd8d65794452f46d141a">variable_type</a>(var_num).family;</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;          <span class="comment">// constraint_rows only applies to nodal variables</span></div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;          <span class="keywordflow">if</span> (fe_family != LAGRANGE &amp;&amp;</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;              fe_family != RATIONAL_BERNSTEIN)</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;          <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> dc_row;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained_id =</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;            node-&gt;dof_number(sys_num, var_num, 0);</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; [pr, val] : node_row.second)</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;            {</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;              <span class="keyword">const</span> Elem * spline_elem = pr.first;</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;              libmesh_assert(spline_elem == mesh.elem_ptr(spline_elem-&gt;id()));</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;              <span class="keyword">const</span> Node &amp; spline_node =</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;                spline_elem-&gt;node_ref(pr.second);</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> spline_dof_id =</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;                spline_node.dof_number(sys_num, var_num, 0);</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;              dc_row[spline_dof_id] = val;</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;            }</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;          <span class="comment">// See if we already have a constraint here.</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;          <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">is_constrained_dof</a>(constrained_id))</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;            {</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;              was_previously_constrained.insert(constrained_id);</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;              <span class="comment">// Keep track of which spline DoFs will be</span></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;              <span class="comment">// inheriting this non-spline DoF&#39;s constraints</span></div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;              <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; row_entry : dc_row)</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;                my_dirichlet_spline_dofs.insert(row_entry.first);</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;              <span class="comment">// If it wasn&#39;t a simple Dirichlet-type constraint</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;              <span class="comment">// then I don&#39;t know what to do with it.  We&#39;ll make</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;              <span class="comment">// this an assertion only because this should only</span></div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;              <span class="comment">// crop up with periodic boundary conditions, which</span></div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;              <span class="comment">// we&#39;ve already made sure we don&#39;t have.</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;              libmesh_assert(<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>[constrained_id].empty());</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;            }</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;          <span class="comment">// Add the constraint, replacing any previous, so we can</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;          <span class="comment">// use the new constraint in setting up the solve below</span></div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ada019c02054ed5945504a6c5fc856d69">add_constraint_row</a>(constrained_id, dc_row, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;        }</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    }</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;  <span class="comment">// my_dirichlet_spline_dofs may now include DoFs whose owners</span></div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;  <span class="comment">// don&#39;t know they need to become spline DoFs!  We need to push</span></div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;  <span class="comment">// this data to them.</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;  <span class="keywordflow">if</span> (this-&gt;comm().size() &gt; 1)</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    {</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;      std::unordered_map</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;        &lt;<a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a>, std::vector&lt;dof_id_type&gt;&gt;</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;        their_dirichlet_spline_dofs;</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;      <span class="comment">// If we ever change the underlying container here then we&#39;d</span></div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;      <span class="comment">// better do some kind of sort before using it; we&#39;ll rely</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;      <span class="comment">// on sorting to make the processor id lookup efficient.</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;      libmesh_assert(std::is_sorted(my_dirichlet_spline_dofs.begin(),</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;                                    my_dirichlet_spline_dofs.end()));</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;      processor_id_type destination_pid = 0;</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> d : my_dirichlet_spline_dofs)</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;        {</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;          libmesh_assert_less(d, this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a92230d3049a3a7a97b8ba2f34b3ec677">end_dof</a>(this-&gt;comm().size()-1));</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;          <span class="keywordflow">while</span> (d &gt;= this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a92230d3049a3a7a97b8ba2f34b3ec677">end_dof</a>(destination_pid))</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;            destination_pid++;</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;          <span class="keywordflow">if</span> (destination_pid != this-&gt;processor_id())</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;            their_dirichlet_spline_dofs[destination_pid].push_back(d);</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        }</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;      <span class="keyword">auto</span> receive_dof_functor =</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;        [&amp; my_dirichlet_spline_dofs]</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;        (<a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a>,</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;         <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; dofs)</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;        {</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;          my_dirichlet_spline_dofs.insert(dofs.begin(), dofs.end());</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;        };</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;      Parallel::push_parallel_vector_data</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;        (this-&gt;comm(), their_dirichlet_spline_dofs, receive_dof_functor);</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    }</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;  <span class="comment">// If anyone had any prior constraints in effect, then we need</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;  <span class="comment">// to convert them to constraints on the spline nodes.</span></div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;  <span class="comment">// NOT simply testing prior_constraints here; maybe it turned</span></div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;  <span class="comment">// out that all our constraints were on non-spline-constrained</span></div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;  <span class="comment">// parts of a hybrid mesh?</span></div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;  <span class="keywordtype">bool</span> important_prior_constraints =</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;    !was_previously_constrained.empty();</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;  this-&gt;comm().max(important_prior_constraints);</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;  <span class="keywordflow">if</span> (important_prior_constraints)</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    {</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;      <span class="comment">// Now that we have the spline constraints added, we can</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;      <span class="comment">// finally construct a sparsity pattern that correctly</span></div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;      <span class="comment">// accounts for those constraints!</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;      mat = <a class="code" href="classlibMesh_1_1SparseMatrix.html#a24060040686ce1e3bf9dd07e47e473da">SparseMatrix&lt;Number&gt;::build</a>(this-&gt;comm());</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> q : IntRange&lt;unsigned int&gt;(0, n_adjoint_rhs+1))</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;        {</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;          solve_rhs[q] = <a class="code" href="classlibMesh_1_1NumericVector.html#adba4a30965537656bb3b0c6f924ff040">NumericVector&lt;Number&gt;::build</a>(this-&gt;comm());</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;          solve_rhs[q]-&gt;init(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a77f8d984574b1bf8886057799e9b0134">n_dofs</a>(), this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8e8912a9fc6b900604ff23807edadd3b">n_local_dofs</a>(),</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;                             <span class="keyword">false</span>, PARALLEL);</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;        }</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;      <span class="comment">// We need to compute our own sparsity pattern, to take into</span></div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;      <span class="comment">// account the particularly non-sparse rows that can be</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;      <span class="comment">// created by the spline constraints we just added.</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;      mat-&gt;attach_dof_map(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;      sp = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a2a9137c2889d7b37503ff390f1034083">build_sparsity</a>(mesh);</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;      mat-&gt;attach_sparsity_pattern(*sp);</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;      mat-&gt;init();</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; node_row : constraint_rows)</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;        {</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;          <span class="keyword">const</span> Node * node = node_row.first;</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;          libmesh_assert(node == mesh.node_ptr(node-&gt;id()));</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> var_num : IntRange&lt;unsigned int&gt;(0, this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aee89c467613b296c215421d60d5ae961">n_variables</a>()))</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;            {</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;              <span class="keyword">const</span> FEFamily &amp; fe_family = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a0c010bb250d4cd8d65794452f46d141a">variable_type</a>(var_num).family;</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;              <span class="comment">// constraint_rows only applies to nodal variables</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;              <span class="keywordflow">if</span> (fe_family != LAGRANGE &amp;&amp;</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;                  fe_family != RATIONAL_BERNSTEIN)</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained_id =</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;                node-&gt;dof_number(sys_num, var_num, 0);</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;              <span class="keywordflow">if</span> (was_previously_constrained.count(constrained_id))</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;                {</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;                  <span class="keywordflow">for</span> (<span class="keyword">auto</span> q : IntRange&lt;int&gt;(0, n_adjoint_rhs+1))</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;                    {</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;                      <a class="code" href="classlibMesh_1_1DenseMatrix.html">DenseMatrix&lt;Number&gt;</a> K(1,1);</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;                      <a class="code" href="classlibMesh_1_1DenseVector.html">DenseVector&lt;Number&gt;</a> F(1);</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;                      std::vector&lt;dof_id_type&gt; <a class="code" href="classlibMesh_1_1DofMap.html#a0d323b6fcb736454a9f6074ebda9ec28">dof_indices</a>(1, constrained_id);</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;                      K(0,0) = 1;</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;                      <a class="code" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a> &amp; vals = q ?</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;                        <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>[q-1] :</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;                        <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>;</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;                      DofConstraintValueMap::const_iterator rhsit =</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;                        vals.find(constrained_id);</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;                      F(0) = (rhsit == vals.end()) ?  0 : rhsit-&gt;second;</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;                      <span class="comment">// We no longer need any rhs values here directly.</span></div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;                      if (rhsit != vals.end())</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;                        vals.erase(rhsit);</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;                      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a41e6fec77b9c1b0a7628420b61966749">heterogeneously_constrain_element_matrix_and_vector</a></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;                        (K, F, <a class="code" href="classlibMesh_1_1DofMap.html#a0d323b6fcb736454a9f6074ebda9ec28">dof_indices</a>, <span class="keyword">false</span>, q ? (q-1) : -1);</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;                      <span class="keywordflow">if</span> (!q)</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;                        mat-&gt;add_matrix(K, <a class="code" href="classlibMesh_1_1DofMap.html#a0d323b6fcb736454a9f6074ebda9ec28">dof_indices</a>);</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;                      solve_rhs[q]-&gt;add_vector(F, <a class="code" href="classlibMesh_1_1DofMap.html#a0d323b6fcb736454a9f6074ebda9ec28">dof_indices</a>);</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;                    }</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;                }</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;            }</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;        }</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;      <span class="comment">// Any DoFs that aren&#39;t part of any constraint, directly or</span></div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;      <span class="comment">// indirectly, need a diagonal term to make the matrix</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;      <span class="comment">// here invertible.</span></div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> d : IntRange&lt;dof_id_type&gt;(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#afe4e2d426832365090b199b7083c0a77">first_dof</a>(),</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;                                                 this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a92230d3049a3a7a97b8ba2f34b3ec677">end_dof</a>()))</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;        <span class="keywordflow">if</span> (!was_previously_constrained.count(d) &amp;&amp;</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;            !my_dirichlet_spline_dofs.count(d))</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;          mat-&gt;add(d,d,1);</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;      <span class="comment">// At this point, we&#39;re finally ready to solve for Dirichlet</span></div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;      <span class="comment">// constraint values on spline nodes.</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;      std::unique_ptr&lt;LinearSolver&lt;Number&gt;&gt; linear_solver =</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;        LinearSolver&lt;Number&gt;::build(this-&gt;comm());</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;      std::unique_ptr&lt;NumericVector&lt;Number&gt;&gt; projected_vals =</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;        <a class="code" href="classlibMesh_1_1NumericVector.html#adba4a30965537656bb3b0c6f924ff040">NumericVector&lt;Number&gt;::build</a>(this-&gt;comm());</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;      projected_vals-&gt;init(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a77f8d984574b1bf8886057799e9b0134">n_dofs</a>(), this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8e8912a9fc6b900604ff23807edadd3b">n_local_dofs</a>(),</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;                           <span class="keyword">false</span>, PARALLEL);</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;      <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> empty_row;</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> sd : my_dirichlet_spline_dofs)</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">local_index</a>(sd))</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ada019c02054ed5945504a6c5fc856d69">add_constraint_row</a>(sd, empty_row);</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> q : IntRange&lt;unsigned int&gt;(0, n_adjoint_rhs+1))</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;        {</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;          <span class="comment">// FIXME: we don&#39;t have an EquationSystems here, but I&#39;d</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;          <span class="comment">// rather not hardcode these...</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">double</span> tol = double(<a class="code" href="namespacelibMesh.html#aadc7666a2b443d9cccbb63174874c14f">TOLERANCE</a> * <a class="code" href="namespacelibMesh.html#aadc7666a2b443d9cccbb63174874c14f">TOLERANCE</a>);</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> max_its = 5000;</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;          linear_solver-&gt;solve(*mat, *projected_vals,</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;                               *(solve_rhs[q]), tol, max_its);</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;          <a class="code" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a> &amp; vals = q ?</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;            <a class="code" href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">_adjoint_constraint_values</a>[q-1] :</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;            <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>;</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> sd : my_dirichlet_spline_dofs)</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;            <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">local_index</a>(sd))</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;              {</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;                <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> constraint_rhs = (*projected_vals)(sd);</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;                std::pair&lt;DofConstraintValueMap::iterator, bool&gt; rhs_it =</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;                  vals.emplace(sd, constraint_rhs);</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;                <span class="keywordflow">if</span> (!rhs_it.second)</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;                  rhs_it.first-&gt;second = constraint_rhs;</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;              }</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;        }</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    }</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a0c010bb250d4cd8d65794452f46d141a"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a0c010bb250d4cd8d65794452f46d141a">libMesh::DofMap::variable_type</a></div><div class="ttdeci">const FEType &amp; variable_type(const unsigned int c) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02141">dof_map.h:2141</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aadc7666a2b443d9cccbb63174874c14f"><div class="ttname"><a href="namespacelibMesh.html#aadc7666a2b443d9cccbb63174874c14f">libMesh::TOLERANCE</a></div><div class="ttdeci">static constexpr Real TOLERANCE</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00150">libmesh_common.h:150</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab6d9ab04643e9028f7f0c9b4d18e0455"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">libMesh::DofMap::local_index</a></div><div class="ttdeci">bool local_index(dof_id_type dof_index) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00831">dof_map.h:831</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a77f8d984574b1bf8886057799e9b0134"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a77f8d984574b1bf8886057799e9b0134">libMesh::DofMap::n_dofs</a></div><div class="ttdeci">dof_id_type n_dofs() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00659">dof_map.h:659</a></div></div>
<div class="ttc" id="classlibMesh_1_1SparseMatrix_html_a24060040686ce1e3bf9dd07e47e473da"><div class="ttname"><a href="classlibMesh_1_1SparseMatrix.html#a24060040686ce1e3bf9dd07e47e473da">libMesh::SparseMatrix::build</a></div><div class="ttdeci">static std::unique_ptr&lt; SparseMatrix&lt; T &gt; &gt; build(const Parallel::Communicator &amp;comm, const SolverPackage solver_package=libMesh::default_solver_package(), const MatrixBuildType matrix_build_type=MatrixBuildType::AUTOMATIC)</div><div class="ttdoc">使用由 solver_package 指定的线性求解器包构建一个 SparseMatrix&amp;lt;T&amp;gt;。 </div><div class="ttdef"><b>Definition:</b> <a href="sparse__matrix_8C_source.html#l00151">sparse_matrix.C:151</a></div></div>
<div class="ttc" id="namespacelibMesh_html_af18245d4f872c36a41fc74086bda3e80"><div class="ttname"><a href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">libMesh::processor_id_type</a></div><div class="ttdeci">uint8_t processor_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00104">id_types.h:104</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a89fdd1d933dc29089eabf3e07908374d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a89fdd1d933dc29089eabf3e07908374d">libMesh::DofMap::_adjoint_constraint_values</a></div><div class="ttdeci">AdjointDofConstraintValues _adjoint_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02034">dof_map.h:2034</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9846273ba4930ef0364bc1fc954af914"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02179">dof_map.h:2179</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ada019c02054ed5945504a6c5fc856d69"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ada019c02054ed5945504a6c5fc856d69">libMesh::DofMap::add_constraint_row</a></div><div class="ttdeci">void add_constraint_row(const dof_id_type dof_number, const DofConstraintRow &amp;constraint_row, const Number constraint_rhs, const bool forbid_constraint_overwrite)</div><div class="ttdoc">Adds a copy of the user-defined row to the constraint matrix, using an inhomogeneous right-hand-side ...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l02183">dof_map_constraints.C:2183</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2a9137c2889d7b37503ff390f1034083"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2a9137c2889d7b37503ff390f1034083">libMesh::DofMap::build_sparsity</a></div><div class="ttdeci">std::unique_ptr&lt; SparsityPattern::Build &gt; build_sparsity(const MeshBase &amp;mesh, bool calculate_constrained=false) const </div><div class="ttdoc">Builds a sparsity pattern for matrices using the current degree-of-freedom numbering and coupling...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l00064">dof_map.C:64</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a244e7a1cd82d5e6ae8780c93205ec1fa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02093">dof_map.h:2093</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_adba4a30965537656bb3b0c6f924ff040"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#adba4a30965537656bb3b0c6f924ff040">libMesh::NumericVector::build</a></div><div class="ttdeci">static std::unique_ptr&lt; NumericVector&lt; T &gt; &gt; build(const Parallel::Communicator &amp;comm, const SolverPackage solver_package=libMesh::default_solver_package())</div><div class="ttdoc">构建一个 NumericVector 对象。 </div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8C_source.html#l00050">numeric_vector.C:50</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofConstraintValueMap_html"><div class="ttname"><a href="classlibMesh_1_1DofConstraintValueMap.html">libMesh::DofConstraintValueMap</a></div><div class="ttdoc">Storage for DofConstraint right hand sides for a particular problem. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00110">dof_map.h:110</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a92230d3049a3a7a97b8ba2f34b3ec677"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a92230d3049a3a7a97b8ba2f34b3ec677">libMesh::DofMap::end_dof</a></div><div class="ttdeci">dof_id_type end_dof() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00711">dof_map.h:711</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aee89c467613b296c215421d60d5ae961"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aee89c467613b296c215421d60d5ae961">libMesh::DofMap::n_variables</a></div><div class="ttdeci">unsigned int n_variables() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00621">dof_map.h:621</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab91693b08a22cfe1af7781287157ac8a"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab91693b08a22cfe1af7781287157ac8a">libMesh::DofMap::_periodic_boundaries</a></div><div class="ttdeci">std::unique_ptr&lt; PeriodicBoundaries &gt; _periodic_boundaries</div><div class="ttdoc">Data structure containing periodic boundaries. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02050">dof_map.h:2050</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02032">dof_map.h:2032</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8e8912a9fc6b900604ff23807edadd3b"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8e8912a9fc6b900604ff23807edadd3b">libMesh::DofMap::n_local_dofs</a></div><div class="ttdeci">dof_id_type n_local_dofs() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00669">dof_map.h:669</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdoc">A row of the Dof constraint matrix. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00090">dof_map.h:90</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseVector_html"><div class="ttname"><a href="classlibMesh_1_1DenseVector.html">libMesh::DenseVector</a></div><div class="ttdoc">定义用于有限元计算的稠密向量类。该类基本上是为了补充 DenseMatrix 类而设计的。 它相对于 std::vector 具有额外的功能，使其在有限元中特别有用，特别是对于方程组。 所有重写的虚拟函...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00064">dof_map.h:64</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a8b17bf24a15bc292850c3a3894e2e8f9"><div class="ttname"><a href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">libMesh::Number</a></div><div class="ttdeci">Real Number</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00214">libmesh_common.h:214</a></div></div>
<div class="ttc" id="classlibMesh_1_1DenseMatrix_html"><div class="ttname"><a href="classlibMesh_1_1DenseMatrix.html">libMesh::DenseMatrix</a></div><div class="ttdoc">定义用于有限元类型计算的密集矩阵。 用于在求和成全局矩阵之前存储单元刚度矩阵。所有被覆盖的虚函数都记录在dense_matrix_base.h中。 </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00065">dof_map.h:65</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a41e6fec77b9c1b0a7628420b61966749"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a41e6fec77b9c1b0a7628420b61966749">libMesh::DofMap::heterogeneously_constrain_element_matrix_and_vector</a></div><div class="ttdeci">void heterogeneously_constrain_element_matrix_and_vector(DenseMatrix&lt; Number &gt; &amp;matrix, DenseVector&lt; Number &gt; &amp;rhs, std::vector&lt; dof_id_type &gt; &amp;elem_dofs, bool asymmetric_constraint_rows=true, int qoi_index=-1) const </div><div class="ttdoc">Constrains the element matrix and vector. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l02529">dof_map_constraints.C:2529</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_afe4e2d426832365090b199b7083c0a77"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#afe4e2d426832365090b199b7083c0a77">libMesh::DofMap::first_dof</a></div><div class="ttdeci">dof_id_type first_dof() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00687">dof_map.h:687</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a0d323b6fcb736454a9f6074ebda9ec28"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a0d323b6fcb736454a9f6074ebda9ec28">libMesh::DofMap::dof_indices</a></div><div class="ttdeci">void dof_indices(const Elem *const elem, std::vector&lt; dof_id_type &gt; &amp;di) const </div><div class="ttdoc">Fills the vector di with the global degree of freedom indices for the element. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01992">dof_map.C:1992</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abf4ed8e608b51a7a4e95935bf42ebbb1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::reinit </td>
          <td>(</td>
          <td class="paramtype">MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reinitialize the underlying data structures conformal to the current mesh. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l00506">506</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01933">_default_coupling</a>, <a class="el" href="dof__map_8h_source.html#l01589">_dof_coupling</a>, <a class="el" href="dof__map_8h_source.html#l02022">_dont_p_refine</a>, <a class="el" href="dof__map_8h_source.html#l01994">_n_SCALAR_dofs</a>, <a class="el" href="variable_8h_source.html#l00157">libMesh::Variable::active_on_subdomain()</a>, <a class="el" href="namespacelibMesh.html#ab0817b8542b150bfa3fb23393df99f28">libMesh::err</a>, <a class="el" href="dof__map_8C_source.html#l00835">invalidate_dofs()</a>, <a class="el" href="dof__map_8h_source.html#l00613">n_variable_groups()</a>, <a class="el" href="variable_8h_source.html#l00256">libMesh::VariableGroup::n_variables()</a>, <a class="el" href="dof__map_8h_source.html#l00621">n_variables()</a>, <a class="el" href="dof__map_8h_source.html#l02093">sys_number()</a>, <a class="el" href="variable_8h_source.html#l00140">libMesh::Variable::type()</a>, <a class="el" href="dof__map_8C_source.html#l01760">use_coupled_neighbor_dofs()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02101">variable_group()</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00927">distribute_dofs()</a>.</p>
<div class="fragment"><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;{</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  libmesh_assert (mesh.is_prepared());</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;reinit()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="comment">// We ought to reconfigure our default coupling functor.</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="comment">// The user might have removed it from our coupling functors set,</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="comment">// but if so, who cares, this reconfiguration is cheap.</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="comment">// Avoid calling set_dof_coupling() with an empty/non-nullptr</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="comment">// _dof_coupling matrix which may happen when there are actually no</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="comment">// variables on the system.</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab276e172c5488ab3b387b235e28556cf">_dof_coupling</a> &amp;&amp; this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab276e172c5488ab3b387b235e28556cf">_dof_coupling</a>-&gt;empty() &amp;&amp; !this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aee89c467613b296c215421d60d5ae961">n_variables</a>())</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab276e172c5488ab3b387b235e28556cf">_dof_coupling</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">_default_coupling</a>-&gt;set_dof_coupling(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab276e172c5488ab3b387b235e28556cf">_dof_coupling</a>);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  <span class="comment">// By default we may want 0 or 1 levels of coupling</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> standard_n_levels =</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a2489e7c067abb05feba00459ac70a1ba">use_coupled_neighbor_dofs</a>(mesh);</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">_default_coupling</a>-&gt;set_n_levels</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    (std::max(<a class="code" href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">_default_coupling</a>-&gt;n_levels(), standard_n_levels));</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="comment">// But we *don&#39;t* want to restrict to a CouplingMatrix unless the</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="comment">// user does so manually; the original libMesh behavior was to put</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  <span class="comment">// ghost indices on the send_list regardless of variable.</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="comment">//_default_evaluating-&gt;set_dof_coupling(this-&gt;_dof_coupling);</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    sys_num      = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">sys_number</a>(),</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    n_var_groups = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a6058ea4ca2ef36bd90f44bcb052a1d1e">n_variable_groups</a>();</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <span class="comment">// The DofObjects need to know how many variable groups we have, and</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <span class="comment">// how many variables there are in each group.</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  std::vector&lt;unsigned int&gt; n_vars_per_group;  n_vars_per_group.reserve (n_var_groups);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vg=0; vg&lt;n_var_groups; vg++)</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    n_vars_per_group.push_back (this-&gt;variable_group(vg).n_variables());</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_AMR</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  <span class="comment">//------------------------------------------------------------</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <span class="comment">// Clear the old_dof_objects for all the nodes</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <span class="comment">// and elements so that we can overwrite them</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; node : mesh.node_ptr_range())</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      node-&gt;clear_old_dof_object();</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      libmesh_assert (!node-&gt;get_old_dof_object());</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    }</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : mesh.element_ptr_range())</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    {</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      elem-&gt;clear_old_dof_object();</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      libmesh_assert (!elem-&gt;get_old_dof_object());</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    }</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  <span class="comment">//------------------------------------------------------------</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="comment">// Set the old_dof_objects for the elements that</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="comment">// weren&#39;t just created, if these old dof objects</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="comment">// had variables</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : mesh.element_ptr_range())</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    {</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      <span class="comment">// Skip the elements that were just refined</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      <span class="keywordflow">if</span> (elem-&gt;refinement_flag() == Elem::JUST_REFINED)</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <span class="keywordflow">for</span> (Node &amp; node : elem-&gt;node_ref_range())</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="keywordflow">if</span> (node.get_old_dof_object() == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;          <span class="keywordflow">if</span> (node.has_dofs(sys_num))</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            node.set_old_dof_object();</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      libmesh_assert (!elem-&gt;get_old_dof_object());</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      <span class="keywordflow">if</span> (elem-&gt;has_dofs(sys_num))</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        elem-&gt;set_old_dof_object();</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    }</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="preprocessor">#endif // #ifdef LIBMESH_ENABLE_AMR</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  <span class="comment">//------------------------------------------------------------</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="comment">// Then set the number of variables for each \p DofObject</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="comment">// equal to n_variables() for this system.  This will</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="comment">// handle new \p DofObjects that may have just been created</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="comment">// All the nodes</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; node : mesh.node_ptr_range())</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    node-&gt;set_n_vars_per_group(sys_num, n_vars_per_group);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="comment">// All the elements</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : mesh.element_ptr_range())</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    elem-&gt;set_n_vars_per_group(sys_num, n_vars_per_group);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="comment">// Zero _n_SCALAR_dofs, it will be updated below.</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">_n_SCALAR_dofs</a> = 0;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="comment">//------------------------------------------------------------</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <span class="comment">// Next allocate space for the DOF indices</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vg=0; vg&lt;n_var_groups; vg++)</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    {</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      <span class="keyword">const</span> VariableGroup &amp; vg_description = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab59bc8ca645e02067744580fdf4c9616">variable_group</a>(vg);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_var_in_group = vg_description.n_variables();</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      <span class="keyword">const</span> FEType &amp; base_fe_type        = vg_description.type();</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> add_p_level =</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_AMR</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="preprocessor"></span>          !<a class="code" href="classlibMesh_1_1DofMap.html#a82dd81ff9e21bdc2d9c80f80c692a9ea">_dont_p_refine</a>.count(vg);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="preprocessor"></span>          <span class="keyword">false</span>;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <span class="comment">// Don&#39;t need to loop over elements for a SCALAR variable</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <span class="comment">// Just increment _n_SCALAR_dofs</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <span class="keywordflow">if</span> (base_fe_type.family == SCALAR)</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">_n_SCALAR_dofs</a> += base_fe_type.order.get_order()*n_var_in_group;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      <span class="comment">// This should be constant even on p-refined elements</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span> extra_hanging_dofs =</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        FEInterface::extra_hanging_dofs(base_fe_type);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      <span class="comment">// For all the active elements, count vertex degrees of freedom.</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : mesh.active_element_ptr_range())</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        {</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;          libmesh_assert(elem);</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;          <span class="comment">// Skip the numbering if this variable is</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;          <span class="comment">// not active on this element&#39;s subdomain</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;          <span class="keywordflow">if</span> (!vg_description.active_on_subdomain(elem-&gt;subdomain_id()))</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;          FEType fe_type = base_fe_type;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;          <span class="keyword">const</span> ElemType type = elem-&gt;type();</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;          libmesh_error_msg_if(base_fe_type.order.get_order() &gt;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                               int(FEInterface::max_order(base_fe_type,type)),</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                               <span class="stringliteral">&quot;ERROR: Finite element &quot;</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                               &lt;&lt; Utility::enum_to_string(base_fe_type.family)</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                               &lt;&lt; <span class="stringliteral">&quot; on geometric element &quot;</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                               &lt;&lt; Utility::enum_to_string(type)</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                               &lt;&lt; <span class="stringliteral">&quot;\nonly supports FEInterface::max_order = &quot;</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                               &lt;&lt; FEInterface::max_order(base_fe_type,type)</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                               &lt;&lt; <span class="stringliteral">&quot;, not fe_type.order = &quot;</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                               &lt;&lt; base_fe_type.order);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_AMR</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="preprocessor"></span>          <span class="comment">// Make sure we haven&#39;t done more p refinement than we can</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;          <span class="comment">// handle</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;          <span class="keywordflow">if</span> (add_p_level*elem-&gt;p_level() + base_fe_type.order &gt;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;              FEInterface::max_order(base_fe_type, type))</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            {</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="preprocessor">#  ifdef DEBUG</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="preprocessor"></span>              <a class="code" href="namespacelibMesh.html#ab0817b8542b150bfa3fb23393df99f28">libMesh::err</a> &lt;&lt; <span class="stringliteral">&quot;WARNING: Finite element &quot;</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                           &lt;&lt; Utility::enum_to_string(base_fe_type.family)</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                           &lt;&lt; <span class="stringliteral">&quot; on geometric element &quot;</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                           &lt;&lt; Utility::enum_to_string(type) &lt;&lt; std::endl</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                           &lt;&lt; <span class="stringliteral">&quot;could not be p refined past FEInterface::max_order = &quot;</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                           &lt;&lt; FEInterface::max_order(base_fe_type,type)</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                           &lt;&lt; std::endl;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="preprocessor">#  endif</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="preprocessor"></span>              elem-&gt;set_p_level(FEInterface::max_order(base_fe_type,type)</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                                - base_fe_type.order);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;          <span class="comment">// Allocate the vertex DOFs</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> n : elem-&gt;node_index_range())</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            {</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;              Node &amp; node = elem-&gt;node_ref(n);</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;              <span class="keywordflow">if</span> (elem-&gt;is_vertex(n))</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                {</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> old_node_dofs =</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                    node.n_comp_group(sys_num, vg);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vertex_dofs =</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                    std::max(FEInterface::n_dofs_at_node(fe_type, elem, n, add_p_level),</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                             old_node_dofs);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                  <span class="comment">// Some discontinuous FEs have no vertex dofs</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                  <span class="keywordflow">if</span> (vertex_dofs &gt; old_node_dofs)</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                    {</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                      node.set_n_comp_group(sys_num, vg,</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                                            vertex_dofs);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                      <span class="comment">// Abusing dof_number to set a &quot;this is a</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                      <span class="comment">// vertex&quot; flag</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                      node.set_vg_dof_base(sys_num, vg,</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                                           vertex_dofs);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                      <span class="comment">// libMesh::out &lt;&lt; &quot;sys_num,vg,old_node_dofs,vertex_dofs=&quot;</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                      <span class="comment">//       &lt;&lt; sys_num &lt;&lt; &quot;,&quot;</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                      <span class="comment">//       &lt;&lt; vg &lt;&lt; &quot;,&quot;</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                      <span class="comment">//       &lt;&lt; old_node_dofs &lt;&lt; &quot;,&quot;</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                      <span class="comment">//       &lt;&lt; vertex_dofs &lt;&lt; &#39;\n&#39;,</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                      <span class="comment">// node.debug_buffer();</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                      <span class="comment">// libmesh_assert_equal_to (vertex_dofs, node.n_comp(sys_num, vg));</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                      <span class="comment">// libmesh_assert_equal_to (vertex_dofs, node.vg_dof_base(sys_num, vg));</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                    }</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                }</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            }</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        } <span class="comment">// done counting vertex dofs</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      <span class="comment">// count edge &amp; face dofs next</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; elem : mesh.active_element_ptr_range())</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;          libmesh_assert(elem);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;          <span class="comment">// Skip the numbering if this variable is</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;          <span class="comment">// not active on this element&#39;s subdomain</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;          <span class="keywordflow">if</span> (!vg_description.active_on_subdomain(elem-&gt;subdomain_id()))</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;          <span class="comment">// Allocate the edge and face DOFs</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> n : elem-&gt;node_index_range())</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            {</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;              Node &amp; node = elem-&gt;node_ref(n);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> old_node_dofs =</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                node.n_comp_group(sys_num, vg);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vertex_dofs = old_node_dofs?</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                cast_int&lt;unsigned int&gt;(node.vg_dof_base (sys_num,vg)):0;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> new_node_dofs =</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                FEInterface::n_dofs_at_node(base_fe_type, elem, n, add_p_level);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;              <span class="comment">// We&#39;ve already allocated vertex DOFs</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;              <span class="keywordflow">if</span> (elem-&gt;is_vertex(n))</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                {</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                  libmesh_assert_greater_equal (old_node_dofs, vertex_dofs);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                  <span class="comment">// //if (vertex_dofs &lt; new_node_dofs)</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                  <span class="comment">//   libMesh::out &lt;&lt; &quot;sys_num,vg,old_node_dofs,vertex_dofs,new_node_dofs=&quot;</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                  <span class="comment">//                &lt;&lt; sys_num &lt;&lt; &quot;,&quot;</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                  <span class="comment">//                &lt;&lt; vg &lt;&lt; &quot;,&quot;</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                  <span class="comment">//                &lt;&lt; old_node_dofs &lt;&lt; &quot;,&quot;</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                  <span class="comment">//                &lt;&lt; vertex_dofs &lt;&lt; &quot;,&quot;</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                  <span class="comment">//                &lt;&lt; new_node_dofs &lt;&lt; &#39;\n&#39;,</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                  <span class="comment">//     node.debug_buffer();</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                  libmesh_assert_greater_equal (vertex_dofs,   new_node_dofs);</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                }</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;              <span class="comment">// We need to allocate the rest</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                {</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                  <span class="comment">// If this has no dofs yet, it needs no vertex</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                  <span class="comment">// dofs, so we just give it edge or face dofs</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                  <span class="keywordflow">if</span> (!old_node_dofs)</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                    {</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                      node.set_n_comp_group(sys_num, vg,</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                                            new_node_dofs);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                      <span class="comment">// Abusing dof_number to set a &quot;this has no</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                      <span class="comment">// vertex dofs&quot; flag</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                      <span class="keywordflow">if</span> (new_node_dofs)</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                        node.set_vg_dof_base(sys_num, vg, 0);</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                    }</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                  <span class="comment">// If this has dofs, but has no vertex dofs,</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                  <span class="comment">// it may still need more edge or face dofs if</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                  <span class="comment">// we&#39;re p-refined.</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (vertex_dofs == 0)</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                    {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                      <span class="keywordflow">if</span> (new_node_dofs &gt; old_node_dofs)</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                        {</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                          node.set_n_comp_group(sys_num, vg,</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                                                new_node_dofs);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                          node.set_vg_dof_base(sys_num, vg,</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                                               vertex_dofs);</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                        }</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                    }</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                  <span class="comment">// If this is another element&#39;s vertex,</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                  <span class="comment">// add more (non-overlapping) edge/face dofs if</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                  <span class="comment">// necessary</span></div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (extra_hanging_dofs)</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                    {</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                      <span class="keywordflow">if</span> (new_node_dofs &gt; old_node_dofs - vertex_dofs)</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                        {</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                          node.set_n_comp_group(sys_num, vg,</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                                                vertex_dofs + new_node_dofs);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                          node.set_vg_dof_base(sys_num, vg,</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                                               vertex_dofs);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                        }</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                    }</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                  <span class="comment">// If this is another element&#39;s vertex, add any</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                  <span class="comment">// (overlapping) edge/face dofs if necessary</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                    {</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                      libmesh_assert_greater_equal (old_node_dofs, vertex_dofs);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                      <span class="keywordflow">if</span> (new_node_dofs &gt; old_node_dofs)</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                        {</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                          node.set_n_comp_group(sys_num, vg,</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                                                new_node_dofs);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                          node.set_vg_dof_base (sys_num, vg,</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                                                vertex_dofs);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                        }</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                    }</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                }</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            }</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;          <span class="comment">// Allocate the element DOFs</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dofs_per_elem =</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            FEInterface::n_dofs_per_elem(base_fe_type, elem, add_p_level);</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;          elem-&gt;set_n_comp_group(sys_num, vg, dofs_per_elem);</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        }</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    } <span class="comment">// end loop over variable groups</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <span class="comment">// Calling DofMap::reinit() by itself makes little sense,</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;  <span class="comment">// so we won&#39;t bother with nonlocal DofObjects.</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <span class="comment">// Those will be fixed by distribute_dofs</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  <span class="comment">//------------------------------------------------------------</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  <span class="comment">// Finally, clear all the current DOF indices</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  <span class="comment">// (distribute_dofs expects them cleared!)</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9cbe9d7dc9f93f266817f997562bfa7c">invalidate_dofs</a>(mesh);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9cbe9d7dc9f93f266817f997562bfa7c"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9cbe9d7dc9f93f266817f997562bfa7c">libMesh::DofMap::invalidate_dofs</a></div><div class="ttdeci">void invalidate_dofs(MeshBase &amp;mesh) const </div><div class="ttdoc">Invalidates all active DofObject dofs for this system. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l00835">dof_map.C:835</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab59bc8ca645e02067744580fdf4c9616"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab59bc8ca645e02067744580fdf4c9616">libMesh::DofMap::variable_group</a></div><div class="ttdeci">const VariableGroup &amp; variable_group(const unsigned int c) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02101">dof_map.h:2101</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8dbee781954d22ad785846b3a2a45193"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8dbee781954d22ad785846b3a2a45193">libMesh::DofMap::_n_SCALAR_dofs</a></div><div class="ttdeci">dof_id_type _n_SCALAR_dofs</div><div class="ttdoc">The total number of SCALAR dofs associated to all SCALAR variables. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01994">dof_map.h:1994</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab276e172c5488ab3b387b235e28556cf"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab276e172c5488ab3b387b235e28556cf">libMesh::DofMap::_dof_coupling</a></div><div class="ttdeci">CouplingMatrix * _dof_coupling</div><div class="ttdoc">Degree of freedom coupling. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01589">dof_map.h:1589</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a6058ea4ca2ef36bd90f44bcb052a1d1e"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a6058ea4ca2ef36bd90f44bcb052a1d1e">libMesh::DofMap::n_variable_groups</a></div><div class="ttdeci">unsigned int n_variable_groups() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00613">dof_map.h:613</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a244e7a1cd82d5e6ae8780c93205ec1fa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02093">dof_map.h:2093</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aee89c467613b296c215421d60d5ae961"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aee89c467613b296c215421d60d5ae961">libMesh::DofMap::n_variables</a></div><div class="ttdeci">unsigned int n_variables() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00621">dof_map.h:621</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab0817b8542b150bfa3fb23393df99f28"><div class="ttname"><a href="namespacelibMesh.html#ab0817b8542b150bfa3fb23393df99f28">libMesh::err</a></div><div class="ttdeci">OStreamProxy err</div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_abb069d1433ad6f8eeb4d5ebf44ae4dc8"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#abb069d1433ad6f8eeb4d5ebf44ae4dc8">libMesh::DofMap::_default_coupling</a></div><div class="ttdeci">std::unique_ptr&lt; DefaultCoupling &gt; _default_coupling</div><div class="ttdoc">The default coupling GhostingFunctor, used to implement standard libMesh sparsity pattern constructio...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01933">dof_map.h:1933</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a82dd81ff9e21bdc2d9c80f80c692a9ea"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a82dd81ff9e21bdc2d9c80f80c692a9ea">libMesh::DofMap::_dont_p_refine</a></div><div class="ttdeci">std::unordered_set&lt; unsigned int &gt; _dont_p_refine</div><div class="ttdoc">A container of variable groups that we should not p-refine. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02022">dof_map.h:2022</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2489e7c067abb05feba00459ac70a1ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2489e7c067abb05feba00459ac70a1ba">libMesh::DofMap::use_coupled_neighbor_dofs</a></div><div class="ttdeci">bool use_coupled_neighbor_dofs(const MeshBase &amp;mesh) const </div><div class="ttdoc">Tells other library functions whether or not this problem includes coupling between dofs in neighbori...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01760">dof_map.C:1760</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a114f4760a9d5c427c0f7e1823ec8b883"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::reinit_send_list </td>
          <td>(</td>
          <td class="paramtype">MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clears the <code>_send_list</code> vector and then rebuilds it. </p>
<p>This may be needed in special situations, for example when an algebraic coupling functor cannot be added to the <code><a class="el" href="classlibMesh_1_1DofMap.html" title="This class handles the numbering of degrees of freedom on a mesh. ">DofMap</a></code> until after it is completely setup. Then this method can be used to rebuild the send_list once the algebraic coupling functor is added. Note that while this will recommunicate constraints with the updated send_list, this does assume no new constraints have been added since the previous reinit_constraints call. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l01734">1734</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8C_source.html#l01544">add_neighbors_to_send_list()</a>, <a class="el" href="dof__map_8h_source.html#l00485">clear_send_list()</a>, <a class="el" href="dof__map_8C_source.html#l01692">prepare_send_list()</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l04372">process_constraints()</a>.</p>
<div class="fragment"><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;{</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a7f04c34ba9909c7d788196575c619aff">clear_send_list</a>();</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aed8eba054300e64164af4a8257bae8d8">add_neighbors_to_send_list</a>(mesh);</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_CONSTRAINTS</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;<span class="preprocessor"></span>  <span class="comment">// This is assuming that we only need to recommunicate</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;  <span class="comment">// the constraints and no new ones have been added since</span></div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;  <span class="comment">// a previous call to reinit_constraints.</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ae07a8531f8f6a082a473c2e4b17a9ea2">process_constraints</a>(mesh);</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;<span class="preprocessor"></span>  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a47865aeb6379c68169e926dd0ecc2b71">prepare_send_list</a>();</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a7f04c34ba9909c7d788196575c619aff"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a7f04c34ba9909c7d788196575c619aff">libMesh::DofMap::clear_send_list</a></div><div class="ttdeci">void clear_send_list()</div><div class="ttdoc">Clears the _send_list vector. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00485">dof_map.h:485</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aed8eba054300e64164af4a8257bae8d8"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aed8eba054300e64164af4a8257bae8d8">libMesh::DofMap::add_neighbors_to_send_list</a></div><div class="ttdeci">void add_neighbors_to_send_list(MeshBase &amp;mesh)</div><div class="ttdoc">Adds entries to the _send_list vector corresponding to DoFs on elements neighboring the current proce...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01544">dof_map.C:1544</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ae07a8531f8f6a082a473c2e4b17a9ea2"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ae07a8531f8f6a082a473c2e4b17a9ea2">libMesh::DofMap::process_constraints</a></div><div class="ttdeci">void process_constraints(MeshBase &amp;)</div><div class="ttdoc">Postprocesses any constrained degrees of freedom to be constrained only in terms of unconstrained dof...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l04372">dof_map_constraints.C:4372</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a47865aeb6379c68169e926dd0ecc2b71"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a47865aeb6379c68169e926dd0ecc2b71">libMesh::DofMap::prepare_send_list</a></div><div class="ttdeci">void prepare_send_list()</div><div class="ttdoc">Takes the _send_list vector (which may have duplicate entries) and sorts it. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01692">dof_map.C:1692</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1b0fefa113360f285feebc78bd3d27f5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::remove_adjoint_dirichlet_boundary </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1DirichletBoundary.html">DirichletBoundary</a> &amp;&#160;</td>
          <td class="paramname"><em>dirichlet_boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Removes from the system the specified Dirichlet boundary for the adjoint equation defined by Quantity of interest index q. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l05513">5513</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02064">_adjoint_dirichlet_boundaries</a>, <a class="el" href="dirichlet__boundaries_8h_source.html#l00180">libMesh::DirichletBoundary::b</a> , 以及 <a class="el" href="dirichlet__boundaries_8h_source.html#l00181">libMesh::DirichletBoundary::variables</a>.</p>
<div class="fragment"><div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160;{</div>
<div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;  libmesh_assert_greater(<a class="code" href="classlibMesh_1_1DofMap.html#a376604ef648f92ce79ed7d2c810b55f3">_adjoint_dirichlet_boundaries</a>.size(),</div>
<div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;                         qoi_index);</div>
<div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;</div>
<div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;  <span class="keyword">auto</span> lam = [&amp;boundary_to_remove](<span class="keyword">const</span> <span class="keyword">auto</span> &amp; bdy)</div>
<div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;    {<span class="keywordflow">return</span> bdy-&gt;b == boundary_to_remove.b &amp;&amp; bdy-&gt;variables == boundary_to_remove.variables;};</div>
<div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;</div>
<div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160;  <span class="keyword">auto</span> it = std::find_if(<a class="code" href="classlibMesh_1_1DofMap.html#a376604ef648f92ce79ed7d2c810b55f3">_adjoint_dirichlet_boundaries</a>[qoi_index]-&gt;begin(),</div>
<div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;                         <a class="code" href="classlibMesh_1_1DofMap.html#a376604ef648f92ce79ed7d2c810b55f3">_adjoint_dirichlet_boundaries</a>[qoi_index]-&gt;end(),</div>
<div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;                         lam);</div>
<div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;</div>
<div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;  <span class="comment">// Assert it was actually found and remove it from the vector</span></div>
<div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;  libmesh_assert (it != <a class="code" href="classlibMesh_1_1DofMap.html#a376604ef648f92ce79ed7d2c810b55f3">_adjoint_dirichlet_boundaries</a>[qoi_index]-&gt;end());</div>
<div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a376604ef648f92ce79ed7d2c810b55f3">_adjoint_dirichlet_boundaries</a>[qoi_index]-&gt;erase(it);</div>
<div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a376604ef648f92ce79ed7d2c810b55f3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a376604ef648f92ce79ed7d2c810b55f3">libMesh::DofMap::_adjoint_dirichlet_boundaries</a></div><div class="ttdeci">std::vector&lt; std::unique_ptr&lt; DirichletBoundaries &gt; &gt; _adjoint_dirichlet_boundaries</div><div class="ttdoc">Data structure containing Dirichlet functions. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02064">dof_map.h:2064</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5bf50c47e4d226197777f2aef750b47d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::remove_algebraic_ghosting_functor </td>
          <td>(</td>
          <td class="paramtype">GhostingFunctor &amp;&#160;</td>
          <td class="paramname"><em>evaluable_functor</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Removes a functor which was previously added to the set of algebraic ghosting functors, from both this <a class="el" href="classlibMesh_1_1DofMap.html" title="This class handles the numbering of degrees of freedom on a mesh. ">DofMap</a> and from the underlying mesh. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l01898">1898</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01951">_algebraic_ghosting_functors</a>, <a class="el" href="dof__map_8h_source.html#l01864">_mesh</a> , 以及 <a class="el" href="dof__map_8h_source.html#l01970">_shared_functors</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01844">remove_default_ghosting()</a>.</p>
<div class="fragment"><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;{</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a378d58f5e860f781a52adb61464c9378">_algebraic_ghosting_functors</a>.erase(&amp;evaluable_functor);</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a>.remove_ghosting_functor(evaluable_functor);</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;  <span class="keyword">auto</span> it = <a class="code" href="classlibMesh_1_1DofMap.html#ac72a2e7009922c18fc0a59ebcceb58b1">_shared_functors</a>.find(&amp;evaluable_functor);</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;  <span class="keywordflow">if</span> (it != <a class="code" href="classlibMesh_1_1DofMap.html#ac72a2e7009922c18fc0a59ebcceb58b1">_shared_functors</a>.end())</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#ac72a2e7009922c18fc0a59ebcceb58b1">_shared_functors</a>.erase(it);</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a378d58f5e860f781a52adb61464c9378"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a378d58f5e860f781a52adb61464c9378">libMesh::DofMap::_algebraic_ghosting_functors</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt; _algebraic_ghosting_functors</div><div class="ttdoc">The list of all GhostingFunctor objects to be used when distributing ghosted vectors. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01951">dof_map.h:1951</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ac0f1617e6f28fc596497b370092bcc17"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">libMesh::DofMap::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdoc">The mesh that system uses. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01864">dof_map.h:1864</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ac72a2e7009922c18fc0a59ebcceb58b1"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ac72a2e7009922c18fc0a59ebcceb58b1">libMesh::DofMap::_shared_functors</a></div><div class="ttdeci">std::map&lt; GhostingFunctor *, std::shared_ptr&lt; GhostingFunctor &gt; &gt; _shared_functors</div><div class="ttdoc">Hang on to references to any GhostingFunctor objects we were passed in shared_ptr form...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01970">dof_map.h:1970</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2f8cd289185341279958ce2baaed3fc0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::remove_coupling_functor </td>
          <td>(</td>
          <td class="paramtype">GhostingFunctor &amp;&#160;</td>
          <td class="paramname"><em>coupling_functor</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Removes a functor which was previously added to the set of coupling functors, from both this <a class="el" href="classlibMesh_1_1DofMap.html" title="This class handles the numbering of degrees of freedom on a mesh. ">DofMap</a> and from the underlying mesh. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l01873">1873</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01964">_coupling_functors</a>, <a class="el" href="dof__map_8h_source.html#l01864">_mesh</a> , 以及 <a class="el" href="dof__map_8h_source.html#l01970">_shared_functors</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01844">remove_default_ghosting()</a>.</p>
<div class="fragment"><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;{</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">_coupling_functors</a>.erase(&amp;coupling_functor);</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">_mesh</a>.remove_ghosting_functor(coupling_functor);</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;  <span class="keyword">auto</span> it = <a class="code" href="classlibMesh_1_1DofMap.html#ac72a2e7009922c18fc0a59ebcceb58b1">_shared_functors</a>.find(&amp;coupling_functor);</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;  <span class="keywordflow">if</span> (it != <a class="code" href="classlibMesh_1_1DofMap.html#ac72a2e7009922c18fc0a59ebcceb58b1">_shared_functors</a>.end())</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#ac72a2e7009922c18fc0a59ebcceb58b1">_shared_functors</a>.erase(it);</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aef1ebc9176a3f7ec9607ba4b26808991"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aef1ebc9176a3f7ec9607ba4b26808991">libMesh::DofMap::_coupling_functors</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt; _coupling_functors</div><div class="ttdoc">The list of all GhostingFunctor objects to be used when coupling degrees of freedom in matrix sparsit...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01964">dof_map.h:1964</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ac0f1617e6f28fc596497b370092bcc17"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ac0f1617e6f28fc596497b370092bcc17">libMesh::DofMap::_mesh</a></div><div class="ttdeci">MeshBase &amp; _mesh</div><div class="ttdoc">The mesh that system uses. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01864">dof_map.h:1864</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ac72a2e7009922c18fc0a59ebcceb58b1"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ac72a2e7009922c18fc0a59ebcceb58b1">libMesh::DofMap::_shared_functors</a></div><div class="ttdeci">std::map&lt; GhostingFunctor *, std::shared_ptr&lt; GhostingFunctor &gt; &gt; _shared_functors</div><div class="ttdoc">Hang on to references to any GhostingFunctor objects we were passed in shared_ptr form...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01970">dof_map.h:1970</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a02a5778a146177c6965d1bf997878ca4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::remove_default_ghosting </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove any default ghosting functor(s). </p>
<p>User-added ghosting functors will be unaffected.</p>
<p>Unless user-added equivalent ghosting functors exist, removing the default coupling functor is only safe for explicit solves, and removing the default algebraic ghosting functor is only safe for codes where no evaluations on neighbor cells (e.g. no jump error estimators) are done.</p>
<p>Defaults can be restored manually via <a class="el" href="classlibMesh_1_1DofMap.html#a71555fd980f9337928ae75bc36a1bd4e" title="Add the default functor(s) for coupling and algebraic ghosting. ">add_default_ghosting()</a>, or automatically if <a class="el" href="classlibMesh_1_1DofMap.html#a480f80bc9234a5586711833b87a89784" title="Free all new memory associated with the object, but restore its original state, with the mesh pointer...">clear()</a> returns the <a class="el" href="classlibMesh_1_1DofMap.html" title="This class handles the numbering of degrees of freedom on a mesh. ">DofMap</a> to a default state. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l01844">1844</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l00418">default_algebraic_ghosting()</a>, <a class="el" href="dof__map_8h_source.html#l00356">default_coupling()</a>, <a class="el" href="dof__map_8C_source.html#l01898">remove_algebraic_ghosting_functor()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l01873">remove_coupling_functor()</a>.</p>
<div class="fragment"><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;{</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a2f8cd289185341279958ce2baaed3fc0">remove_coupling_functor</a>(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aa387f2af29a1998bc1236a20a9870b64">default_coupling</a>());</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a5bf50c47e4d226197777f2aef750b47d">remove_algebraic_ghosting_functor</a>(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ac341c27edd859113d774716d5ad18d9f">default_algebraic_ghosting</a>());</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aa387f2af29a1998bc1236a20a9870b64"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa387f2af29a1998bc1236a20a9870b64">libMesh::DofMap::default_coupling</a></div><div class="ttdeci">DefaultCoupling &amp; default_coupling()</div><div class="ttdoc">Default coupling functor. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00356">dof_map.h:356</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ac341c27edd859113d774716d5ad18d9f"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ac341c27edd859113d774716d5ad18d9f">libMesh::DofMap::default_algebraic_ghosting</a></div><div class="ttdeci">DefaultCoupling &amp; default_algebraic_ghosting()</div><div class="ttdoc">Default algebraic ghosting functor. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00418">dof_map.h:418</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2f8cd289185341279958ce2baaed3fc0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2f8cd289185341279958ce2baaed3fc0">libMesh::DofMap::remove_coupling_functor</a></div><div class="ttdeci">void remove_coupling_functor(GhostingFunctor &amp;coupling_functor)</div><div class="ttdoc">Removes a functor which was previously added to the set of coupling functors, from both this DofMap a...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01873">dof_map.C:1873</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a5bf50c47e4d226197777f2aef750b47d"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a5bf50c47e4d226197777f2aef750b47d">libMesh::DofMap::remove_algebraic_ghosting_functor</a></div><div class="ttdeci">void remove_algebraic_ghosting_functor(GhostingFunctor &amp;evaluable_functor)</div><div class="ttdoc">Removes a functor which was previously added to the set of algebraic ghosting functors, from both this DofMap and from the underlying mesh. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01898">dof_map.C:1898</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae6183b4266a0562a8e53f898d685c689"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::remove_dirichlet_boundary </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1DirichletBoundary.html">DirichletBoundary</a> &amp;&#160;</td>
          <td class="paramname"><em>dirichlet_boundary</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Removes the specified Dirichlet boundary from the system. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l05499">5499</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02058">_dirichlet_boundaries</a>, <a class="el" href="dirichlet__boundaries_8h_source.html#l00180">libMesh::DirichletBoundary::b</a> , 以及 <a class="el" href="dirichlet__boundaries_8h_source.html#l00181">libMesh::DirichletBoundary::variables</a>.</p>
<div class="fragment"><div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;{</div>
<div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;  <span class="comment">// Find a boundary condition matching the one to be removed</span></div>
<div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;  <span class="keyword">auto</span> lam = [&amp;boundary_to_remove](<span class="keyword">const</span> <span class="keyword">auto</span> &amp; bdy)</div>
<div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160;    {<span class="keywordflow">return</span> bdy-&gt;b == boundary_to_remove.b &amp;&amp; bdy-&gt;variables == boundary_to_remove.variables;};</div>
<div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;</div>
<div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;  <span class="keyword">auto</span> it = std::find_if(<a class="code" href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">_dirichlet_boundaries</a>-&gt;begin(), <a class="code" href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">_dirichlet_boundaries</a>-&gt;end(), lam);</div>
<div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;</div>
<div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160;  <span class="comment">// Assert it was actually found and remove it from the vector</span></div>
<div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160;  libmesh_assert (it != <a class="code" href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">_dirichlet_boundaries</a>-&gt;end());</div>
<div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">_dirichlet_boundaries</a>-&gt;erase(it);</div>
<div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2e9be7e72291d4fd6e841ae7733a5ff0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2e9be7e72291d4fd6e841ae7733a5ff0">libMesh::DofMap::_dirichlet_boundaries</a></div><div class="ttdeci">std::unique_ptr&lt; DirichletBoundaries &gt; _dirichlet_boundaries</div><div class="ttdoc">Data structure containing Dirichlet functions. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02058">dof_map.h:2058</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a347faeed226256bbb37de75dda07b8a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::SCALAR_dof_indices </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>di</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>vn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>old_dofs</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fills the vector <code>di</code> with the global degree of freedom indices corresponding to the SCALAR variable vn. </p>
<p>If old_dofs=true, the old SCALAR dof indices are returned.</p>
<dl class="section note"><dt>注解</dt><dd>We do not need to pass in an element since SCALARs are global variables. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l02544">2544</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02017">_first_old_scalar_df</a>, <a class="el" href="dof__map_8h_source.html#l01887">_first_scalar_df</a>, <a class="el" href="dof__object_8h_source.html#l00477">libMesh::DofObject::invalid_id</a>, <a class="el" href="dof__map_8h_source.html#l01539">n_old_dofs()</a>, <a class="el" href="dof__map_8h_source.html#l00664">n_SCALAR_dofs()</a>, <a class="el" href="variable_8h_source.html#l00140">libMesh::Variable::type()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02111">variable()</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01992">dof_indices()</a>, <a class="el" href="dof__map_8C_source.html#l01109">local_variable_indices()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l02630">old_dof_indices()</a>.</p>
<div class="fragment"><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;{</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;SCALAR_dof_indices()&quot;</span>, <span class="stringliteral">&quot;DofMap&quot;</span>);</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;  libmesh_assert(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab36a0dc3c2c457fa8c01c1b0ba37facc">variable</a>(vn).type().family == SCALAR);</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_AMR</span></div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;<span class="preprocessor"></span>  <span class="comment">// If we&#39;re asking for old dofs then we&#39;d better have some</span></div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;  <span class="keywordflow">if</span> (old_dofs)</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;    libmesh_assert_greater_equal(<a class="code" href="classlibMesh_1_1DofMap.html#a1a5ccf3ea5ac20cd67ee29805c42d6c5">n_old_dofs</a>(), <a class="code" href="classlibMesh_1_1DofMap.html#a39feeb5bedb05e160b5190e26d433605">n_SCALAR_dofs</a>());</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;  <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> my_idx = old_dofs ?</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;    this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a92da14cf60e82ed600bfe67ca3422765">_first_old_scalar_df</a>[vn] : this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af1fc10139391d71da470387d9e4adbb5">_first_scalar_df</a>[vn];</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;<span class="preprocessor"></span>  <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> my_idx = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#af1fc10139391d71da470387d9e4adbb5">_first_scalar_df</a>[vn];</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;  libmesh_assert_not_equal_to(my_idx, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;  <span class="comment">// The number of SCALAR dofs comes from the variable order</span></div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> n_dofs_vn = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab36a0dc3c2c457fa8c01c1b0ba37facc">variable</a>(vn).<a class="code" href="classlibMesh_1_1Variable.html#a8dcb07137d70a83fcf5b412e08e2783e">type</a>().order.get_order();</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;  di.resize(n_dofs_vn);</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i != n_dofs_vn; ++i)</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;    di[i] = my_idx++;</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1Variable_html_a8dcb07137d70a83fcf5b412e08e2783e"><div class="ttname"><a href="classlibMesh_1_1Variable.html#a8dcb07137d70a83fcf5b412e08e2783e">libMesh::Variable::type</a></div><div class="ttdeci">const FEType &amp; type() const </div><div class="ttdef"><b>Definition:</b> <a href="variable_8h_source.html#l00140">variable.h:140</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab36a0dc3c2c457fa8c01c1b0ba37facc"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab36a0dc3c2c457fa8c01c1b0ba37facc">libMesh::DofMap::variable</a></div><div class="ttdeci">const Variable &amp; variable(const unsigned int c) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02111">dof_map.h:2111</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af1fc10139391d71da470387d9e4adbb5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af1fc10139391d71da470387d9e4adbb5">libMesh::DofMap::_first_scalar_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_scalar_df</div><div class="ttdoc">First DOF index for SCALAR variable v, or garbage for non-SCALAR variable v. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01887">dof_map.h:1887</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a92da14cf60e82ed600bfe67ca3422765"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a92da14cf60e82ed600bfe67ca3422765">libMesh::DofMap::_first_old_scalar_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _first_old_scalar_df</div><div class="ttdoc">First old DOF index for SCALAR variable v, or garbage for non-SCALAR variable v. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02017">dof_map.h:2017</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_adf3b0ebe7fcc0c41bced4c9f17bf4822"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">libMesh::DofObject::invalid_id</a></div><div class="ttdeci">static const dof_id_type invalid_id</div><div class="ttdoc">An invalid id to distinguish an uninitialized DofObject. </div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00477">dof_object.h:477</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a1a5ccf3ea5ac20cd67ee29805c42d6c5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a1a5ccf3ea5ac20cd67ee29805c42d6c5">libMesh::DofMap::n_old_dofs</a></div><div class="ttdeci">dof_id_type n_old_dofs() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01539">dof_map.h:1539</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a39feeb5bedb05e160b5190e26d433605"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a39feeb5bedb05e160b5190e26d433605">libMesh::DofMap::n_SCALAR_dofs</a></div><div class="ttdeci">dof_id_type n_SCALAR_dofs() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00664">dof_map.h:664</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3db4816e2bba5ce9617e7bee6329de19"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::scatter_constraints </td>
          <td>(</td>
          <td class="paramtype">MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends constraint equations to constraining processors. </p>

<p>在文件 <a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a> 第 <a class="el" href="dof__map__constraints_8C_source.html#l04643">4643</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a>, <a class="el" href="dof__map_8h_source.html#l01881">_end_df</a>, <a class="el" href="dof__map_8h_source.html#l02041">_node_constraints</a>, <a class="el" href="dof__map_8h_source.html#l02032">_primal_constraint_values</a>, <a class="el" href="dof__map_8h_source.html#l00344">coupling_functors_begin()</a>, <a class="el" href="dof__map_8h_source.html#l00350">coupling_functors_end()</a>, <a class="el" href="dof__map_8C_source.html#l01992">dof_indices()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l05055">gather_constraints()</a>, <a class="el" href="dof__map_8h_source.html#l02179">is_constrained_dof()</a>, <a class="el" href="dof__map_8h_source.html#l02163">is_constrained_node()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l01440">merge_ghost_functor_outputs()</a>.</p>

<p>参考自 <a class="el" href="dof__map__constraints_8C_source.html#l04372">process_constraints()</a>.</p>
<div class="fragment"><div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;{</div>
<div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;  <span class="comment">// At this point each processor with a constrained node knows</span></div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;  <span class="comment">// the corresponding constraint row, but we also need each processor</span></div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;  <span class="comment">// with a constrainer node to know the corresponding row(s).</span></div>
<div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;</div>
<div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;  parallel_object_only();</div>
<div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;</div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;  <span class="comment">// Return immediately if there&#39;s nothing to gather</span></div>
<div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;  <span class="keywordflow">if</span> (this-&gt;n_processors() == 1)</div>
<div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;</div>
<div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;  <span class="comment">// We might get to return immediately if none of the processors</span></div>
<div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;  <span class="comment">// found any constraints</span></div>
<div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> has_constraints = !<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.empty()</div>
<div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div>
<div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;<span class="preprocessor"></span>    || !<a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>.empty()</div>
<div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;<span class="preprocessor">#endif // LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div>
<div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;<span class="preprocessor"></span>    ;</div>
<div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;  this-&gt;comm().max(has_constraints);</div>
<div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;  <span class="keywordflow">if</span> (!has_constraints)</div>
<div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;</div>
<div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;  <span class="comment">// We may be receiving packed_range sends out of order with</span></div>
<div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;  <span class="comment">// parallel_sync tags, so make sure they&#39;re received correctly.</span></div>
<div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;  Parallel::MessageTag range_tag = this-&gt;comm().get_unique_tag();</div>
<div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;</div>
<div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;<span class="preprocessor"></span>  std::map&lt;processor_id_type, std::set&lt;dof_id_type&gt;&gt; pushed_node_ids;</div>
<div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;<span class="preprocessor">#endif // LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;  std::map&lt;processor_id_type, std::set&lt;dof_id_type&gt;&gt; pushed_ids;</div>
<div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;</div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;  <span class="comment">// Collect the dof constraints I need to push to each processor</span></div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;  <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained_proc_id = 0;</div>
<div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; [constrained, row] : <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>)</div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;    {</div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;      <span class="keywordflow">while</span> (constrained &gt;= <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>[constrained_proc_id])</div>
<div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;        constrained_proc_id++;</div>
<div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;</div>
<div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;      <span class="keywordflow">if</span> (constrained_proc_id != this-&gt;processor_id())</div>
<div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;</div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; j : row)</div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;        {</div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constraining = j.first;</div>
<div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;</div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;          <a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> constraining_proc_id = 0;</div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;          <span class="keywordflow">while</span> (constraining &gt;= <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>[constraining_proc_id])</div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;            constraining_proc_id++;</div>
<div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;</div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;          <span class="keywordflow">if</span> (constraining_proc_id != this-&gt;processor_id() &amp;&amp;</div>
<div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;              constraining_proc_id != constrained_proc_id)</div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;            pushed_ids[constraining_proc_id].insert(constrained);</div>
<div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;        }</div>
<div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;    }</div>
<div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;</div>
<div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;  <span class="comment">// Pack the dof constraint rows and rhs&#39;s to push</span></div>
<div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;</div>
<div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;  std::map&lt;<a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a>,</div>
<div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;          std::vector&lt;std::vector&lt;std::pair&lt;dof_id_type, Real&gt;&gt;&gt;&gt;</div>
<div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;    pushed_keys_vals, pushed_keys_vals_to_me;</div>
<div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;</div>
<div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;  std::map&lt;processor_id_type, std::vector&lt;std::pair&lt;dof_id_type, Number&gt;&gt;&gt;</div>
<div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;    pushed_ids_rhss, pushed_ids_rhss_to_me;</div>
<div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;</div>
<div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;  <span class="keyword">auto</span> gather_ids =</div>
<div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;    [<span class="keyword">this</span>,</div>
<div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;     &amp; pushed_ids,</div>
<div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;     &amp; pushed_keys_vals,</div>
<div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;     &amp; pushed_ids_rhss]</div>
<div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;    ()</div>
<div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;    {</div>
<div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; [pid, pid_ids] : pushed_ids)</div>
<div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;        {</div>
<div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;          <span class="keyword">const</span> std::size_t ids_size = pid_ids.size();</div>
<div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;          std::vector&lt;std::vector&lt;std::pair&lt;dof_id_type, Real&gt;&gt;&gt; &amp;</div>
<div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;            keys_vals = pushed_keys_vals[pid];</div>
<div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;          std::vector&lt;std::pair&lt;dof_id_type,Number&gt;&gt; &amp;</div>
<div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;            ids_rhss = pushed_ids_rhss[pid];</div>
<div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;          keys_vals.resize(ids_size);</div>
<div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;          ids_rhss.resize(ids_size);</div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;</div>
<div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;          std::size_t push_i;</div>
<div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;          std::set&lt;dof_id_type&gt;::const_iterator it;</div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;          <span class="keywordflow">for</span> (push_i = 0, it = pid_ids.begin();</div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;               it != pid_ids.end(); ++push_i, ++it)</div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;            {</div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained = *it;</div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;              <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; row = _dof_constraints[constrained];</div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;              keys_vals[push_i].assign(row.begin(), row.end());</div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;</div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;              DofConstraintValueMap::const_iterator rhsit =</div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;                <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.find(constrained);</div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;              ids_rhss[push_i].first = constrained;</div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;              ids_rhss[push_i].second =</div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;                (rhsit == <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.end()) ?</div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;                0 : rhsit-&gt;second;</div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;            }</div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;        }</div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;    };</div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;</div>
<div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;  gather_ids();</div>
<div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;</div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;  <span class="keyword">auto</span> ids_rhss_action_functor =</div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;    [&amp; pushed_ids_rhss_to_me]</div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;    (processor_id_type pid,</div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;     <span class="keyword">const</span> std::vector&lt;std::pair&lt;dof_id_type, Number&gt;&gt; &amp; data)</div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;    {</div>
<div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;      pushed_ids_rhss_to_me[pid] = data;</div>
<div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;    };</div>
<div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;</div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;  <span class="keyword">auto</span> keys_vals_action_functor =</div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;    [&amp; pushed_keys_vals_to_me]</div>
<div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;    (processor_id_type pid,</div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;     <span class="keyword">const</span> std::vector&lt;std::vector&lt;std::pair&lt;dof_id_type, Real&gt;&gt;&gt; &amp; data)</div>
<div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;    {</div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;      pushed_keys_vals_to_me[pid] = data;</div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;    };</div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;</div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;  Parallel::push_parallel_vector_data</div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;    (this-&gt;comm(), pushed_ids_rhss, ids_rhss_action_functor);</div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;  Parallel::push_parallel_vector_data</div>
<div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;    (this-&gt;comm(), pushed_keys_vals, keys_vals_action_functor);</div>
<div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;</div>
<div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;  <span class="comment">// Now work on traded dof constraint rows</span></div>
<div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;  <span class="keyword">auto</span> receive_dof_constraints =</div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;    [<span class="keyword">this</span>,</div>
<div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;     &amp; pushed_ids_rhss_to_me,</div>
<div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;     &amp; pushed_keys_vals_to_me]</div>
<div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;    ()</div>
<div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;    {</div>
<div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; [pid, ids_rhss] : pushed_ids_rhss_to_me)</div>
<div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;        {</div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span> &amp; keys_vals = pushed_keys_vals_to_me[pid];</div>
<div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;</div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;          libmesh_assert_equal_to</div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;            (ids_rhss.size(), keys_vals.size());</div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;</div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;          <span class="comment">// Add the dof constraints that I&#39;ve been sent</span></div>
<div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : index_range(ids_rhss))</div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;            {</div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;              <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained = ids_rhss[i].first;</div>
<div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;</div>
<div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;              <span class="comment">// If we don&#39;t already have a constraint for this dof,</span></div>
<div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;              <span class="comment">// add the one we were sent</span></div>
<div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;              <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">is_constrained_dof</a>(constrained))</div>
<div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;                {</div>
<div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;                  <a class="code" href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">DofConstraintRow</a> &amp; row = _dof_constraints[constrained];</div>
<div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;                  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; key_val : keys_vals[i])</div>
<div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;                    {</div>
<div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;                      libmesh_assert_less(key_val.first, this-&gt;n_dofs());</div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;                      row[key_val.first] = key_val.second;</div>
<div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;                    }</div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;                  <span class="keywordflow">if</span> (ids_rhss[i].second != <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>(0))</div>
<div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;                    <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>[constrained] =</div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;                      ids_rhss[i].second;</div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;                    <a class="code" href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">_primal_constraint_values</a>.erase(constrained);</div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;                }</div>
<div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;            }</div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;        }</div>
<div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;    };</div>
<div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;</div>
<div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;  receive_dof_constraints();</div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;</div>
<div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div>
<div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;<span class="preprocessor"></span>  <span class="comment">// Collect the node constraints to push to each processor</span></div>
<div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; i : <a class="code" href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">_node_constraints</a>)</div>
<div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;    {</div>
<div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;      <span class="keyword">const</span> Node * constrained = i.first;</div>
<div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;</div>
<div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;      <span class="keywordflow">if</span> (constrained-&gt;processor_id() != this-&gt;processor_id())</div>
<div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;</div>
<div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;      <a class="code" href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">NodeConstraintRow</a> &amp; row = i.second.first;</div>
<div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; j : row)</div>
<div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;        {</div>
<div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;          <span class="keyword">const</span> Node * constraining = j.first;</div>
<div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;</div>
<div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;          <span class="keywordflow">if</span> (constraining-&gt;processor_id() != this-&gt;processor_id() &amp;&amp;</div>
<div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;              constraining-&gt;processor_id() != constrained-&gt;processor_id())</div>
<div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;            pushed_node_ids[constraining-&gt;processor_id()].insert(constrained-&gt;id());</div>
<div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;        }</div>
<div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;    }</div>
<div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;</div>
<div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;  <span class="comment">// Pack the node constraint rows and rhss to push</span></div>
<div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;  std::map&lt;<a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a>,</div>
<div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;          std::vector&lt;std::vector&lt;std::pair&lt;dof_id_type,Real&gt;&gt;&gt;&gt;</div>
<div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;    pushed_node_keys_vals, pushed_node_keys_vals_to_me;</div>
<div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;  std::map&lt;processor_id_type, std::vector&lt;std::pair&lt;dof_id_type, Point&gt;&gt;&gt;</div>
<div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;    pushed_node_ids_offsets, pushed_node_ids_offsets_to_me;</div>
<div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;  std::map&lt;processor_id_type, std::vector&lt;const Node *&gt;&gt; pushed_node_vecs;</div>
<div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;</div>
<div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; [pid, pid_ids]: pushed_node_ids)</div>
<div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;    {</div>
<div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;      <span class="keyword">const</span> std::size_t ids_size = pid_ids.size();</div>
<div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;      std::vector&lt;std::vector&lt;std::pair&lt;dof_id_type,Real&gt;&gt;&gt; &amp;</div>
<div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;        keys_vals = pushed_node_keys_vals[pid];</div>
<div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;      std::vector&lt;std::pair&lt;dof_id_type, Point&gt;&gt; &amp;</div>
<div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;        ids_offsets = pushed_node_ids_offsets[pid];</div>
<div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;      keys_vals.resize(ids_size);</div>
<div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;      ids_offsets.resize(ids_size);</div>
<div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;      std::set&lt;Node *&gt; nodes;</div>
<div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;</div>
<div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;      std::size_t push_i;</div>
<div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;      std::set&lt;dof_id_type&gt;::const_iterator it;</div>
<div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;      <span class="keywordflow">for</span> (push_i = 0, it = pid_ids.begin();</div>
<div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;           it != pid_ids.end(); ++push_i, ++it)</div>
<div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;        {</div>
<div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;          Node * constrained = mesh.node_ptr(*it);</div>
<div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;</div>
<div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;          <span class="keywordflow">if</span> (constrained-&gt;processor_id() != pid)</div>
<div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;            nodes.insert(constrained);</div>
<div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;</div>
<div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;          <a class="code" href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">NodeConstraintRow</a> &amp; row = _node_constraints[constrained].first;</div>
<div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;          std::size_t row_size = row.size();</div>
<div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;          keys_vals[push_i].reserve(row_size);</div>
<div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; j : row)</div>
<div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;            {</div>
<div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;              Node * constraining = <span class="keyword">const_cast&lt;</span>Node *<span class="keyword">&gt;</span>(j.first);</div>
<div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;</div>
<div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;              keys_vals[push_i].emplace_back(constraining-&gt;id(), j.second);</div>
<div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;</div>
<div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;              <span class="keywordflow">if</span> (constraining-&gt;processor_id() != pid)</div>
<div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;                nodes.insert(constraining);</div>
<div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;            }</div>
<div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;</div>
<div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;          ids_offsets[push_i].first = *it;</div>
<div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;          ids_offsets[push_i].second = _node_constraints[constrained].second;</div>
<div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;        }</div>
<div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;</div>
<div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;      <span class="keywordflow">if</span> (!mesh.is_serial())</div>
<div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;        {</div>
<div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;          <span class="keyword">auto</span> &amp; pid_nodes = pushed_node_vecs[pid];</div>
<div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;          pid_nodes.assign(nodes.begin(), nodes.end());</div>
<div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;        }</div>
<div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;    }</div>
<div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;</div>
<div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;  <span class="keyword">auto</span> node_ids_offsets_action_functor =</div>
<div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;    [&amp; pushed_node_ids_offsets_to_me]</div>
<div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;    (processor_id_type pid,</div>
<div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;     <span class="keyword">const</span> std::vector&lt;std::pair&lt;dof_id_type, Point&gt;&gt; &amp; data)</div>
<div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;    {</div>
<div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;      pushed_node_ids_offsets_to_me[pid] = data;</div>
<div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;    };</div>
<div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;</div>
<div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;  <span class="keyword">auto</span> node_keys_vals_action_functor =</div>
<div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;    [&amp; pushed_node_keys_vals_to_me]</div>
<div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;    (processor_id_type pid,</div>
<div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;     <span class="keyword">const</span> std::vector&lt;std::vector&lt;std::pair&lt;dof_id_type, Real&gt;&gt;&gt; &amp; data)</div>
<div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;    {</div>
<div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;      pushed_node_keys_vals_to_me[pid] = data;</div>
<div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;    };</div>
<div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;</div>
<div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;  <span class="comment">// Trade pushed node constraint rows</span></div>
<div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;  Parallel::push_parallel_vector_data</div>
<div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;    (this-&gt;comm(), pushed_node_ids_offsets, node_ids_offsets_action_functor);</div>
<div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;  Parallel::push_parallel_vector_data</div>
<div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;    (this-&gt;comm(), pushed_node_keys_vals, node_keys_vals_action_functor);</div>
<div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;</div>
<div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;  <span class="comment">// Constraining nodes might not even exist on our subset of a</span></div>
<div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;  <span class="comment">// distributed mesh, so let&#39;s make them exist.</span></div>
<div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;</div>
<div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;  <span class="comment">// Node unpack() now automatically adds them to the context mesh</span></div>
<div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;  <span class="keyword">auto</span> null_node_functor = [](<a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a>, <span class="keyword">const</span> std::vector&lt;const Node *&gt; &amp;){};</div>
<div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;</div>
<div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;  <span class="keywordflow">if</span> (!mesh.is_serial())</div>
<div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;    Parallel::push_parallel_packed_range</div>
<div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;      (this-&gt;comm(), pushed_node_vecs, &amp;mesh, null_node_functor);</div>
<div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;</div>
<div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; [pid, ids_offsets] : pushed_node_ids_offsets_to_me)</div>
<div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;    {</div>
<div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> &amp; keys_vals = pushed_node_keys_vals_to_me[pid];</div>
<div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;</div>
<div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;      libmesh_assert_equal_to</div>
<div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;        (ids_offsets.size(), keys_vals.size());</div>
<div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;</div>
<div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;      <span class="comment">// Add the node constraints that I&#39;ve been sent</span></div>
<div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : index_range(ids_offsets))</div>
<div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;        {</div>
<div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;          <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constrained_id = ids_offsets[i].first;</div>
<div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;</div>
<div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;          <span class="comment">// If we don&#39;t already have a constraint for this node,</span></div>
<div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;          <span class="comment">// add the one we were sent</span></div>
<div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;          <span class="keyword">const</span> Node * constrained = mesh.node_ptr(constrained_id);</div>
<div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;          <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aa074902e46e34c42cab1888d111911f3">is_constrained_node</a>(constrained))</div>
<div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;            {</div>
<div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;              <a class="code" href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">NodeConstraintRow</a> &amp; row = _node_constraints[constrained].first;</div>
<div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;              <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; key_val : keys_vals[i])</div>
<div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;                {</div>
<div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;                  <span class="keyword">const</span> Node * key_node = mesh.node_ptr(key_val.first);</div>
<div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;                  row[key_node] = key_val.second;</div>
<div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;                }</div>
<div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;              _node_constraints[constrained].second =</div>
<div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;                ids_offsets[i].second;</div>
<div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;            }</div>
<div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;        }</div>
<div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;    }</div>
<div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;<span class="preprocessor">#endif // LIBMESH_ENABLE_NODE_CONSTRAINTS</span></div>
<div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;  <span class="comment">// Next we need to push constraints to processors which don&#39;t own</span></div>
<div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;  <span class="comment">// the constrained dof, don&#39;t own the constraining dof, but own an</span></div>
<div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;  <span class="comment">// element supporting the constraining dof.</span></div>
<div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;  <span class="comment">// We need to be able to quickly look up constrained dof ids by what</span></div>
<div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;  <span class="comment">// constrains them, so that we can handle the case where we see a</span></div>
<div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;  <span class="comment">// foreign element containing one of our constraining DoF ids and we</span></div>
<div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;  <span class="comment">// need to push that constraint.</span></div>
<div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;  <span class="comment">//</span></div>
<div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;  <span class="comment">// Getting distributed adaptive sparsity patterns right is hard.</span></div>
<div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;</div>
<div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;  <span class="keyword">typedef</span> std::map&lt;dof_id_type, std::set&lt;dof_id_type&gt;&gt; DofConstrainsMap;</div>
<div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;  DofConstrainsMap dof_id_constrains;</div>
<div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;</div>
<div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; [constrained, row] : _dof_constraints)</div>
<div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;    {</div>
<div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; j : row)</div>
<div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;        {</div>
<div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constraining = j.first;</div>
<div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;</div>
<div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;          <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> constraining_proc_id = 0;</div>
<div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;          <span class="keywordflow">while</span> (constraining &gt;= <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>[constraining_proc_id])</div>
<div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;            constraining_proc_id++;</div>
<div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;</div>
<div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;          <span class="keywordflow">if</span> (constraining_proc_id == this-&gt;processor_id())</div>
<div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;            dof_id_constrains[constraining].insert(constrained);</div>
<div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;        }</div>
<div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;    }</div>
<div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;</div>
<div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;  <span class="comment">// Loop over all foreign elements, find any supporting our</span></div>
<div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;  <span class="comment">// constrained dof indices.</span></div>
<div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;  pushed_ids.clear();</div>
<div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;</div>
<div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; elem : as_range(mesh.active_not_local_elements_begin(),</div>
<div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;                                    mesh.active_not_local_elements_end()))</div>
<div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;    {</div>
<div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;      std::vector&lt;dof_id_type&gt; my_dof_indices;</div>
<div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a0d323b6fcb736454a9f6074ebda9ec28">dof_indices</a> (elem, my_dof_indices);</div>
<div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;</div>
<div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; dof : my_dof_indices)</div>
<div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;        {</div>
<div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;          DofConstrainsMap::const_iterator dcmi = dof_id_constrains.find(dof);</div>
<div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;          <span class="keywordflow">if</span> (dcmi != dof_id_constrains.end())</div>
<div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;            {</div>
<div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;              <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; constrained : dcmi-&gt;second)</div>
<div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;                {</div>
<div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;                  <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> the_constrained_proc_id = 0;</div>
<div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;                  <span class="keywordflow">while</span> (constrained &gt;= <a class="code" href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">_end_df</a>[the_constrained_proc_id])</div>
<div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;                    the_constrained_proc_id++;</div>
<div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;</div>
<div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;                  <span class="keyword">const</span> processor_id_type elemproc = elem-&gt;processor_id();</div>
<div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;                  <span class="keywordflow">if</span> (elemproc != the_constrained_proc_id)</div>
<div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;                    pushed_ids[elemproc].insert(constrained);</div>
<div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;                }</div>
<div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;            }</div>
<div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;        }</div>
<div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;    }</div>
<div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;</div>
<div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;  pushed_ids_rhss.clear();</div>
<div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;  pushed_ids_rhss_to_me.clear();</div>
<div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;  pushed_keys_vals.clear();</div>
<div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;  pushed_keys_vals_to_me.clear();</div>
<div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;</div>
<div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;  gather_ids();</div>
<div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;</div>
<div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;  <span class="comment">// Trade pushed dof constraint rows</span></div>
<div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;  Parallel::push_parallel_vector_data</div>
<div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;    (this-&gt;comm(), pushed_ids_rhss, ids_rhss_action_functor);</div>
<div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;  Parallel::push_parallel_vector_data</div>
<div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;    (this-&gt;comm(), pushed_keys_vals, keys_vals_action_functor);</div>
<div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;</div>
<div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;  receive_dof_constraints();</div>
<div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;</div>
<div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;  <span class="comment">// Finally, we need to handle the case of remote dof coupling.  If a</span></div>
<div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;  <span class="comment">// processor&#39;s element is coupled to a ghost element, then the</span></div>
<div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;  <span class="comment">// processor needs to know about all constraints which affect the</span></div>
<div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;  <span class="comment">// dofs on that ghost element, so we&#39;ll have to query the ghost</span></div>
<div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;  <span class="comment">// element&#39;s owner.</span></div>
<div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;</div>
<div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;  GhostingFunctor::map_type elements_to_couple;</div>
<div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#abddb472d25fdb74e211e214710c48534">DofMap::CouplingMatricesSet</a> temporary_coupling_matrices;</div>
<div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;</div>
<div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aaba8d0fe4f60763e0a52f7ae1d4b7153">merge_ghost_functor_outputs</a></div>
<div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;    (elements_to_couple,</div>
<div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;     temporary_coupling_matrices,</div>
<div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;     this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a167ad5d7c58f7ef60da5e365764962c1">coupling_functors_begin</a>(),</div>
<div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;     this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a13a2755e548a51040ee833c1aca2520b">coupling_functors_end</a>(),</div>
<div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;     mesh.active_local_elements_begin(),</div>
<div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;     mesh.active_local_elements_end(),</div>
<div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;     this-&gt;processor_id());</div>
<div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;</div>
<div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;  <span class="comment">// Each ghost-coupled element&#39;s owner should get a request for its dofs</span></div>
<div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;  std::set&lt;dof_id_type&gt; requested_dofs;</div>
<div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;</div>
<div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; pr : elements_to_couple)</div>
<div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;    {</div>
<div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;      <span class="keyword">const</span> Elem * elem = pr.first;</div>
<div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;</div>
<div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;      <span class="comment">// FIXME - optimize for the non-fully-coupled case?</span></div>
<div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;      std::vector&lt;dof_id_type&gt; element_dofs;</div>
<div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a0d323b6fcb736454a9f6074ebda9ec28">dof_indices</a>(elem, element_dofs);</div>
<div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;</div>
<div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> dof : element_dofs)</div>
<div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;        requested_dofs.insert(dof);</div>
<div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;    }</div>
<div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;</div>
<div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a2ad8b64590135362f5ac09c581f828bf">gather_constraints</a>(mesh, requested_dofs, <span class="keyword">false</span>);</div>
<div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a167ad5d7c58f7ef60da5e365764962c1"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a167ad5d7c58f7ef60da5e365764962c1">libMesh::DofMap::coupling_functors_begin</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt;::const_iterator coupling_functors_begin() const </div><div class="ttdoc">Beginning of range of coupling functors. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00344">dof_map.h:344</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2ad8b64590135362f5ac09c581f828bf"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2ad8b64590135362f5ac09c581f828bf">libMesh::DofMap::gather_constraints</a></div><div class="ttdeci">void gather_constraints(MeshBase &amp;mesh, std::set&lt; dof_id_type &gt; &amp;unexpanded_dofs, bool look_for_constrainees)</div><div class="ttdoc">Helper function for querying about constraint equations on other processors. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map__constraints_8C_source.html#l05055">dof_map_constraints.C:5055</a></div></div>
<div class="ttc" id="namespacelibMesh_html_af18245d4f872c36a41fc74086bda3e80"><div class="ttname"><a href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">libMesh::processor_id_type</a></div><div class="ttdeci">uint8_t processor_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00104">id_types.h:104</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a9846273ba4930ef0364bc1fc954af914"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a9846273ba4930ef0364bc1fc954af914">libMesh::DofMap::is_constrained_dof</a></div><div class="ttdeci">bool is_constrained_dof(const dof_id_type dof) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02179">dof_map.h:2179</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aa074902e46e34c42cab1888d111911f3"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa074902e46e34c42cab1888d111911f3">libMesh::DofMap::is_constrained_node</a></div><div class="ttdeci">bool is_constrained_node(const Node *node) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02163">dof_map.h:2163</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_abddb472d25fdb74e211e214710c48534"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#abddb472d25fdb74e211e214710c48534">libMesh::DofMap::CouplingMatricesSet</a></div><div class="ttdeci">std::set&lt; std::unique_ptr&lt; CouplingMatrix &gt;, Utility::CompareUnderlying &gt; CouplingMatricesSet</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01742">dof_map.h:1742</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aaba8d0fe4f60763e0a52f7ae1d4b7153"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aaba8d0fe4f60763e0a52f7ae1d4b7153">libMesh::DofMap::merge_ghost_functor_outputs</a></div><div class="ttdeci">static void merge_ghost_functor_outputs(GhostingFunctor::map_type &amp;elements_to_ghost, CouplingMatricesSet &amp;temporary_coupling_matrices, const std::set&lt; GhostingFunctor * &gt;::iterator &amp;gf_begin, const std::set&lt; GhostingFunctor * &gt;::iterator &amp;gf_end, const MeshBase::const_element_iterator &amp;elems_begin, const MeshBase::const_element_iterator &amp;elems_end, processor_id_type p)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01440">dof_map.C:1440</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a24e7c497429c2bd81a5cc39f71cfa6e0"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a24e7c497429c2bd81a5cc39f71cfa6e0">libMesh::DofMap::_primal_constraint_values</a></div><div class="ttdeci">DofConstraintValueMap _primal_constraint_values</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02032">dof_map.h:2032</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aa01f327876e40c4c56621d025ada561d"><div class="ttname"><a href="namespacelibMesh.html#aa01f327876e40c4c56621d025ada561d">libMesh::DofConstraintRow</a></div><div class="ttdeci">std::map&lt; dof_id_type, Real, std::less&lt; dof_id_type &gt;, Threads::scalable_allocator&lt; std::pair&lt; const dof_id_type, Real &gt; &gt; &gt; DofConstraintRow</div><div class="ttdoc">A row of the Dof constraint matrix. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00090">dof_map.h:90</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af43f96a9e11b3f4221306fdfd4511aaa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af43f96a9e11b3f4221306fdfd4511aaa">libMesh::DofMap::_end_df</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _end_df</div><div class="ttdoc">Last DOF index (plus 1) on processor p. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01881">dof_map.h:1881</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a0d8f16f2dd1d9a0c1780943811e37c1c"><div class="ttname"><a href="namespacelibMesh.html#a0d8f16f2dd1d9a0c1780943811e37c1c">libMesh::NodeConstraintRow</a></div><div class="ttdeci">std::map&lt; const Node *, Real, std::less&lt; const Node * &gt;, Threads::scalable_allocator&lt; std::pair&lt; const Node *const, Real &gt; &gt; &gt; NodeConstraintRow</div><div class="ttdoc">A row of the Node constraint mapping. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00138">dof_map.h:138</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a13a2755e548a51040ee833c1aca2520b"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a13a2755e548a51040ee833c1aca2520b">libMesh::DofMap::coupling_functors_end</a></div><div class="ttdeci">std::set&lt; GhostingFunctor * &gt;::const_iterator coupling_functors_end() const </div><div class="ttdoc">End of range of coupling functors. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00350">dof_map.h:350</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a8b17bf24a15bc292850c3a3894e2e8f9"><div class="ttname"><a href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">libMesh::Number</a></div><div class="ttdeci">Real Number</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00214">libmesh_common.h:214</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a8856db766d722a0edaa9f5c5d94d40f7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a8856db766d722a0edaa9f5c5d94d40f7">libMesh::DofMap::_node_constraints</a></div><div class="ttdeci">NodeConstraints _node_constraints</div><div class="ttdoc">Data structure containing DofObject constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02041">dof_map.h:2041</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a0d323b6fcb736454a9f6074ebda9ec28"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a0d323b6fcb736454a9f6074ebda9ec28">libMesh::DofMap::dof_indices</a></div><div class="ttdeci">void dof_indices(const Elem *const elem, std::vector&lt; dof_id_type &gt; &amp;di) const </div><div class="ttdoc">Fills the vector di with the global degree of freedom indices for the element. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l01992">dof_map.C:1992</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa654bbcfc7f4d67d7cc6e3bb8cc390b3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::semilocal_index </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&#160;</td>
          <td class="paramname"><em>dof_index</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd><code>true</code> if degree of freedom index <code>dof_index</code> is either a local index or in the <code>send_list</code>.</dd></dl>
<dl class="section note"><dt>注解</dt><dd>This is an O(logN) operation for a send_list of size N; we don't cache enough information for O(1) right now. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l02580">2580</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01893">_send_list</a> , 以及 <a class="el" href="dof__map_8h_source.html#l00831">local_index()</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l02596">all_semilocal_indices()</a>.</p>
<div class="fragment"><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;{</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;  <span class="comment">// If it&#39;s not in the local indices</span></div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;  <span class="keywordflow">if</span> (!this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">local_index</a>(dof_index))</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;    {</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;      <span class="comment">// and if it&#39;s not in the ghost indices, then we&#39;re not</span></div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;      <span class="comment">// semilocal</span></div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;      <span class="keywordflow">if</span> (!std::binary_search(<a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>.begin(), <a class="code" href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">_send_list</a>.end(), dof_index))</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;    }</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a2b3873478d701811b9562b514fc2c369"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a2b3873478d701811b9562b514fc2c369">libMesh::DofMap::_send_list</a></div><div class="ttdeci">std::vector&lt; dof_id_type &gt; _send_list</div><div class="ttdoc">A list containing all the global DOF indices that affect the solution on my processor. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01893">dof_map.h:1893</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab6d9ab04643e9028f7f0c9b4d18e0455"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab6d9ab04643e9028f7f0c9b4d18e0455">libMesh::DofMap::local_index</a></div><div class="ttdeci">bool local_index(dof_id_type dof_index) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00831">dof_map.h:831</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3d60daee3f791c37d0957d9f367718d2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::set_constrained_sparsity_construction </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>use_constraints</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sets the current policy for constructing sparsity patterns: if <code>use_constraints</code> is true (for robustness), we explicitly account for sparsity entries created by constraint matrix pre- and post- application. </p>
<p>If <code>use_constraints</code> is false (for speed), we calculate only the sparsity pattern of an unconstrained matrix. This is false by default, because in nearly all applications our constraints do not increase the number of non-zeros required in a sparse matrix. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02294">2294</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01834">_constrained_sparsity_construction</a> , 以及 <a class="el" href="libmesh__common_8h_source.html#l00516">libMesh::libmesh_ignore()</a>.</p>
<div class="fragment"><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;{</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;  <span class="comment">// This got only partly finished...</span></div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;  <span class="keywordflow">if</span> (use_constraints)</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;    libmesh_not_implemented();</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_CONSTRAINTS</span></div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;<span class="preprocessor"></span>  <a class="code" href="classlibMesh_1_1DofMap.html#a780be47336e49e2f9cd55bba69ee919a">_constrained_sparsity_construction</a> = use_constraints;</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;<span class="preprocessor"></span>  <a class="code" href="namespacelibMesh.html#a43f45640aab1af26176e69592c666432">libmesh_ignore</a>(use_constraints);</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a780be47336e49e2f9cd55bba69ee919a"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a780be47336e49e2f9cd55bba69ee919a">libMesh::DofMap::_constrained_sparsity_construction</a></div><div class="ttdeci">bool _constrained_sparsity_construction</div><div class="ttdoc">This flag indicates whether or not we explicitly take constraint equations into account when computin...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01834">dof_map.h:1834</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a43f45640aab1af26176e69592c666432"><div class="ttname"><a href="namespacelibMesh.html#a43f45640aab1af26176e69592c666432">libMesh::libmesh_ignore</a></div><div class="ttdeci">void libmesh_ignore(const Args &amp;...)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00516">libmesh_common.h:516</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af72602b9f4e23db0dbe054bf4dafe123"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::set_error_on_constraint_loop </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>error_on_constraint_loop</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l00245">245</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01828">_error_on_constraint_loop</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00238">set_error_on_cyclic_constraint()</a>.</p>
<div class="fragment"><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;{</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#aef749fe651254903abfc12d9b81e2a16">_error_on_constraint_loop</a> = error_on_constraint_loop;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aef749fe651254903abfc12d9b81e2a16"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aef749fe651254903abfc12d9b81e2a16">libMesh::DofMap::_error_on_constraint_loop</a></div><div class="ttdeci">bool _error_on_constraint_loop</div><div class="ttdoc">This flag indicates whether or not we do an opt-mode check for the presence of constraint loops...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01828">dof_map.h:1828</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a694b0be4a4514f1d7f0775ddfec78d4b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::set_error_on_cyclic_constraint </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>error_on_cyclic_constraint</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Specify whether or not we perform an extra (opt-mode enabled) check for constraint loops. </p>
<p>If a constraint loop is present then the system constraints are not valid, so if <code>error_on_constraint_loop</code> is true we will throw an error in this case.</p>
<dl class="section note"><dt>注解</dt><dd>We previously referred to these types of constraints as "cyclic" but that has now been deprecated, and these will now instead be referred to as "constraint loops" in <a class="el" href="namespacelibMesh.html" title="The libMesh namespace provides an interface to certain functionality in the library. ">libMesh</a>. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l00238">238</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8C_source.html#l00245">set_error_on_constraint_loop()</a>.</p>
<div class="fragment"><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;{</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="comment">// This function will eventually be officially libmesh_deprecated();</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="comment">// Call DofMap::set_error_on_constraint_loop() instead.</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#af72602b9f4e23db0dbe054bf4dafe123">set_error_on_constraint_loop</a>(error_on_cyclic_constraint);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af72602b9f4e23db0dbe054bf4dafe123"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af72602b9f4e23db0dbe054bf4dafe123">libMesh::DofMap::set_error_on_constraint_loop</a></div><div class="ttdeci">void set_error_on_constraint_loop(bool error_on_constraint_loop)</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l00245">dof_map.C:245</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2eb44e4da2c8afcd039995ef239457da"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::set_implicit_neighbor_dofs </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>implicit_neighbor_dofs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allow the implicit_neighbor_dofs flag to be set programmatically. </p>
<p>This overrides the &ndash;implicit_neighbor_dofs commandline option. We can use this to set the implicit neighbor dofs option differently for different systems, whereas the commandline option is the same for all systems. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l01748">1748</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02074">_implicit_neighbor_dofs</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02073">_implicit_neighbor_dofs_initialized</a>.</p>
<div class="fragment"><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;{</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#aa6ed76ce98cd73ed8339f505a5284fef">_implicit_neighbor_dofs_initialized</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a09368a6dcd32c12d7a51dc00852982d5">_implicit_neighbor_dofs</a> = implicit_neighbor_dofs;</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aa6ed76ce98cd73ed8339f505a5284fef"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa6ed76ce98cd73ed8339f505a5284fef">libMesh::DofMap::_implicit_neighbor_dofs_initialized</a></div><div class="ttdeci">bool _implicit_neighbor_dofs_initialized</div><div class="ttdoc">Bools to indicate if we override the –implicit_neighbor_dofs commandline options. ...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02073">dof_map.h:2073</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a09368a6dcd32c12d7a51dc00852982d5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a09368a6dcd32c12d7a51dc00852982d5">libMesh::DofMap::_implicit_neighbor_dofs</a></div><div class="ttdeci">bool _implicit_neighbor_dofs</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02074">dof_map.h:2074</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7bad83b3b5e37a8afe4ea251d72df300"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename iterator_type &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::set_nonlocal_dof_objects </td>
          <td>(</td>
          <td class="paramtype">iterator_type&#160;</td>
          <td class="paramname"><em>objects_begin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">iterator_type&#160;</td>
          <td class="paramname"><em>objects_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DofMap.html#abf72c97b24845ea8b10a7c4a83e726b4">dofobject_accessor</a>&#160;</td>
          <td class="paramname"><em>objects</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper function for distributing dofs in parallel. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l00356">356</a> 行定义.</p>

<p>参考 <a class="el" href="dof__object_8h_source.html#l01025">libMesh::DofObject::dof_number()</a>, <a class="el" href="dof__object_8h_source.html#l00823">libMesh::DofObject::id()</a>, <a class="el" href="dof__object_8h_source.html#l00477">libMesh::DofObject::invalid_id</a>, <a class="el" href="dof__object_8h_source.html#l00488">libMesh::DofObject::invalid_processor_id</a>, <a class="el" href="dof__object_8h_source.html#l00995">libMesh::DofObject::n_comp()</a>, <a class="el" href="dof__object_8h_source.html#l01008">libMesh::DofObject::n_comp_group()</a>, <a class="el" href="dof__object_8h_source.html#l00950">libMesh::DofObject::n_var_groups()</a>, <a class="el" href="dof__map_8h_source.html#l00613">n_variable_groups()</a>, <a class="el" href="dof__object_8h_source.html#l00960">libMesh::DofObject::n_vars()</a>, <a class="el" href="dof__object_8h_source.html#l00898">libMesh::DofObject::processor_id()</a>, <a class="el" href="dof__object_8C_source.html#l00397">libMesh::DofObject::set_n_comp_group()</a>, <a class="el" href="dof__object_8h_source.html#l01290">libMesh::DofObject::set_vg_dof_base()</a>, <a class="el" href="dof__map_8h_source.html#l02093">sys_number()</a> , 以及 <a class="el" href="dof__object_8h_source.html#l01310">libMesh::DofObject::vg_dof_base()</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00927">distribute_dofs()</a>.</p>
<div class="fragment"><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;{</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  parallel_object_only();</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="comment">// First, iterate over local objects to find out how many</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="comment">// are on each processor</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  std::unordered_map&lt;processor_id_type, dof_id_type&gt; ghost_objects_from_proc;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  iterator_type it  = objects_begin;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keywordflow">for</span> (; it != objects_end; ++it)</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      DofObject * obj = *it;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <span class="keywordflow">if</span> (obj)</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;          <a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> obj_procid = obj-&gt;processor_id();</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;          <span class="comment">// We&#39;d better be completely partitioned by now</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;          libmesh_assert_not_equal_to (obj_procid, <a class="code" href="classlibMesh_1_1DofObject.html#aa65deab833c8b1802790cd43ab1b6ee4">DofObject::invalid_processor_id</a>);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;          ghost_objects_from_proc[obj_procid]++;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="comment">// Request sets to send to each processor</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  std::map&lt;processor_id_type, std::vector&lt;dof_id_type&gt;&gt;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    requested_ids;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="comment">// We know how many of our objects live on each processor, so</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="comment">// reserve() space for requests from each.</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> [p, size] : ghost_objects_from_proc)</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="keywordflow">if</span> (p != this-&gt;processor_id())</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        requested_ids[p].reserve(size);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="keywordflow">for</span> (it = objects_begin; it != objects_end; ++it)</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      DofObject * obj = *it;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="keywordflow">if</span> (obj-&gt;processor_id() != <a class="code" href="classlibMesh_1_1DofObject.html#aa65deab833c8b1802790cd43ab1b6ee4">DofObject::invalid_processor_id</a>)</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        requested_ids[obj-&gt;processor_id()].push_back(obj-&gt;id());</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    }</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> p : make_range(this-&gt;n_processors()))</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <span class="keywordflow">if</span> (ghost_objects_from_proc.count(p))</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        libmesh_assert_equal_to (requested_ids[p].size(), ghost_objects_from_proc[p]);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        libmesh_assert(!requested_ids.count(p));</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keyword">typedef</span> std::vector&lt;dof_id_type&gt; datum;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keyword">auto</span> gather_functor =</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    [<span class="keyword">this</span>, &amp;mesh, &amp;objects]</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    (<a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a>,</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;     <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; ids,</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;     std::vector&lt;datum&gt; &amp; data)</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="comment">// Fill those requests</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        sys_num      = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">sys_number</a>(),</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        n_var_groups = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a6058ea4ca2ef36bd90f44bcb052a1d1e">n_variable_groups</a>();</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="keyword">const</span> std::size_t query_size = ids.size();</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      data.resize(query_size);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; d : data)</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        d.resize(2 * n_var_groups);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="keywordflow">for</span> (std::size_t i=0; i != query_size; ++i)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;          DofObject * requested = (this-&gt;*objects)(mesh, ids[i]);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;          libmesh_assert(requested);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;          libmesh_assert_equal_to (requested-&gt;processor_id(), this-&gt;processor_id());</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;          libmesh_assert_equal_to (requested-&gt;n_var_groups(sys_num), n_var_groups);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vg=0; vg != n_var_groups; ++vg)</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_comp_g =</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                requested-&gt;n_comp_group(sys_num, vg);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;              data[i][vg] = n_comp_g;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;              <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> my_first_dof = n_comp_g ?</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                requested-&gt;vg_dof_base(sys_num, vg) : 0;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;              libmesh_assert_not_equal_to (my_first_dof, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;              data[i][n_var_groups+vg] = my_first_dof;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            }</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    };</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keyword">auto</span> action_functor =</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    [<span class="keyword">this</span>, &amp;mesh, &amp;objects]</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    (processor_id_type libmesh_dbg_var(pid),</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;     <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; ids,</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;     <span class="keyword">const</span> std::vector&lt;datum&gt; &amp; data)</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    {</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        sys_num      = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">sys_number</a>(),</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        n_var_groups = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a6058ea4ca2ef36bd90f44bcb052a1d1e">n_variable_groups</a>();</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <span class="comment">// Copy the id changes we&#39;ve now been informed of</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : index_range(ids))</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;          DofObject * requested = (this-&gt;*objects)(mesh, ids[i]);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;          libmesh_assert(requested);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;          libmesh_assert_equal_to (requested-&gt;processor_id(), pid);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> vg=0; vg != n_var_groups; ++vg)</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_comp_g =</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                cast_int&lt;unsigned int&gt;(data[i][vg]);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;              requested-&gt;set_n_comp_group(sys_num, vg, n_comp_g);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;              <span class="keywordflow">if</span> (n_comp_g)</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                  <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> my_first_dof = data[i][n_var_groups+vg];</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                  libmesh_assert_not_equal_to (my_first_dof, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                  requested-&gt;set_vg_dof_base</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                    (sys_num, vg, my_first_dof);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                }</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            }</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        }</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    };</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  datum * ex = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  Parallel::pull_parallel_vector_data</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    (this-&gt;comm(), requested_ids, gather_functor, action_functor, ex);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="preprocessor"></span>  <span class="comment">// Double check for invalid dofs</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="keywordflow">for</span> (it = objects_begin; it != objects_end; ++it)</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      DofObject * obj = *it;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      libmesh_assert (obj);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> num_variables = obj-&gt;n_vars(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">sys_number</a>());</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v=0; v != num_variables; ++v)</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_comp =</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;            obj-&gt;n_comp(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">sys_number</a>(), v);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;          <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> my_first_dof = n_comp ?</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            obj-&gt;dof_number(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">sys_number</a>(), v, 0) : 0;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;          libmesh_assert_not_equal_to (my_first_dof, <a class="code" href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">DofObject::invalid_id</a>);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    }</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="preprocessor"></span>}</div>
<div class="ttc" id="namespacelibMesh_html_af18245d4f872c36a41fc74086bda3e80"><div class="ttname"><a href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">libMesh::processor_id_type</a></div><div class="ttdeci">uint8_t processor_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00104">id_types.h:104</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_aa65deab833c8b1802790cd43ab1b6ee4"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#aa65deab833c8b1802790cd43ab1b6ee4">libMesh::DofObject::invalid_processor_id</a></div><div class="ttdeci">static const processor_id_type invalid_processor_id</div><div class="ttdoc">An invalid processor_id to distinguish DoFs that have not been assigned to a processor. </div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00488">dof_object.h:488</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofObject_html_adf3b0ebe7fcc0c41bced4c9f17bf4822"><div class="ttname"><a href="classlibMesh_1_1DofObject.html#adf3b0ebe7fcc0c41bced4c9f17bf4822">libMesh::DofObject::invalid_id</a></div><div class="ttdeci">static const dof_id_type invalid_id</div><div class="ttdoc">An invalid id to distinguish an uninitialized DofObject. </div><div class="ttdef"><b>Definition:</b> <a href="dof__object_8h_source.html#l00477">dof_object.h:477</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a6058ea4ca2ef36bd90f44bcb052a1d1e"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a6058ea4ca2ef36bd90f44bcb052a1d1e">libMesh::DofMap::n_variable_groups</a></div><div class="ttdeci">unsigned int n_variable_groups() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00613">dof_map.h:613</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a244e7a1cd82d5e6ae8780c93205ec1fa"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a244e7a1cd82d5e6ae8780c93205ec1fa">libMesh::DofMap::sys_number</a></div><div class="ttdeci">unsigned int sys_number() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02093">dof_map.h:2093</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4775dc7cbf1b1d282fcf8fdc088f3eaf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::set_verify_dirichlet_bc_consistency </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>val</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the _verify_dirichlet_bc_consistency flag. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l01754">1754</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02086">_verify_dirichlet_bc_consistency</a>.</p>
<div class="fragment"><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;{</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;  <a class="code" href="classlibMesh_1_1DofMap.html#a126ef1ca10f48a41d48010b3296ddef7">_verify_dirichlet_bc_consistency</a> = val;</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a126ef1ca10f48a41d48010b3296ddef7"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a126ef1ca10f48a41d48010b3296ddef7">libMesh::DofMap::_verify_dirichlet_bc_consistency</a></div><div class="ttdeci">bool _verify_dirichlet_bc_consistency</div><div class="ttdoc">Flag which determines whether we should do some additional checking of the consistency of the Dirichl...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02086">dof_map.h:2086</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a709945cd61f9c28ef504f3d7d1ac6962"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::should_p_refine </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>p_refine</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Describe whether the given variable group should be p-refined. </p>
<p>If this API is not called with <code>false</code>, the default is to p-refine </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02319">2319</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02022">_dont_p_refine</a> , 以及 <a class="el" href="libmesh__common_8h_source.html#l00516">libMesh::libmesh_ignore()</a>.</p>
<div class="fragment"><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;{</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_AMR</span></div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">if</span> (p_refine)</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;  {</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    <span class="keyword">auto</span> it = <a class="code" href="classlibMesh_1_1DofMap.html#a82dd81ff9e21bdc2d9c80f80c692a9ea">_dont_p_refine</a>.find(g);</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;    <span class="keywordflow">if</span> (it != <a class="code" href="classlibMesh_1_1DofMap.html#a82dd81ff9e21bdc2d9c80f80c692a9ea">_dont_p_refine</a>.end())</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;      <a class="code" href="classlibMesh_1_1DofMap.html#a82dd81ff9e21bdc2d9c80f80c692a9ea">_dont_p_refine</a>.erase(it);</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;  }</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#a82dd81ff9e21bdc2d9c80f80c692a9ea">_dont_p_refine</a>.insert(g);</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;<span class="preprocessor"></span>  <a class="code" href="namespacelibMesh.html#a43f45640aab1af26176e69592c666432">libmesh_ignore</a>(g, p_refine);</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;<span class="preprocessor"></span>}</div>
<div class="ttc" id="namespacelibMesh_html_a43f45640aab1af26176e69592c666432"><div class="ttname"><a href="namespacelibMesh.html#a43f45640aab1af26176e69592c666432">libMesh::libmesh_ignore</a></div><div class="ttdeci">void libmesh_ignore(const Args &amp;...)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00516">libmesh_common.h:516</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a82dd81ff9e21bdc2d9c80f80c692a9ea"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a82dd81ff9e21bdc2d9c80f80c692a9ea">libMesh::DofMap::_dont_p_refine</a></div><div class="ttdeci">std::unordered_set&lt; unsigned int &gt; _dont_p_refine</div><div class="ttdoc">A container of variable groups that we should not p-refine. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02022">dof_map.h:2022</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af7246dc103533c5b41635ef3b467a739"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::should_p_refine </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>g</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Whether the given variable group should be p-refined. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02336">2336</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02022">_dont_p_refine</a> , 以及 <a class="el" href="libmesh__common_8h_source.html#l00516">libMesh::libmesh_ignore()</a>.</p>
<div class="fragment"><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;{</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_AMR</span></div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;<span class="preprocessor"></span>  <span class="keywordflow">return</span> !<a class="code" href="classlibMesh_1_1DofMap.html#a82dd81ff9e21bdc2d9c80f80c692a9ea">_dont_p_refine</a>.count(g);</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;<span class="preprocessor"></span>  <a class="code" href="namespacelibMesh.html#a43f45640aab1af26176e69592c666432">libmesh_ignore</a>(g);</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;<span class="preprocessor"></span>}</div>
<div class="ttc" id="namespacelibMesh_html_a43f45640aab1af26176e69592c666432"><div class="ttname"><a href="namespacelibMesh.html#a43f45640aab1af26176e69592c666432">libMesh::libmesh_ignore</a></div><div class="ttdeci">void libmesh_ignore(const Args &amp;...)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00516">libmesh_common.h:516</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a82dd81ff9e21bdc2d9c80f80c692a9ea"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a82dd81ff9e21bdc2d9c80f80c692a9ea">libMesh::DofMap::_dont_p_refine</a></div><div class="ttdeci">std::unordered_set&lt; unsigned int &gt; _dont_p_refine</div><div class="ttdoc">A container of variable groups that we should not p-refine. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02022">dof_map.h:2022</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a50b09652f7ce880c57162036dadc763f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::should_p_refine </td>
          <td>(</td>
          <td class="paramtype">FEFamily&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a356438358e2137848c04b66abc6b396e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::should_p_refine </td>
          <td>(</td>
          <td class="paramtype">Order&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a59a34ed0ac2739c2108a7c2fc01d8347"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::should_p_refine </td>
          <td>(</td>
          <td class="paramtype">FEFamily&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a0363ec6658f4a1620ca7427cb6e505e7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::should_p_refine </td>
          <td>(</td>
          <td class="paramtype">Order&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a65eaac8ba07b919a2042addb902d4c75"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::should_p_refine_var </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>var</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Whether the given variable should be p-refined. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02354">2354</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02022">_dont_p_refine</a>, <a class="el" href="libmesh__common_8h_source.html#l00516">libMesh::libmesh_ignore()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02347">var_group_from_var_number()</a>.</p>
<div class="fragment"><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;{</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_AMR</span></div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;<span class="preprocessor"></span>  <span class="keyword">const</span> <span class="keyword">auto</span> vg = this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a3262c6d5e69e4a6c07dd9b44d79365d1">var_group_from_var_number</a>(var);</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;  <span class="keywordflow">return</span> !<a class="code" href="classlibMesh_1_1DofMap.html#a82dd81ff9e21bdc2d9c80f80c692a9ea">_dont_p_refine</a>.count(vg);</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;<span class="preprocessor"></span>  <a class="code" href="namespacelibMesh.html#a43f45640aab1af26176e69592c666432">libmesh_ignore</a>(var);</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;<span class="preprocessor"></span>}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a3262c6d5e69e4a6c07dd9b44d79365d1"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a3262c6d5e69e4a6c07dd9b44d79365d1">libMesh::DofMap::var_group_from_var_number</a></div><div class="ttdeci">unsigned int var_group_from_var_number(unsigned int var_num) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02347">dof_map.h:2347</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a43f45640aab1af26176e69592c666432"><div class="ttname"><a href="namespacelibMesh.html#a43f45640aab1af26176e69592c666432">libMesh::libmesh_ignore</a></div><div class="ttdeci">void libmesh_ignore(const Args &amp;...)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00516">libmesh_common.h:516</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a82dd81ff9e21bdc2d9c80f80c692a9ea"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a82dd81ff9e21bdc2d9c80f80c692a9ea">libMesh::DofMap::_dont_p_refine</a></div><div class="ttdeci">std::unordered_set&lt; unsigned int &gt; _dont_p_refine</div><div class="ttdoc">A container of variable groups that we should not p-refine. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02022">dof_map.h:2022</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a72f54b69e830ade14656c309586850f8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::stash_dof_constraints </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01025">1025</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02030">_stashed_dof_constraints</a>.</p>
<div class="fragment"><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  {</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    libmesh_assert(<a class="code" href="classlibMesh_1_1DofMap.html#af21470daae1a06d29df4bac4807a019c">_stashed_dof_constraints</a>.empty());</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.swap(<a class="code" href="classlibMesh_1_1DofMap.html#af21470daae1a06d29df4bac4807a019c">_stashed_dof_constraints</a>);</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af21470daae1a06d29df4bac4807a019c"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af21470daae1a06d29df4bac4807a019c">libMesh::DofMap::_stashed_dof_constraints</a></div><div class="ttdeci">DofConstraints _stashed_dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7168817015b9e35965dbbe7cdd683668"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::swap_dof_constraints </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Similar to the stash/unstash_dof_constraints() API, but swaps _dof_constraints and _stashed_dof_constraints without asserting that the source or destination is empty first. </p>
<dl class="section note"><dt>注解</dt><dd>There is an implicit assumption that swapping between sets of Constraints does not change the sparsity pattern or expand the send_list, since the only thing changed is the <a class="el" href="classlibMesh_1_1DofConstraints.html" title="The constraint matrix storage format. ">DofConstraints</a> themselves. This is intended to work for swapping between <a class="el" href="classlibMesh_1_1DofConstraints.html" title="The constraint matrix storage format. ">DofConstraints</a> A and B, where A is used to define the send_list, and B is a subset of A. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01049">1049</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02030">_stashed_dof_constraints</a>.</p>
<div class="fragment"><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  {</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.swap(<a class="code" href="classlibMesh_1_1DofMap.html#af21470daae1a06d29df4bac4807a019c">_stashed_dof_constraints</a>);</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af21470daae1a06d29df4bac4807a019c"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af21470daae1a06d29df4bac4807a019c">libMesh::DofMap::_stashed_dof_constraints</a></div><div class="ttdeci">DofConstraints _stashed_dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a244e7a1cd82d5e6ae8780c93205ec1fa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int libMesh::DofMap::sys_number </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The number of the system we are responsible for. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02093">2093</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01859">_sys_number</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l02381">_dof_indices()</a>, <a class="el" href="dof__map_8C_source.html#l02296">_node_dof_indices()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03708">allgather_recursive_constraints()</a>, <a class="el" href="dof__map_8C_source.html#l01418">assert_no_nodes_missed()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l05391">constrain_p_dofs()</a>, <a class="el" href="dof__map_8C_source.html#l00927">distribute_dofs()</a>, <a class="el" href="dof__map_8C_source.html#l01196">distribute_local_dofs_node_major()</a>, <a class="el" href="dof__map_8C_source.html#l01299">distribute_local_dofs_var_major()</a>, <a class="el" href="dof__map_8C_source.html#l02177">dof_indices()</a>, <a class="el" href="dof__map_8C_source.html#l00835">invalidate_dofs()</a>, <a class="el" href="dof__map_8C_source.html#l01109">local_variable_indices()</a>, <a class="el" href="dof__map_8C_source.html#l02630">old_dof_indices()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l01898">process_mesh_constraint_rows()</a>, <a class="el" href="dof__map_8C_source.html#l00506">reinit()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l00356">set_nonlocal_dof_objects()</a>.</p>
<div class="fragment"><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;{</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a32b9faf7127f48555386705a952460d6">_sys_number</a>;</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a32b9faf7127f48555386705a952460d6"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a32b9faf7127f48555386705a952460d6">libMesh::DofMap::_sys_number</a></div><div class="ttdeci">const unsigned int _sys_number</div><div class="ttdoc">The number of the system we manage DOFs for. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01859">dof_map.h:1859</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af08d2b93738109ef74741d685e063982"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::unstash_dof_constraints </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01031">1031</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02030">_dof_constraints</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02030">_stashed_dof_constraints</a>.</p>
<div class="fragment"><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  {</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    libmesh_assert(<a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.empty());</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <a class="code" href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">_dof_constraints</a>.swap(<a class="code" href="classlibMesh_1_1DofMap.html#af21470daae1a06d29df4bac4807a019c">_stashed_dof_constraints</a>);</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  }</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af7fe4d0cf13618e6dd04ff22fdaca0ba"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af7fe4d0cf13618e6dd04ff22fdaca0ba">libMesh::DofMap::_dof_constraints</a></div><div class="ttdeci">DofConstraints _dof_constraints</div><div class="ttdoc">Data structure containing DOF constraints. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_af21470daae1a06d29df4bac4807a019c"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#af21470daae1a06d29df4bac4807a019c">libMesh::DofMap::_stashed_dof_constraints</a></div><div class="ttdeci">DofConstraints _stashed_dof_constraints</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02030">dof_map.h:2030</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a080083acc01f3035d17895205d1399d4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DofMap::update_sparsity_pattern </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>matrix</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Additional matrices may be be temporarily initialized by this <code><a class="el" href="classlibMesh_1_1DofMap.html" title="This class handles the numbering of degrees of freedom on a mesh. ">DofMap</a></code>. </p>
<p>They are initialized to the same sparsity structure as the major matrix. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l00307">307</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01983">_sp</a>, <a class="el" href="sparse__matrix_8C_source.html#l00058">libMesh::SparseMatrix&lt; T &gt;::attach_dof_map()</a>, <a class="el" href="sparse__matrix_8C_source.html#l00068">libMesh::SparseMatrix&lt; T &gt;::attach_sparsity_pattern()</a>, <a class="el" href="dof__map_8C_source.html#l00296">computed_sparsity_already()</a>, <a class="el" href="sparse__matrix_8h_source.html#l00126">libMesh::SparseMatrix&lt; T &gt;::need_full_sparsity_pattern()</a>, <a class="el" href="dof__map_8h_source.html#l01976">need_full_sparsity_pattern</a> , 以及 <a class="el" href="sparse__matrix_8h_source.html#l00133">libMesh::SparseMatrix&lt; T &gt;::update_sparsity_pattern()</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00278">attach_matrix()</a>.</p>
<div class="fragment"><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;{</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  matrix.attach_dof_map (*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="comment">// If we&#39;ve already computed sparsity, then it&#39;s too late</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="comment">// to wait for &quot;compute_sparsity&quot; to help with sparse matrix</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="comment">// initialization, and we need to handle this matrix individually</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a235d7415e617ce36b0f2af4afc106400">computed_sparsity_already</a>())</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      libmesh_assert(<a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>.get());</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keywordflow">if</span> (matrix.need_full_sparsity_pattern())</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;          <span class="comment">// We&#39;d better have already computed the full sparsity</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;          <span class="comment">// pattern if we need it here</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;          libmesh_assert(<a class="code" href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">need_full_sparsity_pattern</a>);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;          matrix.update_sparsity_pattern (<a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>-&gt;get_sparsity_pattern());</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      matrix.attach_sparsity_pattern(*<a class="code" href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">_sp</a>);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    }</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ab14c66a56c0815c857dc662bea96f124"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ab14c66a56c0815c857dc662bea96f124">libMesh::DofMap::_sp</a></div><div class="ttdeci">std::unique_ptr&lt; SparsityPattern::Build &gt; _sp</div><div class="ttdoc">The sparsity pattern of the global matrix. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01983">dof_map.h:1983</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a235d7415e617ce36b0f2af4afc106400"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a235d7415e617ce36b0f2af4afc106400">libMesh::DofMap::computed_sparsity_already</a></div><div class="ttdeci">bool computed_sparsity_already() const </div><div class="ttdoc">Returns true iff a sparsity pattern has already been computed. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8C_source.html#l00296">dof_map.C:296</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aa8ed6583656addff061ba113f0ca4347"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa8ed6583656addff061ba113f0ca4347">libMesh::DofMap::need_full_sparsity_pattern</a></div><div class="ttdeci">bool need_full_sparsity_pattern</div><div class="ttdoc">Default false; set to true if any attached matrix requires a full sparsity pattern. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01976">dof_map.h:1976</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2489e7c067abb05feba00459ac70a1ba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::use_coupled_neighbor_dofs </td>
          <td>(</td>
          <td class="paramtype">const MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tells other library functions whether or not this problem includes coupling between dofs in neighboring cells, as can currently be specified on the command line or inferred from the use of all discontinuous variables. </p>

<p>在文件 <a class="el" href="dof__map_8C_source.html">dof_map.C</a> 第 <a class="el" href="dof__map_8C_source.html#l01760">1760</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l02074">_implicit_neighbor_dofs</a>, <a class="el" href="dof__map_8h_source.html#l02073">_implicit_neighbor_dofs_initialized</a>, <a class="el" href="libmesh_8C_source.html#l00937">libMesh::command_line_next()</a>, <a class="el" href="dof__map_8h_source.html#l00621">n_variables()</a>, <a class="el" href="libmesh_8C_source.html#l00872">libMesh::on_command_line()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02141">variable_type()</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00064">build_sparsity()</a>, <a class="el" href="dof__map_8C_source.html#l00850">clear()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l00506">reinit()</a>.</p>
<div class="fragment"><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;{</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;  <span class="comment">// If we were asked on the command line, then we need to</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;  <span class="comment">// include sensitivities between neighbor degrees of freedom</span></div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;  <span class="keywordtype">bool</span> implicit_neighbor_dofs =</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    <a class="code" href="namespacelibMesh.html#adc9fb0dafe70b50cd0848a8142cf57c0">libMesh::on_command_line</a> (<span class="stringliteral">&quot;--implicit-neighbor-dofs&quot;</span>);</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;  <span class="comment">// If the user specifies --implicit-neighbor-dofs 0, then</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;  <span class="comment">// presumably he knows what he is doing and we won&#39;t try to</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;  <span class="comment">// automatically turn it on even when all the variables are</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;  <span class="comment">// discontinuous.</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;  <span class="keywordflow">if</span> (implicit_neighbor_dofs)</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    {</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;      <span class="comment">// No flag provided defaults to &#39;true&#39;</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;      <span class="keywordtype">int</span> flag = 1;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;      flag = <a class="code" href="namespacelibMesh.html#a7e1c5da5a247e5c99321c2eac5776615">libMesh::command_line_next</a> (<span class="stringliteral">&quot;--implicit-neighbor-dofs&quot;</span>, flag);</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;      <span class="keywordflow">if</span> (!flag)</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;        {</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;          <span class="comment">// The user said --implicit-neighbor-dofs 0, so he knows</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;          <span class="comment">// what he is doing and really doesn&#39;t want it.</span></div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;        }</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    }</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;  <span class="comment">// Possibly override the commandline option, if set_implicit_neighbor_dofs</span></div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;  <span class="comment">// has been called.</span></div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1DofMap.html#aa6ed76ce98cd73ed8339f505a5284fef">_implicit_neighbor_dofs_initialized</a>)</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    {</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;      implicit_neighbor_dofs = <a class="code" href="classlibMesh_1_1DofMap.html#a09368a6dcd32c12d7a51dc00852982d5">_implicit_neighbor_dofs</a>;</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;      <span class="comment">// Again, if the user explicitly says implicit_neighbor_dofs = false,</span></div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;      <span class="comment">// then we return here.</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;      <span class="keywordflow">if</span> (!implicit_neighbor_dofs)</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    }</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;  <span class="comment">// Look at all the variables in this system.  If every one is</span></div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;  <span class="comment">// discontinuous then the user must be doing DG/FVM, so be nice</span></div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;  <span class="comment">// and force implicit_neighbor_dofs=true.</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;  {</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    <span class="keywordtype">bool</span> all_discontinuous_dofs = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> var : make_range(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#aee89c467613b296c215421d60d5ae961">n_variables</a>()))</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;      <span class="keywordflow">if</span> (FEInterface::get_continuity(this-&gt;<a class="code" href="classlibMesh_1_1DofMap.html#a0c010bb250d4cd8d65794452f46d141a">variable_type</a>(var)) !=  DISCONTINUOUS)</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;        all_discontinuous_dofs = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    <span class="keywordflow">if</span> (all_discontinuous_dofs)</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;      implicit_neighbor_dofs = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  }</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;  <span class="keywordflow">return</span> implicit_neighbor_dofs;</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_a7e1c5da5a247e5c99321c2eac5776615"><div class="ttname"><a href="namespacelibMesh.html#a7e1c5da5a247e5c99321c2eac5776615">libMesh::command_line_next</a></div><div class="ttdeci">T command_line_next(std::string name, T value)</div><div class="ttdoc">Use GetPot&amp;#39;s search()/next() functions to get following arguments from the command line...</div><div class="ttdef"><b>Definition:</b> <a href="libmesh_8C_source.html#l00937">libmesh.C:937</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aa6ed76ce98cd73ed8339f505a5284fef"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aa6ed76ce98cd73ed8339f505a5284fef">libMesh::DofMap::_implicit_neighbor_dofs_initialized</a></div><div class="ttdeci">bool _implicit_neighbor_dofs_initialized</div><div class="ttdoc">Bools to indicate if we override the –implicit_neighbor_dofs commandline options. ...</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02073">dof_map.h:2073</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a09368a6dcd32c12d7a51dc00852982d5"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a09368a6dcd32c12d7a51dc00852982d5">libMesh::DofMap::_implicit_neighbor_dofs</a></div><div class="ttdeci">bool _implicit_neighbor_dofs</div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02074">dof_map.h:2074</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a0c010bb250d4cd8d65794452f46d141a"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a0c010bb250d4cd8d65794452f46d141a">libMesh::DofMap::variable_type</a></div><div class="ttdeci">const FEType &amp; variable_type(const unsigned int c) const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l02141">dof_map.h:2141</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aee89c467613b296c215421d60d5ae961"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aee89c467613b296c215421d60d5ae961">libMesh::DofMap::n_variables</a></div><div class="ttdeci">unsigned int n_variables() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00621">dof_map.h:621</a></div></div>
<div class="ttc" id="namespacelibMesh_html_adc9fb0dafe70b50cd0848a8142cf57c0"><div class="ttname"><a href="namespacelibMesh.html#adc9fb0dafe70b50cd0848a8142cf57c0">libMesh::on_command_line</a></div><div class="ttdeci">bool on_command_line(std::string arg)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh_8C_source.html#l00872">libmesh.C:872</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3262c6d5e69e4a6c07dd9b44d79365d1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int libMesh::DofMap::var_group_from_var_number </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>var_num</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The variable group number that the provided variable number belongs to </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02347">2347</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01854">_var_to_vg</a> , 以及 <a class="el" href="dof__map_8h_source.html#l00621">n_variables()</a>.</p>

<p>参考自 <a class="el" href="dof__map_8h_source.html#l02354">should_p_refine_var()</a>.</p>
<div class="fragment"><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;{</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;  libmesh_assert(var_num &lt; <a class="code" href="classlibMesh_1_1DofMap.html#aee89c467613b296c215421d60d5ae961">n_variables</a>());</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;  <span class="keywordflow">return</span> libmesh_map_find(<a class="code" href="classlibMesh_1_1DofMap.html#a1bc6f6a2a702bfb9511b442d99fc7a28">_var_to_vg</a>, var_num);</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a1bc6f6a2a702bfb9511b442d99fc7a28"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a1bc6f6a2a702bfb9511b442d99fc7a28">libMesh::DofMap::_var_to_vg</a></div><div class="ttdeci">std::unordered_map&lt; unsigned int, unsigned int &gt; _var_to_vg</div><div class="ttdoc">A map from variable number to variable group number. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01854">dof_map.h:1854</a></div></div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_aee89c467613b296c215421d60d5ae961"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#aee89c467613b296c215421d60d5ae961">libMesh::DofMap::n_variables</a></div><div class="ttdeci">unsigned int n_variables() const </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l00621">dof_map.h:621</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab36a0dc3c2c457fa8c01c1b0ba37facc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classlibMesh_1_1Variable.html">Variable</a> &amp; libMesh::DofMap::variable </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The variable description object for variable <code>c</code>. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02111">2111</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01839">_variables</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00927">distribute_dofs()</a>, <a class="el" href="dof__map_8C_source.html#l01109">local_variable_indices()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l02544">SCALAR_dof_indices()</a>.</p>
<div class="fragment"><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;{</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;  libmesh_assert_less (c, <a class="code" href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">_variables</a>.size());</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">_variables</a>[c];</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a5232a8054e580a408f394ba1574c63df"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">libMesh::DofMap::_variables</a></div><div class="ttdeci">std::vector&lt; Variable &gt; _variables</div><div class="ttdoc">The finite element type for each variable. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01839">dof_map.h:1839</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab59bc8ca645e02067744580fdf4c9616"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classlibMesh_1_1VariableGroup.html">VariableGroup</a> &amp; libMesh::DofMap::variable_group </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The <code><a class="el" href="classlibMesh_1_1VariableGroup.html" title="This class defines a logically grouped set of variables in the system. ">VariableGroup</a></code> description object for group <code>g</code>. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02101">2101</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01844">_variable_groups</a>.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l02381">_dof_indices()</a>, <a class="el" href="dof__map_8C_source.html#l02296">_node_dof_indices()</a>, <a class="el" href="dof__map_8C_source.html#l01196">distribute_local_dofs_node_major()</a>, <a class="el" href="dof__map_8C_source.html#l01299">distribute_local_dofs_var_major()</a>, <a class="el" href="dof__map_8C_source.html#l01394">distribute_scalar_dofs()</a>, <a class="el" href="dof__map_8C_source.html#l01992">dof_indices()</a>, <a class="el" href="dof__map_8C_source.html#l02630">old_dof_indices()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l00506">reinit()</a>.</p>
<div class="fragment"><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;{</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;  libmesh_assert_less (g, <a class="code" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a>.size());</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a>[g];</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad840cf4659b6b1a2f781d29225e82743"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">libMesh::DofMap::_variable_groups</a></div><div class="ttdeci">std::vector&lt; VariableGroup &gt; _variable_groups</div><div class="ttdoc">The finite element type for each variable group. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01844">dof_map.h:1844</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9da01b7cbcfcea58b75763f80593344a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Order libMesh::DofMap::variable_group_order </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>vg</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The approximation order for <code><a class="el" href="classlibMesh_1_1VariableGroup.html" title="This class defines a logically grouped set of variables in the system. ">VariableGroup</a></code> <code>vg</code>. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02131">2131</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01844">_variable_groups</a>.</p>
<div class="fragment"><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;{</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;  libmesh_assert_less (vg, <a class="code" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a>.size());</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a>[vg].type().order;</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad840cf4659b6b1a2f781d29225e82743"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">libMesh::DofMap::_variable_groups</a></div><div class="ttdeci">std::vector&lt; VariableGroup &gt; _variable_groups</div><div class="ttdoc">The finite element type for each variable group. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01844">dof_map.h:1844</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6a2bcb4503981fc74555ec17a45cb3c3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const FEType &amp; libMesh::DofMap::variable_group_type </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>vg</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The finite element type for <code><a class="el" href="classlibMesh_1_1VariableGroup.html" title="This class defines a logically grouped set of variables in the system. ">VariableGroup</a></code> <code>vg</code>. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02151">2151</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01844">_variable_groups</a>.</p>
<div class="fragment"><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;{</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;  libmesh_assert_less (vg, <a class="code" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a>.size());</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">_variable_groups</a>[vg].type();</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_ad840cf4659b6b1a2f781d29225e82743"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#ad840cf4659b6b1a2f781d29225e82743">libMesh::DofMap::_variable_groups</a></div><div class="ttdeci">std::vector&lt; VariableGroup &gt; _variable_groups</div><div class="ttdoc">The finite element type for each variable group. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01844">dof_map.h:1844</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a43aa131ac08b4b6aff6d865e672638da"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Order libMesh::DofMap::variable_order </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The approximation order for variable <code>c</code>. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02121">2121</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01839">_variables</a>.</p>
<div class="fragment"><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;{</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;  libmesh_assert_less (c, <a class="code" href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">_variables</a>.size());</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">_variables</a>[c].type().order;</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a5232a8054e580a408f394ba1574c63df"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">libMesh::DofMap::_variables</a></div><div class="ttdeci">std::vector&lt; Variable &gt; _variables</div><div class="ttdoc">The finite element type for each variable. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01839">dof_map.h:1839</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0c010bb250d4cd8d65794452f46d141a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const FEType &amp; libMesh::DofMap::variable_type </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The finite element type for variable <code>c</code>. </dd></dl>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02141">2141</a> 行定义.</p>

<p>参考 <a class="el" href="dof__map_8h_source.html#l01839">_variables</a>.</p>

<p>参考自 <a class="el" href="dof__map__constraints_8C_source.html#l05391">constrain_p_dofs()</a>, <a class="el" href="dof__map_8C_source.html#l01109">local_variable_indices()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l01898">process_mesh_constraint_rows()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l01760">use_coupled_neighbor_dofs()</a>.</p>
<div class="fragment"><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;{</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;  libmesh_assert_less (c, <a class="code" href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">_variables</a>.size());</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">_variables</a>[c].type();</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DofMap_html_a5232a8054e580a408f394ba1574c63df"><div class="ttname"><a href="classlibMesh_1_1DofMap.html#a5232a8054e580a408f394ba1574c63df">libMesh::DofMap::_variables</a></div><div class="ttdeci">std::vector&lt; Variable &gt; _variables</div><div class="ttdoc">The finite element type for each variable. </div><div class="ttdef"><b>Definition:</b> <a href="dof__map_8h_source.html#l01839">dof_map.h:1839</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">友元及相关函数文档</h2>
<a class="anchor" id="a298e05b1935249e7045795d918f46d70"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classlibMesh_1_1SparsityPattern_1_1Build.html">SparsityPattern::Build</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02067">2067</a> 行定义.</p>

</div>
</div>
<h2 class="groupheader">类成员变量说明</h2>
<a class="anchor" id="a89fdd1d933dc29089eabf3e07908374d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1AdjointDofConstraintValues.html">AdjointDofConstraintValues</a> libMesh::DofMap::_adjoint_constraint_values</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02034">2034</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map__constraints_8C_source.html#l02218">add_adjoint_constraint_row()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03708">allgather_recursive_constraints()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03569">build_constraint_matrix_and_vector()</a>, <a class="el" href="dof__map_8C_source.html#l00850">clear()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l01736">create_dof_constraints()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03285">enforce_adjoint_constraints_exactly()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l05055">gather_constraints()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l02288">get_local_constraints()</a>, <a class="el" href="dof__map_8h_source.html#l02203">has_heterogeneous_adjoint_constraint()</a>, <a class="el" href="dof__map_8h_source.html#l02189">has_heterogeneous_adjoint_constraints()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l02529">heterogeneously_constrain_element_matrix_and_vector()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l02836">heterogeneously_constrain_element_vector()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l04372">process_constraints()</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l01898">process_mesh_constraint_rows()</a>.</p>

</div>
</div>
<a class="anchor" id="a376604ef648f92ce79ed7d2c810b55f3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::unique_ptr&lt;<a class="el" href="classlibMesh_1_1DirichletBoundaries.html">DirichletBoundaries</a>&gt; &gt; libMesh::DofMap::_adjoint_dirichlet_boundaries</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Data structure containing Dirichlet functions. </p>
<p>The ith entry is the constraint matrix row for boundaryid i. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02064">2064</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map__constraints_8C_source.html#l05456">add_adjoint_dirichlet_boundary()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l01736">create_dof_constraints()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l05480">get_adjoint_dirichlet_boundaries()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l02288">get_local_constraints()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l05470">has_adjoint_dirichlet_boundaries()</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l05513">remove_adjoint_dirichlet_boundary()</a>.</p>

</div>
</div>
<a class="anchor" id="a378d58f5e860f781a52adb61464c9378"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::set&lt;GhostingFunctor *&gt; libMesh::DofMap::_algebraic_ghosting_functors</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The list of all GhostingFunctor objects to be used when distributing ghosted vectors. </p>
<p>The library should automatically copy these functors to the MeshBase, too, so any algebraically ghosted dofs will live on geometrically ghosted elements. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01951">1951</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01886">add_algebraic_ghosting_functor()</a>, <a class="el" href="dof__map_8h_source.html#l00406">algebraic_ghosting_functors_begin()</a>, <a class="el" href="dof__map_8h_source.html#l00412">algebraic_ghosting_functors_end()</a>, <a class="el" href="dof__map_8C_source.html#l00850">clear()</a>, <a class="el" href="dof__map_8C_source.html#l00927">distribute_dofs()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l01898">remove_algebraic_ghosting_functor()</a>.</p>

</div>
</div>
<a class="anchor" id="a409a5dccf85edf7260f6186482cb9c9c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1DofMap_1_1AugmentSendList.html">AugmentSendList</a>* libMesh::DofMap::_augment_send_list</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function object to call to add extra entries to the send list. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01915">1915</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8h_source.html#l00459">attach_extra_send_list_object()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l01692">prepare_send_list()</a>.</p>

</div>
</div>
<a class="anchor" id="a8d69e59ae9a96426ceca2f356caab1b6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1SparsityPattern_1_1AugmentSparsityPattern.html">SparsityPattern::AugmentSparsityPattern</a>* libMesh::DofMap::_augment_sparsity_pattern</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function object to call to add extra entries to the sparsity pattern. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01898">1898</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8h_source.html#l00430">attach_extra_sparsity_object()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l00064">build_sparsity()</a>.</p>

</div>
</div>
<a class="anchor" id="a780be47336e49e2f9cd55bba69ee919a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::_constrained_sparsity_construction</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This flag indicates whether or not we explicitly take constraint equations into account when computing a sparsity pattern. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01834">1834</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01816">compute_sparsity()</a>, <a class="el" href="dof__map_8h_source.html#l02309">constrained_sparsity_construction()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02294">set_constrained_sparsity_construction()</a>.</p>

</div>
</div>
<a class="anchor" id="a7c913252d05560f8bc7c75a63547c4c3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1ReferenceCounter.html#adb5daadc989c1fe71ec8d173adf0ed1e">ReferenceCounter::Counts</a> libMesh::ReferenceCounter::_counts</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Actually holds the data. </p>

<p>在文件 <a class="el" href="reference__counter_8h_source.html">reference_counter.h</a> 第 <a class="el" href="reference__counter_8h_source.html#l00124">124</a> 行定义.</p>

<p>参考自 <a class="el" href="reference__counter_8C_source.html#l00047">libMesh::ReferenceCounter::get_info()</a>.</p>

</div>
</div>
<a class="anchor" id="aef1ebc9176a3f7ec9607ba4b26808991"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::set&lt;GhostingFunctor *&gt; libMesh::DofMap::_coupling_functors</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The list of all GhostingFunctor objects to be used when coupling degrees of freedom in matrix sparsity patterns. </p>
<p>These objects will <em>also</em> be used as algebraic ghosting functors, but not vice-versa.</p>
<p>The library should automatically copy these functors to the MeshBase, too, so any dofs coupled to local dofs will live on geometrically ghosted elements. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01964">1964</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01861">add_coupling_functor()</a>, <a class="el" href="dof__map_8C_source.html#l00064">build_sparsity()</a>, <a class="el" href="dof__map_8C_source.html#l00850">clear()</a>, <a class="el" href="dof__map_8h_source.html#l00344">coupling_functors_begin()</a>, <a class="el" href="dof__map_8h_source.html#l00350">coupling_functors_end()</a>, <a class="el" href="dof__map_8C_source.html#l00927">distribute_dofs()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l01873">remove_coupling_functor()</a>.</p>

</div>
</div>
<a class="anchor" id="abb069d1433ad6f8eeb4d5ebf44ae4dc8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;DefaultCoupling&gt; libMesh::DofMap::_default_coupling</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The default coupling GhostingFunctor, used to implement standard <a class="el" href="namespacelibMesh.html" title="The libMesh namespace provides an interface to certain functionality in the library. ">libMesh</a> sparsity pattern construction. </p>
<p>We use a std::unique_ptr here to reduce header dependencies. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01933">1933</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00850">clear()</a>, <a class="el" href="dof__map_8h_source.html#l00356">default_coupling()</a>, <a class="el" href="dof__map_8C_source.html#l00135">DofMap()</a>, <a class="el" href="dof__map_8C_source.html#l00506">reinit()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l00206">~DofMap()</a>.</p>

</div>
</div>
<a class="anchor" id="a4eb9c9ed9c530781aac48df4fc0cf27b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;DefaultCoupling&gt; libMesh::DofMap::_default_evaluating</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The default algebraic GhostingFunctor, used to implement standard <a class="el" href="namespacelibMesh.html" title="The libMesh namespace provides an interface to certain functionality in the library. ">libMesh</a> send_list construction. </p>
<p>We use a std::unique_ptr here to reduce header dependencies. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01941">1941</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00850">clear()</a>, <a class="el" href="dof__map_8h_source.html#l00418">default_algebraic_ghosting()</a>, <a class="el" href="dof__map_8C_source.html#l00135">DofMap()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l00206">~DofMap()</a>.</p>

</div>
</div>
<a class="anchor" id="a2e9be7e72291d4fd6e841ae7733a5ff0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classlibMesh_1_1DirichletBoundaries.html">DirichletBoundaries</a>&gt; libMesh::DofMap::_dirichlet_boundaries</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Data structure containing Dirichlet functions. </p>
<p>The ith entry is the constraint matrix row for boundaryid i. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02058">2058</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map__constraints_8C_source.html#l05450">add_dirichlet_boundary()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l01736">create_dof_constraints()</a>, <a class="el" href="dof__map_8h_source.html#l01482">get_dirichlet_boundaries()</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l05499">remove_dirichlet_boundary()</a>.</p>

</div>
</div>
<a class="anchor" id="af7fe4d0cf13618e6dd04ff22fdaca0ba"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1DofConstraints.html">DofConstraints</a> libMesh::DofMap::_dof_constraints</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Data structure containing DOF constraints. </p>
<p>The ith entry is the constraint matrix row for DOF i. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02030">2030</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map__constraints_8C_source.html#l02183">add_constraint_row()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l05349">add_constraints_to_send_list()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03708">allgather_recursive_constraints()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03459">build_constraint_matrix()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03569">build_constraint_matrix_and_vector()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l04545">check_for_constraint_loops()</a>, <a class="el" href="dof__map_8C_source.html#l00850">clear()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03048">constrain_element_dyad_matrix()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l02380">constrain_element_matrix()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l02450">constrain_element_matrix_and_vector()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03006">constrain_element_vector()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03099">constrain_nothing()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l05391">constrain_p_dofs()</a>, <a class="el" href="dof__map_8h_source.html#l01010">constraint_rows_begin()</a>, <a class="el" href="dof__map_8h_source.html#l01016">constraint_rows_end()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l01736">create_dof_constraints()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03285">enforce_adjoint_constraints_exactly()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03113">enforce_constraints_exactly()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03260">enforce_constraints_on_jacobian()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03203">enforce_constraints_on_residual()</a>, <a class="el" href="dof__map_8C_source.html#l02852">find_connected_dofs()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l05055">gather_constraints()</a>, <a class="el" href="dof__map_8h_source.html#l01023">get_dof_constraints()</a>, <a class="el" href="dof__map_8C_source.html#l02922">get_info()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l02288">get_local_constraints()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l02529">heterogeneously_constrain_element_matrix_and_vector()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l02836">heterogeneously_constrain_element_vector()</a>, <a class="el" href="dof__map_8h_source.html#l02179">is_constrained_dof()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03381">max_constraint_error()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l01724">n_local_constrained_dofs()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l04372">process_constraints()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l01898">process_mesh_constraint_rows()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l04643">scatter_constraints()</a>, <a class="el" href="dof__map_8h_source.html#l01025">stash_dof_constraints()</a>, <a class="el" href="dof__map_8h_source.html#l01049">swap_dof_constraints()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l01031">unstash_dof_constraints()</a>.</p>

</div>
</div>
<a class="anchor" id="ab276e172c5488ab3b387b235e28556cf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CouplingMatrix* libMesh::DofMap::_dof_coupling</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Degree of freedom coupling. </p>
<p>If left empty each DOF couples to all others. Can be used to reduce memory requirements for sparse matrices. DOF 0 might only couple to itself, in which case <code>dof_coupling(0,0)</code> should be 1 and <code>dof_coupling(0,j)</code> = 0 for j not equal to 0.</p>
<p>This variable is named as though it were class private, but it is in the public interface. Also there are no public methods for accessing it... This typically means you should only use it if you know what you are doing. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01589">1589</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00064">build_sparsity()</a>, <a class="el" href="dof__map_8C_source.html#l00850">clear()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l00506">reinit()</a>.</p>

</div>
</div>
<a class="anchor" id="a82dd81ff9e21bdc2d9c80f80c692a9ea"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_set&lt;unsigned int&gt; libMesh::DofMap::_dont_p_refine</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A container of variable groups that we should not p-refine. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02022">2022</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l02381">_dof_indices()</a>, <a class="el" href="dof__map_8C_source.html#l02296">_node_dof_indices()</a>, <a class="el" href="dof__map_8C_source.html#l02630">old_dof_indices()</a>, <a class="el" href="dof__map_8C_source.html#l00506">reinit()</a>, <a class="el" href="dof__map_8h_source.html#l02319">should_p_refine()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02354">should_p_refine_var()</a>.</p>

</div>
</div>
<a class="anchor" id="a8f75e8a4a280f2c41636f2ae1307a311"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::ReferenceCounter::_enable_print_counter = true</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flag to control whether reference count information is printed when print_info is called. </p>

<p>在文件 <a class="el" href="reference__counter_8h_source.html">reference_counter.h</a> 第 <a class="el" href="reference__counter_8h_source.html#l00143">143</a> 行定义.</p>

<p>参考自 <a class="el" href="reference__counter_8C_source.html#l00100">libMesh::ReferenceCounter::disable_print_counter_info()</a>, <a class="el" href="reference__counter_8C_source.html#l00094">libMesh::ReferenceCounter::enable_print_counter_info()</a> , 以及 <a class="el" href="reference__counter_8C_source.html#l00081">libMesh::ReferenceCounter::print_info()</a>.</p>

</div>
</div>
<a class="anchor" id="af43f96a9e11b3f4221306fdfd4511aaa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&gt; libMesh::DofMap::_end_df</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Last DOF index (plus 1) on processor <code>p</code>. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01881">1881</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00850">clear()</a>, <a class="el" href="dof__map_8C_source.html#l00927">distribute_dofs()</a>, <a class="el" href="dof__map_8h_source.html#l00717">dof_owner()</a>, <a class="el" href="dof__map_8h_source.html#l00708">end_dof()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l05055">gather_constraints()</a>, <a class="el" href="dof__map_8h_source.html#l00675">n_dofs_on_processor()</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l04643">scatter_constraints()</a>.</p>

</div>
</div>
<a class="anchor" id="ab96f5b260e5925063553da996bb3b428"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&gt; libMesh::DofMap::_end_old_df</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Last old DOF index (plus 1) on processor <code>p</code>. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02011">2011</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00850">clear()</a>, <a class="el" href="dof__map_8C_source.html#l00927">distribute_dofs()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l00731">end_old_dof()</a>.</p>

</div>
</div>
<a class="anchor" id="aef749fe651254903abfc12d9b81e2a16"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::_error_on_constraint_loop</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This flag indicates whether or not we do an opt-mode check for the presence of constraint loops, i.e. </p>
<p>cases where the constraint graph is cyclic. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01828">1828</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map__constraints_8C_source.html#l04372">process_constraints()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l00245">set_error_on_constraint_loop()</a>.</p>

</div>
</div>
<a class="anchor" id="a6c450ba54bc8caffac28eed88a98a17d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void* libMesh::DofMap::_extra_send_list_context</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A pointer associated with the extra send list that can optionally be passed in. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01925">1925</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8h_source.html#l00468">attach_extra_send_list_function()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l01692">prepare_send_list()</a>.</p>

</div>
</div>
<a class="anchor" id="af1bdebf08fdd914c71545e45624e3c8f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void(* libMesh::DofMap::_extra_send_list_function)(std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;, void *)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A function pointer to a function to call to add extra entries to the send list. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01920">1920</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8h_source.html#l00468">attach_extra_send_list_function()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l01692">prepare_send_list()</a>.</p>

</div>
</div>
<a class="anchor" id="a283ce213140aa281498b56e138ee8de2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void* libMesh::DofMap::_extra_sparsity_context</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A pointer associated with the extra sparsity that can optionally be passed in. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01910">1910</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8h_source.html#l00445">attach_extra_sparsity_function()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l00064">build_sparsity()</a>.</p>

</div>
</div>
<a class="anchor" id="ab3513c402066e6431799e388d62be036"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void(* libMesh::DofMap::_extra_sparsity_function)(<a class="el" href="classlibMesh_1_1SparsityPattern_1_1Graph.html">SparsityPattern::Graph</a> &amp;, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;n_nz, std::vector&lt; <a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> &gt; &amp;n_oz, void *)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A function pointer to a function to call to add extra entries to the sparsity pattern. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01903">1903</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8h_source.html#l00445">attach_extra_sparsity_function()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l00064">build_sparsity()</a>.</p>

</div>
</div>
<a class="anchor" id="ab72062de06b72df985ac5bf16837a7da"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&gt; libMesh::DofMap::_first_df</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>First DOF index on processor <code>p</code>. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01876">1876</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00850">clear()</a>, <a class="el" href="dof__map_8C_source.html#l00927">distribute_dofs()</a>, <a class="el" href="dof__map_8h_source.html#l00684">first_dof()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l00675">n_dofs_on_processor()</a>.</p>

</div>
</div>
<a class="anchor" id="ab91d708f5167f50c0392b2fd5dea2559"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&gt; libMesh::DofMap::_first_old_df</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>First old DOF index on processor <code>p</code>. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02006">2006</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00850">clear()</a>, <a class="el" href="dof__map_8C_source.html#l00927">distribute_dofs()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l00694">first_old_dof()</a>.</p>

</div>
</div>
<a class="anchor" id="a92da14cf60e82ed600bfe67ca3422765"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&gt; libMesh::DofMap::_first_old_scalar_df</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>First old DOF index for SCALAR variable v, or garbage for non-SCALAR variable v. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02017">2017</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00850">clear()</a>, <a class="el" href="dof__map_8C_source.html#l00927">distribute_dofs()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l02544">SCALAR_dof_indices()</a>.</p>

</div>
</div>
<a class="anchor" id="af1fc10139391d71da470387d9e4adbb5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&gt; libMesh::DofMap::_first_scalar_df</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>First DOF index for SCALAR variable v, or garbage for non-SCALAR variable v. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01887">1887</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00850">clear()</a>, <a class="el" href="dof__map_8C_source.html#l00927">distribute_dofs()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l02544">SCALAR_dof_indices()</a>.</p>

</div>
</div>
<a class="anchor" id="a09368a6dcd32c12d7a51dc00852982d5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::_implicit_neighbor_dofs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02074">2074</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01748">set_implicit_neighbor_dofs()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l01760">use_coupled_neighbor_dofs()</a>.</p>

</div>
</div>
<a class="anchor" id="aa6ed76ce98cd73ed8339f505a5284fef"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::_implicit_neighbor_dofs_initialized</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Bools to indicate if we override the &ndash;implicit_neighbor_dofs commandline options. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02073">2073</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01748">set_implicit_neighbor_dofs()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l01760">use_coupled_neighbor_dofs()</a>.</p>

</div>
</div>
<a class="anchor" id="aacf8838eb951b139f05e56e338ac2195"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classlibMesh_1_1SparseMatrix.html">SparseMatrix</a>&lt;<a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a>&gt; * &gt; libMesh::DofMap::_matrices</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Additional matrices handled by this object. </p>
<p>These pointers do <em>not</em> handle the memory, instead, <code>System</code>, who told <code><a class="el" href="classlibMesh_1_1DofMap.html" title="This class handles the numbering of degrees of freedom on a mesh. ">DofMap</a></code> about them, owns them. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01871">1871</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00278">attach_matrix()</a>, <a class="el" href="dof__map_8C_source.html#l00850">clear()</a>, <a class="el" href="dof__map_8C_source.html#l01816">compute_sparsity()</a>, <a class="el" href="dof__map_8C_source.html#l00135">DofMap()</a>, <a class="el" href="dof__map_8C_source.html#l02922">get_info()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l00333">is_attached()</a>.</p>

</div>
</div>
<a class="anchor" id="ac0f1617e6f28fc596497b370092bcc17"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MeshBase&amp; libMesh::DofMap::_mesh</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The mesh that system uses. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01864">1864</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01886">add_algebraic_ghosting_functor()</a>, <a class="el" href="dof__map_8C_source.html#l01861">add_coupling_functor()</a>, <a class="el" href="dof__map_8C_source.html#l00850">clear()</a>, <a class="el" href="dof__map_8C_source.html#l00135">DofMap()</a>, <a class="el" href="dof__map_8C_source.html#l01898">remove_algebraic_ghosting_functor()</a>, <a class="el" href="dof__map_8C_source.html#l01873">remove_coupling_functor()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l00206">~DofMap()</a>.</p>

</div>
</div>
<a class="anchor" id="abedbd3a4ce19686187449a8a0557b74b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Threads::spin_mutex libMesh::ReferenceCounter::_mutex</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Mutual exclusion object to enable thread-safe reference counting. </p>

<p>在文件 <a class="el" href="reference__counter_8h_source.html">reference_counter.h</a> 第 <a class="el" href="reference__counter_8h_source.html#l00137">137</a> 行定义.</p>

</div>
</div>
<a class="anchor" id="a0964620ae8054b969297d1d9087b7b05"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::_n_dfs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Total number of degrees of freedom. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01988">1988</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00850">clear()</a>, <a class="el" href="dof__map_8C_source.html#l00927">distribute_dofs()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l00659">n_dofs()</a>.</p>

</div>
</div>
<a class="anchor" id="ad2c30f0f71dcd00f00faa8e46aa3e043"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Threads::atomic&lt; unsigned int &gt; libMesh::ReferenceCounter::_n_objects</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The number of objects. </p>
<p>Print the reference count information when the number returns to 0. </p>

<p>在文件 <a class="el" href="reference__counter_8h_source.html">reference_counter.h</a> 第 <a class="el" href="reference__counter_8h_source.html#l00132">132</a> 行定义.</p>

<p>参考自 <a class="el" href="reference__counter_8h_source.html#l00085">libMesh::ReferenceCounter::n_objects()</a>, <a class="el" href="reference__counter_8h_source.html#l00150">libMesh::ReferenceCounter::ReferenceCounter()</a> , 以及 <a class="el" href="reference__counter_8h_source.html#l00171">libMesh::ReferenceCounter::~ReferenceCounter()</a>.</p>

</div>
</div>
<a class="anchor" id="abbca79dca4f02ab917e89aeac3113808"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::_n_old_dfs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Total number of degrees of freedom on old dof objects. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02001">2001</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00850">clear()</a>, <a class="el" href="dof__map_8C_source.html#l00927">distribute_dofs()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l01539">n_old_dofs()</a>.</p>

</div>
</div>
<a class="anchor" id="a8dbee781954d22ad785846b3a2a45193"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> libMesh::DofMap::_n_SCALAR_dofs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The total number of SCALAR dofs associated to all SCALAR variables. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01994">1994</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01394">distribute_scalar_dofs()</a>, <a class="el" href="dof__map_8h_source.html#l00664">n_SCALAR_dofs()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l00506">reinit()</a>.</p>

</div>
</div>
<a class="anchor" id="a8856db766d722a0edaa9f5c5d94d40f7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1NodeConstraints.html">NodeConstraints</a> libMesh::DofMap::_node_constraints</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Data structure containing <a class="el" href="classlibMesh_1_1DofObject.html" title="The DofObject defines an abstract base class for objects that have degrees of freedom associated with...">DofObject</a> constraints. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02041">2041</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map__constraints_8C_source.html#l03708">allgather_recursive_constraints()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l01736">create_dof_constraints()</a>, <a class="el" href="dof__map_8C_source.html#l02922">get_info()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l02288">get_local_constraints()</a>, <a class="el" href="dof__map_8h_source.html#l02163">is_constrained_node()</a>, <a class="el" href="dof__map_8h_source.html#l00908">n_constrained_nodes()</a>, <a class="el" href="dof__map_8h_source.html#l01058">node_constraint_rows_begin()</a>, <a class="el" href="dof__map_8h_source.html#l01064">node_constraint_rows_end()</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l04643">scatter_constraints()</a>.</p>

</div>
</div>
<a class="anchor" id="ab91693b08a22cfe1af7781287157ac8a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classlibMesh_1_1PeriodicBoundaries.html">PeriodicBoundaries</a>&gt; libMesh::DofMap::_periodic_boundaries</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Data structure containing periodic boundaries. </p>
<p>The ith entry is the constraint matrix row for boundaryid i. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02050">2050</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map__constraints_8C_source.html#l05570">add_periodic_boundary()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l01736">create_dof_constraints()</a>, <a class="el" href="dof__map_8C_source.html#l00135">DofMap()</a>, <a class="el" href="dof__map_8h_source.html#l01429">get_periodic_boundaries()</a>, <a class="el" href="dof__map_8C_source.html#l00219">is_periodic_boundary()</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l01898">process_mesh_constraint_rows()</a>.</p>

</div>
</div>
<a class="anchor" id="a24e7c497429c2bd81a5cc39f71cfa6e0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1DofConstraintValueMap.html">DofConstraintValueMap</a> libMesh::DofMap::_primal_constraint_values</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02032">2032</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map__constraints_8C_source.html#l02183">add_constraint_row()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03708">allgather_recursive_constraints()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03569">build_constraint_matrix_and_vector()</a>, <a class="el" href="dof__map_8C_source.html#l00850">clear()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l05391">constrain_p_dofs()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l01736">create_dof_constraints()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03113">enforce_constraints_exactly()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03203">enforce_constraints_on_residual()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l05055">gather_constraints()</a>, <a class="el" href="dof__map_8C_source.html#l02922">get_info()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l02288">get_local_constraints()</a>, <a class="el" href="dof__map_8h_source.html#l02224">get_primal_constraint_values()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l02529">heterogeneously_constrain_element_matrix_and_vector()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l02836">heterogeneously_constrain_element_vector()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l03381">max_constraint_error()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l04372">process_constraints()</a>, <a class="el" href="dof__map__constraints_8C_source.html#l01898">process_mesh_constraint_rows()</a> , 以及 <a class="el" href="dof__map__constraints_8C_source.html#l04643">scatter_constraints()</a>.</p>

</div>
</div>
<a class="anchor" id="a2b3873478d701811b9562b514fc2c369"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a>&gt; libMesh::DofMap::_send_list</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A list containing all the global DOF indices that affect the solution on my processor. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01893">1893</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map__constraints_8C_source.html#l05349">add_constraints_to_send_list()</a>, <a class="el" href="dof__map_8C_source.html#l01544">add_neighbors_to_send_list()</a>, <a class="el" href="dof__map_8h_source.html#l00485">clear_send_list()</a>, <a class="el" href="dof__map_8h_source.html#l00511">get_send_list()</a>, <a class="el" href="dof__map_8C_source.html#l01692">prepare_send_list()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l02580">semilocal_index()</a>.</p>

</div>
</div>
<a class="anchor" id="ac72a2e7009922c18fc0a59ebcceb58b1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::map&lt;GhostingFunctor *, std::shared_ptr&lt;GhostingFunctor&gt; &gt; libMesh::DofMap::_shared_functors</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Hang on to references to any GhostingFunctor objects we were passed in shared_ptr form. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01970">1970</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8h_source.html#l00391">add_algebraic_ghosting_functor()</a>, <a class="el" href="dof__map_8h_source.html#l00329">add_coupling_functor()</a>, <a class="el" href="dof__map_8C_source.html#l00850">clear()</a>, <a class="el" href="dof__map_8C_source.html#l01898">remove_algebraic_ghosting_functor()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l01873">remove_coupling_functor()</a>.</p>

</div>
</div>
<a class="anchor" id="ab14c66a56c0815c857dc662bea96f124"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classlibMesh_1_1SparsityPattern_1_1Build.html">SparsityPattern::Build</a>&gt; libMesh::DofMap::_sp</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The sparsity pattern of the global matrix. </p>
<p>If need_full_sparsity_pattern is true, we save the entire sparse graph here. Otherwise we save just the n_nz and n_oz vectors. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01983">1983</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l01837">clear_sparsity()</a>, <a class="el" href="dof__map_8C_source.html#l01816">compute_sparsity()</a>, <a class="el" href="dof__map_8C_source.html#l00296">computed_sparsity_already()</a>, <a class="el" href="dof__map_8C_source.html#l02922">get_info()</a>, <a class="el" href="dof__map_8h_source.html#l00520">get_n_nz()</a>, <a class="el" href="dof__map_8h_source.html#l00533">get_n_oz()</a>, <a class="el" href="dof__map_8h_source.html#l00548">get_sparsity_pattern()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l00307">update_sparsity_pattern()</a>.</p>

</div>
</div>
<a class="anchor" id="af21470daae1a06d29df4bac4807a019c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1DofConstraints.html">DofConstraints</a> libMesh::DofMap::_stashed_dof_constraints</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02030">2030</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00850">clear()</a>, <a class="el" href="dof__map_8h_source.html#l01025">stash_dof_constraints()</a>, <a class="el" href="dof__map_8h_source.html#l01049">swap_dof_constraints()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l01031">unstash_dof_constraints()</a>.</p>

</div>
</div>
<a class="anchor" id="a32b9faf7127f48555386705a952460d6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned int libMesh::DofMap::_sys_number</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The number of the system we manage DOFs for. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01859">1859</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8h_source.html#l02093">sys_number()</a>.</p>

</div>
</div>
<a class="anchor" id="a1bc6f6a2a702bfb9511b442d99fc7a28"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt;unsigned int, unsigned int&gt; libMesh::DofMap::_var_to_vg</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A map from variable number to variable group number. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01854">1854</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00252">add_variable_group()</a>, <a class="el" href="dof__map_8C_source.html#l00850">clear()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02347">var_group_from_var_number()</a>.</p>

</div>
</div>
<a class="anchor" id="a04bedd57c80ef97a7d9a0a3e2fe8a248"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;unsigned int&gt; libMesh::DofMap::_variable_group_numbers</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The variable group number for each variable. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01849">1849</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00252">add_variable_group()</a>, <a class="el" href="dof__map_8C_source.html#l00850">clear()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l02102">dof_indices()</a>.</p>

</div>
</div>
<a class="anchor" id="ad840cf4659b6b1a2f781d29225e82743"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classlibMesh_1_1VariableGroup.html">VariableGroup</a>&gt; libMesh::DofMap::_variable_groups</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The finite element type for each variable group. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01844">1844</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00252">add_variable_group()</a>, <a class="el" href="dof__map_8C_source.html#l00850">clear()</a>, <a class="el" href="dof__map_8h_source.html#l00613">n_variable_groups()</a>, <a class="el" href="dof__map_8h_source.html#l02101">variable_group()</a>, <a class="el" href="dof__map_8h_source.html#l02131">variable_group_order()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02151">variable_group_type()</a>.</p>

</div>
</div>
<a class="anchor" id="a5232a8054e580a408f394ba1574c63df"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classlibMesh_1_1Variable.html">Variable</a>&gt; libMesh::DofMap::_variables</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The finite element type for each variable. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01839">1839</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00252">add_variable_group()</a>, <a class="el" href="dof__map_8C_source.html#l00850">clear()</a>, <a class="el" href="dof__map_8h_source.html#l00621">n_variables()</a>, <a class="el" href="dof__map_8h_source.html#l02111">variable()</a>, <a class="el" href="dof__map_8h_source.html#l02121">variable_order()</a> , 以及 <a class="el" href="dof__map_8h_source.html#l02141">variable_type()</a>.</p>

</div>
</div>
<a class="anchor" id="a126ef1ca10f48a41d48010b3296ddef7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::_verify_dirichlet_bc_consistency</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Flag which determines whether we should do some additional checking of the consistency of the <a class="el" href="classlibMesh_1_1DirichletBoundary.html" title="This class allows one to associate Dirichlet boundary values with a given set of mesh boundary ids an...">DirichletBoundary</a> objects added by the user. </p>
<p>Defaults to true, but can be disabled in cases where you only want to add <a class="el" href="classlibMesh_1_1DirichletBoundary.html" title="This class allows one to associate Dirichlet boundary values with a given set of mesh boundary ids an...">DirichletBoundary</a> objects "locally" and can guarantee that no repartitioning will be done, since repartitioning could cause processors to own new boundary sides for which they no longer have the proper <a class="el" href="classlibMesh_1_1DirichletBoundary.html" title="This class allows one to associate Dirichlet boundary values with a given set of mesh boundary ids an...">DirichletBoundary</a> objects stored. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l02086">2086</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map__constraints_8C_source.html#l01736">create_dof_constraints()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l01754">set_verify_dirichlet_bc_consistency()</a>.</p>

</div>
</div>
<a class="anchor" id="aa8ed6583656addff061ba113f0ca4347"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DofMap::need_full_sparsity_pattern</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Default false; set to true if any attached matrix requires a full sparsity pattern. </p>

<p>在文件 <a class="el" href="dof__map_8h_source.html">dof_map.h</a> 第 <a class="el" href="dof__map_8h_source.html#l01976">1976</a> 行定义.</p>

<p>参考自 <a class="el" href="dof__map_8C_source.html#l00278">attach_matrix()</a>, <a class="el" href="dof__map_8C_source.html#l00064">build_sparsity()</a>, <a class="el" href="dof__map_8C_source.html#l00850">clear()</a>, <a class="el" href="dof__map_8C_source.html#l01816">compute_sparsity()</a> , 以及 <a class="el" href="dof__map_8C_source.html#l00307">update_sparsity_pattern()</a>.</p>

</div>
</div>
<hr/>该类的文档由以下文件生成:<ul>
<li>/home/lwz/libmesh/include/base/<a class="el" href="dof__map_8h_source.html">dof_map.h</a></li>
<li>/home/lwz/libmesh/src/base/<a class="el" href="dof__map_8C_source.html">dof_map.C</a></li>
<li>/home/lwz/libmesh/src/base/<a class="el" href="dof__map__constraints_8C_source.html">dof_map_constraints.C</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
生成于 2023年 十二月 20日 星期三 14:07:07 , 为 libmesh解析使用  &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
