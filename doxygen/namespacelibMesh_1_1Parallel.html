<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>libmesh解析: libMesh::Parallel 命名空间参考</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">libmesh解析
   </div>
   <div id="projectbrief">本工作只是尝试解析原libmesh的代码,供学习使用</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'搜索');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>首页</span></a></li>
      <li><a href="annotated.html"><span>类</span></a></li>
      <li><a href="files.html"><span>文件</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="搜索" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespacemembers.html"><span>命名空间成员</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>全部</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>类</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>命名空间</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>文件</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>函数</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>变量</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>类型定义</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>枚举</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>枚举值</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>友元</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>页</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacelibMesh.html">libMesh</a></li><li class="navelem"><a class="el" href="namespacelibMesh_1_1Parallel.html">Parallel</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#namespaces">命名空间</a> &#124;
<a href="#nested-classes">类</a> &#124;
<a href="#typedef-members">类型定义</a> &#124;
<a href="#func-members">函数</a>  </div>
  <div class="headertitle">
<div class="title">libMesh::Parallel 命名空间参考</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
命名空间</h2></td></tr>
<tr class="memitem:namespacelibMesh_1_1Parallel_1_1Utils"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelibMesh_1_1Parallel_1_1Utils.html">Utils</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
类</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1Parallel_1_1BinSorter.html">BinSorter</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform a parallel sort using a bin-sort method.  <a href="classlibMesh_1_1Parallel_1_1BinSorter.html#details">更多...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1Parallel_1_1Packing_3_01Eigen_1_1Matrix_3_01Scalar_00_01Rows_00_01Cols_00_01Optieb76b857bed7045b2d00148d52549571.html">Packing&lt; Eigen::Matrix&lt; Scalar, Rows, Cols, Options, MaxRows, MaxCols &gt; &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1Parallel_1_1Packing_3_01const_01Elem_01_5_01_4.html">Packing&lt; const Elem * &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1Parallel_1_1Packing_3_01Elem_01_5_01_4.html">Packing&lt; Elem * &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1Parallel_1_1Packing_3_01Elem_01_5const_01_01_4.html">Packing&lt; Elem *const  &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1Parallel_1_1Packing_3_01const_01Elem_01_5const_01_01_4.html">Packing&lt; const Elem *const  &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlibMesh_1_1Parallel_1_1SyncEverything.html">SyncEverything</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1Parallel_1_1Histogram.html">Histogram</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines a histogram to be used in parallel in conjunction with a <code><a class="el" href="classlibMesh_1_1Parallel_1_1BinSorter.html" title="Perform a parallel sort using a bin-sort method. ">BinSorter</a></code>.  <a href="classlibMesh_1_1Parallel_1_1Histogram.html#details">更多...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1Parallel_1_1Packing_3_01const_01Node_01_5_01_4.html">Packing&lt; const Node * &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1Parallel_1_1Packing_3_01Node_01_5_01_4.html">Packing&lt; Node * &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1Parallel_1_1Packing_3_01Node_01_5const_01_01_4.html">Packing&lt; Node *const  &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1Parallel_1_1Packing_3_01const_01Node_01_5const_01_01_4.html">Packing&lt; const Node *const  &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1Parallel_1_1Sort.html">Sort</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The parallel sorting method is templated on the type of data which is to be sorted.  <a href="classlibMesh_1_1Parallel_1_1Sort.html#details">更多...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
类型定义</h2></td></tr>
<tr class="memitem:aefbe7c94fa1895557e56fdc001710b16"><td class="memItemLeft" align="right" valign="top">typedef std::pair<br class="typebreak"/>
&lt; Hilbert::HilbertIndices, <br class="typebreak"/>
<a class="el" href="namespacelibMesh.html#a0c8246ed396fb6017ccc59711d9b9f7e">unique_id_type</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelibMesh_1_1Parallel.html#aefbe7c94fa1895557e56fdc001710b16">DofObjectKey</a></td></tr>
<tr class="separator:aefbe7c94fa1895557e56fdc001710b16"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
函数</h2></td></tr>
<tr class="memitem:ab412d3606d51e5df080eab5795351901"><td class="memTemplParams" colspan="2">template&lt;typename Iterator , typename DofObjType , typename SyncFunctor &gt; </td></tr>
<tr class="memitem:ab412d3606d51e5df080eab5795351901"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacelibMesh_1_1Parallel.html#ab412d3606d51e5df080eab5795351901">sync_dofobject_data_by_xyz</a> (const Communicator &amp;comm, const Iterator &amp;range_begin, const Iterator &amp;range_end, <a class="el" href="classlibMesh_1_1LocationMap.html">LocationMap</a>&lt; DofObjType &gt; &amp;location_map, SyncFunctor &amp;sync)</td></tr>
<tr class="memdesc:ab412d3606d51e5df080eab5795351901"><td class="mdescLeft">&#160;</td><td class="mdescRight">Request data about a range of ghost nodes uniquely identified by their xyz location or a range of active ghost elements uniquely identified by their vertex averages' xyz location.  <a href="#ab412d3606d51e5df080eab5795351901">更多...</a><br/></td></tr>
<tr class="separator:ab412d3606d51e5df080eab5795351901"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7d4f06bb34625465942e6b8d10f135e"><td class="memTemplParams" colspan="2">template&lt;typename Iterator , typename SyncFunctor &gt; </td></tr>
<tr class="memitem:ac7d4f06bb34625465942e6b8d10f135e"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacelibMesh_1_1Parallel.html#ac7d4f06bb34625465942e6b8d10f135e">sync_dofobject_data_by_id</a> (const Communicator &amp;comm, const Iterator &amp;range_begin, const Iterator &amp;range_end, SyncFunctor &amp;sync)</td></tr>
<tr class="memdesc:ac7d4f06bb34625465942e6b8d10f135e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Request data about a range of ghost dofobjects uniquely identified by their id.  <a href="#ac7d4f06bb34625465942e6b8d10f135e">更多...</a><br/></td></tr>
<tr class="separator:ac7d4f06bb34625465942e6b8d10f135e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0ccf736a24de62226fbaf331153735c"><td class="memTemplParams" colspan="2">template&lt;typename Iterator , typename DofObjectCheckFunctor , typename SyncFunctor &gt; </td></tr>
<tr class="memitem:ab0ccf736a24de62226fbaf331153735c"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacelibMesh_1_1Parallel.html#ab0ccf736a24de62226fbaf331153735c">sync_dofobject_data_by_id</a> (const Communicator &amp;comm, const Iterator &amp;range_begin, const Iterator &amp;range_end, const DofObjectCheckFunctor &amp;dofobj_check, SyncFunctor &amp;sync)</td></tr>
<tr class="memdesc:ab0ccf736a24de62226fbaf331153735c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Request data about a range of ghost dofobjects uniquely identified by their id.  <a href="#ab0ccf736a24de62226fbaf331153735c">更多...</a><br/></td></tr>
<tr class="separator:ab0ccf736a24de62226fbaf331153735c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29c79f0c66ce48d4b3801a77b139df3b"><td class="memTemplParams" colspan="2">template&lt;typename Iterator , typename SyncFunctor &gt; </td></tr>
<tr class="memitem:a29c79f0c66ce48d4b3801a77b139df3b"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacelibMesh_1_1Parallel.html#a29c79f0c66ce48d4b3801a77b139df3b">sync_element_data_by_parent_id</a> (<a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;<a class="el" href="mesh__tools_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>, const Iterator &amp;range_begin, const Iterator &amp;range_end, SyncFunctor &amp;sync)</td></tr>
<tr class="memdesc:a29c79f0c66ce48d4b3801a77b139df3b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Request data about a range of ghost elements uniquely identified by their parent id and which child they are.  <a href="#a29c79f0c66ce48d4b3801a77b139df3b">更多...</a><br/></td></tr>
<tr class="separator:a29c79f0c66ce48d4b3801a77b139df3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a690437fd4e60ad2cedf64948c3f21519"><td class="memTemplParams" colspan="2">template&lt;typename ElemCheckFunctor , typename NodeCheckFunctor , typename SyncFunctor &gt; </td></tr>
<tr class="memitem:a690437fd4e60ad2cedf64948c3f21519"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacelibMesh_1_1Parallel.html#a690437fd4e60ad2cedf64948c3f21519">sync_node_data_by_element_id_once</a> (<a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;<a class="el" href="mesh__tools_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>, const <a class="el" href="structlibMesh_1_1MeshBase_1_1const__element__iterator.html">MeshBase::const_element_iterator</a> &amp;range_begin, const <a class="el" href="structlibMesh_1_1MeshBase_1_1const__element__iterator.html">MeshBase::const_element_iterator</a> &amp;range_end, const ElemCheckFunctor &amp;elem_check, const NodeCheckFunctor &amp;node_check, SyncFunctor &amp;sync)</td></tr>
<tr class="memdesc:a690437fd4e60ad2cedf64948c3f21519"><td class="mdescLeft">&#160;</td><td class="mdescRight">Synchronize data about a range of ghost nodes uniquely identified by an element id and local node id, assuming a single synchronization pass is necessary.  <a href="#a690437fd4e60ad2cedf64948c3f21519">更多...</a><br/></td></tr>
<tr class="separator:a690437fd4e60ad2cedf64948c3f21519"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78a93cd4ce160f40c758f96e2cadbe25"><td class="memTemplParams" colspan="2">template&lt;typename ElemCheckFunctor , typename NodeCheckFunctor , typename SyncFunctor &gt; </td></tr>
<tr class="memitem:a78a93cd4ce160f40c758f96e2cadbe25"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacelibMesh_1_1Parallel.html#a78a93cd4ce160f40c758f96e2cadbe25">sync_node_data_by_element_id</a> (<a class="el" href="classlibMesh_1_1MeshBase.html">MeshBase</a> &amp;<a class="el" href="mesh__tools_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>, const <a class="el" href="structlibMesh_1_1MeshBase_1_1const__element__iterator.html">MeshBase::const_element_iterator</a> &amp;range_begin, const <a class="el" href="structlibMesh_1_1MeshBase_1_1const__element__iterator.html">MeshBase::const_element_iterator</a> &amp;range_end, const ElemCheckFunctor &amp;elem_check, const NodeCheckFunctor &amp;node_check, SyncFunctor &amp;sync)</td></tr>
<tr class="memdesc:a78a93cd4ce160f40c758f96e2cadbe25"><td class="mdescLeft">&#160;</td><td class="mdescRight">Synchronize data about a range of ghost nodes uniquely identified by an element id and local node id, iterating until data is completely in sync and further synchronization passes cause no changes.  <a href="#a78a93cd4ce160f40c758f96e2cadbe25">更多...</a><br/></td></tr>
<tr class="separator:a78a93cd4ce160f40c758f96e2cadbe25"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">类型定义说明</h2>
<a class="anchor" id="aefbe7c94fa1895557e56fdc001710b16"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef Hilbert::HilbertIndices <a class="el" href="namespacelibMesh_1_1Parallel.html#aefbe7c94fa1895557e56fdc001710b16">libMesh::Parallel::DofObjectKey</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="parallel__hilbert_8h_source.html">parallel_hilbert.h</a> 第 <a class="el" href="parallel__hilbert_8h_source.html#l00080">80</a> 行定义.</p>

</div>
</div>
<h2 class="groupheader">函数说明</h2>
<a class="anchor" id="ac7d4f06bb34625465942e6b8d10f135e"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Iterator , typename SyncFunctor &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::Parallel::sync_dofobject_data_by_id </td>
          <td>(</td>
          <td class="paramtype">const Communicator &amp;&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Iterator &amp;&#160;</td>
          <td class="paramname"><em>range_begin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Iterator &amp;&#160;</td>
          <td class="paramname"><em>range_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SyncFunctor &amp;&#160;</td>
          <td class="paramname"><em>sync</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Request data about a range of ghost dofobjects uniquely identified by their id. </p>
<p>Fulfill requests with sync.gather_data(const std::vector&lt;dof_id_type&gt; &amp; ids, std::vector&lt;sync::datum&gt; &amp; data), by resizing and setting the values of the data vector. Respond to fulfillment with sync.act_on_data(const std::vector&lt;dof_id_type&gt; &amp; ids, std::vector&lt;sync::datum&gt; &amp; data) The user must define Parallel::StandardType&lt;sync::datum&gt; if sync::datum isn't a built-in type. </p>

<p>在文件 <a class="el" href="parallel__ghost__sync_8h_source.html">parallel_ghost_sync.h</a> 第 <a class="el" href="parallel__ghost__sync_8h_source.html#l00357">357</a> 行定义.</p>

<p>参考自 <a class="el" href="partitioner_8C_source.html#l01067">libMesh::Partitioner::_find_global_index_by_pid_map()</a>, <a class="el" href="mesh__tools_8C_source.html#l02222">libMesh::MeshTools::correct_node_proc_ids()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00779">libMesh::MeshRefinement::make_coarsening_compatible()</a>, <a class="el" href="mesh__communication_8C_source.html#l01634">libMesh::MeshCommunication::make_elems_parallel_consistent()</a>, <a class="el" href="mesh__refinement_8C_source.html#l00751">libMesh::MeshRefinement::make_flags_parallel_consistent()</a>, <a class="el" href="mesh__communication_8C_source.html#l01612">libMesh::MeshCommunication::make_node_bcids_parallel_consistent()</a>, <a class="el" href="mesh__communication_8C_source.html#l01591">libMesh::MeshCommunication::make_node_unique_ids_parallel_consistent()</a>, <a class="el" href="mesh__communication_8C_source.html#l01658">libMesh::MeshCommunication::make_p_levels_parallel_consistent()</a>, <a class="el" href="fem__system_8C_source.html#l01087">libMesh::FEMSystem::mesh_position_set()</a>, <a class="el" href="mesh__smoother__laplace_8C_source.html#l00046">libMesh::LaplaceMeshSmoother::smooth()</a> , 以及 <a class="el" href="mesh__refinement_8C_source.html#l01709">libMesh::MeshRefinement::uniformly_coarsen()</a>.</p>
<div class="fragment"><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;{</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <a class="code" href="namespacelibMesh_1_1Parallel.html#ac7d4f06bb34625465942e6b8d10f135e">sync_dofobject_data_by_id</a>(comm, range_begin, range_end, SyncEverything(), sync);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_1_1Parallel_html_ac7d4f06bb34625465942e6b8d10f135e"><div class="ttname"><a href="namespacelibMesh_1_1Parallel.html#ac7d4f06bb34625465942e6b8d10f135e">libMesh::Parallel::sync_dofobject_data_by_id</a></div><div class="ttdeci">void sync_dofobject_data_by_id(const Communicator &amp;comm, const Iterator &amp;range_begin, const Iterator &amp;range_end, SyncFunctor &amp;sync)</div><div class="ttdoc">Request data about a range of ghost dofobjects uniquely identified by their id. </div><div class="ttdef"><b>Definition:</b> <a href="parallel__ghost__sync_8h_source.html#l00357">parallel_ghost_sync.h:357</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab0ccf736a24de62226fbaf331153735c"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Iterator , typename DofObjectCheckFunctor , typename SyncFunctor &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::Parallel::sync_dofobject_data_by_id </td>
          <td>(</td>
          <td class="paramtype">const Communicator &amp;&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Iterator &amp;&#160;</td>
          <td class="paramname"><em>range_begin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Iterator &amp;&#160;</td>
          <td class="paramname"><em>range_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const DofObjectCheckFunctor &amp;&#160;</td>
          <td class="paramname"><em>dofobj_check</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SyncFunctor &amp;&#160;</td>
          <td class="paramname"><em>sync</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Request data about a range of ghost dofobjects uniquely identified by their id. </p>
<p>Elements within the range can be excluded from the request by returning false from dofobj_check(dof_object) </p>

<p>在文件 <a class="el" href="parallel__ghost__sync_8h_source.html">parallel_ghost_sync.h</a> 第 <a class="el" href="parallel__ghost__sync_8h_source.html#l00368">368</a> 行定义.</p>

<p>参考 <a class="el" href="dof__object_8h_source.html#l00823">libMesh::DofObject::id()</a>, <a class="el" href="dof__object_8h_source.html#l00488">libMesh::DofObject::invalid_processor_id</a>, <a class="el" href="namespacelibMesh.html#a4f791f2cb1525c37e7916d564c3b3b78">libMesh::libmesh_assert()</a> , 以及 <a class="el" href="dof__object_8h_source.html#l00898">libMesh::DofObject::processor_id()</a>.</p>
<div class="fragment"><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;{</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  libmesh_parallel_only(comm);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="comment">// Count the objects to ask each processor about</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  std::map&lt;processor_id_type, dof_id_type&gt;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    ghost_objects_from_proc;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="keywordflow">for</span> (Iterator it = range_begin; it != range_end; ++it)</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    {</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <span class="keyword">const</span> DofObject * obj = *it;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <a class="code" href="namespacelibMesh.html#a4f791f2cb1525c37e7916d564c3b3b78">libmesh_assert</a> (obj);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <span class="comment">// We may want to pass Elem* or Node* to the check function, not</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      <span class="comment">// just DofObject*</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <span class="keywordflow">if</span> (!dofobj_check(*it))</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> obj_procid = obj-&gt;processor_id();</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <span class="keywordflow">if</span> (obj_procid != DofObject::invalid_processor_id)</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        ghost_objects_from_proc[obj_procid]++;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="comment">// Request sets to send to each processor</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  std::map&lt;processor_id_type, std::vector&lt;dof_id_type&gt;&gt;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    requested_objs_id;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="comment">// We know how many objects live on each processor, so reserve()</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="comment">// space for each.</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> pair : ghost_objects_from_proc)</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> p = pair.first;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <span class="keywordflow">if</span> (p != comm.rank())</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        requested_objs_id[p].reserve(pair.second);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    }</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keywordflow">for</span> (Iterator it = range_begin; it != range_end; ++it)</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    {</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <span class="keyword">const</span> DofObject * obj = *it;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <span class="keywordflow">if</span> (!dofobj_check(*it))</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> obj_procid = obj-&gt;processor_id();</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      <span class="keywordflow">if</span> (obj_procid == comm.rank() ||</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;          obj_procid == DofObject::invalid_processor_id)</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      requested_objs_id[obj_procid].push_back(obj-&gt;id());</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    }</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="keyword">auto</span> gather_functor =</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    [&amp;sync]</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    (<a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a>, <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; ids,</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;     std::vector&lt;typename SyncFunctor::datum&gt; &amp; data)</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      sync.gather_data(ids, data);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    };</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="keyword">auto</span> action_functor =</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    [&amp;sync]</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    (<a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a>, <span class="keyword">const</span> std::vector&lt;dof_id_type&gt; &amp; ids,</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;     <span class="keyword">const</span> std::vector&lt;typename SyncFunctor::datum&gt; &amp; data)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      <span class="comment">// Let the user process the results</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      sync.act_on_data(ids, data);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    };</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="comment">// Trade requests with other processors</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="keyword">typename</span> SyncFunctor::datum * ex = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  pull_parallel_vector_data</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    (comm, requested_objs_id, gather_functor, action_functor, ex);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_af18245d4f872c36a41fc74086bda3e80"><div class="ttname"><a href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">libMesh::processor_id_type</a></div><div class="ttdeci">uint8_t processor_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00104">id_types.h:104</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a4f791f2cb1525c37e7916d564c3b3b78"><div class="ttname"><a href="namespacelibMesh.html#a4f791f2cb1525c37e7916d564c3b3b78">libMesh::libmesh_assert</a></div><div class="ttdeci">libmesh_assert(ctx)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab412d3606d51e5df080eab5795351901"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Iterator , typename DofObjType , typename SyncFunctor &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::Parallel::sync_dofobject_data_by_xyz </td>
          <td>(</td>
          <td class="paramtype">const Communicator &amp;&#160;</td>
          <td class="paramname"><em>comm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Iterator &amp;&#160;</td>
          <td class="paramname"><em>range_begin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Iterator &amp;&#160;</td>
          <td class="paramname"><em>range_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LocationMap&lt; DofObjType &gt; &amp;&#160;</td>
          <td class="paramname"><em>location_map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SyncFunctor &amp;&#160;</td>
          <td class="paramname"><em>sync</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Request data about a range of ghost nodes uniquely identified by their xyz location or a range of active ghost elements uniquely identified by their vertex averages' xyz location. </p>
<p>Fulfill requests with sync.gather_data(const std::vector&lt;unsigned int&gt; &amp; ids, std::vector&lt;sync::datum&gt; &amp; data), by resizing and setting the values of the data vector. Respond to fulfillment with sync.act_on_data(const std::vector&lt;unsigned int&gt; &amp; ids, std::vector&lt;sync::datum&gt; &amp; data) The user must define Parallel::StandardType&lt;sync::datum&gt; if sync::datum isn't a built-in type. The user-provided location_map should be already filled.</p>
<p>This method may fail in cases of overlapping nodes or vertex averages, e.g. with slit meshes and/or overset meshes. </p>

<p>在文件 <a class="el" href="parallel__ghost__sync_8h_source.html">parallel_ghost_sync.h</a> 第 <a class="el" href="parallel__ghost__sync_8h_source.html#l00240">240</a> 行定义.</p>

<p>参考 <a class="el" href="location__maps_8h_source.html#l00063">libMesh::LocationMap&lt; T &gt;::empty()</a>, <a class="el" href="location__maps_8C_source.html#l00112">libMesh::LocationMap&lt; T &gt;::find()</a>, <a class="el" href="dof__object_8h_source.html#l00488">libMesh::DofObject::invalid_processor_id</a>, <a class="el" href="namespacelibMesh.html#a4f791f2cb1525c37e7916d564c3b3b78">libMesh::libmesh_assert()</a> , 以及 <a class="el" href="classlibMesh_1_1LocationMap.html#a7bbf664429b19a3744a74836121bcc11">libMesh::LocationMap&lt; T &gt;::point_of()</a>.</p>
<div class="fragment"><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;{</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  libmesh_parallel_only(comm);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="comment">// We need a valid location_map</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="preprocessor"></span>  <span class="keywordtype">bool</span> need_map_update = (range_begin != range_end &amp;&amp; location_map.empty());</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  comm.max(need_map_update);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <a class="code" href="namespacelibMesh.html#a4f791f2cb1525c37e7916d564c3b3b78">libmesh_assert</a>(!need_map_update);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="comment">// Count the objects to ask each processor about</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  std::map&lt;processor_id_type, dof_id_type&gt;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    ghost_objects_from_proc;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keywordflow">for</span> (Iterator it = range_begin; it != range_end; ++it)</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      DofObjType * obj = *it;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <a class="code" href="namespacelibMesh.html#a4f791f2cb1525c37e7916d564c3b3b78">libmesh_assert</a> (obj);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> obj_procid = obj-&gt;processor_id();</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="keywordflow">if</span> (obj_procid != DofObject::invalid_processor_id)</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        ghost_objects_from_proc[obj_procid]++;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="comment">// Request sets to send to each processor</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  std::map&lt;processor_id_type, std::vector&lt;Point&gt;&gt;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    requested_objs_pt;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="comment">// Corresponding ids to keep track of</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  std::map&lt;processor_id_type, std::vector&lt;dof_id_type&gt;&gt;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    requested_objs_id;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="comment">// We know how many objects live on each processor, so reserve()</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="comment">// space for each.</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> pair : ghost_objects_from_proc)</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> p = pair.first;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="keywordflow">if</span> (p != comm.rank())</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;          requested_objs_pt[p].reserve(pair.second);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;          requested_objs_id[p].reserve(pair.second);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keywordflow">for</span> (Iterator it = range_begin; it != range_end; ++it)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      DofObjType * obj = *it;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> obj_procid = obj-&gt;processor_id();</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      <span class="keywordflow">if</span> (obj_procid == comm.rank() ||</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;          obj_procid == DofObject::invalid_processor_id)</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      Point p = location_map.point_of(*obj);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      requested_objs_pt[obj_procid].push_back(p);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      requested_objs_id[obj_procid].push_back(obj-&gt;id());</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  std::map&lt;const std::vector&lt;Point&gt; *, <a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a>&gt;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    requested_objs_pt_inv;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; pair : requested_objs_pt)</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    requested_objs_pt_inv[&amp;pair.second] = pair.first;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keyword">auto</span> gather_functor =</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    [&amp;location_map, &amp;sync]</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    (<a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> <span class="comment">/*pid*/</span>, <span class="keyword">const</span> std::vector&lt;Point&gt; &amp; pts,</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;     std::vector&lt;typename SyncFunctor::datum&gt; &amp; data)</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="comment">// Find the local id of each requested object</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      std::size_t query_size = pts.size();</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      std::vector&lt;dof_id_type&gt; query_id(query_size);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <span class="keywordflow">for</span> (std::size_t i=0; i != query_size; ++i)</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;          Point pt = pts[i];</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;          <span class="comment">// Look for this object in the multimap</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;          DofObjType * obj = location_map.find(pt);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;          <span class="comment">// We&#39;d better find every object we&#39;re asked for</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;          <a class="code" href="namespacelibMesh.html#a4f791f2cb1525c37e7916d564c3b3b78">libmesh_assert</a> (obj);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;          <span class="comment">// Return the object&#39;s correct processor id,</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;          <span class="comment">// and our (correct if it&#39;s local) id for it.</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;          query_id[i] = obj-&gt;id();</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <span class="comment">// Gather whatever data the user wants</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      sync.gather_data(query_id, data);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    };</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="keyword">auto</span> action_functor =</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    [&amp;sync, &amp;requested_objs_id,</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;     &amp;requested_objs_pt_inv]</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    (processor_id_type <span class="comment">/* pid */</span>, <span class="keyword">const</span> std::vector&lt;Point&gt; &amp; point_request,</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;     <span class="keyword">const</span> std::vector&lt;typename SyncFunctor::datum&gt; &amp; data)</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      <span class="comment">// With splits working on more pids than ranks, query_pid may not equal pid</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      <span class="keyword">const</span> processor_id_type query_pid =</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        requested_objs_pt_inv[&amp;point_request];</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <span class="comment">// Let the user process the results</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      sync.act_on_data(requested_objs_id[query_pid], data);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    };</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="comment">// Trade requests with other processors</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="keyword">typename</span> SyncFunctor::datum * ex = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  pull_parallel_vector_data</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    (comm, requested_objs_pt, gather_functor, action_functor, ex);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_af18245d4f872c36a41fc74086bda3e80"><div class="ttname"><a href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">libMesh::processor_id_type</a></div><div class="ttdeci">uint8_t processor_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00104">id_types.h:104</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a4f791f2cb1525c37e7916d564c3b3b78"><div class="ttname"><a href="namespacelibMesh.html#a4f791f2cb1525c37e7916d564c3b3b78">libMesh::libmesh_assert</a></div><div class="ttdeci">libmesh_assert(ctx)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a29c79f0c66ce48d4b3801a77b139df3b"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Iterator , typename SyncFunctor &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::Parallel::sync_element_data_by_parent_id </td>
          <td>(</td>
          <td class="paramtype">MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Iterator &amp;&#160;</td>
          <td class="paramname"><em>range_begin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Iterator &amp;&#160;</td>
          <td class="paramname"><em>range_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SyncFunctor &amp;&#160;</td>
          <td class="paramname"><em>sync</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Request data about a range of ghost elements uniquely identified by their parent id and which child they are. </p>
<p>Fulfill requests with sync.gather_data(const std::vector&lt;unsigned int&gt; &amp; ids, std::vector&lt;sync::datum&gt; &amp; data), by resizing and setting the values of the data vector. Respond to fulfillment with sync.act_on_data(const std::vector&lt;unsigned int&gt; &amp; ids, std::vector&lt;sync::datum&gt; &amp; data) The user must define Parallel::StandardType&lt;sync::datum&gt; if sync::datum isn't a built-in type. </p>

<p>在文件 <a class="el" href="parallel__ghost__sync_8h_source.html">parallel_ghost_sync.h</a> 第 <a class="el" href="parallel__ghost__sync_8h_source.html#l00453">453</a> 行定义.</p>

<p>参考 <a class="el" href="elem_8h_source.html#l02754">libMesh::Elem::active()</a>, <a class="el" href="elem_8h_source.html#l02976">libMesh::Elem::child_ptr()</a>, <a class="el" href="parallel__object_8h_source.html#l00097">libMesh::ParallelObject::comm()</a>, <a class="el" href="mesh__base_8h_source.html#l00614">libMesh::MeshBase::elem_ref()</a>, <a class="el" href="elem_8h_source.html#l02792">libMesh::Elem::has_children()</a>, <a class="el" href="dof__object_8h_source.html#l00823">libMesh::DofObject::id()</a>, <a class="el" href="dof__object_8h_source.html#l00488">libMesh::DofObject::invalid_processor_id</a>, <a class="el" href="namespacelibMesh.html#a4f791f2cb1525c37e7916d564c3b3b78">libMesh::libmesh_assert()</a>, <a class="el" href="mesh__communication_8C_source.html#l01308">mesh</a>, <a class="el" href="elem_8h_source.html#l02843">libMesh::Elem::parent()</a>, <a class="el" href="dof__object_8h_source.html#l00898">libMesh::DofObject::processor_id()</a> , 以及 <a class="el" href="elem_8h_source.html#l03005">libMesh::Elem::which_child_am_i()</a>.</p>

<p>参考自 <a class="el" href="mesh__communication_8C_source.html#l01634">libMesh::MeshCommunication::make_elems_parallel_consistent()</a>.</p>
<div class="fragment"><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;{</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="keyword">const</span> Communicator &amp; comm (<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.comm());</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  libmesh_parallel_only(comm);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="comment">// Count the objects to ask each processor about</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  std::map&lt;processor_id_type, dof_id_type&gt;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    ghost_objects_from_proc;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keywordflow">for</span> (Iterator it = range_begin; it != range_end; ++it)</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      Elem * elem = *it;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> obj_procid = elem-&gt;processor_id();</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <span class="keywordflow">if</span> (obj_procid == comm.rank() ||</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;          obj_procid == DofObject::invalid_processor_id)</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      <span class="keyword">const</span> Elem * parent = elem-&gt;parent();</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <span class="keywordflow">if</span> (!parent || !elem-&gt;active())</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      ghost_objects_from_proc[obj_procid]++;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="comment">// Request sets to send to each processor</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  std::map&lt;processor_id_type, std::vector&lt;dof_id_type&gt;&gt;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    requested_objs_id;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  std::map&lt;processor_id_type, std::vector&lt;std::pair&lt;dof_id_type,unsigned char&gt;&gt;&gt;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    requested_objs_parent_id_child_num;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="comment">// We know how many objects live on each processor, so reserve()</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="comment">// space for each.</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> pair : ghost_objects_from_proc)</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> p = pair.first;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      <span class="keywordflow">if</span> (p != comm.rank())</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;          requested_objs_id[p].reserve(pair.second);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;          requested_objs_parent_id_child_num[p].reserve(pair.second);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        }</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    }</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="keywordflow">for</span> (Iterator it = range_begin; it != range_end; ++it)</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      Elem * elem = *it;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> obj_procid = elem-&gt;processor_id();</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <span class="keywordflow">if</span> (obj_procid == comm.rank() ||</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;          obj_procid == DofObject::invalid_processor_id)</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <span class="keyword">const</span> Elem * parent = elem-&gt;parent();</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <span class="keywordflow">if</span> (!parent || !elem-&gt;active())</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      requested_objs_id[obj_procid].push_back(elem-&gt;id());</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      requested_objs_parent_id_child_num[obj_procid].emplace_back</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        (parent-&gt;id(), cast_int&lt;unsigned char&gt;(parent-&gt;which_child_am_i(elem)));</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  std::map&lt;const std::vector&lt;std::pair&lt;dof_id_type,unsigned char&gt;&gt; *, <a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a>&gt;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    requested_objs_parent_id_child_num_inv;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; pair : requested_objs_parent_id_child_num)</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    requested_objs_parent_id_child_num_inv[&amp;pair.second] = pair.first;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="keyword">auto</span> gather_functor =</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    [&amp;<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>, &amp;sync]</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    (<a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a>,</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;     <span class="keyword">const</span> std::vector&lt;std::pair&lt;dof_id_type, unsigned char&gt;&gt; &amp; parent_id_child_num,</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;     std::vector&lt;typename SyncFunctor::datum&gt; &amp; data)</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      <span class="comment">// Find the id of each requested element</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      std::size_t query_size = parent_id_child_num.size();</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      std::vector&lt;dof_id_type&gt; query_id(query_size);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      <span class="keywordflow">for</span> (std::size_t i=0; i != query_size; ++i)</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;          Elem &amp; parent = <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.elem_ref(parent_id_child_num[i].first);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;          <a class="code" href="namespacelibMesh.html#a4f791f2cb1525c37e7916d564c3b3b78">libmesh_assert</a>(parent.has_children());</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;          Elem * child = parent.child_ptr(parent_id_child_num[i].second);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;          <a class="code" href="namespacelibMesh.html#a4f791f2cb1525c37e7916d564c3b3b78">libmesh_assert</a>(child);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;          <a class="code" href="namespacelibMesh.html#a4f791f2cb1525c37e7916d564c3b3b78">libmesh_assert</a>(child-&gt;active());</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;          query_id[i] = child-&gt;id();</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        }</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      <span class="comment">// Gather whatever data the user wants</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      sync.gather_data(query_id, data);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    };</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <span class="keyword">auto</span> action_functor =</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    [&amp;sync, &amp;requested_objs_id,</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;     &amp;requested_objs_parent_id_child_num_inv]</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    (processor_id_type <span class="comment">/* pid */</span>,</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;     <span class="keyword">const</span> std::vector&lt;std::pair&lt;dof_id_type, unsigned char&gt;&gt; &amp; parent_id_child_num_request,</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;     <span class="keyword">const</span> std::vector&lt;typename SyncFunctor::datum&gt; &amp; data)</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    {</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      <span class="comment">// With splits working on more pids than ranks, query_pid may not equal pid</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <span class="keyword">const</span> processor_id_type query_pid =</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        requested_objs_parent_id_child_num_inv[&amp;parent_id_child_num_request];</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      <span class="comment">// Let the user process the results</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      sync.act_on_data(requested_objs_id[query_pid], data);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    };</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="comment">// Trade requests with other processors</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <span class="keyword">typename</span> SyncFunctor::datum * ex = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  pull_parallel_vector_data</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    (comm, requested_objs_parent_id_child_num, gather_functor,</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;     action_functor, ex);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;}</div>
<div class="ttc" id="mesh__communication_8C_html_afaa03b874c297f4693d9cdef7f50f3c6"><div class="ttname"><a href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a></div><div class="ttdeci">MeshBase &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01308">mesh_communication.C:1308</a></div></div>
<div class="ttc" id="namespacelibMesh_html_af18245d4f872c36a41fc74086bda3e80"><div class="ttname"><a href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">libMesh::processor_id_type</a></div><div class="ttdeci">uint8_t processor_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00104">id_types.h:104</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a4f791f2cb1525c37e7916d564c3b3b78"><div class="ttname"><a href="namespacelibMesh.html#a4f791f2cb1525c37e7916d564c3b3b78">libMesh::libmesh_assert</a></div><div class="ttdeci">libmesh_assert(ctx)</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a78a93cd4ce160f40c758f96e2cadbe25"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename ElemCheckFunctor , typename NodeCheckFunctor , typename SyncFunctor &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::Parallel::sync_node_data_by_element_id </td>
          <td>(</td>
          <td class="paramtype">MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const MeshBase::const_element_iterator &amp;&#160;</td>
          <td class="paramname"><em>range_begin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const MeshBase::const_element_iterator &amp;&#160;</td>
          <td class="paramname"><em>range_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ElemCheckFunctor &amp;&#160;</td>
          <td class="paramname"><em>elem_check</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const NodeCheckFunctor &amp;&#160;</td>
          <td class="paramname"><em>node_check</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SyncFunctor &amp;&#160;</td>
          <td class="paramname"><em>sync</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Synchronize data about a range of ghost nodes uniquely identified by an element id and local node id, iterating until data is completely in sync and further synchronization passes cause no changes. </p>
<p>Imagine a vertex surrounded by triangles, each on a different processor, with a ghosting policy that include only face neighbors and not point neighbors. Then the only way for authoritative information to trickle out from that vertex is by being passed along, one neighbor at a time, to processors who mostly don't even see the node's true owner!</p>
<p>Data for all nodes connected to elements in the given range of <em>element</em> iterators will be requested.</p>
<p>Elements can be further excluded from the request by returning false from element_check(elem)</p>
<p>Nodes can be further excluded from the request by returning false from node_check(elem, local_node_num)</p>
<p>Fulfill requests with sync.gather_data(const std::vector&lt;unsigned int&gt; &amp; ids, std::vector&lt;sync::datum&gt; &amp; data), by resizing and setting the values of the data vector. Respond to fulfillment with bool sync.act_on_data(const std::vector&lt;unsigned int&gt; &amp; ids, std::vector&lt;sync::datum&gt; &amp; data) and return true iff the response changed any data.</p>
<p>The user must define Parallel::StandardType&lt;sync::datum&gt; if sync::datum isn't a built-in type. </p>

<p>在文件 <a class="el" href="parallel__ghost__sync_8h_source.html">parallel_ghost_sync.h</a> 第 <a class="el" href="parallel__ghost__sync_8h_source.html#l00780">780</a> 行定义.</p>

<p>参考 <a class="el" href="parallel__object_8h_source.html#l00097">libMesh::ParallelObject::comm()</a> , 以及 <a class="el" href="parallel__ghost__sync_8h_source.html#l00580">sync_node_data_by_element_id_once()</a>.</p>

<p>参考自 <a class="el" href="mesh__communication_8C_source.html#l01814">libMesh::MeshCommunication::make_new_node_proc_ids_parallel_consistent()</a>, <a class="el" href="mesh__communication_8C_source.html#l01562">libMesh::MeshCommunication::make_node_ids_parallel_consistent()</a>, <a class="el" href="mesh__communication_8C_source.html#l01785">libMesh::MeshCommunication::make_node_proc_ids_parallel_consistent()</a> , 以及 <a class="el" href="partitioner_8C_source.html#l00851">libMesh::Partitioner::set_node_processor_ids()</a>.</p>
<div class="fragment"><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;{</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  libmesh_parallel_only(<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.comm());</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <span class="keywordtype">bool</span> need_sync = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="keywordflow">do</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      need_sync =</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <a class="code" href="namespacelibMesh_1_1Parallel.html#a690437fd4e60ad2cedf64948c3f21519">sync_node_data_by_element_id_once</a></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;          (<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>, range_begin, range_end, elem_check, node_check,</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;           sync);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    } <span class="keywordflow">while</span> (need_sync);</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;}</div>
<div class="ttc" id="mesh__communication_8C_html_afaa03b874c297f4693d9cdef7f50f3c6"><div class="ttname"><a href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a></div><div class="ttdeci">MeshBase &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01308">mesh_communication.C:1308</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1Parallel_html_a690437fd4e60ad2cedf64948c3f21519"><div class="ttname"><a href="namespacelibMesh_1_1Parallel.html#a690437fd4e60ad2cedf64948c3f21519">libMesh::Parallel::sync_node_data_by_element_id_once</a></div><div class="ttdeci">bool sync_node_data_by_element_id_once(MeshBase &amp;mesh, const MeshBase::const_element_iterator &amp;range_begin, const MeshBase::const_element_iterator &amp;range_end, const ElemCheckFunctor &amp;elem_check, const NodeCheckFunctor &amp;node_check, SyncFunctor &amp;sync)</div><div class="ttdoc">Synchronize data about a range of ghost nodes uniquely identified by an element id and local node id...</div><div class="ttdef"><b>Definition:</b> <a href="parallel__ghost__sync_8h_source.html#l00580">parallel_ghost_sync.h:580</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a690437fd4e60ad2cedf64948c3f21519"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename ElemCheckFunctor , typename NodeCheckFunctor , typename SyncFunctor &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::Parallel::sync_node_data_by_element_id_once </td>
          <td>(</td>
          <td class="paramtype">MeshBase &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const MeshBase::const_element_iterator &amp;&#160;</td>
          <td class="paramname"><em>range_begin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const MeshBase::const_element_iterator &amp;&#160;</td>
          <td class="paramname"><em>range_end</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ElemCheckFunctor &amp;&#160;</td>
          <td class="paramname"><em>elem_check</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const NodeCheckFunctor &amp;&#160;</td>
          <td class="paramname"><em>node_check</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SyncFunctor &amp;&#160;</td>
          <td class="paramname"><em>sync</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Synchronize data about a range of ghost nodes uniquely identified by an element id and local node id, assuming a single synchronization pass is necessary. </p>
<p>Data for all nodes connected to elements in the given range of <em>element</em> iterators will be requested.</p>
<p>Elements can be further excluded from the request by returning false from element_check(elem)</p>
<p>Nodes can be further excluded from the request by returning false from node_check(elem, local_node_num)</p>
<p>Fulfill requests with sync.gather_data(const std::vector&lt;unsigned int&gt; &amp; ids, std::vector&lt;sync::datum&gt; &amp; data), by resizing and setting the values of the data vector. Respond to fulfillment with bool sync.act_on_data(const std::vector&lt;unsigned int&gt; &amp; ids, std::vector&lt;sync::datum&gt; &amp; data) and return true iff the response changed any data.</p>
<p>The user must define Parallel::StandardType&lt;sync::datum&gt; if sync::datum isn't a built-in type.</p>
<p>This method returns true iff the sync pass changed any data on any processor. </p>

<p>在文件 <a class="el" href="parallel__ghost__sync_8h_source.html">parallel_ghost_sync.h</a> 第 <a class="el" href="parallel__ghost__sync_8h_source.html#l00580">580</a> 行定义.</p>

<p>参考 <a class="el" href="simple__range_8h_source.html#l00057">libMesh::as_range()</a>, <a class="el" href="parallel__object_8h_source.html#l00097">libMesh::ParallelObject::comm()</a>, <a class="el" href="dof__object_8h_source.html#l00823">libMesh::DofObject::id()</a>, <a class="el" href="dof__object_8h_source.html#l00477">libMesh::DofObject::invalid_id</a>, <a class="el" href="dof__object_8h_source.html#l00488">libMesh::DofObject::invalid_processor_id</a>, <a class="el" href="namespacelibMesh.html#a4f791f2cb1525c37e7916d564c3b3b78">libMesh::libmesh_assert()</a>, <a class="el" href="mesh__communication_8C_source.html#l01308">mesh</a>, <a class="el" href="classlibMesh_1_1Elem.html#a3a1e00b1906b0f6cf0cc1760c9a7da1f">libMesh::Elem::n_nodes()</a>, <a class="el" href="elem_8h_source.html#l02329">libMesh::Elem::node_ref()</a>, <a class="el" href="dof__object_8h_source.html#l00898">libMesh::DofObject::processor_id()</a> , 以及 <a class="el" href="classlibMesh_1_1MeshBase.html#a61954736112b225cf323b93f57cd70ed">libMesh::MeshBase::query_elem_ptr()</a>.</p>

<p>参考自 <a class="el" href="mesh__communication_8C_source.html#l01814">libMesh::MeshCommunication::make_new_node_proc_ids_parallel_consistent()</a> , 以及 <a class="el" href="parallel__ghost__sync_8h_source.html#l00780">sync_node_data_by_element_id()</a>.</p>
<div class="fragment"><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;{</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="keyword">const</span> Communicator &amp; comm (<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.comm());</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  <span class="comment">// Count the objects to ask each processor about</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  std::map&lt;processor_id_type, dof_id_type&gt;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    ghost_objects_from_proc;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; elem : <a class="code" href="namespacelibMesh.html#a6775c045a6c8e84299b5467df9fc81ae">as_range</a>(range_begin, range_end))</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    {</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      <a class="code" href="namespacelibMesh.html#a4f791f2cb1525c37e7916d564c3b3b78">libmesh_assert</a> (elem);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <span class="keywordflow">if</span> (!elem_check(elem))</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> proc_id = elem-&gt;processor_id();</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      <span class="keywordtype">bool</span> i_have_elem =</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        (proc_id == comm.rank() ||</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;         proc_id == DofObject::invalid_processor_id);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      <span class="keywordflow">if</span> (elem-&gt;active() &amp;&amp; i_have_elem)</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> n : elem-&gt;node_index_range())</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;          <span class="keywordflow">if</span> (!node_check(elem, n))</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> node_pid =</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            elem-&gt;node_ref(n).processor_id();</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;          <span class="keywordflow">if</span> (i_have_elem &amp;&amp; (node_pid == comm.rank()))</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;          <span class="keywordflow">if</span> (i_have_elem)</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;              libmesh_assert_not_equal_to</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                (node_pid, DofObject::invalid_processor_id);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;              ghost_objects_from_proc[node_pid]++;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> request_pid =</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                (node_pid == DofObject::invalid_processor_id) ?</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                 proc_id : node_pid;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;              ghost_objects_from_proc[request_pid]++;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            }</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        }</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    }</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <span class="comment">// Now repeat that iteration, filling request sets this time.</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  <span class="comment">// Request sets to send to each processor</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  std::map&lt;processor_id_type, std::vector&lt;std::pair&lt;dof_id_type, unsigned char&gt;&gt;&gt;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    requested_objs_elem_id_node_num;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="comment">// We know how many objects live on each processor, so reserve()</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="comment">// space for each.</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> pair : ghost_objects_from_proc)</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    {</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> p = pair.first;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      <span class="keywordflow">if</span> (p != comm.rank())</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        requested_objs_elem_id_node_num[p].reserve(ghost_objects_from_proc[p]);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    }</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; elem : <a class="code" href="namespacelibMesh.html#a6775c045a6c8e84299b5467df9fc81ae">as_range</a>(range_begin, range_end))</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      <a class="code" href="namespacelibMesh.html#a4f791f2cb1525c37e7916d564c3b3b78">libmesh_assert</a> (elem);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      <span class="keywordflow">if</span> (!elem_check(elem))</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> proc_id = elem-&gt;processor_id();</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      <span class="keywordtype">bool</span> i_have_elem =</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        (proc_id == comm.rank() ||</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;         proc_id == DofObject::invalid_processor_id);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      <span class="keywordflow">if</span> (elem-&gt;active() &amp;&amp; i_have_elem)</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> elem_id = elem-&gt;id();</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> n : elem-&gt;node_index_range())</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        {</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;          <span class="keywordflow">if</span> (!node_check(elem, n))</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;          <span class="keyword">const</span> Node &amp; node = elem-&gt;node_ref(n);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> node_pid = node.processor_id();</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;          <span class="keywordflow">if</span> (i_have_elem &amp;&amp; (node_pid == comm.rank()))</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;          <span class="keywordflow">if</span> (i_have_elem)</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;              libmesh_assert_not_equal_to</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                (node_pid, DofObject::invalid_processor_id);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;              requested_objs_elem_id_node_num[node_pid].emplace_back</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                (elem_id, cast_int&lt;unsigned char&gt;(n));</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            }</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            {</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a> request_pid =</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                (node_pid == DofObject::invalid_processor_id) ?</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                 proc_id : node_pid;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;              requested_objs_elem_id_node_num[request_pid].emplace_back</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                (elem_id,cast_int&lt;unsigned char&gt;(n));</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            }</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        }</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    }</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <span class="keyword">auto</span> gather_functor =</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    [&amp;<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>, &amp;sync]</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    (<a class="code" href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">processor_id_type</a>,</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;     <span class="keyword">const</span> std::vector&lt;std::pair&lt;dof_id_type, unsigned char&gt;&gt; &amp; elem_id_node_num,</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;     std::vector&lt;typename SyncFunctor::datum&gt; &amp; data)</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    {</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      <span class="comment">// Find the id of each requested element</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      std::size_t request_size = elem_id_node_num.size();</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      std::vector&lt;dof_id_type&gt; query_id(request_size);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;      <span class="keywordflow">for</span> (std::size_t i=0; i != request_size; ++i)</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        {</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;          <span class="comment">// We might now get queries about remote elements, in which</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;          <span class="comment">// case we&#39;ll have to ignore them and wait for the query</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;          <span class="comment">// answer to filter to the querier via another source.</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;          <span class="keyword">const</span> Elem * elem = <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>.query_elem_ptr(elem_id_node_num[i].first);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;          <span class="keywordflow">if</span> (elem)</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = elem_id_node_num[i].second;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;              libmesh_assert_less (n, elem-&gt;n_nodes());</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;              <span class="keyword">const</span> Node &amp; node = elem-&gt;node_ref(n);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;              <span class="comment">// This isn&#39;t a safe assertion in the case where we&#39;re</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;              <span class="comment">// syncing processor ids</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;              <span class="comment">// libmesh_assert_equal_to (node-&gt;processor_id(), comm.rank());</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;              query_id[i] = node.id();</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            }</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            query_id[i] = DofObject::invalid_id;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        }</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      <span class="comment">// Gather whatever data the user wants</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      sync.gather_data(query_id, data);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    };</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <span class="keywordtype">bool</span> data_changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="keyword">auto</span> action_functor =</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    [&amp;sync, &amp;<a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a>, &amp;data_changed]</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    (processor_id_type <span class="comment">/* pid */</span>,</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;     <span class="keyword">const</span> std::vector&lt;std::pair&lt;dof_id_type, unsigned char&gt;&gt; &amp; elem_id_node_num,</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;     <span class="keyword">const</span> std::vector&lt;typename SyncFunctor::datum&gt; &amp; data)</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    {</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      <span class="keyword">const</span> std::size_t data_size = data.size();</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      libmesh_assert_equal_to(elem_id_node_num.size(), data_size);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      std::vector&lt;dof_id_type&gt; requested_objs_id(data.size());</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : IntRange&lt;std::size_t&gt;(0,data_size))</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        {</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;          <span class="keyword">const</span> Elem &amp; elem = mesh.elem_ref(elem_id_node_num[i].first);</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;          <span class="keyword">const</span> Node &amp; node = elem.node_ref(elem_id_node_num[i].second);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;          requested_objs_id[i] = node.id();</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        }</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      <span class="comment">// Let the user process the results.  If any of the results</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      <span class="comment">// were different than what the user expected, then we may</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      <span class="comment">// need to sync again just in case this processor has to</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      <span class="comment">// pass on the changes to yet another processor.</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      <span class="keywordflow">if</span> (sync.act_on_data(requested_objs_id, data))</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        data_changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    };</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="comment">// Trade requests with other processors</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <span class="keyword">typename</span> SyncFunctor::datum * ex = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  pull_parallel_vector_data</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    (comm, requested_objs_elem_id_node_num, gather_functor,</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;     action_functor, ex);</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  comm.max(data_changed);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <span class="keywordflow">return</span> data_changed;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;}</div>
<div class="ttc" id="mesh__communication_8C_html_afaa03b874c297f4693d9cdef7f50f3c6"><div class="ttname"><a href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a></div><div class="ttdeci">MeshBase &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01308">mesh_communication.C:1308</a></div></div>
<div class="ttc" id="namespacelibMesh_html_af18245d4f872c36a41fc74086bda3e80"><div class="ttname"><a href="namespacelibMesh.html#af18245d4f872c36a41fc74086bda3e80">libMesh::processor_id_type</a></div><div class="ttdeci">uint8_t processor_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00104">id_types.h:104</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a6775c045a6c8e84299b5467df9fc81ae"><div class="ttname"><a href="namespacelibMesh.html#a6775c045a6c8e84299b5467df9fc81ae">libMesh::as_range</a></div><div class="ttdeci">SimpleRange&lt; IndexType &gt; as_range(const std::pair&lt; IndexType, IndexType &gt; &amp;p)</div><div class="ttdoc">Helper function that allows us to treat a homogenous pair as a range. </div><div class="ttdef"><b>Definition:</b> <a href="simple__range_8h_source.html#l00057">simple_range.h:57</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a4f791f2cb1525c37e7916d564c3b3b78"><div class="ttname"><a href="namespacelibMesh.html#a4f791f2cb1525c37e7916d564c3b3b78">libMesh::libmesh_assert</a></div><div class="ttdeci">libmesh_assert(ctx)</div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
生成于 2023年 十二月 20日 星期三 12:09:47 , 为 libmesh解析使用  &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
