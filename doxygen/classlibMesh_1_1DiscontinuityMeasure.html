<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>libmesh解析: libMesh::DiscontinuityMeasure类 参考</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">libmesh解析
   </div>
   <div id="projectbrief">本工作只是尝试解析原libmesh的代码,供学习使用</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'搜索');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>首页</span></a></li>
      <li class="current"><a href="annotated.html"><span>类</span></a></li>
      <li><a href="files.html"><span>文件</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="搜索" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>类列表</span></a></li>
      <li><a href="classes.html"><span>类索引</span></a></li>
      <li><a href="inherits.html"><span>类继承关系</span></a></li>
      <li><a href="functions.html"><span>类成员</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>全部</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>类</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>命名空间</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>文件</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>函数</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>变量</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>类型定义</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>枚举</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>枚举值</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>友元</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>页</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacelibMesh.html">libMesh</a></li><li class="navelem"><a class="el" href="classlibMesh_1_1DiscontinuityMeasure.html">DiscontinuityMeasure</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public 类型</a> &#124;
<a href="#pub-methods">Public 成员函数</a> &#124;
<a href="#pub-attribs">Public 属性</a> &#124;
<a href="#pro-methods">Protected 成员函数</a> &#124;
<a href="#pro-attribs">Protected 属性</a> &#124;
<a href="classlibMesh_1_1DiscontinuityMeasure-members.html">所有成员列表</a>  </div>
  <div class="headertitle">
<div class="title">libMesh::DiscontinuityMeasure类 参考</div>  </div>
</div><!--header-->
<div class="contents">

<p>This class measures discontinuities between elements for debugging purposes.  
 <a href="classlibMesh_1_1DiscontinuityMeasure.html#details">更多...</a></p>

<p><code>#include &lt;<a class="el" href="discontinuity__measure_8h_source.html">discontinuity_measure.h</a>&gt;</code></p>
<div class="dynheader">
类 libMesh::DiscontinuityMeasure 继承关系图:</div>
<div class="dyncontent">
<div class="center"><!-- SVG 0 -->
</div>
<center><span class="legend">[<a href="graph_legend.html">图例</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public 类型</h2></td></tr>
<tr class="memitem:ab37d862060bbddf77099b6e34c62ef71"><td class="memItemLeft" align="right" valign="top">typedef std::map&lt; std::pair<br class="typebreak"/>
&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, unsigned int &gt;<br class="typebreak"/>
, std::unique_ptr&lt; <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ErrorEstimator.html#ab37d862060bbddf77099b6e34c62ef71">ErrorMap</a></td></tr>
<tr class="memdesc:ab37d862060bbddf77099b6e34c62ef71"><td class="mdescLeft">&#160;</td><td class="mdescRight">When calculating many error vectors at once, we need a data structure to hold them all.  <a href="#ab37d862060bbddf77099b6e34c62ef71">更多...</a><br/></td></tr>
<tr class="separator:ab37d862060bbddf77099b6e34c62ef71"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public 成员函数</h2></td></tr>
<tr class="memitem:afce341055712ce5587b524e77a4d1265"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DiscontinuityMeasure.html#afce341055712ce5587b524e77a4d1265">DiscontinuityMeasure</a> ()</td></tr>
<tr class="memdesc:afce341055712ce5587b524e77a4d1265"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#afce341055712ce5587b524e77a4d1265">更多...</a><br/></td></tr>
<tr class="separator:afce341055712ce5587b524e77a4d1265"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ae9c55a7431c79e4a9ecfc39a054c84"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DiscontinuityMeasure.html#a6ae9c55a7431c79e4a9ecfc39a054c84">DiscontinuityMeasure</a> (const <a class="el" href="classlibMesh_1_1DiscontinuityMeasure.html">DiscontinuityMeasure</a> &amp;)=delete</td></tr>
<tr class="memdesc:a6ae9c55a7431c79e4a9ecfc39a054c84"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class cannot be (default) copy constructed/assigned because its base class has unique_ptr members.  <a href="#a6ae9c55a7431c79e4a9ecfc39a054c84">更多...</a><br/></td></tr>
<tr class="separator:a6ae9c55a7431c79e4a9ecfc39a054c84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a74542c2df6f0f7242ef024f7211d63"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1DiscontinuityMeasure.html">DiscontinuityMeasure</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DiscontinuityMeasure.html#a2a74542c2df6f0f7242ef024f7211d63">operator=</a> (const <a class="el" href="classlibMesh_1_1DiscontinuityMeasure.html">DiscontinuityMeasure</a> &amp;)=delete</td></tr>
<tr class="separator:a2a74542c2df6f0f7242ef024f7211d63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1e28e6aa73241697ce9b10915694b0e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DiscontinuityMeasure.html#ae1e28e6aa73241697ce9b10915694b0e">DiscontinuityMeasure</a> (<a class="el" href="classlibMesh_1_1DiscontinuityMeasure.html">DiscontinuityMeasure</a> &amp;&amp;)=default</td></tr>
<tr class="memdesc:ae1e28e6aa73241697ce9b10915694b0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defaulted move ctor, move assignment operator, and destructor.  <a href="#ae1e28e6aa73241697ce9b10915694b0e">更多...</a><br/></td></tr>
<tr class="separator:ae1e28e6aa73241697ce9b10915694b0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0ee49bdcf8717cea14f64b1938af557"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1DiscontinuityMeasure.html">DiscontinuityMeasure</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DiscontinuityMeasure.html#ab0ee49bdcf8717cea14f64b1938af557">operator=</a> (<a class="el" href="classlibMesh_1_1DiscontinuityMeasure.html">DiscontinuityMeasure</a> &amp;&amp;)=default</td></tr>
<tr class="separator:ab0ee49bdcf8717cea14f64b1938af557"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99e01a499979cd70af5172accc0b869a"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DiscontinuityMeasure.html#a99e01a499979cd70af5172accc0b869a">~DiscontinuityMeasure</a> ()=default</td></tr>
<tr class="separator:a99e01a499979cd70af5172accc0b869a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3aafdec861b5dde7ef332895de4b7440"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DiscontinuityMeasure.html#a3aafdec861b5dde7ef332895de4b7440">attach_essential_bc_function</a> (std::pair&lt; bool, <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &gt; fptr(const <a class="el" href="classlibMesh_1_1System.html">System</a> &amp;system, const <a class="el" href="classlibMesh_1_1Point.html">Point</a> &amp;p, const std::string &amp;var_name))</td></tr>
<tr class="memdesc:a3aafdec861b5dde7ef332895de4b7440"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register a user function to use in computing the essential BCs.  <a href="#a3aafdec861b5dde7ef332895de4b7440">更多...</a><br/></td></tr>
<tr class="separator:a3aafdec861b5dde7ef332895de4b7440"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e3d1fed40dc4dfdb1bcd873f8f69674"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacelibMesh.html#a370493a82a7f09613a0fdc56fc7912b7">ErrorEstimatorType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DiscontinuityMeasure.html#a3e3d1fed40dc4dfdb1bcd873f8f69674">type</a> () const override</td></tr>
<tr class="separator:a3e3d1fed40dc4dfdb1bcd873f8f69674"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8f1c906c185d73857e7a86bd47fad70"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1JumpErrorEstimator.html#ae8f1c906c185d73857e7a86bd47fad70">estimate_error</a> (const <a class="el" href="classlibMesh_1_1System.html">System</a> &amp;system, <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;error_per_cell, const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *solution_vector=nullptr, bool estimate_parent_error=false) override</td></tr>
<tr class="memdesc:ae8f1c906c185d73857e7a86bd47fad70"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function uses the derived class's jump error estimate formula to estimate the error on each cell.  <a href="#ae8f1c906c185d73857e7a86bd47fad70">更多...</a><br/></td></tr>
<tr class="separator:ae8f1c906c185d73857e7a86bd47fad70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad575aa2606bb47551e562a290499df0"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ErrorEstimator.html#aad575aa2606bb47551e562a290499df0">estimate_errors</a> (const <a class="el" href="classlibMesh_1_1EquationSystems.html">EquationSystems</a> &amp;equation_systems, <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;error_per_cell, const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, <a class="el" href="classlibMesh_1_1SystemNorm.html">SystemNorm</a> &gt; &amp;error_norms, const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; * &gt; *solution_vectors=nullptr, bool estimate_parent_error=false)</td></tr>
<tr class="memdesc:aad575aa2606bb47551e562a290499df0"><td class="mdescLeft">&#160;</td><td class="mdescRight">This virtual function can be redefined in derived classes, but by default computes the sum of the error_per_cell for each system in the equation_systems.  <a href="#aad575aa2606bb47551e562a290499df0">更多...</a><br/></td></tr>
<tr class="separator:aad575aa2606bb47551e562a290499df0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bf8e0fb666d439804046465cf443867"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ErrorEstimator.html#a6bf8e0fb666d439804046465cf443867">estimate_errors</a> (const <a class="el" href="classlibMesh_1_1EquationSystems.html">EquationSystems</a> &amp;equation_systems, <a class="el" href="classlibMesh_1_1ErrorEstimator.html#ab37d862060bbddf77099b6e34c62ef71">ErrorMap</a> &amp;errors_per_cell, const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; * &gt; *solution_vectors=nullptr, bool estimate_parent_error=false)</td></tr>
<tr class="memdesc:a6bf8e0fb666d439804046465cf443867"><td class="mdescLeft">&#160;</td><td class="mdescRight">This virtual function can be redefined in derived classes, but by default it calls estimate_error repeatedly to calculate the requested error vectors.  <a href="#a6bf8e0fb666d439804046465cf443867">更多...</a><br/></td></tr>
<tr class="separator:a6bf8e0fb666d439804046465cf443867"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public 属性</h2></td></tr>
<tr class="memitem:a4edf0ef12588e39bb85d8dea4e7d560d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1JumpErrorEstimator.html#a4edf0ef12588e39bb85d8dea4e7d560d">scale_by_n_flux_faces</a></td></tr>
<tr class="memdesc:a4edf0ef12588e39bb85d8dea4e7d560d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This boolean flag allows you to scale the error indicator result for each element by the number of "flux faces" the element actually has.  <a href="#a4edf0ef12588e39bb85d8dea4e7d560d">更多...</a><br/></td></tr>
<tr class="separator:a4edf0ef12588e39bb85d8dea4e7d560d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a203fe804a4341ea7633f0dad9cc128d1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1JumpErrorEstimator.html#a203fe804a4341ea7633f0dad9cc128d1">use_unweighted_quadrature_rules</a></td></tr>
<tr class="memdesc:a203fe804a4341ea7633f0dad9cc128d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">This boolean flag allows you to use "unweighted" quadrature rules (sized to exactly integrate unweighted shape functions in master element space) rather than "default" quadrature rules (sized to exactly integrate polynomials of one higher degree than mass matrix terms).  <a href="#a203fe804a4341ea7633f0dad9cc128d1">更多...</a><br/></td></tr>
<tr class="separator:a203fe804a4341ea7633f0dad9cc128d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d626496b0b6f99f679c4ef4f0a5e46e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1SystemNorm.html">SystemNorm</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a></td></tr>
<tr class="memdesc:a9d626496b0b6f99f679c4ef4f0a5e46e"><td class="mdescLeft">&#160;</td><td class="mdescRight">When estimating the error in a single system, the <code>error_norm</code> is used to control the scaling and norm choice for each variable.  <a href="#a9d626496b0b6f99f679c4ef4f0a5e46e">更多...</a><br/></td></tr>
<tr class="separator:a9d626496b0b6f99f679c4ef4f0a5e46e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected 成员函数</h2></td></tr>
<tr class="memitem:aae0c22664d6487c8659656a255226e40"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DiscontinuityMeasure.html#aae0c22664d6487c8659656a255226e40">init_context</a> (<a class="el" href="classlibMesh_1_1FEMContext.html">FEMContext</a> &amp;c) override</td></tr>
<tr class="memdesc:aae0c22664d6487c8659656a255226e40"><td class="mdescLeft">&#160;</td><td class="mdescRight">An initialization function, for requesting specific data from the <a class="el" href="classlibMesh_1_1FE.html" title="A specific instantiation of the FEBase class. ">FE</a> objects.  <a href="#aae0c22664d6487c8659656a255226e40">更多...</a><br/></td></tr>
<tr class="separator:aae0c22664d6487c8659656a255226e40"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6aacf9c7c291bdae135aae000975dd9a"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DiscontinuityMeasure.html#a6aacf9c7c291bdae135aae000975dd9a">internal_side_integration</a> () override</td></tr>
<tr class="memdesc:a6aacf9c7c291bdae135aae000975dd9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">The function which calculates a normal derivative jump based error term on an internal side.  <a href="#a6aacf9c7c291bdae135aae000975dd9a">更多...</a><br/></td></tr>
<tr class="separator:a6aacf9c7c291bdae135aae000975dd9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1883242043c459480bc8e26bed93190"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DiscontinuityMeasure.html#ae1883242043c459480bc8e26bed93190">boundary_side_integration</a> () override</td></tr>
<tr class="memdesc:ae1883242043c459480bc8e26bed93190"><td class="mdescLeft">&#160;</td><td class="mdescRight">The function which calculates a normal derivative jump based error term on a boundary side.  <a href="#ae1883242043c459480bc8e26bed93190">更多...</a><br/></td></tr>
<tr class="separator:ae1883242043c459480bc8e26bed93190"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ce39bedb72e4b8c5b5f3403c4ad162d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1JumpErrorEstimator.html#a6ce39bedb72e4b8c5b5f3403c4ad162d">reinit_sides</a> ()</td></tr>
<tr class="memdesc:a6ce39bedb72e4b8c5b5f3403c4ad162d"><td class="mdescLeft">&#160;</td><td class="mdescRight">A utility function to reinit the finite element data on elements sharing a side.  <a href="#a6ce39bedb72e4b8c5b5f3403c4ad162d">更多...</a><br/></td></tr>
<tr class="separator:a6ce39bedb72e4b8c5b5f3403c4ad162d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00b086850721807623cae109806ce189"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1JumpErrorEstimator.html#a00b086850721807623cae109806ce189">coarse_n_flux_faces_increment</a> ()</td></tr>
<tr class="memdesc:a00b086850721807623cae109806ce189"><td class="mdescLeft">&#160;</td><td class="mdescRight">A utility function to correctly increase n_flux_faces for the coarse element.  <a href="#a00b086850721807623cae109806ce189">更多...</a><br/></td></tr>
<tr class="separator:a00b086850721807623cae109806ce189"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac29685e2e9f05123fd4d6db97326a2a9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ErrorEstimator.html#ac29685e2e9f05123fd4d6db97326a2a9">reduce_error</a> (std::vector&lt; <a class="el" href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">ErrorVectorReal</a> &gt; &amp;error_per_cell, const Parallel::Communicator &amp;comm) const </td></tr>
<tr class="memdesc:ac29685e2e9f05123fd4d6db97326a2a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method takes the local error contributions in <code>error_per_cell</code> from each processor and combines them to get the global error vector.  <a href="#ac29685e2e9f05123fd4d6db97326a2a9">更多...</a><br/></td></tr>
<tr class="separator:ac29685e2e9f05123fd4d6db97326a2a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected 属性</h2></td></tr>
<tr class="memitem:ae25735cd54c0767a0e03c7f611b0ee17"><td class="memItemLeft" align="right" valign="top">std::pair&lt; bool, <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &gt;(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1DiscontinuityMeasure.html#ae25735cd54c0767a0e03c7f611b0ee17">_bc_function</a> )(const <a class="el" href="classlibMesh_1_1System.html">System</a> &amp;system, const <a class="el" href="classlibMesh_1_1Point.html">Point</a> &amp;p, const std::string &amp;var_name)</td></tr>
<tr class="memdesc:ae25735cd54c0767a0e03c7f611b0ee17"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pointer to function that provides BC information.  <a href="#ae25735cd54c0767a0e03c7f611b0ee17">更多...</a><br/></td></tr>
<tr class="separator:ae25735cd54c0767a0e03c7f611b0ee17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5407898d65d3aeeaeada1786234e5de4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1JumpErrorEstimator.html#a5407898d65d3aeeaeada1786234e5de4">integrate_boundary_sides</a></td></tr>
<tr class="memdesc:a5407898d65d3aeeaeada1786234e5de4"><td class="mdescLeft">&#160;</td><td class="mdescRight">A boolean flag, by default false, to be set to true if integrations with <a class="el" href="classlibMesh_1_1JumpErrorEstimator.html#a32d9097610a87627382c5ea81a70d0b1" title="The function, to be implemented by derived classes, which calculates an error term on a boundary side...">boundary_side_integration()</a> should be performed.  <a href="#a5407898d65d3aeeaeada1786234e5de4">更多...</a><br/></td></tr>
<tr class="separator:a5407898d65d3aeeaeada1786234e5de4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae38eda2aa4b373ade6e83467f3ebc1ef"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classlibMesh_1_1FEMContext.html">FEMContext</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a></td></tr>
<tr class="memdesc:ae38eda2aa4b373ade6e83467f3ebc1ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Context objects for integrating on the fine and coarse elements sharing a face.  <a href="#ae38eda2aa4b373ade6e83467f3ebc1ef">更多...</a><br/></td></tr>
<tr class="separator:ae38eda2aa4b373ade6e83467f3ebc1ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7f203c19f25ccbb259f793064f5014f"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classlibMesh_1_1FEMContext.html">FEMContext</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1JumpErrorEstimator.html#ab7f203c19f25ccbb259f793064f5014f">coarse_context</a></td></tr>
<tr class="separator:ab7f203c19f25ccbb259f793064f5014f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28cc78a25a550e30504bfef7402398d3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1JumpErrorEstimator.html#a28cc78a25a550e30504bfef7402398d3">fine_error</a></td></tr>
<tr class="memdesc:a28cc78a25a550e30504bfef7402398d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">The fine and coarse error values to be set by each side_integration();.  <a href="#a28cc78a25a550e30504bfef7402398d3">更多...</a><br/></td></tr>
<tr class="separator:a28cc78a25a550e30504bfef7402398d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5999107dbf9dfc4166e59cdc6e1c24fe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1JumpErrorEstimator.html#a5999107dbf9dfc4166e59cdc6e1c24fe">coarse_error</a></td></tr>
<tr class="separator:a5999107dbf9dfc4166e59cdc6e1c24fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05b93294744b2b7a95dc593d7ab122bf"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a></td></tr>
<tr class="memdesc:a05b93294744b2b7a95dc593d7ab122bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">The variable number currently being evaluated.  <a href="#a05b93294744b2b7a95dc593d7ab122bf">更多...</a><br/></td></tr>
<tr class="separator:a05b93294744b2b7a95dc593d7ab122bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">详细描述</h2>
<div class="textblock"><p>This class measures discontinuities between elements for debugging purposes. </p>
<p>It derives from <a class="el" href="classlibMesh_1_1ErrorEstimator.html" title="This class holds functions that will estimate the error in a finite element solution on a given mesh...">ErrorEstimator</a> just in case someone finds it useful in a DG framework.</p>
<dl class="section author"><dt>作者</dt><dd>Roy H. Stogner </dd></dl>
<dl class="section date"><dt>日期</dt><dd>2006 </dd></dl>

<p>在文件 <a class="el" href="discontinuity__measure_8h_source.html">discontinuity_measure.h</a> 第 <a class="el" href="discontinuity__measure_8h_source.html#l00049">49</a> 行定义.</p>
</div><h2 class="groupheader">成员类型定义说明</h2>
<a class="anchor" id="ab37d862060bbddf77099b6e34c62ef71"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::map&lt;std::pair&lt;const <a class="el" href="classlibMesh_1_1System.html">System</a> *, unsigned int&gt;, std::unique_ptr&lt;<a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a>&gt; &gt; <a class="el" href="classlibMesh_1_1ErrorEstimator.html#ab37d862060bbddf77099b6e34c62ef71">libMesh::ErrorEstimator::ErrorMap</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>When calculating many error vectors at once, we need a data structure to hold them all. </p>

<p>在文件 <a class="el" href="error__estimator_8h_source.html">error_estimator.h</a> 第 <a class="el" href="error__estimator_8h_source.html#l00121">121</a> 行定义.</p>

</div>
</div>
<h2 class="groupheader">构造及析构函数说明</h2>
<a class="anchor" id="afce341055712ce5587b524e77a4d1265"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">libMesh::DiscontinuityMeasure::DiscontinuityMeasure </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<p>Responsible for initializing the _bc_function function pointer to nullptr. Defaults to L2 norm; changes to system norm are ignored. </p>

<p>在文件 <a class="el" href="discontinuity__measure_8C_source.html">discontinuity_measure.C</a> 第 <a class="el" href="discontinuity__measure_8C_source.html#l00041">41</a> 行定义.</p>

<p>参考 <a class="el" href="error__estimator_8h_source.html#l00158">libMesh::ErrorEstimator::error_norm</a> , 以及 <a class="el" href="enum__norm__type_8h_source.html#l00036">libMesh::L2</a>.</p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                                           :</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a056856c8945a3fd4f050e72865b8cab6">JumpErrorEstimator</a>(),</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="classlibMesh_1_1DiscontinuityMeasure.html#ae25735cd54c0767a0e03c7f611b0ee17">_bc_function</a>(<span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;{</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a> = <a class="code" href="namespacelibMesh.html#a2fef831ba9c2670aafb97bcb7e597346a71490c0b88084ba46be0c58b19fbedb7">L2</a>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DiscontinuityMeasure_html_ae25735cd54c0767a0e03c7f611b0ee17"><div class="ttname"><a href="classlibMesh_1_1DiscontinuityMeasure.html#ae25735cd54c0767a0e03c7f611b0ee17">libMesh::DiscontinuityMeasure::_bc_function</a></div><div class="ttdeci">std::pair&lt; bool, Real &gt;(* _bc_function)(const System &amp;system, const Point &amp;p, const std::string &amp;var_name)</div><div class="ttdoc">Pointer to function that provides BC information. </div><div class="ttdef"><b>Definition:</b> <a href="discontinuity__measure_8h_source.html#l00108">discontinuity_measure.h:108</a></div></div>
<div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_a9d626496b0b6f99f679c4ef4f0a5e46e"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">libMesh::ErrorEstimator::error_norm</a></div><div class="ttdeci">SystemNorm error_norm</div><div class="ttdoc">When estimating the error in a single system, the error_norm is used to control the scaling and norm ...</div><div class="ttdef"><b>Definition:</b> <a href="error__estimator_8h_source.html#l00158">error_estimator.h:158</a></div></div>
<div class="ttc" id="classlibMesh_1_1JumpErrorEstimator_html_a056856c8945a3fd4f050e72865b8cab6"><div class="ttname"><a href="classlibMesh_1_1JumpErrorEstimator.html#a056856c8945a3fd4f050e72865b8cab6">libMesh::JumpErrorEstimator::JumpErrorEstimator</a></div><div class="ttdeci">JumpErrorEstimator()</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> <a href="jump__error__estimator_8h_source.html#l00055">jump_error_estimator.h:55</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a2fef831ba9c2670aafb97bcb7e597346a71490c0b88084ba46be0c58b19fbedb7"><div class="ttname"><a href="namespacelibMesh.html#a2fef831ba9c2670aafb97bcb7e597346a71490c0b88084ba46be0c58b19fbedb7">libMesh::L2</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__norm__type_8h_source.html#l00036">enum_norm_type.h:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6ae9c55a7431c79e4a9ecfc39a054c84"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">libMesh::DiscontinuityMeasure::DiscontinuityMeasure </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1DiscontinuityMeasure.html">DiscontinuityMeasure</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This class cannot be (default) copy constructed/assigned because its base class has unique_ptr members. </p>

</div>
</div>
<a class="anchor" id="ae1e28e6aa73241697ce9b10915694b0e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">libMesh::DiscontinuityMeasure::DiscontinuityMeasure </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DiscontinuityMeasure.html">DiscontinuityMeasure</a> &amp;&amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Defaulted move ctor, move assignment operator, and destructor. </p>

</div>
</div>
<a class="anchor" id="a99e01a499979cd70af5172accc0b869a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual libMesh::DiscontinuityMeasure::~DiscontinuityMeasure </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">成员函数说明</h2>
<a class="anchor" id="a3aafdec861b5dde7ef332895de4b7440"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DiscontinuityMeasure::attach_essential_bc_function </td>
          <td>(</td>
          <td class="paramtype">std::pair&lt; bool, <a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> &gt; &#160;</td>
          <td class="paramname"><em>fptr</em>const System &amp;system,const Point &amp;p,const std::string &amp;var_name</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Register a user function to use in computing the essential BCs. </p>

<p>在文件 <a class="el" href="discontinuity__measure_8C_source.html">discontinuity_measure.C</a> 第 <a class="el" href="discontinuity__measure_8C_source.html#l00200">200</a> 行定义.</p>

<p>参考 <a class="el" href="discontinuity__measure_8h_source.html#l00108">_bc_function</a> , 以及 <a class="el" href="jump__error__estimator_8h_source.html#l00152">libMesh::JumpErrorEstimator::integrate_boundary_sides</a>.</p>
<div class="fragment"><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;{</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <a class="code" href="classlibMesh_1_1DiscontinuityMeasure.html#ae25735cd54c0767a0e03c7f611b0ee17">_bc_function</a> = fptr;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="comment">// We may be turning boundary side integration on or off</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordflow">if</span> (fptr)</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a5407898d65d3aeeaeada1786234e5de4">integrate_boundary_sides</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a5407898d65d3aeeaeada1786234e5de4">integrate_boundary_sides</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DiscontinuityMeasure_html_ae25735cd54c0767a0e03c7f611b0ee17"><div class="ttname"><a href="classlibMesh_1_1DiscontinuityMeasure.html#ae25735cd54c0767a0e03c7f611b0ee17">libMesh::DiscontinuityMeasure::_bc_function</a></div><div class="ttdeci">std::pair&lt; bool, Real &gt;(* _bc_function)(const System &amp;system, const Point &amp;p, const std::string &amp;var_name)</div><div class="ttdoc">Pointer to function that provides BC information. </div><div class="ttdef"><b>Definition:</b> <a href="discontinuity__measure_8h_source.html#l00108">discontinuity_measure.h:108</a></div></div>
<div class="ttc" id="classlibMesh_1_1JumpErrorEstimator_html_a5407898d65d3aeeaeada1786234e5de4"><div class="ttname"><a href="classlibMesh_1_1JumpErrorEstimator.html#a5407898d65d3aeeaeada1786234e5de4">libMesh::JumpErrorEstimator::integrate_boundary_sides</a></div><div class="ttdeci">bool integrate_boundary_sides</div><div class="ttdoc">A boolean flag, by default false, to be set to true if integrations with boundary_side_integration() ...</div><div class="ttdef"><b>Definition:</b> <a href="jump__error__estimator_8h_source.html#l00152">jump_error_estimator.h:152</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae1883242043c459480bc8e26bed93190"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::DiscontinuityMeasure::boundary_side_integration </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The function which calculates a normal derivative jump based error term on a boundary side. </p>
<dl class="section return"><dt>返回</dt><dd><code>true</code> if the flux bc function is in fact defined on the current side. </dd></dl>

<p>重载 <a class="el" href="classlibMesh_1_1JumpErrorEstimator.html#a32d9097610a87627382c5ea81a70d0b1">libMesh::JumpErrorEstimator</a> .</p>

<p>在文件 <a class="el" href="discontinuity__measure_8C_source.html">discontinuity_measure.C</a> 第 <a class="el" href="discontinuity__measure_8C_source.html#l00129">129</a> 行定义.</p>

<p>参考 <a class="el" href="discontinuity__measure_8h_source.html#l00108">_bc_function</a>, <a class="el" href="classlibMesh_1_1Elem.html#a90a7ca1f28a92f659ab6f8cdef91d806">libMesh::Elem::dim()</a>, <a class="el" href="error__estimator_8h_source.html#l00158">libMesh::ErrorEstimator::error_norm</a>, <a class="el" href="jump__error__estimator_8h_source.html#l00158">libMesh::JumpErrorEstimator::fine_context</a>, <a class="el" href="jump__error__estimator_8h_source.html#l00163">libMesh::JumpErrorEstimator::fine_error</a>, <a class="el" href="fe__abstract_8h_source.html#l00295">libMesh::FEAbstract::get_JxW()</a>, <a class="el" href="fe__base_8h_source.html#l00207">libMesh::FEGenericBase&lt; T &gt;::get_phi()</a>, <a class="el" href="fe__abstract_8h_source.html#l00272">libMesh::FEAbstract::get_xyz()</a>, <a class="el" href="elem_8C_source.html#l00531">libMesh::Elem::hmax()</a>, <a class="el" href="classlibMesh_1_1FEAbstract.html#a621286e4f4f0474c9367caeec9b6b305">libMesh::FEAbstract::n_quadrature_points()</a>, <a class="el" href="tensor__tools_8h_source.html#l00074">libMesh::TensorTools::norm_sq()</a>, <a class="el" href="libmesh__common_8h_source.html#l00143">libMesh::Real</a>, <a class="el" href="jump__error__estimator_8h_source.html#l00168">libMesh::JumpErrorEstimator::var</a> , 以及 <a class="el" href="system__norm_8C_source.html#l00134">libMesh::SystemNorm::weight()</a>.</p>
<div class="fragment"><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;{</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keyword">const</span> Elem &amp; fine_elem = <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;get_elem();</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <a class="code" href="namespacelibMesh.html#adf7aee34b8c6fe4be28c90fe132a73a0">FEBase</a> * fe_fine = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;get_side_fe( <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>, fe_fine, fine_elem.dim() );</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keyword">const</span> std::string &amp; var_name =</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;get_system().variable_name(<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  std::vector&lt;std::vector&lt;Real&gt;&gt; phi_fine = fe_fine-&gt;get_phi();</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  std::vector&lt;Real&gt; JxW_face = fe_fine-&gt;get_JxW();</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  std::vector&lt;Point&gt; qface_point = fe_fine-&gt;get_xyz();</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">// The reinitialization also recomputes the locations of</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="comment">// the quadrature points on the side.  By checking if the</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="comment">// first quadrature point on the side is on an essential boundary</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="comment">// for a particular variable, we will determine if the whole</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="comment">// element is on an essential boundary (assuming quadrature points</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="comment">// are strictly contained in the side).</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1DiscontinuityMeasure.html#ae25735cd54c0767a0e03c7f611b0ee17">_bc_function</a>(<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;get_system(),</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                         qface_point[0], var_name).first)</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> h = fine_elem.hmax();</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <span class="comment">// The number of quadrature points</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_qp = fe_fine-&gt;n_quadrature_points();</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="comment">// The error contribution from this face</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> error = 1.e-30;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="comment">// loop over the integration points on the face.</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> qp=0; qp&lt;n_qp; qp++)</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          <span class="comment">// Value of the imposed essential BC at this quadrature point.</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;          <span class="keyword">const</span> std::pair&lt;bool,Real&gt; essential_bc =</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            this-&gt;<a class="code" href="classlibMesh_1_1DiscontinuityMeasure.html#ae25735cd54c0767a0e03c7f611b0ee17">_bc_function</a>(<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;get_system(), qface_point[qp],</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                               var_name);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;          <span class="comment">// Be sure the BC function still thinks we&#39;re on the</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;          <span class="comment">// essential boundary.</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;          libmesh_assert_equal_to (essential_bc.first, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;          <span class="comment">// The solution value on each point</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;          <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> u_fine = <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;side_value(<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>, qp);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;          <span class="comment">// The difference between the desired BC and the approximate solution.</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> jump = essential_bc.second - u_fine;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;          <span class="comment">// The flux jump squared.  If using complex numbers,</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;          <span class="comment">// norm_sq(z) returns |z|^2, where |z| is the modulus of z.</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> jump2 = <a class="code" href="namespacelibMesh_1_1TensorTools.html#aece0d041f4f91b393d2564f4a5e4b1ee">TensorTools::norm_sq</a>(jump);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;          <span class="comment">// Integrate the error on the face.  The error is</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;          <span class="comment">// scaled by an additional power of h, where h is</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;          <span class="comment">// the maximum side length for the element.  This</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;          <span class="comment">// arises in the definition of the indicator.</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;          error += JxW_face[qp]*jump2;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        } <span class="comment">// End quadrature point loop</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a28cc78a25a550e30504bfef7402398d3">fine_error</a> = error*h*<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a>.<a class="code" href="classlibMesh_1_1SystemNorm.html#ac8a59940264314511d0e4f253433e76b">weight</a>(<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    } <span class="comment">// end if side on flux boundary</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1DiscontinuityMeasure_html_ae25735cd54c0767a0e03c7f611b0ee17"><div class="ttname"><a href="classlibMesh_1_1DiscontinuityMeasure.html#ae25735cd54c0767a0e03c7f611b0ee17">libMesh::DiscontinuityMeasure::_bc_function</a></div><div class="ttdeci">std::pair&lt; bool, Real &gt;(* _bc_function)(const System &amp;system, const Point &amp;p, const std::string &amp;var_name)</div><div class="ttdoc">Pointer to function that provides BC information. </div><div class="ttdef"><b>Definition:</b> <a href="discontinuity__measure_8h_source.html#l00108">discontinuity_measure.h:108</a></div></div>
<div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_a9d626496b0b6f99f679c4ef4f0a5e46e"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">libMesh::ErrorEstimator::error_norm</a></div><div class="ttdeci">SystemNorm error_norm</div><div class="ttdoc">When estimating the error in a single system, the error_norm is used to control the scaling and norm ...</div><div class="ttdef"><b>Definition:</b> <a href="error__estimator_8h_source.html#l00158">error_estimator.h:158</a></div></div>
<div class="ttc" id="classlibMesh_1_1JumpErrorEstimator_html_ae38eda2aa4b373ade6e83467f3ebc1ef"><div class="ttname"><a href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">libMesh::JumpErrorEstimator::fine_context</a></div><div class="ttdeci">std::unique_ptr&lt; FEMContext &gt; fine_context</div><div class="ttdoc">Context objects for integrating on the fine and coarse elements sharing a face. </div><div class="ttdef"><b>Definition:</b> <a href="jump__error__estimator_8h_source.html#l00158">jump_error_estimator.h:158</a></div></div>
<div class="ttc" id="classlibMesh_1_1SystemNorm_html_ac8a59940264314511d0e4f253433e76b"><div class="ttname"><a href="classlibMesh_1_1SystemNorm.html#ac8a59940264314511d0e4f253433e76b">libMesh::SystemNorm::weight</a></div><div class="ttdeci">Real weight(unsigned int var) const </div><div class="ttdef"><b>Definition:</b> <a href="system__norm_8C_source.html#l00134">system_norm.C:134</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1TensorTools_html_aece0d041f4f91b393d2564f4a5e4b1ee"><div class="ttname"><a href="namespacelibMesh_1_1TensorTools.html#aece0d041f4f91b393d2564f4a5e4b1ee">libMesh::TensorTools::norm_sq</a></div><div class="ttdeci">T norm_sq(std::complex&lt; T &gt; a)</div><div class="ttdef"><b>Definition:</b> <a href="tensor__tools_8h_source.html#l00074">tensor_tools.h:74</a></div></div>
<div class="ttc" id="namespacelibMesh_html_adf7aee34b8c6fe4be28c90fe132a73a0"><div class="ttname"><a href="namespacelibMesh.html#adf7aee34b8c6fe4be28c90fe132a73a0">libMesh::FEBase</a></div><div class="ttdeci">FEGenericBase&lt; Real &gt; FEBase</div><div class="ttdef"><b>Definition:</b> <a href="exact__error__estimator_8h_source.html#l00039">exact_error_estimator.h:39</a></div></div>
<div class="ttc" id="classlibMesh_1_1JumpErrorEstimator_html_a28cc78a25a550e30504bfef7402398d3"><div class="ttname"><a href="classlibMesh_1_1JumpErrorEstimator.html#a28cc78a25a550e30504bfef7402398d3">libMesh::JumpErrorEstimator::fine_error</a></div><div class="ttdeci">Real fine_error</div><div class="ttdoc">The fine and coarse error values to be set by each side_integration();. </div><div class="ttdef"><b>Definition:</b> <a href="jump__error__estimator_8h_source.html#l00163">jump_error_estimator.h:163</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aef28359fb4851abec08fc99cfbac118d"><div class="ttname"><a href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">libMesh::Real</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef LIBMESH_DEFAULT_SCALAR_TYPE Real</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00143">libmesh_common.h:143</a></div></div>
<div class="ttc" id="classlibMesh_1_1JumpErrorEstimator_html_a05b93294744b2b7a95dc593d7ab122bf"><div class="ttname"><a href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">libMesh::JumpErrorEstimator::var</a></div><div class="ttdeci">unsigned int var</div><div class="ttdoc">The variable number currently being evaluated. </div><div class="ttdef"><b>Definition:</b> <a href="jump__error__estimator_8h_source.html#l00168">jump_error_estimator.h:168</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a8b17bf24a15bc292850c3a3894e2e8f9"><div class="ttname"><a href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">libMesh::Number</a></div><div class="ttdeci">Real Number</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00214">libmesh_common.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a00b086850721807623cae109806ce189"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">float libMesh::JumpErrorEstimator::coarse_n_flux_faces_increment </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A utility function to correctly increase n_flux_faces for the coarse element. </p>

<p>在文件 <a class="el" href="jump__error__estimator_8C_source.html">jump_error_estimator.C</a> 第 <a class="el" href="jump__error__estimator_8C_source.html#l00488">488</a> 行定义.</p>

<p>参考 <a class="el" href="jump__error__estimator_8h_source.html#l00158">libMesh::JumpErrorEstimator::coarse_context</a> , 以及 <a class="el" href="jump__error__estimator_8h_source.html#l00158">libMesh::JumpErrorEstimator::fine_context</a>.</p>

<p>参考自 <a class="el" href="jump__error__estimator_8C_source.html#l00056">libMesh::JumpErrorEstimator::estimate_error()</a>.</p>
<div class="fragment"><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;{</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="comment">// Keep track of the number of internal flux sides found on each</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="comment">// element</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> dim = <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ab7f203c19f25ccbb259f793064f5014f">coarse_context</a>-&gt;get_elem().dim();</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> divisor =</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    1 &lt;&lt; (dim-1)*(<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;get_elem().level() -</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                  <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ab7f203c19f25ccbb259f793064f5014f">coarse_context</a>-&gt;get_elem().level());</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="comment">// With a difference of n levels between fine and coarse elements,</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  <span class="comment">// we compute a fractional flux face for the coarse element by adding:</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="comment">// 1/2^n in 2D</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="comment">// 1/4^n in 3D</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="comment">// each time.  This code will get hit 2^n times in 2D and 4^n</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="comment">// times in 3D so that the final flux face count for the coarse</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="comment">// element will be an integer value.</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="keywordflow">return</span> 1.0f / <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(divisor);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1JumpErrorEstimator_html_ae38eda2aa4b373ade6e83467f3ebc1ef"><div class="ttname"><a href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">libMesh::JumpErrorEstimator::fine_context</a></div><div class="ttdeci">std::unique_ptr&lt; FEMContext &gt; fine_context</div><div class="ttdoc">Context objects for integrating on the fine and coarse elements sharing a face. </div><div class="ttdef"><b>Definition:</b> <a href="jump__error__estimator_8h_source.html#l00158">jump_error_estimator.h:158</a></div></div>
<div class="ttc" id="classlibMesh_1_1JumpErrorEstimator_html_ab7f203c19f25ccbb259f793064f5014f"><div class="ttname"><a href="classlibMesh_1_1JumpErrorEstimator.html#ab7f203c19f25ccbb259f793064f5014f">libMesh::JumpErrorEstimator::coarse_context</a></div><div class="ttdeci">std::unique_ptr&lt; FEMContext &gt; coarse_context</div><div class="ttdef"><b>Definition:</b> <a href="jump__error__estimator_8h_source.html#l00158">jump_error_estimator.h:158</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae8f1c906c185d73857e7a86bd47fad70"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::JumpErrorEstimator::estimate_error </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1System.html">System</a> &amp;&#160;</td>
          <td class="paramname"><em>system</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;&#160;</td>
          <td class="paramname"><em>error_per_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *&#160;</td>
          <td class="paramname"><em>solution_vector</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>estimate_parent_error</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function uses the derived class's jump error estimate formula to estimate the error on each cell. </p>
<p>The estimated error is output in the vector <code>error_per_cell</code> </p>
<p>Conventions for assigning the direction of the normal:</p>
<ul>
<li>e &amp; f are global element ids</li>
</ul>
<p>Case (1.) Elements are at the same level, e&lt;f Compute the flux jump on the face and add it as a contribution to error_per_cell[e] and error_per_cell[f] </p>
<hr/>
<p> | | | </p>
<table class="doxtable">
<tr>
<th></th><th>f  </th></tr>
<tr>
<td>e </td><td>&mdash;&gt; n </td></tr>
<tr>
<td></td><td></td></tr>
<tr>
<td></td><td></td></tr>
</table>
<hr/>
<p>Case (2.) The neighbor is at a higher level. Compute the flux jump on e's face and add it as a contribution to error_per_cell[e] and error_per_cell[f] </p>
<hr/>
<p> | | | | | | e |&mdash;&gt; n | | | | | |--------&mdash;| f | </p>
<table class="doxtable">
<tr>
<th></th><th></th><th></th></tr>
<tr>
<td></td><td></td><td></td></tr>
</table>
<hr/>

<p>实现了 <a class="el" href="classlibMesh_1_1ErrorEstimator.html#ab5ee8217ac35baaa00cc3b72e9815d93">libMesh::ErrorEstimator</a>.</p>

<p>在文件 <a class="el" href="jump__error__estimator_8C_source.html">jump_error_estimator.C</a> 第 <a class="el" href="jump__error__estimator_8C_source.html#l00056">56</a> 行定义.</p>

<p>参考 <a class="el" href="elem_8h_source.html#l02754">libMesh::Elem::active()</a>, <a class="el" href="elem__internal_8h_source.html#l00320">libMesh::ElemInternal::active_family_tree_by_neighbor()</a>, <a class="el" href="jump__error__estimator_8h_source.html#l00146">libMesh::JumpErrorEstimator::boundary_side_integration()</a>, <a class="el" href="elem_8h_source.html#l02164">libMesh::Elem::child_ref_range()</a>, <a class="el" href="jump__error__estimator_8h_source.html#l00158">libMesh::JumpErrorEstimator::coarse_context</a>, <a class="el" href="jump__error__estimator_8h_source.html#l00163">libMesh::JumpErrorEstimator::coarse_error</a>, <a class="el" href="jump__error__estimator_8C_source.html#l00488">libMesh::JumpErrorEstimator::coarse_n_flux_faces_increment()</a>, <a class="el" href="fe__base_8C_source.html#l00976">libMesh::FEGenericBase&lt; T &gt;::coarsened_dof_values()</a>, <a class="el" href="error__estimator_8h_source.html#l00158">libMesh::ErrorEstimator::error_norm</a>, <a class="el" href="libmesh__common_8h_source.html#l00225">libMesh::ErrorVectorReal</a>, <a class="el" href="jump__error__estimator_8h_source.html#l00158">libMesh::JumpErrorEstimator::fine_context</a>, <a class="el" href="jump__error__estimator_8h_source.html#l00163">libMesh::JumpErrorEstimator::fine_error</a>, <a class="el" href="numeric__vector_8h_source.html#l01012">libMesh::NumericVector&lt; T &gt;::get()</a>, <a class="el" href="system_8h_source.html#l02293">libMesh::System::get_dof_map()</a>, <a class="el" href="system_8h_source.html#l02277">libMesh::System::get_mesh()</a>, <a class="el" href="fe__abstract_8h_source.html#l00272">libMesh::FEAbstract::get_xyz()</a>, <a class="el" href="dof__object_8h_source.html#l00823">libMesh::DofObject::id()</a>, <a class="el" href="int__range_8h_source.html#l00111">libMesh::index_range()</a>, <a class="el" href="jump__error__estimator_8C_source.html#l00048">libMesh::JumpErrorEstimator::init_context()</a>, <a class="el" href="jump__error__estimator_8h_source.html#l00152">libMesh::JumpErrorEstimator::integrate_boundary_sides</a>, <a class="el" href="classlibMesh_1_1JumpErrorEstimator.html#a3518b201b4f8bb17a292be2701d76749">libMesh::JumpErrorEstimator::internal_side_integration()</a>, <a class="el" href="elem_8h_source.html#l02887">libMesh::Elem::level()</a>, <a class="el" href="libmesh__common_8h_source.html#l00516">libMesh::libmesh_ignore()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a807e5541b5e0608c8847daf6f3ffc1cf">libMesh::MeshBase::max_elem_id()</a>, <a class="el" href="mesh__communication_8C_source.html#l01308">mesh</a>, <a class="el" href="tecplot__io_8C_source.html#l00068">n_vars</a>, <a class="el" href="system_8h_source.html#l02349">libMesh::System::n_vars()</a>, <a class="el" href="elem_8h_source.html#l02383">libMesh::Elem::neighbor_ptr()</a>, <a class="el" href="elem_8h_source.html#l02843">libMesh::Elem::parent()</a>, <a class="el" href="error__estimator_8C_source.html#l00032">libMesh::ErrorEstimator::reduce_error()</a>, <a class="el" href="jump__error__estimator_8C_source.html#l00450">libMesh::JumpErrorEstimator::reinit_sides()</a>, <a class="el" href="enum__fe__family_8h_source.html#l00058">libMesh::SCALAR</a>, <a class="el" href="jump__error__estimator_8h_source.html#l00099">libMesh::JumpErrorEstimator::scale_by_n_flux_faces</a>, <a class="el" href="elem_8h_source.html#l02486">libMesh::Elem::side_index_range()</a>, <a class="el" href="dense__vector_8h_source.html#l00111">libMesh::DenseVector&lt; T &gt;::size()</a>, <a class="el" href="system_8h_source.html#l01573">libMesh::System::solution</a>, <a class="el" href="type__vector_8h_source.html#l00088">std::sqrt()</a>, <a class="el" href="numeric__vector_8h_source.html#l01179">libMesh::NumericVector&lt; T &gt;::swap()</a>, <a class="el" href="jump__error__estimator_8h_source.html#l00113">libMesh::JumpErrorEstimator::use_unweighted_quadrature_rules</a>, <a class="el" href="jump__error__estimator_8h_source.html#l00168">libMesh::JumpErrorEstimator::var</a> , 以及 <a class="el" href="system__norm_8C_source.html#l00134">libMesh::SystemNorm::weight()</a>.</p>
<div class="fragment"><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;{</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;estimate_error()&quot;</span>, <span class="stringliteral">&quot;JumpErrorEstimator&quot;</span>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">// This parameter is not used when !LIBMESH_ENABLE_AMR.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <a class="code" href="namespacelibMesh.html#a43f45640aab1af26176e69592c666432">libmesh_ignore</a>(estimate_parent_error);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="comment">// The current mesh</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keyword">const</span> MeshBase &amp; <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a> = system.get_mesh();</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="comment">// The number of variables in the system</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a> = system.n_vars();</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="comment">// The DofMap for this system</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_AMR</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor"></span>  <span class="keyword">const</span> DofMap &amp; dof_map = system.get_dof_map();</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="comment">// Resize the error_per_cell vector to be</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="comment">// the number of elements, initialize it to 0.</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  error_per_cell.resize (mesh.max_elem_id());</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  std::fill (error_per_cell.begin(), error_per_cell.end(), 0.);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="comment">// Declare a vector of floats which is as long as</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <span class="comment">// error_per_cell above, and fill with zeros.  This vector will be</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="comment">// used to keep track of the number of edges (faces) on each active</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="comment">// element which are either:</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="comment">// 1) an internal edge</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="comment">// 2) an edge on a Neumann boundary for which a boundary condition</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="comment">//    function has been specified.</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="comment">// The error estimator can be scaled by the number of flux edges (faces)</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="comment">// which the element actually has to obtain a more uniform measure</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="comment">// of the error.  Use floats instead of ints since in case 2 (above)</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="comment">// f gets 1/2 of a flux face contribution from each of his</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="comment">// neighbors</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  std::vector&lt;float&gt; n_flux_faces;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a4edf0ef12588e39bb85d8dea4e7d560d">scale_by_n_flux_faces</a>)</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    n_flux_faces.resize(error_per_cell.size(), 0);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="comment">// Prepare current_local_solution to localize a non-standard</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="comment">// solution vector if necessary</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keywordflow">if</span> (solution_vector &amp;&amp; solution_vector != system.solution.<a class="code" href="classlibMesh_1_1NumericVector.html#a8eac3a527f0194feae3a9dd80c878df1">get</a>())</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <a class="code" href="namespacelibMesh.html#af63481288585b5ba172278c33c726667">NumericVector&lt;Number&gt;</a> * newsol =</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keyword">const_cast&lt;</span><a class="code" href="namespacelibMesh.html#af63481288585b5ba172278c33c726667">NumericVector&lt;Number&gt;</a> *<span class="keyword">&gt;</span>(solution_vector);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      System &amp; sys = <span class="keyword">const_cast&lt;</span>System &amp;<span class="keyword">&gt;</span>(system);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      newsol-&gt;swap(*sys.solution);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      sys.update();</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="comment">// We don&#39;t use full elem_jacobian or subjacobians here.</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a> = std::make_unique&lt;FEMContext&gt;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    (system, <span class="keyword">nullptr</span>, <span class="comment">/* allocate_local_matrices = */</span> <span class="keyword">false</span>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ab7f203c19f25ccbb259f793064f5014f">coarse_context</a> = std::make_unique&lt;FEMContext&gt;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    (system, <span class="keyword">nullptr</span>, <span class="comment">/* allocate_local_matrices = */</span> <span class="keyword">false</span>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="comment">// Don&#39;t overintegrate - we&#39;re evaluating differences of FE values,</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="comment">// not products of them.</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a203fe804a4341ea7633f0dad9cc128d1">use_unweighted_quadrature_rules</a>)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;use_unweighted_quadrature_rules(system.extra_quadrature_order);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="comment">// Loop over all the variables we&#39;ve been requested to find jumps in, to</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="comment">// pre-request</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>=0; <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>&lt;<a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>; <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>++)</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="comment">// Skip variables which aren&#39;t part of our norm,</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="comment">// as well as SCALAR variables, which have no jumps</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a>.<a class="code" href="classlibMesh_1_1SystemNorm.html#ac8a59940264314511d0e4f253433e76b">weight</a>(<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>) == 0.0 ||</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          system.variable_type(<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>).family == <a class="code" href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">SCALAR</a>)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="comment">// FIXME: Need to generalize this to vector-valued elements. [PB]</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <a class="code" href="namespacelibMesh.html#adf7aee34b8c6fe4be28c90fe132a73a0">FEBase</a> * side_fe = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="keyword">const</span> std::set&lt;unsigned char&gt; &amp; elem_dims =</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;elem_dimensions();</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; dim : elem_dims)</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;          <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;get_side_fe( <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>, side_fe, dim );</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;          side_fe-&gt;get_xyz();</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#aaa89b26b02d41e6540c886bcf9dd98ca">init_context</a>(*<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#aaa89b26b02d41e6540c886bcf9dd98ca">init_context</a>(*coarse_context);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="comment">// Iterate over all the active elements in the mesh</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="comment">// that live on this processor.</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; e : mesh.active_local_element_ptr_range())</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> e_id = e-&gt;id();</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="preprocessor">#ifdef LIBMESH_ENABLE_AMR</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="keywordflow">if</span> (e-&gt;infinite())</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;         libmesh_warning(<span class="stringliteral">&quot;Warning: Jumps on the border of infinite elements are ignored.&quot;</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                         &lt;&lt; std::endl);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;         <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      <span class="comment">// See if the parent of element e has been examined yet;</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      <span class="comment">// if not, we may want to compute the estimator on it</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      <span class="keyword">const</span> Elem * parent = e-&gt;parent();</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <span class="comment">// We only can compute and only need to compute on</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <span class="comment">// parents with all active children</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <span class="keywordtype">bool</span> compute_on_parent = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="keywordflow">if</span> (!parent || !estimate_parent_error)</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        compute_on_parent = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp; child : parent-&gt;child_ref_range())</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;          <span class="keywordflow">if</span> (!child.active())</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            compute_on_parent = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="keywordflow">if</span> (compute_on_parent &amp;&amp;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;          !error_per_cell[parent-&gt;id()])</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;          <span class="comment">// Compute a projection onto the parent</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;          DenseVector&lt;Number&gt; Uparent;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;          <a class="code" href="classlibMesh_1_1FEGenericBase.html#a3024e8290899e60cd900365414cc1e21">FEBase::coarsened_dof_values</a></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            (*(system.solution), dof_map, parent, Uparent, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;          <span class="comment">// Loop over the neighbors of the parent</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> n_p : parent-&gt;side_index_range())</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;              <span class="keywordflow">if</span> (parent-&gt;neighbor_ptr(n_p) != <span class="keyword">nullptr</span>) <span class="comment">// parent has a neighbor here</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                  <span class="comment">// Find the active neighbors in this direction</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                  std::vector&lt;const Elem *&gt; active_neighbors;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                  parent-&gt;neighbor_ptr(n_p)-&gt;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                    <a class="code" href="namespacelibMesh_1_1ElemInternal.html#ae6fd90b811bfe28c8080668c5dd34d53">active_family_tree_by_neighbor</a>(active_neighbors,</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                                                   parent);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                  <span class="comment">// Compute the flux to each active neighbor</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                  <span class="keywordflow">for</span> (std::size_t a=0,</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                        n_active_neighbors = active_neighbors.size();</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                       a != n_active_neighbors; ++a)</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                    {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                      <span class="keyword">const</span> Elem * f = active_neighbors[a];</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                      <span class="keywordflow">if</span> (f -&gt;infinite()) <span class="comment">// don&#39;t take infinite elements into account</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                         <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                      <span class="comment">// FIXME - what about when f-&gt;level &lt;</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                      <span class="comment">// parent-&gt;level()??</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                      <span class="keywordflow">if</span> (f-&gt;level() &gt;= parent-&gt;level())</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                        {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                          <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;pre_fe_reinit(system, f);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                          coarse_context-&gt;pre_fe_reinit(system, parent);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                          libmesh_assert_equal_to</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                            (coarse_context-&gt;get_elem_solution().size(),</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                             Uparent.size());</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                          coarse_context-&gt;get_elem_solution() = Uparent;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                          this-&gt;<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a6ce39bedb72e4b8c5b5f3403c4ad162d">reinit_sides</a>();</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                          <span class="comment">// Loop over all significant variables in the system</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                          <span class="keywordflow">for</span> (<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>=0; <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>&lt;<a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>; <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>++)</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a>.<a class="code" href="classlibMesh_1_1SystemNorm.html#ac8a59940264314511d0e4f253433e76b">weight</a>(<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>) != 0.0 &amp;&amp;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                                system.variable_type(<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>).family != <a class="code" href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">SCALAR</a>)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                              {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                                this-&gt;<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a3518b201b4f8bb17a292be2701d76749">internal_side_integration</a>();</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                                error_per_cell[<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;get_elem().id()] +=</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                                  <span class="keyword">static_cast&lt;</span><a class="code" href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">ErrorVectorReal</a><span class="keyword">&gt;</span>(<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a28cc78a25a550e30504bfef7402398d3">fine_error</a>);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                                error_per_cell[coarse_context-&gt;get_elem().id()] +=</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                                  <span class="keyword">static_cast&lt;</span><a class="code" href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">ErrorVectorReal</a><span class="keyword">&gt;</span>(<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a5999107dbf9dfc4166e59cdc6e1c24fe">coarse_error</a>);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                              }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                          <span class="comment">// Keep track of the number of internal flux</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                          <span class="comment">// sides found on each element</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                          <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a4edf0ef12588e39bb85d8dea4e7d560d">scale_by_n_flux_faces</a>)</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                            {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                              n_flux_faces[<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;get_elem().id()]++;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                              n_flux_faces[coarse_context-&gt;get_elem().id()] +=</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                                this-&gt;<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a00b086850721807623cae109806ce189">coarse_n_flux_faces_increment</a>();</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                            }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                        }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                    }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a5407898d65d3aeeaeada1786234e5de4">integrate_boundary_sides</a>)</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                  <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;pre_fe_reinit(system, parent);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                  libmesh_assert_equal_to</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                    (<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;get_elem_solution().size(),</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                     Uparent.size());</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                  <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;get_elem_solution() = Uparent;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                  <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;side = cast_int&lt;unsigned char&gt;(n_p);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                  <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;side_fe_reinit();</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                  <span class="comment">// If we find a boundary flux for any variable,</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                  <span class="comment">// let&#39;s just count it as a flux face for all</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                  <span class="comment">// variables.  Otherwise we&#39;d need to keep track of</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                  <span class="comment">// a separate n_flux_faces and error_per_cell for</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                  <span class="comment">// every single var.</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                  <span class="keywordtype">bool</span> found_boundary_flux = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>=0; <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>&lt;<a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>; <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>++)</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a>.<a class="code" href="classlibMesh_1_1SystemNorm.html#ac8a59940264314511d0e4f253433e76b">weight</a>(<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>) != 0.0 &amp;&amp;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                        system.variable_type(<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>).family != <a class="code" href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">SCALAR</a>)</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                      {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                        <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a32d9097610a87627382c5ea81a70d0b1">boundary_side_integration</a>())</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                          {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                            error_per_cell[<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;get_elem().id()] +=</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                              <span class="keyword">static_cast&lt;</span><a class="code" href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">ErrorVectorReal</a><span class="keyword">&gt;</span>(<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a28cc78a25a550e30504bfef7402398d3">fine_error</a>);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                            found_boundary_flux = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                          }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                      }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a4edf0ef12588e39bb85d8dea4e7d560d">scale_by_n_flux_faces</a> &amp;&amp; found_boundary_flux)</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                    n_flux_faces[<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;get_elem().id()]++;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="preprocessor">#endif // #ifdef LIBMESH_ENABLE_AMR</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="comment">// If we do any more flux integration, e will be the fine element</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;pre_fe_reinit(system, e);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="comment">// Loop over the neighbors of element e</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> n_e : e-&gt;side_index_range())</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;          <span class="keywordflow">if</span> ((e-&gt;neighbor_ptr(n_e) != <span class="keyword">nullptr</span>) ||</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;              <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a5407898d65d3aeeaeada1786234e5de4">integrate_boundary_sides</a>)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;              <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;side = cast_int&lt;unsigned char&gt;(n_e);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;              <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;side_fe_reinit();</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;          <span class="comment">// e is not on the boundary (infinite elements are treated as boundary)</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;          <span class="keywordflow">if</span> (e-&gt;neighbor_ptr(n_e) != <span class="keyword">nullptr</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;              &amp;&amp; !e-&gt;neighbor_ptr(n_e) -&gt;infinite())</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;              <span class="keyword">const</span> Elem * f           = e-&gt;neighbor_ptr(n_e);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;              <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">dof_id_type</a> f_id = f-&gt;id();</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;              <span class="comment">// Compute flux jumps if we are in case 1 or case 2.</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;              <span class="keywordflow">if</span> ((f-&gt;active() &amp;&amp; (f-&gt;level() == e-&gt;level()) &amp;&amp; (e_id &lt; f_id))</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                  || (f-&gt;level() &lt; e-&gt;level()))</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                  <span class="comment">// f is now the coarse element</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                  coarse_context-&gt;pre_fe_reinit(system, f);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                  this-&gt;<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a6ce39bedb72e4b8c5b5f3403c4ad162d">reinit_sides</a>();</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                  <span class="comment">// Loop over all significant variables in the system</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                  <span class="keywordflow">for</span> (<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>=0; <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>&lt;<a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>; <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>++)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a>.<a class="code" href="classlibMesh_1_1SystemNorm.html#ac8a59940264314511d0e4f253433e76b">weight</a>(<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>) != 0.0 &amp;&amp;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                        system.variable_type(<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>).family != <a class="code" href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">SCALAR</a>)</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                      {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                        this-&gt;<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a3518b201b4f8bb17a292be2701d76749">internal_side_integration</a>();</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                        error_per_cell[<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;get_elem().id()] +=</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                          <span class="keyword">static_cast&lt;</span><a class="code" href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">ErrorVectorReal</a><span class="keyword">&gt;</span>(<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a28cc78a25a550e30504bfef7402398d3">fine_error</a>);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                        error_per_cell[coarse_context-&gt;get_elem().id()] +=</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                          <span class="keyword">static_cast&lt;</span><a class="code" href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">ErrorVectorReal</a><span class="keyword">&gt;</span>(<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a5999107dbf9dfc4166e59cdc6e1c24fe">coarse_error</a>);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                      }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                  <span class="comment">// Keep track of the number of internal flux</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                  <span class="comment">// sides found on each element</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                  <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a4edf0ef12588e39bb85d8dea4e7d560d">scale_by_n_flux_faces</a>)</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                    {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                      n_flux_faces[<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;get_elem().id()]++;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                      n_flux_faces[coarse_context-&gt;get_elem().id()] +=</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                        this-&gt;<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a00b086850721807623cae109806ce189">coarse_n_flux_faces_increment</a>();</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                    }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                } <span class="comment">// end if (case1 || case2)</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            } <span class="comment">// if (e-&gt;neighbor(n_e) != nullptr)</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;          <span class="comment">// Otherwise, e is on the boundary.  If it happens to</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;          <span class="comment">// be on a Dirichlet boundary, we need not do anything.</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;          <span class="comment">// On the other hand, if e is on a Neumann (flux) boundary</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;          <span class="comment">// with grad(u).n = g, we need to compute the additional residual</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;          <span class="comment">// (h * \int |g - grad(u_h).n|^2 dS)^(1/2).</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;          <span class="comment">// We can only do this with some knowledge of the boundary</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;          <span class="comment">// conditions, i.e. the user must have attached an appropriate</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;          <span class="comment">// BC function.</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a5407898d65d3aeeaeada1786234e5de4">integrate_boundary_sides</a>)</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;              <span class="keywordtype">bool</span> found_boundary_flux = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;              <span class="keywordflow">for</span> (<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>=0; <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>&lt;<a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>; <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>++)</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a>.<a class="code" href="classlibMesh_1_1SystemNorm.html#ac8a59940264314511d0e4f253433e76b">weight</a>(<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>) != 0.0 &amp;&amp;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                    system.variable_type(<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>).family != <a class="code" href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">SCALAR</a>)</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a32d9097610a87627382c5ea81a70d0b1">boundary_side_integration</a>())</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                    {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                      error_per_cell[<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;get_elem().id()] +=</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                        <span class="keyword">static_cast&lt;</span><a class="code" href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">ErrorVectorReal</a><span class="keyword">&gt;</span>(<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a28cc78a25a550e30504bfef7402398d3">fine_error</a>);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                      found_boundary_flux = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                    }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a4edf0ef12588e39bb85d8dea4e7d560d">scale_by_n_flux_faces</a> &amp;&amp; found_boundary_flux)</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                n_flux_faces[<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;get_elem().id()]++;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            } <span class="comment">// end if (e-&gt;neighbor_ptr(n_e) == nullptr)</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        } <span class="comment">// end loop over neighbors</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    } <span class="comment">// End loop over active local elements</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="comment">// Each processor has now computed the error contributions</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="comment">// for its local elements.  We need to sum the vector</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="comment">// and then take the square-root of each component.  Note</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="comment">// that we only need to sum if we are running on multiple</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="comment">// processors, and we only need to take the square-root</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="comment">// if the value is nonzero.  There will in general be many</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="comment">// zeros for the inactive elements.</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="comment">// First sum the vector of estimated error values</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#ac29685e2e9f05123fd4d6db97326a2a9">reduce_error</a>(error_per_cell, system.comm());</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="comment">// Compute the square-root of each component.</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : <a class="code" href="namespacelibMesh.html#a26e38c0dc87c05a5e8df7e26bfed543b">index_range</a>(error_per_cell))</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">if</span> (error_per_cell[i] != 0.)</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      error_per_cell[i] = <a class="code" href="namespacestd.html#a5e539986868ffa7c4c08ef163cae5266">std::sqrt</a>(error_per_cell[i]);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a4edf0ef12588e39bb85d8dea4e7d560d">scale_by_n_flux_faces</a>)</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    {</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <span class="comment">// Sum the vector of flux face counts</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#ac29685e2e9f05123fd4d6db97326a2a9">reduce_error</a>(n_flux_faces, system.comm());</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <span class="comment">// Sanity check: Make sure the number of flux faces is</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <span class="comment">// always an integer value</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="preprocessor"></span>      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; val : n_flux_faces)</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        libmesh_assert_equal_to (val, static_cast&lt;float&gt;(static_cast&lt;unsigned int&gt;(val)));</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      <span class="comment">// Scale the error by the number of flux faces for each element</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : <a class="code" href="namespacelibMesh.html#a26e38c0dc87c05a5e8df7e26bfed543b">index_range</a>(n_flux_faces))</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;          <span class="keywordflow">if</span> (n_flux_faces[i] == 0.0) <span class="comment">// inactive or non-local element</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;          error_per_cell[i] /= <span class="keyword">static_cast&lt;</span><a class="code" href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">ErrorVectorReal</a><span class="keyword">&gt;</span>(n_flux_faces[i]);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        }</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="comment">// If we used a non-standard solution before, now is the time to fix</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  <span class="comment">// the current_local_solution</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="keywordflow">if</span> (solution_vector &amp;&amp; solution_vector != system.solution.<a class="code" href="classlibMesh_1_1NumericVector.html#a8eac3a527f0194feae3a9dd80c878df1">get</a>())</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <a class="code" href="namespacelibMesh.html#af63481288585b5ba172278c33c726667">NumericVector&lt;Number&gt;</a> * newsol =</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="keyword">const_cast&lt;</span><a class="code" href="namespacelibMesh.html#af63481288585b5ba172278c33c726667">NumericVector&lt;Number&gt;</a> *<span class="keyword">&gt;</span>(solution_vector);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      System &amp; sys = <span class="keyword">const_cast&lt;</span>System &amp;<span class="keyword">&gt;</span>(system);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      newsol-&gt;swap(*sys.solution);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      sys.update();</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c"><div class="ttname"><a href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">libMesh::SCALAR</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__fe__family_8h_source.html#l00058">enum_fe_family.h:58</a></div></div>
<div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_a9d626496b0b6f99f679c4ef4f0a5e46e"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">libMesh::ErrorEstimator::error_norm</a></div><div class="ttdeci">SystemNorm error_norm</div><div class="ttdoc">When estimating the error in a single system, the error_norm is used to control the scaling and norm ...</div><div class="ttdef"><b>Definition:</b> <a href="error__estimator_8h_source.html#l00158">error_estimator.h:158</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1ElemInternal_html_ae6fd90b811bfe28c8080668c5dd34d53"><div class="ttname"><a href="namespacelibMesh_1_1ElemInternal.html#ae6fd90b811bfe28c8080668c5dd34d53">libMesh::ElemInternal::active_family_tree_by_neighbor</a></div><div class="ttdeci">void active_family_tree_by_neighbor(T elem, std::vector&lt; T &gt; &amp;family, T neighbor_in, bool reset=true)</div><div class="ttdef"><b>Definition:</b> <a href="elem__internal_8h_source.html#l00320">elem_internal.h:320</a></div></div>
<div class="ttc" id="classlibMesh_1_1JumpErrorEstimator_html_ae38eda2aa4b373ade6e83467f3ebc1ef"><div class="ttname"><a href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">libMesh::JumpErrorEstimator::fine_context</a></div><div class="ttdeci">std::unique_ptr&lt; FEMContext &gt; fine_context</div><div class="ttdoc">Context objects for integrating on the fine and coarse elements sharing a face. </div><div class="ttdef"><b>Definition:</b> <a href="jump__error__estimator_8h_source.html#l00158">jump_error_estimator.h:158</a></div></div>
<div class="ttc" id="classlibMesh_1_1SystemNorm_html_ac8a59940264314511d0e4f253433e76b"><div class="ttname"><a href="classlibMesh_1_1SystemNorm.html#ac8a59940264314511d0e4f253433e76b">libMesh::SystemNorm::weight</a></div><div class="ttdeci">Real weight(unsigned int var) const </div><div class="ttdef"><b>Definition:</b> <a href="system__norm_8C_source.html#l00134">system_norm.C:134</a></div></div>
<div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_ac29685e2e9f05123fd4d6db97326a2a9"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#ac29685e2e9f05123fd4d6db97326a2a9">libMesh::ErrorEstimator::reduce_error</a></div><div class="ttdeci">void reduce_error(std::vector&lt; ErrorVectorReal &gt; &amp;error_per_cell, const Parallel::Communicator &amp;comm) const </div><div class="ttdoc">This method takes the local error contributions in error_per_cell from each processor and combines th...</div><div class="ttdef"><b>Definition:</b> <a href="error__estimator_8C_source.html#l00032">error_estimator.C:32</a></div></div>
<div class="ttc" id="classlibMesh_1_1JumpErrorEstimator_html_a5999107dbf9dfc4166e59cdc6e1c24fe"><div class="ttname"><a href="classlibMesh_1_1JumpErrorEstimator.html#a5999107dbf9dfc4166e59cdc6e1c24fe">libMesh::JumpErrorEstimator::coarse_error</a></div><div class="ttdeci">Real coarse_error</div><div class="ttdef"><b>Definition:</b> <a href="jump__error__estimator_8h_source.html#l00163">jump_error_estimator.h:163</a></div></div>
<div class="ttc" id="mesh__communication_8C_html_afaa03b874c297f4693d9cdef7f50f3c6"><div class="ttname"><a href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a></div><div class="ttdeci">MeshBase &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01308">mesh_communication.C:1308</a></div></div>
<div class="ttc" id="classlibMesh_1_1JumpErrorEstimator_html_a3518b201b4f8bb17a292be2701d76749"><div class="ttname"><a href="classlibMesh_1_1JumpErrorEstimator.html#a3518b201b4f8bb17a292be2701d76749">libMesh::JumpErrorEstimator::internal_side_integration</a></div><div class="ttdeci">virtual void internal_side_integration()=0</div><div class="ttdoc">The function, to be implemented by derived classes, which calculates an error term on an internal sid...</div></div>
<div class="ttc" id="namespacestd_html_a5e539986868ffa7c4c08ef163cae5266"><div class="ttname"><a href="namespacestd.html#a5e539986868ffa7c4c08ef163cae5266">std::sqrt</a></div><div class="ttdeci">ADRealEigenVector&lt; T, D, asd &gt; sqrt(const ADRealEigenVector&lt; T, D, asd &gt; &amp;)</div><div class="ttdoc">计算自动微分实数向量的平方根。 </div><div class="ttdef"><b>Definition:</b> <a href="type__vector_8h_source.html#l00088">type_vector.h:88</a></div></div>
<div class="ttc" id="tecplot__io_8C_html_ac001e4247887b98c2aa5b8ec5107ca0d"><div class="ttname"><a href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a></div><div class="ttdeci">const unsigned int n_vars</div><div class="ttdef"><b>Definition:</b> <a href="tecplot__io_8C_source.html#l00068">tecplot_io.C:68</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a26acf05f075521cbfb223db57e63d6d0"><div class="ttname"><a href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">libMesh::ErrorVectorReal</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef float ErrorVectorReal</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00225">libmesh_common.h:225</a></div></div>
<div class="ttc" id="classlibMesh_1_1FEGenericBase_html_a3024e8290899e60cd900365414cc1e21"><div class="ttname"><a href="classlibMesh_1_1FEGenericBase.html#a3024e8290899e60cd900365414cc1e21">libMesh::FEGenericBase::coarsened_dof_values</a></div><div class="ttdeci">static void coarsened_dof_values(const NumericVector&lt; Number &gt; &amp;global_vector, const DofMap &amp;dof_map, const Elem *coarse_elem, DenseVector&lt; Number &gt; &amp;coarse_dofs, const unsigned int var, const bool use_old_dof_indices=false)</div><div class="ttdoc">Creates a local projection on coarse_elem, based on the DoF values in global_vector for it&amp;#39;s children...</div><div class="ttdef"><b>Definition:</b> <a href="fe__base_8C_source.html#l00976">fe_base.C:976</a></div></div>
<div class="ttc" id="classlibMesh_1_1JumpErrorEstimator_html_a6ce39bedb72e4b8c5b5f3403c4ad162d"><div class="ttname"><a href="classlibMesh_1_1JumpErrorEstimator.html#a6ce39bedb72e4b8c5b5f3403c4ad162d">libMesh::JumpErrorEstimator::reinit_sides</a></div><div class="ttdeci">void reinit_sides()</div><div class="ttdoc">A utility function to reinit the finite element data on elements sharing a side. </div><div class="ttdef"><b>Definition:</b> <a href="jump__error__estimator_8C_source.html#l00450">jump_error_estimator.C:450</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a43f45640aab1af26176e69592c666432"><div class="ttname"><a href="namespacelibMesh.html#a43f45640aab1af26176e69592c666432">libMesh::libmesh_ignore</a></div><div class="ttdeci">void libmesh_ignore(const Args &amp;...)</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00516">libmesh_common.h:516</a></div></div>
<div class="ttc" id="classlibMesh_1_1JumpErrorEstimator_html_a32d9097610a87627382c5ea81a70d0b1"><div class="ttname"><a href="classlibMesh_1_1JumpErrorEstimator.html#a32d9097610a87627382c5ea81a70d0b1">libMesh::JumpErrorEstimator::boundary_side_integration</a></div><div class="ttdeci">virtual bool boundary_side_integration()</div><div class="ttdoc">The function, to be implemented by derived classes, which calculates an error term on a boundary side...</div><div class="ttdef"><b>Definition:</b> <a href="jump__error__estimator_8h_source.html#l00146">jump_error_estimator.h:146</a></div></div>
<div class="ttc" id="classlibMesh_1_1JumpErrorEstimator_html_ab7f203c19f25ccbb259f793064f5014f"><div class="ttname"><a href="classlibMesh_1_1JumpErrorEstimator.html#ab7f203c19f25ccbb259f793064f5014f">libMesh::JumpErrorEstimator::coarse_context</a></div><div class="ttdeci">std::unique_ptr&lt; FEMContext &gt; coarse_context</div><div class="ttdef"><b>Definition:</b> <a href="jump__error__estimator_8h_source.html#l00158">jump_error_estimator.h:158</a></div></div>
<div class="ttc" id="namespacelibMesh_html_adf7aee34b8c6fe4be28c90fe132a73a0"><div class="ttname"><a href="namespacelibMesh.html#adf7aee34b8c6fe4be28c90fe132a73a0">libMesh::FEBase</a></div><div class="ttdeci">FEGenericBase&lt; Real &gt; FEBase</div><div class="ttdef"><b>Definition:</b> <a href="exact__error__estimator_8h_source.html#l00039">exact_error_estimator.h:39</a></div></div>
<div class="ttc" id="classlibMesh_1_1JumpErrorEstimator_html_a28cc78a25a550e30504bfef7402398d3"><div class="ttname"><a href="classlibMesh_1_1JumpErrorEstimator.html#a28cc78a25a550e30504bfef7402398d3">libMesh::JumpErrorEstimator::fine_error</a></div><div class="ttdeci">Real fine_error</div><div class="ttdoc">The fine and coarse error values to be set by each side_integration();. </div><div class="ttdef"><b>Definition:</b> <a href="jump__error__estimator_8h_source.html#l00163">jump_error_estimator.h:163</a></div></div>
<div class="ttc" id="classlibMesh_1_1NumericVector_html_a8eac3a527f0194feae3a9dd80c878df1"><div class="ttname"><a href="classlibMesh_1_1NumericVector.html#a8eac3a527f0194feae3a9dd80c878df1">libMesh::NumericVector::get</a></div><div class="ttdeci">virtual void get(const std::vector&lt; numeric_index_type &gt; &amp;index, T *values) const </div><div class="ttdoc">一次访问多个组件。 values 将 *不会* 重新分配空间；它应该已经具有足够的空间。 默认实现对每个索引调用 operator() ，但某些实现可能在此处提供更快的方法。 ...</div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8h_source.html#l01012">numeric_vector.h:1012</a></div></div>
<div class="ttc" id="classlibMesh_1_1JumpErrorEstimator_html_a00b086850721807623cae109806ce189"><div class="ttname"><a href="classlibMesh_1_1JumpErrorEstimator.html#a00b086850721807623cae109806ce189">libMesh::JumpErrorEstimator::coarse_n_flux_faces_increment</a></div><div class="ttdeci">float coarse_n_flux_faces_increment()</div><div class="ttdoc">A utility function to correctly increase n_flux_faces for the coarse element. </div><div class="ttdef"><b>Definition:</b> <a href="jump__error__estimator_8C_source.html#l00488">jump_error_estimator.C:488</a></div></div>
<div class="ttc" id="classlibMesh_1_1JumpErrorEstimator_html_a203fe804a4341ea7633f0dad9cc128d1"><div class="ttname"><a href="classlibMesh_1_1JumpErrorEstimator.html#a203fe804a4341ea7633f0dad9cc128d1">libMesh::JumpErrorEstimator::use_unweighted_quadrature_rules</a></div><div class="ttdeci">bool use_unweighted_quadrature_rules</div><div class="ttdoc">This boolean flag allows you to use &amp;quot;unweighted&amp;quot; quadrature rules (sized to exactly integrate unweigh...</div><div class="ttdef"><b>Definition:</b> <a href="jump__error__estimator_8h_source.html#l00113">jump_error_estimator.h:113</a></div></div>
<div class="ttc" id="classlibMesh_1_1JumpErrorEstimator_html_a05b93294744b2b7a95dc593d7ab122bf"><div class="ttname"><a href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">libMesh::JumpErrorEstimator::var</a></div><div class="ttdeci">unsigned int var</div><div class="ttdoc">The variable number currently being evaluated. </div><div class="ttdef"><b>Definition:</b> <a href="jump__error__estimator_8h_source.html#l00168">jump_error_estimator.h:168</a></div></div>
<div class="ttc" id="classlibMesh_1_1JumpErrorEstimator_html_a4edf0ef12588e39bb85d8dea4e7d560d"><div class="ttname"><a href="classlibMesh_1_1JumpErrorEstimator.html#a4edf0ef12588e39bb85d8dea4e7d560d">libMesh::JumpErrorEstimator::scale_by_n_flux_faces</a></div><div class="ttdeci">bool scale_by_n_flux_faces</div><div class="ttdoc">This boolean flag allows you to scale the error indicator result for each element by the number of &amp;quot;f...</div><div class="ttdef"><b>Definition:</b> <a href="jump__error__estimator_8h_source.html#l00099">jump_error_estimator.h:99</a></div></div>
<div class="ttc" id="classlibMesh_1_1JumpErrorEstimator_html_a5407898d65d3aeeaeada1786234e5de4"><div class="ttname"><a href="classlibMesh_1_1JumpErrorEstimator.html#a5407898d65d3aeeaeada1786234e5de4">libMesh::JumpErrorEstimator::integrate_boundary_sides</a></div><div class="ttdeci">bool integrate_boundary_sides</div><div class="ttdoc">A boolean flag, by default false, to be set to true if integrations with boundary_side_integration() ...</div><div class="ttdef"><b>Definition:</b> <a href="jump__error__estimator_8h_source.html#l00152">jump_error_estimator.h:152</a></div></div>
<div class="ttc" id="namespacelibMesh_html_af63481288585b5ba172278c33c726667"><div class="ttname"><a href="namespacelibMesh.html#af63481288585b5ba172278c33c726667">libMesh::NumericVector&lt; Number &gt;</a></div><div class="ttdeci">template class LIBMESH_EXPORT NumericVector&lt; Number &gt;</div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8C_source.html#l00436">numeric_vector.C:436</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a26e38c0dc87c05a5e8df7e26bfed543b"><div class="ttname"><a href="namespacelibMesh.html#a26e38c0dc87c05a5e8df7e26bfed543b">libMesh::index_range</a></div><div class="ttdeci">auto index_range(const T &amp;sizable)</div><div class="ttdoc">Helper function that returns an IntRange&amp;lt;std::size_t&amp;gt; representing all the indices of the passed-in v...</div><div class="ttdef"><b>Definition:</b> <a href="int__range_8h_source.html#l00111">int_range.h:111</a></div></div>
<div class="ttc" id="classlibMesh_1_1JumpErrorEstimator_html_aaa89b26b02d41e6540c886bcf9dd98ca"><div class="ttname"><a href="classlibMesh_1_1JumpErrorEstimator.html#aaa89b26b02d41e6540c886bcf9dd98ca">libMesh::JumpErrorEstimator::init_context</a></div><div class="ttdeci">virtual void init_context(FEMContext &amp;c)</div><div class="ttdoc">An initialization function, to give derived classes a chance to request specific data from the FE obj...</div><div class="ttdef"><b>Definition:</b> <a href="jump__error__estimator_8C_source.html#l00048">jump_error_estimator.C:48</a></div></div>
<div class="ttc" id="namespacelibMesh_html_ab4541d74809228310a715b11c40587fc"><div class="ttname"><a href="namespacelibMesh.html#ab4541d74809228310a715b11c40587fc">libMesh::dof_id_type</a></div><div class="ttdeci">uint8_t dof_id_type</div><div class="ttdef"><b>Definition:</b> <a href="id__types_8h_source.html#l00067">id_types.h:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aad575aa2606bb47551e562a290499df0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::ErrorEstimator::estimate_errors </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1EquationSystems.html">EquationSystems</a> &amp;&#160;</td>
          <td class="paramname"><em>equation_systems</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;&#160;</td>
          <td class="paramname"><em>error_per_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, <a class="el" href="classlibMesh_1_1SystemNorm.html">SystemNorm</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>error_norms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; * &gt; *&#160;</td>
          <td class="paramname"><em>solution_vectors</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>estimate_parent_error</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This virtual function can be redefined in derived classes, but by default computes the sum of the error_per_cell for each system in the equation_systems. </p>
<p>Currently this function ignores the error_norm member variable, and uses the function argument error_norms instead.</p>
<p>This function is named estimate_errors instead of estimate_error because otherwise C++ can get confused. </p>

<p>被 <a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html#a41eeb5e8506a3489f913e1d3ec9c30b0">libMesh::UniformRefinementEstimator</a> 重载.</p>

<p>在文件 <a class="el" href="error__estimator_8C_source.html">error_estimator.C</a> 第 <a class="el" href="error__estimator_8C_source.html#l00047">47</a> 行定义.</p>

<p>参考 <a class="el" href="error__estimator_8h_source.html#l00158">libMesh::ErrorEstimator::error_norm</a>, <a class="el" href="classlibMesh_1_1ErrorEstimator.html#ab5ee8217ac35baaa00cc3b72e9815d93">libMesh::ErrorEstimator::estimate_error()</a>, <a class="el" href="equation__systems_8h_source.html#l00745">libMesh::EquationSystems::get_system()</a>, <a class="el" href="int__range_8h_source.html#l00111">libMesh::index_range()</a>, <a class="el" href="int__range_8h_source.html#l00134">libMesh::make_range()</a> , 以及 <a class="el" href="equation__systems_8h_source.html#l00649">libMesh::EquationSystems::n_systems()</a>.</p>
<div class="fragment"><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;{</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  SystemNorm old_error_norm = this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="comment">// Sum the error values from each system</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> s : <a class="code" href="namespacelibMesh.html#a18dea64f5cc7fa12c864d7571bb69d0b">make_range</a>(equation_systems.n_systems()))</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      ErrorVector system_error_per_cell;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keyword">const</span> System &amp; sys = equation_systems.get_system(s);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="keywordflow">if</span> (error_norms.find(&amp;sys) == error_norms.end())</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a> = old_error_norm;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a> = error_norms.find(&amp;sys)-&gt;second;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#af63481288585b5ba172278c33c726667">NumericVector&lt;Number&gt;</a> * solution_vector = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordflow">if</span> (solution_vectors &amp;&amp;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;          solution_vectors-&gt;find(&amp;sys) != solution_vectors-&gt;end())</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        solution_vector = solution_vectors-&gt;find(&amp;sys)-&gt;second;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#ab5ee8217ac35baaa00cc3b72e9815d93">estimate_error</a>(sys, system_error_per_cell,</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                           solution_vector, estimate_parent_error);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="keywordflow">if</span> (s)</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;          libmesh_assert_equal_to (error_per_cell.size(), system_error_per_cell.size());</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : <a class="code" href="namespacelibMesh.html#a26e38c0dc87c05a5e8df7e26bfed543b">index_range</a>(error_per_cell))</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            error_per_cell[i] += system_error_per_cell[i];</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        error_per_cell = system_error_per_cell;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">// Restore our old state before returning</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a> = old_error_norm;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_a9d626496b0b6f99f679c4ef4f0a5e46e"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">libMesh::ErrorEstimator::error_norm</a></div><div class="ttdeci">SystemNorm error_norm</div><div class="ttdoc">When estimating the error in a single system, the error_norm is used to control the scaling and norm ...</div><div class="ttdef"><b>Definition:</b> <a href="error__estimator_8h_source.html#l00158">error_estimator.h:158</a></div></div>
<div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_ab5ee8217ac35baaa00cc3b72e9815d93"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#ab5ee8217ac35baaa00cc3b72e9815d93">libMesh::ErrorEstimator::estimate_error</a></div><div class="ttdeci">virtual void estimate_error(const System &amp;system, ErrorVector &amp;error_per_cell, const NumericVector&lt; Number &gt; *solution_vector=nullptr, bool estimate_parent_error=false)=0</div><div class="ttdoc">This pure virtual function must be redefined in derived classes to compute the error for each active ...</div></div>
<div class="ttc" id="namespacelibMesh_html_a18dea64f5cc7fa12c864d7571bb69d0b"><div class="ttname"><a href="namespacelibMesh.html#a18dea64f5cc7fa12c864d7571bb69d0b">libMesh::make_range</a></div><div class="ttdeci">IntRange&lt; T &gt; make_range(T beg, T end)</div><div class="ttdoc">The 2-parameter make_range() helper function returns an IntRange&amp;lt;T&amp;gt; when both input parameters are of...</div><div class="ttdef"><b>Definition:</b> <a href="int__range_8h_source.html#l00134">int_range.h:134</a></div></div>
<div class="ttc" id="namespacelibMesh_html_af63481288585b5ba172278c33c726667"><div class="ttname"><a href="namespacelibMesh.html#af63481288585b5ba172278c33c726667">libMesh::NumericVector&lt; Number &gt;</a></div><div class="ttdeci">template class LIBMESH_EXPORT NumericVector&lt; Number &gt;</div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8C_source.html#l00436">numeric_vector.C:436</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a26e38c0dc87c05a5e8df7e26bfed543b"><div class="ttname"><a href="namespacelibMesh.html#a26e38c0dc87c05a5e8df7e26bfed543b">libMesh::index_range</a></div><div class="ttdeci">auto index_range(const T &amp;sizable)</div><div class="ttdoc">Helper function that returns an IntRange&amp;lt;std::size_t&amp;gt; representing all the indices of the passed-in v...</div><div class="ttdef"><b>Definition:</b> <a href="int__range_8h_source.html#l00111">int_range.h:111</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6bf8e0fb666d439804046465cf443867"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::ErrorEstimator::estimate_errors </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1EquationSystems.html">EquationSystems</a> &amp;&#160;</td>
          <td class="paramname"><em>equation_systems</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1ErrorEstimator.html#ab37d862060bbddf77099b6e34c62ef71">ErrorMap</a> &amp;&#160;</td>
          <td class="paramname"><em>errors_per_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; * &gt; *&#160;</td>
          <td class="paramname"><em>solution_vectors</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>estimate_parent_error</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This virtual function can be redefined in derived classes, but by default it calls estimate_error repeatedly to calculate the requested error vectors. </p>
<p>FIXME: This is a default implementation - derived classes should reimplement it for efficiency.</p>
<p>Currently this function ignores the <a class="el" href="namespacelibMesh_1_1MeshTools.html#a0701de7f01fd5eced3da4a332ff5ae51">error_norm.weight()</a> values because it calculates each variable's error individually, unscaled.</p>
<p>The user selects which errors get computed by filling a map with error vectors: If errors_per_cell[&amp;system][v] exists, it will be filled with the error values in variable <code>v</code> of <code>system</code> </p>

<p>被 <a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html#a676215e74e7c4517162b4431835453a4">libMesh::UniformRefinementEstimator</a> 重载.</p>

<p>在文件 <a class="el" href="error__estimator_8C_source.html">error_estimator.C</a> 第 <a class="el" href="error__estimator_8C_source.html#l00093">93</a> 行定义.</p>

<p>参考 <a class="el" href="error__estimator_8h_source.html#l00158">libMesh::ErrorEstimator::error_norm</a>, <a class="el" href="classlibMesh_1_1ErrorEstimator.html#ab5ee8217ac35baaa00cc3b72e9815d93">libMesh::ErrorEstimator::estimate_error()</a>, <a class="el" href="equation__systems_8h_source.html#l00745">libMesh::EquationSystems::get_system()</a>, <a class="el" href="int__range_8h_source.html#l00134">libMesh::make_range()</a>, <a class="el" href="equation__systems_8h_source.html#l00649">libMesh::EquationSystems::n_systems()</a>, <a class="el" href="tecplot__io_8C_source.html#l00068">n_vars</a>, <a class="el" href="system_8h_source.html#l02349">libMesh::System::n_vars()</a> , 以及 <a class="el" href="system__norm_8C_source.html#l00112">libMesh::SystemNorm::type()</a>.</p>
<div class="fragment"><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;{</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  SystemNorm old_error_norm = this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="comment">// Find the requested error values from each system</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> s : <a class="code" href="namespacelibMesh.html#a18dea64f5cc7fa12c864d7571bb69d0b">make_range</a>(equation_systems.n_systems()))</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="keyword">const</span> System &amp; sys = equation_systems.get_system(s);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a> = sys.n_vars();</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v != <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>; ++v)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;          <span class="comment">// Only fill in ErrorVectors the user asks for</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;          <span class="keywordflow">if</span> (!errors_per_cell.count(std::make_pair(&amp;sys, v)))</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;          <span class="comment">// Calculate error in only one variable</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;          std::vector&lt;Real&gt; weights(n_vars, 0.0);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;          weights[v] = 1.0;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a> =</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            SystemNorm(std::vector&lt;FEMNormType&gt;(n_vars, old_error_norm.type(v)),</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                       weights);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#af63481288585b5ba172278c33c726667">NumericVector&lt;Number&gt;</a> * solution_vector = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;          <span class="keywordflow">if</span> (solution_vectors &amp;&amp;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;              solution_vectors-&gt;find(&amp;sys) != solution_vectors-&gt;end())</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            solution_vector = solution_vectors-&gt;find(&amp;sys)-&gt;second;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#ab5ee8217ac35baaa00cc3b72e9815d93">estimate_error</a></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            (sys, *errors_per_cell[std::make_pair(&amp;sys, v)],</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;             solution_vector, estimate_parent_error);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="comment">// Restore our old state before returning</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a> = old_error_norm;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_a9d626496b0b6f99f679c4ef4f0a5e46e"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">libMesh::ErrorEstimator::error_norm</a></div><div class="ttdeci">SystemNorm error_norm</div><div class="ttdoc">When estimating the error in a single system, the error_norm is used to control the scaling and norm ...</div><div class="ttdef"><b>Definition:</b> <a href="error__estimator_8h_source.html#l00158">error_estimator.h:158</a></div></div>
<div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_ab5ee8217ac35baaa00cc3b72e9815d93"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#ab5ee8217ac35baaa00cc3b72e9815d93">libMesh::ErrorEstimator::estimate_error</a></div><div class="ttdeci">virtual void estimate_error(const System &amp;system, ErrorVector &amp;error_per_cell, const NumericVector&lt; Number &gt; *solution_vector=nullptr, bool estimate_parent_error=false)=0</div><div class="ttdoc">This pure virtual function must be redefined in derived classes to compute the error for each active ...</div></div>
<div class="ttc" id="tecplot__io_8C_html_ac001e4247887b98c2aa5b8ec5107ca0d"><div class="ttname"><a href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a></div><div class="ttdeci">const unsigned int n_vars</div><div class="ttdef"><b>Definition:</b> <a href="tecplot__io_8C_source.html#l00068">tecplot_io.C:68</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a18dea64f5cc7fa12c864d7571bb69d0b"><div class="ttname"><a href="namespacelibMesh.html#a18dea64f5cc7fa12c864d7571bb69d0b">libMesh::make_range</a></div><div class="ttdeci">IntRange&lt; T &gt; make_range(T beg, T end)</div><div class="ttdoc">The 2-parameter make_range() helper function returns an IntRange&amp;lt;T&amp;gt; when both input parameters are of...</div><div class="ttdef"><b>Definition:</b> <a href="int__range_8h_source.html#l00134">int_range.h:134</a></div></div>
<div class="ttc" id="namespacelibMesh_html_af63481288585b5ba172278c33c726667"><div class="ttname"><a href="namespacelibMesh.html#af63481288585b5ba172278c33c726667">libMesh::NumericVector&lt; Number &gt;</a></div><div class="ttdeci">template class LIBMESH_EXPORT NumericVector&lt; Number &gt;</div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8C_source.html#l00436">numeric_vector.C:436</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aae0c22664d6487c8659656a255226e40"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DiscontinuityMeasure::init_context </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1FEMContext.html">FEMContext</a> &amp;&#160;</td>
          <td class="paramname"><em>c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>An initialization function, for requesting specific data from the <a class="el" href="classlibMesh_1_1FE.html" title="A specific instantiation of the FEBase class. ">FE</a> objects. </p>

<p>重载 <a class="el" href="classlibMesh_1_1JumpErrorEstimator.html#aaa89b26b02d41e6540c886bcf9dd98ca">libMesh::JumpErrorEstimator</a> .</p>

<p>在文件 <a class="el" href="discontinuity__measure_8C_source.html">discontinuity_measure.C</a> 第 <a class="el" href="discontinuity__measure_8C_source.html#l00059">59</a> 行定义.</p>

<p>参考 <a class="el" href="fem__context_8h_source.html#l00951">libMesh::FEMContext::elem_dimensions()</a>, <a class="el" href="error__estimator_8h_source.html#l00158">libMesh::ErrorEstimator::error_norm</a>, <a class="el" href="fe__base_8h_source.html#l00207">libMesh::FEGenericBase&lt; T &gt;::get_phi()</a>, <a class="el" href="fem__context_8h_source.html#l00317">libMesh::FEMContext::get_side_fe()</a>, <a class="el" href="tecplot__io_8C_source.html#l00068">n_vars</a>, <a class="el" href="diff__context_8h_source.html#l00090">libMesh::DiffContext::n_vars()</a> , 以及 <a class="el" href="system__norm_8C_source.html#l00134">libMesh::SystemNorm::weight()</a>.</p>
<div class="fragment"><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;{</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a> = c.n_vars();</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v=0; v&lt;<a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>; v++)</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    {</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="comment">// Possibly skip this variable</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a>.<a class="code" href="classlibMesh_1_1SystemNorm.html#ac8a59940264314511d0e4f253433e76b">weight</a>(v) == 0.0) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <span class="comment">// FIXME: Need to generalize this to vector-valued elements. [PB]</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <a class="code" href="namespacelibMesh.html#adf7aee34b8c6fe4be28c90fe132a73a0">FEBase</a> * side_fe = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="keyword">const</span> std::set&lt;unsigned char&gt; &amp; elem_dims =</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        c.elem_dimensions();</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp; dim : elem_dims)</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;          c.get_side_fe( v, side_fe, dim );</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;          <span class="comment">// We&#39;ll need values on both sides for discontinuity computation</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;          side_fe-&gt;get_phi();</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_a9d626496b0b6f99f679c4ef4f0a5e46e"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">libMesh::ErrorEstimator::error_norm</a></div><div class="ttdeci">SystemNorm error_norm</div><div class="ttdoc">When estimating the error in a single system, the error_norm is used to control the scaling and norm ...</div><div class="ttdef"><b>Definition:</b> <a href="error__estimator_8h_source.html#l00158">error_estimator.h:158</a></div></div>
<div class="ttc" id="classlibMesh_1_1SystemNorm_html_ac8a59940264314511d0e4f253433e76b"><div class="ttname"><a href="classlibMesh_1_1SystemNorm.html#ac8a59940264314511d0e4f253433e76b">libMesh::SystemNorm::weight</a></div><div class="ttdeci">Real weight(unsigned int var) const </div><div class="ttdef"><b>Definition:</b> <a href="system__norm_8C_source.html#l00134">system_norm.C:134</a></div></div>
<div class="ttc" id="tecplot__io_8C_html_ac001e4247887b98c2aa5b8ec5107ca0d"><div class="ttname"><a href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a></div><div class="ttdeci">const unsigned int n_vars</div><div class="ttdef"><b>Definition:</b> <a href="tecplot__io_8C_source.html#l00068">tecplot_io.C:68</a></div></div>
<div class="ttc" id="namespacelibMesh_html_adf7aee34b8c6fe4be28c90fe132a73a0"><div class="ttname"><a href="namespacelibMesh.html#adf7aee34b8c6fe4be28c90fe132a73a0">libMesh::FEBase</a></div><div class="ttdeci">FEGenericBase&lt; Real &gt; FEBase</div><div class="ttdef"><b>Definition:</b> <a href="exact__error__estimator_8h_source.html#l00039">exact_error_estimator.h:39</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6aacf9c7c291bdae135aae000975dd9a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::DiscontinuityMeasure::internal_side_integration </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The function which calculates a normal derivative jump based error term on an internal side. </p>

<p>实现了 <a class="el" href="classlibMesh_1_1JumpErrorEstimator.html#a3518b201b4f8bb17a292be2701d76749">libMesh::JumpErrorEstimator</a>.</p>

<p>在文件 <a class="el" href="discontinuity__measure_8C_source.html">discontinuity_measure.C</a> 第 <a class="el" href="discontinuity__measure_8C_source.html#l00086">86</a> 行定义.</p>

<p>参考 <a class="el" href="jump__error__estimator_8h_source.html#l00158">libMesh::JumpErrorEstimator::coarse_context</a>, <a class="el" href="jump__error__estimator_8h_source.html#l00163">libMesh::JumpErrorEstimator::coarse_error</a>, <a class="el" href="classlibMesh_1_1Elem.html#a90a7ca1f28a92f659ab6f8cdef91d806">libMesh::Elem::dim()</a>, <a class="el" href="error__estimator_8h_source.html#l00158">libMesh::ErrorEstimator::error_norm</a>, <a class="el" href="jump__error__estimator_8h_source.html#l00158">libMesh::JumpErrorEstimator::fine_context</a>, <a class="el" href="jump__error__estimator_8h_source.html#l00163">libMesh::JumpErrorEstimator::fine_error</a>, <a class="el" href="fe__abstract_8h_source.html#l00295">libMesh::FEAbstract::get_JxW()</a>, <a class="el" href="fe__base_8h_source.html#l00207">libMesh::FEGenericBase&lt; T &gt;::get_phi()</a>, <a class="el" href="elem_8C_source.html#l00531">libMesh::Elem::hmax()</a>, <a class="el" href="classlibMesh_1_1FEAbstract.html#a621286e4f4f0474c9367caeec9b6b305">libMesh::FEAbstract::n_quadrature_points()</a>, <a class="el" href="tensor__tools_8h_source.html#l00074">libMesh::TensorTools::norm_sq()</a>, <a class="el" href="libmesh__common_8h_source.html#l00143">libMesh::Real</a>, <a class="el" href="jump__error__estimator_8h_source.html#l00168">libMesh::JumpErrorEstimator::var</a> , 以及 <a class="el" href="system__norm_8C_source.html#l00134">libMesh::SystemNorm::weight()</a>.</p>
<div class="fragment"><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;{</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keyword">const</span> Elem &amp; coarse_elem = <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ab7f203c19f25ccbb259f793064f5014f">coarse_context</a>-&gt;get_elem();</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keyword">const</span> Elem &amp; fine_elem = <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;get_elem();</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <a class="code" href="namespacelibMesh.html#adf7aee34b8c6fe4be28c90fe132a73a0">FEBase</a> * fe_fine = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;get_side_fe( <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>, fe_fine, fine_elem.dim() );</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <a class="code" href="namespacelibMesh.html#adf7aee34b8c6fe4be28c90fe132a73a0">FEBase</a> * fe_coarse = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ab7f203c19f25ccbb259f793064f5014f">coarse_context</a>-&gt;get_side_fe( <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>, fe_coarse, fine_elem.dim() );</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> error = 1.e-30;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_qp = fe_fine-&gt;n_quadrature_points();</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  std::vector&lt;std::vector&lt;Real&gt;&gt; phi_coarse = fe_coarse-&gt;get_phi();</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  std::vector&lt;std::vector&lt;Real&gt;&gt; phi_fine = fe_fine-&gt;get_phi();</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  std::vector&lt;Real&gt; JxW_face = fe_fine-&gt;get_JxW();</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> qp=0; qp != n_qp; ++qp)</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <span class="comment">// Calculate solution values on fine and coarse elements</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <span class="comment">// at this quadrature point</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        u_fine   = <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;side_value(<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>, qp),</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        u_coarse = <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ab7f203c19f25ccbb259f793064f5014f">coarse_context</a>-&gt;side_value(<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>, qp);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="comment">// Find the jump in the value</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="comment">// at this quadrature point</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> jump = u_fine - u_coarse;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> jump2 = <a class="code" href="namespacelibMesh_1_1TensorTools.html#aece0d041f4f91b393d2564f4a5e4b1ee">TensorTools::norm_sq</a>(jump);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="comment">// Accumulate the jump integral</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      error += JxW_face[qp] * jump2;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    }</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="comment">// Add the h-weighted jump integral to each error term</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a28cc78a25a550e30504bfef7402398d3">fine_error</a> =</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    error * fine_elem.hmax() * <a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a>.<a class="code" href="classlibMesh_1_1SystemNorm.html#ac8a59940264314511d0e4f253433e76b">weight</a>(<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a5999107dbf9dfc4166e59cdc6e1c24fe">coarse_error</a> =</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    error * coarse_elem.hmax() * <a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a>.<a class="code" href="classlibMesh_1_1SystemNorm.html#ac8a59940264314511d0e4f253433e76b">weight</a>(<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">var</a>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_a9d626496b0b6f99f679c4ef4f0a5e46e"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">libMesh::ErrorEstimator::error_norm</a></div><div class="ttdeci">SystemNorm error_norm</div><div class="ttdoc">When estimating the error in a single system, the error_norm is used to control the scaling and norm ...</div><div class="ttdef"><b>Definition:</b> <a href="error__estimator_8h_source.html#l00158">error_estimator.h:158</a></div></div>
<div class="ttc" id="classlibMesh_1_1JumpErrorEstimator_html_ae38eda2aa4b373ade6e83467f3ebc1ef"><div class="ttname"><a href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">libMesh::JumpErrorEstimator::fine_context</a></div><div class="ttdeci">std::unique_ptr&lt; FEMContext &gt; fine_context</div><div class="ttdoc">Context objects for integrating on the fine and coarse elements sharing a face. </div><div class="ttdef"><b>Definition:</b> <a href="jump__error__estimator_8h_source.html#l00158">jump_error_estimator.h:158</a></div></div>
<div class="ttc" id="classlibMesh_1_1SystemNorm_html_ac8a59940264314511d0e4f253433e76b"><div class="ttname"><a href="classlibMesh_1_1SystemNorm.html#ac8a59940264314511d0e4f253433e76b">libMesh::SystemNorm::weight</a></div><div class="ttdeci">Real weight(unsigned int var) const </div><div class="ttdef"><b>Definition:</b> <a href="system__norm_8C_source.html#l00134">system_norm.C:134</a></div></div>
<div class="ttc" id="classlibMesh_1_1JumpErrorEstimator_html_a5999107dbf9dfc4166e59cdc6e1c24fe"><div class="ttname"><a href="classlibMesh_1_1JumpErrorEstimator.html#a5999107dbf9dfc4166e59cdc6e1c24fe">libMesh::JumpErrorEstimator::coarse_error</a></div><div class="ttdeci">Real coarse_error</div><div class="ttdef"><b>Definition:</b> <a href="jump__error__estimator_8h_source.html#l00163">jump_error_estimator.h:163</a></div></div>
<div class="ttc" id="namespacelibMesh_1_1TensorTools_html_aece0d041f4f91b393d2564f4a5e4b1ee"><div class="ttname"><a href="namespacelibMesh_1_1TensorTools.html#aece0d041f4f91b393d2564f4a5e4b1ee">libMesh::TensorTools::norm_sq</a></div><div class="ttdeci">T norm_sq(std::complex&lt; T &gt; a)</div><div class="ttdef"><b>Definition:</b> <a href="tensor__tools_8h_source.html#l00074">tensor_tools.h:74</a></div></div>
<div class="ttc" id="classlibMesh_1_1JumpErrorEstimator_html_ab7f203c19f25ccbb259f793064f5014f"><div class="ttname"><a href="classlibMesh_1_1JumpErrorEstimator.html#ab7f203c19f25ccbb259f793064f5014f">libMesh::JumpErrorEstimator::coarse_context</a></div><div class="ttdeci">std::unique_ptr&lt; FEMContext &gt; coarse_context</div><div class="ttdef"><b>Definition:</b> <a href="jump__error__estimator_8h_source.html#l00158">jump_error_estimator.h:158</a></div></div>
<div class="ttc" id="namespacelibMesh_html_adf7aee34b8c6fe4be28c90fe132a73a0"><div class="ttname"><a href="namespacelibMesh.html#adf7aee34b8c6fe4be28c90fe132a73a0">libMesh::FEBase</a></div><div class="ttdeci">FEGenericBase&lt; Real &gt; FEBase</div><div class="ttdef"><b>Definition:</b> <a href="exact__error__estimator_8h_source.html#l00039">exact_error_estimator.h:39</a></div></div>
<div class="ttc" id="classlibMesh_1_1JumpErrorEstimator_html_a28cc78a25a550e30504bfef7402398d3"><div class="ttname"><a href="classlibMesh_1_1JumpErrorEstimator.html#a28cc78a25a550e30504bfef7402398d3">libMesh::JumpErrorEstimator::fine_error</a></div><div class="ttdeci">Real fine_error</div><div class="ttdoc">The fine and coarse error values to be set by each side_integration();. </div><div class="ttdef"><b>Definition:</b> <a href="jump__error__estimator_8h_source.html#l00163">jump_error_estimator.h:163</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aef28359fb4851abec08fc99cfbac118d"><div class="ttname"><a href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">libMesh::Real</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef LIBMESH_DEFAULT_SCALAR_TYPE Real</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00143">libmesh_common.h:143</a></div></div>
<div class="ttc" id="classlibMesh_1_1JumpErrorEstimator_html_a05b93294744b2b7a95dc593d7ab122bf"><div class="ttname"><a href="classlibMesh_1_1JumpErrorEstimator.html#a05b93294744b2b7a95dc593d7ab122bf">libMesh::JumpErrorEstimator::var</a></div><div class="ttdeci">unsigned int var</div><div class="ttdoc">The variable number currently being evaluated. </div><div class="ttdef"><b>Definition:</b> <a href="jump__error__estimator_8h_source.html#l00168">jump_error_estimator.h:168</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a8b17bf24a15bc292850c3a3894e2e8f9"><div class="ttname"><a href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">libMesh::Number</a></div><div class="ttdeci">Real Number</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00214">libmesh_common.h:214</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2a74542c2df6f0f7242ef024f7211d63"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1DiscontinuityMeasure.html">DiscontinuityMeasure</a>&amp; libMesh::DiscontinuityMeasure::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1DiscontinuityMeasure.html">DiscontinuityMeasure</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab0ee49bdcf8717cea14f64b1938af557"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1DiscontinuityMeasure.html">DiscontinuityMeasure</a>&amp; libMesh::DiscontinuityMeasure::operator= </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1DiscontinuityMeasure.html">DiscontinuityMeasure</a> &amp;&amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ac29685e2e9f05123fd4d6db97326a2a9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::ErrorEstimator::reduce_error </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">ErrorVectorReal</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>error_per_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Parallel::Communicator &amp;&#160;</td>
          <td class="paramname"><em>comm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This method takes the local error contributions in <code>error_per_cell</code> from each processor and combines them to get the global error vector. </p>

<p>在文件 <a class="el" href="error__estimator_8C_source.html">error_estimator.C</a> 第 <a class="el" href="error__estimator_8C_source.html#l00032">32</a> 行定义.</p>

<p>参考自 <a class="el" href="uniform__refinement__estimator_8C_source.html#l00119">libMesh::UniformRefinementEstimator::_estimate_error()</a>, <a class="el" href="patch__recovery__error__estimator_8C_source.html#l00154">libMesh::PatchRecoveryErrorEstimator::estimate_error()</a>, <a class="el" href="weighted__patch__recovery__error__estimator_8C_source.html#l00055">libMesh::WeightedPatchRecoveryErrorEstimator::estimate_error()</a>, <a class="el" href="jump__error__estimator_8C_source.html#l00056">libMesh::JumpErrorEstimator::estimate_error()</a>, <a class="el" href="adjoint__refinement__estimator_8C_source.html#l00091">libMesh::AdjointRefinementEstimator::estimate_error()</a> , 以及 <a class="el" href="exact__error__estimator_8C_source.html#l00188">libMesh::ExactErrorEstimator::estimate_error()</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;{</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="comment">// parallel_object_only();</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="comment">// Each processor has now computed the error contributions</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="comment">// for its local elements.  We may need to sum the vector to</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="comment">// recover the error for each element.</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  comm.sum(error_per_cell);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6ce39bedb72e4b8c5b5f3403c4ad162d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::JumpErrorEstimator::reinit_sides </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A utility function to reinit the finite element data on elements sharing a side. </p>

<p>在文件 <a class="el" href="jump__error__estimator_8C_source.html">jump_error_estimator.C</a> 第 <a class="el" href="jump__error__estimator_8C_source.html#l00450">450</a> 行定义.</p>

<p>参考 <a class="el" href="jump__error__estimator_8h_source.html#l00158">libMesh::JumpErrorEstimator::coarse_context</a>, <a class="el" href="error__estimator_8h_source.html#l00158">libMesh::ErrorEstimator::error_norm</a>, <a class="el" href="jump__error__estimator_8h_source.html#l00158">libMesh::JumpErrorEstimator::fine_context</a>, <a class="el" href="fe__map_8C_source.html#l01626">libMesh::FEMap::inverse_map()</a>, <a class="el" href="tecplot__io_8C_source.html#l00068">n_vars</a>, <a class="el" href="classlibMesh_1_1FEAbstract.html#ac0d116e8c8be017b411d4544c5fff433">libMesh::FEAbstract::reinit()</a>, <a class="el" href="enum__fe__family_8h_source.html#l00058">libMesh::SCALAR</a> , 以及 <a class="el" href="system__norm_8C_source.html#l00134">libMesh::SystemNorm::weight()</a>.</p>

<p>参考自 <a class="el" href="jump__error__estimator_8C_source.html#l00056">libMesh::JumpErrorEstimator::estimate_error()</a>.</p>
<div class="fragment"><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;{</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;side_fe_reinit();</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> dim = <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;get_elem().dim();</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  libmesh_assert_equal_to(dim, <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ab7f203c19f25ccbb259f793064f5014f">coarse_context</a>-&gt;get_elem().dim());</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;  <a class="code" href="namespacelibMesh.html#adf7aee34b8c6fe4be28c90fe132a73a0">FEBase</a> * fe_fine = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;get_side_fe( 0, fe_fine, dim );</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="comment">// Get the physical locations of the fine element quadrature points</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  std::vector&lt;Point&gt; qface_point = fe_fine-&gt;get_xyz();</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="comment">// Find the master quadrature point locations on the coarse element</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <a class="code" href="namespacelibMesh.html#adf7aee34b8c6fe4be28c90fe132a73a0">FEBase</a> * fe_coarse = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ab7f203c19f25ccbb259f793064f5014f">coarse_context</a>-&gt;get_side_fe( 0, fe_coarse, dim );</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  std::vector&lt;Point&gt; qp_coarse;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <a class="code" href="classlibMesh_1_1FEMap.html#ab1c33e2c2078d7b474470fed4a58d0af">FEMap::inverse_map</a> (<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ab7f203c19f25ccbb259f793064f5014f">coarse_context</a>-&gt;get_elem().dim(),</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                      &amp;<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ab7f203c19f25ccbb259f793064f5014f">coarse_context</a>-&gt;get_elem(), qface_point,</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                      qp_coarse);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="comment">// The number of variables in the system</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a> = <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;n_vars();</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="comment">// Calculate all coarse element shape functions at those locations</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v=0; v&lt;<a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>; v++)</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a>.<a class="code" href="classlibMesh_1_1SystemNorm.html#ac8a59940264314511d0e4f253433e76b">weight</a>(v) != 0.0 &amp;&amp;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">fine_context</a>-&gt;get_system().variable_type(v).family != <a class="code" href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">SCALAR</a>)</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      {</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ab7f203c19f25ccbb259f793064f5014f">coarse_context</a>-&gt;get_side_fe( v, fe_coarse, dim );</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        fe_coarse-&gt;reinit (&amp;<a class="code" href="classlibMesh_1_1JumpErrorEstimator.html#ab7f203c19f25ccbb259f793064f5014f">coarse_context</a>-&gt;get_elem(), &amp;qp_coarse);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c"><div class="ttname"><a href="namespacelibMesh.html#abcdbcd8364bf9fb7a67b3b4013031b2daefdbf95da65edcfa0cdb6c10eac5482c">libMesh::SCALAR</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__fe__family_8h_source.html#l00058">enum_fe_family.h:58</a></div></div>
<div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_a9d626496b0b6f99f679c4ef4f0a5e46e"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">libMesh::ErrorEstimator::error_norm</a></div><div class="ttdeci">SystemNorm error_norm</div><div class="ttdoc">When estimating the error in a single system, the error_norm is used to control the scaling and norm ...</div><div class="ttdef"><b>Definition:</b> <a href="error__estimator_8h_source.html#l00158">error_estimator.h:158</a></div></div>
<div class="ttc" id="classlibMesh_1_1JumpErrorEstimator_html_ae38eda2aa4b373ade6e83467f3ebc1ef"><div class="ttname"><a href="classlibMesh_1_1JumpErrorEstimator.html#ae38eda2aa4b373ade6e83467f3ebc1ef">libMesh::JumpErrorEstimator::fine_context</a></div><div class="ttdeci">std::unique_ptr&lt; FEMContext &gt; fine_context</div><div class="ttdoc">Context objects for integrating on the fine and coarse elements sharing a face. </div><div class="ttdef"><b>Definition:</b> <a href="jump__error__estimator_8h_source.html#l00158">jump_error_estimator.h:158</a></div></div>
<div class="ttc" id="classlibMesh_1_1FEMap_html_ab1c33e2c2078d7b474470fed4a58d0af"><div class="ttname"><a href="classlibMesh_1_1FEMap.html#ab1c33e2c2078d7b474470fed4a58d0af">libMesh::FEMap::inverse_map</a></div><div class="ttdeci">static Point inverse_map(const unsigned int dim, const Elem *elem, const Point &amp;p, const Real tolerance=TOLERANCE, const bool secure=true, const bool extra_checks=true)</div><div class="ttdoc">返回位于物理空间中的点 p 在参考单元上的位置。 </div><div class="ttdef"><b>Definition:</b> <a href="fe__map_8C_source.html#l01626">fe_map.C:1626</a></div></div>
<div class="ttc" id="classlibMesh_1_1SystemNorm_html_ac8a59940264314511d0e4f253433e76b"><div class="ttname"><a href="classlibMesh_1_1SystemNorm.html#ac8a59940264314511d0e4f253433e76b">libMesh::SystemNorm::weight</a></div><div class="ttdeci">Real weight(unsigned int var) const </div><div class="ttdef"><b>Definition:</b> <a href="system__norm_8C_source.html#l00134">system_norm.C:134</a></div></div>
<div class="ttc" id="tecplot__io_8C_html_ac001e4247887b98c2aa5b8ec5107ca0d"><div class="ttname"><a href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a></div><div class="ttdeci">const unsigned int n_vars</div><div class="ttdef"><b>Definition:</b> <a href="tecplot__io_8C_source.html#l00068">tecplot_io.C:68</a></div></div>
<div class="ttc" id="classlibMesh_1_1JumpErrorEstimator_html_ab7f203c19f25ccbb259f793064f5014f"><div class="ttname"><a href="classlibMesh_1_1JumpErrorEstimator.html#ab7f203c19f25ccbb259f793064f5014f">libMesh::JumpErrorEstimator::coarse_context</a></div><div class="ttdeci">std::unique_ptr&lt; FEMContext &gt; coarse_context</div><div class="ttdef"><b>Definition:</b> <a href="jump__error__estimator_8h_source.html#l00158">jump_error_estimator.h:158</a></div></div>
<div class="ttc" id="namespacelibMesh_html_adf7aee34b8c6fe4be28c90fe132a73a0"><div class="ttname"><a href="namespacelibMesh.html#adf7aee34b8c6fe4be28c90fe132a73a0">libMesh::FEBase</a></div><div class="ttdeci">FEGenericBase&lt; Real &gt; FEBase</div><div class="ttdef"><b>Definition:</b> <a href="exact__error__estimator_8h_source.html#l00039">exact_error_estimator.h:39</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3e3d1fed40dc4dfdb1bcd873f8f69674"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#a370493a82a7f09613a0fdc56fc7912b7">ErrorEstimatorType</a> libMesh::DiscontinuityMeasure::type </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The type for the <a class="el" href="classlibMesh_1_1ErrorEstimator.html" title="This class holds functions that will estimate the error in a finite element solution on a given mesh...">ErrorEstimator</a> subclass. </dd></dl>

<p>实现了 <a class="el" href="classlibMesh_1_1ErrorEstimator.html#a8a3162f59ee5f231d73ab54252cfa8f1">libMesh::ErrorEstimator</a>.</p>

<p>在文件 <a class="el" href="discontinuity__measure_8C_source.html">discontinuity_measure.C</a> 第 <a class="el" href="discontinuity__measure_8C_source.html#l00051">51</a> 行定义.</p>

<p>参考 <a class="el" href="enum__error__estimator__type_8h_source.html#l00037">libMesh::DISCONTINUITY_MEASURE</a>.</p>
<div class="fragment"><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;{</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#a370493a82a7f09613a0fdc56fc7912b7a34a65a410d9cdd2472865c4419dea930">DISCONTINUITY_MEASURE</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_a370493a82a7f09613a0fdc56fc7912b7a34a65a410d9cdd2472865c4419dea930"><div class="ttname"><a href="namespacelibMesh.html#a370493a82a7f09613a0fdc56fc7912b7a34a65a410d9cdd2472865c4419dea930">libMesh::DISCONTINUITY_MEASURE</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__error__estimator__type_8h_source.html#l00037">enum_error_estimator_type.h:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">类成员变量说明</h2>
<a class="anchor" id="ae25735cd54c0767a0e03c7f611b0ee17"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt;bool,<a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a>&gt;(*  libMesh::DiscontinuityMeasure::_bc_function)(const <a class="el" href="classlibMesh_1_1System.html">System</a> &amp;system, const <a class="el" href="classlibMesh_1_1Point.html">Point</a> &amp;p, const std::string &amp;var_name)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pointer to function that provides BC information. </p>

<p>在文件 <a class="el" href="discontinuity__measure_8h_source.html">discontinuity_measure.h</a> 第 <a class="el" href="discontinuity__measure_8h_source.html#l00108">108</a> 行定义.</p>

<p>参考自 <a class="el" href="discontinuity__measure_8C_source.html#l00200">attach_essential_bc_function()</a> , 以及 <a class="el" href="discontinuity__measure_8C_source.html#l00129">boundary_side_integration()</a>.</p>

</div>
</div>
<a class="anchor" id="ab7f203c19f25ccbb259f793064f5014f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classlibMesh_1_1FEMContext.html">FEMContext</a>&gt; libMesh::JumpErrorEstimator::coarse_context</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="jump__error__estimator_8h_source.html">jump_error_estimator.h</a> 第 <a class="el" href="jump__error__estimator_8h_source.html#l00158">158</a> 行定义.</p>

<p>参考自 <a class="el" href="jump__error__estimator_8C_source.html#l00488">libMesh::JumpErrorEstimator::coarse_n_flux_faces_increment()</a>, <a class="el" href="jump__error__estimator_8C_source.html#l00056">libMesh::JumpErrorEstimator::estimate_error()</a>, <a class="el" href="kelly__error__estimator_8C_source.html#l00059">libMesh::KellyErrorEstimator::init_context()</a>, <a class="el" href="fourth__error__estimators_8C_source.html#l00090">libMesh::LaplacianErrorEstimator::internal_side_integration()</a>, <a class="el" href="discontinuity__measure_8C_source.html#l00086">internal_side_integration()</a>, <a class="el" href="kelly__error__estimator_8C_source.html#l00090">libMesh::KellyErrorEstimator::internal_side_integration()</a> , 以及 <a class="el" href="jump__error__estimator_8C_source.html#l00450">libMesh::JumpErrorEstimator::reinit_sides()</a>.</p>

</div>
</div>
<a class="anchor" id="a5999107dbf9dfc4166e59cdc6e1c24fe"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> libMesh::JumpErrorEstimator::coarse_error</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>在文件 <a class="el" href="jump__error__estimator_8h_source.html">jump_error_estimator.h</a> 第 <a class="el" href="jump__error__estimator_8h_source.html#l00163">163</a> 行定义.</p>

<p>参考自 <a class="el" href="jump__error__estimator_8C_source.html#l00056">libMesh::JumpErrorEstimator::estimate_error()</a>, <a class="el" href="fourth__error__estimators_8C_source.html#l00090">libMesh::LaplacianErrorEstimator::internal_side_integration()</a>, <a class="el" href="discontinuity__measure_8C_source.html#l00086">internal_side_integration()</a> , 以及 <a class="el" href="kelly__error__estimator_8C_source.html#l00090">libMesh::KellyErrorEstimator::internal_side_integration()</a>.</p>

</div>
</div>
<a class="anchor" id="a9d626496b0b6f99f679c4ef4f0a5e46e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1SystemNorm.html">SystemNorm</a> libMesh::ErrorEstimator::error_norm</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>When estimating the error in a single system, the <code>error_norm</code> is used to control the scaling and norm choice for each variable. </p>
<p>Not all estimators will support all norm choices. The default scaling is for all variables to be weighted equally. The default norm choice depends on the error estimator.</p>
<p>Part of this functionality was supported via component_scale and sobolev_order in older <a class="el" href="namespacelibMesh.html" title="The libMesh namespace provides an interface to certain functionality in the library. ">libMesh</a> versions, and a small part was supported via component_mask in even older versions. Hopefully the encapsulation here will allow us to avoid changing this API again. </p>

<p>在文件 <a class="el" href="error__estimator_8h_source.html">error_estimator.h</a> 第 <a class="el" href="error__estimator_8h_source.html#l00158">158</a> 行定义.</p>

<p>参考自 <a class="el" href="uniform__refinement__estimator_8C_source.html#l00119">libMesh::UniformRefinementEstimator::_estimate_error()</a>, <a class="el" href="adjoint__refinement__estimator_8C_source.html#l00073">libMesh::AdjointRefinementEstimator::AdjointRefinementEstimator()</a>, <a class="el" href="discontinuity__measure_8C_source.html#l00129">boundary_side_integration()</a>, <a class="el" href="kelly__error__estimator_8C_source.html#l00135">libMesh::KellyErrorEstimator::boundary_side_integration()</a>, <a class="el" href="discontinuity__measure_8C_source.html#l00041">DiscontinuityMeasure()</a>, <a class="el" href="jump__error__estimator_8C_source.html#l00056">libMesh::JumpErrorEstimator::estimate_error()</a>, <a class="el" href="adjoint__residual__error__estimator_8C_source.html#l00061">libMesh::AdjointResidualErrorEstimator::estimate_error()</a>, <a class="el" href="exact__error__estimator_8C_source.html#l00188">libMesh::ExactErrorEstimator::estimate_error()</a>, <a class="el" href="error__estimator_8C_source.html#l00047">libMesh::ErrorEstimator::estimate_errors()</a>, <a class="el" href="exact__error__estimator_8C_source.html#l00049">libMesh::ExactErrorEstimator::ExactErrorEstimator()</a>, <a class="el" href="exact__error__estimator_8C_source.html#l00402">libMesh::ExactErrorEstimator::find_squared_element_error()</a>, <a class="el" href="fourth__error__estimators_8C_source.html#l00063">libMesh::LaplacianErrorEstimator::init_context()</a>, <a class="el" href="discontinuity__measure_8C_source.html#l00059">init_context()</a>, <a class="el" href="kelly__error__estimator_8C_source.html#l00059">libMesh::KellyErrorEstimator::init_context()</a>, <a class="el" href="fourth__error__estimators_8C_source.html#l00090">libMesh::LaplacianErrorEstimator::internal_side_integration()</a>, <a class="el" href="discontinuity__measure_8C_source.html#l00086">internal_side_integration()</a>, <a class="el" href="kelly__error__estimator_8C_source.html#l00090">libMesh::KellyErrorEstimator::internal_side_integration()</a>, <a class="el" href="kelly__error__estimator_8C_source.html#l00041">libMesh::KellyErrorEstimator::KellyErrorEstimator()</a>, <a class="el" href="fourth__error__estimators_8C_source.html#l00046">libMesh::LaplacianErrorEstimator::LaplacianErrorEstimator()</a>, <a class="el" href="weighted__patch__recovery__error__estimator_8C_source.html#l00112">libMesh::WeightedPatchRecoveryErrorEstimator::EstimateError::operator()()</a>, <a class="el" href="patch__recovery__error__estimator_8C_source.html#l00211">libMesh::PatchRecoveryErrorEstimator::EstimateError::operator()()</a>, <a class="el" href="patch__recovery__error__estimator_8C_source.html#l00065">libMesh::PatchRecoveryErrorEstimator::PatchRecoveryErrorEstimator()</a>, <a class="el" href="jump__error__estimator_8C_source.html#l00450">libMesh::JumpErrorEstimator::reinit_sides()</a> , 以及 <a class="el" href="uniform__refinement__estimator_8C_source.html#l00054">libMesh::UniformRefinementEstimator::UniformRefinementEstimator()</a>.</p>

</div>
</div>
<a class="anchor" id="ae38eda2aa4b373ade6e83467f3ebc1ef"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classlibMesh_1_1FEMContext.html">FEMContext</a>&gt; libMesh::JumpErrorEstimator::fine_context</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Context objects for integrating on the fine and coarse elements sharing a face. </p>

<p>在文件 <a class="el" href="jump__error__estimator_8h_source.html">jump_error_estimator.h</a> 第 <a class="el" href="jump__error__estimator_8h_source.html#l00158">158</a> 行定义.</p>

<p>参考自 <a class="el" href="discontinuity__measure_8C_source.html#l00129">boundary_side_integration()</a>, <a class="el" href="kelly__error__estimator_8C_source.html#l00135">libMesh::KellyErrorEstimator::boundary_side_integration()</a>, <a class="el" href="jump__error__estimator_8C_source.html#l00488">libMesh::JumpErrorEstimator::coarse_n_flux_faces_increment()</a>, <a class="el" href="jump__error__estimator_8C_source.html#l00056">libMesh::JumpErrorEstimator::estimate_error()</a>, <a class="el" href="fourth__error__estimators_8C_source.html#l00090">libMesh::LaplacianErrorEstimator::internal_side_integration()</a>, <a class="el" href="discontinuity__measure_8C_source.html#l00086">internal_side_integration()</a>, <a class="el" href="kelly__error__estimator_8C_source.html#l00090">libMesh::KellyErrorEstimator::internal_side_integration()</a> , 以及 <a class="el" href="jump__error__estimator_8C_source.html#l00450">libMesh::JumpErrorEstimator::reinit_sides()</a>.</p>

</div>
</div>
<a class="anchor" id="a28cc78a25a550e30504bfef7402398d3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> libMesh::JumpErrorEstimator::fine_error</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The fine and coarse error values to be set by each side_integration();. </p>

<p>在文件 <a class="el" href="jump__error__estimator_8h_source.html">jump_error_estimator.h</a> 第 <a class="el" href="jump__error__estimator_8h_source.html#l00163">163</a> 行定义.</p>

<p>参考自 <a class="el" href="discontinuity__measure_8C_source.html#l00129">boundary_side_integration()</a>, <a class="el" href="kelly__error__estimator_8C_source.html#l00135">libMesh::KellyErrorEstimator::boundary_side_integration()</a>, <a class="el" href="jump__error__estimator_8C_source.html#l00056">libMesh::JumpErrorEstimator::estimate_error()</a>, <a class="el" href="fourth__error__estimators_8C_source.html#l00090">libMesh::LaplacianErrorEstimator::internal_side_integration()</a>, <a class="el" href="discontinuity__measure_8C_source.html#l00086">internal_side_integration()</a> , 以及 <a class="el" href="kelly__error__estimator_8C_source.html#l00090">libMesh::KellyErrorEstimator::internal_side_integration()</a>.</p>

</div>
</div>
<a class="anchor" id="a5407898d65d3aeeaeada1786234e5de4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::JumpErrorEstimator::integrate_boundary_sides</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A boolean flag, by default false, to be set to true if integrations with <a class="el" href="classlibMesh_1_1JumpErrorEstimator.html#a32d9097610a87627382c5ea81a70d0b1" title="The function, to be implemented by derived classes, which calculates an error term on a boundary side...">boundary_side_integration()</a> should be performed. </p>

<p>在文件 <a class="el" href="jump__error__estimator_8h_source.html">jump_error_estimator.h</a> 第 <a class="el" href="jump__error__estimator_8h_source.html#l00152">152</a> 行定义.</p>

<p>参考自 <a class="el" href="discontinuity__measure_8C_source.html#l00200">attach_essential_bc_function()</a>, <a class="el" href="kelly__error__estimator_8C_source.html#l00207">libMesh::KellyErrorEstimator::attach_flux_bc_function()</a> , 以及 <a class="el" href="jump__error__estimator_8C_source.html#l00056">libMesh::JumpErrorEstimator::estimate_error()</a>.</p>

</div>
</div>
<a class="anchor" id="a4edf0ef12588e39bb85d8dea4e7d560d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::JumpErrorEstimator::scale_by_n_flux_faces</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This boolean flag allows you to scale the error indicator result for each element by the number of "flux faces" the element actually has. </p>
<p>This tends to weight more evenly cells which are on the boundaries and thus have fewer contributions to their flux. The value is initialized to false, simply set it to true if you want to use the feature. </p>

<p>在文件 <a class="el" href="jump__error__estimator_8h_source.html">jump_error_estimator.h</a> 第 <a class="el" href="jump__error__estimator_8h_source.html#l00099">99</a> 行定义.</p>

<p>参考自 <a class="el" href="jump__error__estimator_8C_source.html#l00056">libMesh::JumpErrorEstimator::estimate_error()</a>.</p>

</div>
</div>
<a class="anchor" id="a203fe804a4341ea7633f0dad9cc128d1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool libMesh::JumpErrorEstimator::use_unweighted_quadrature_rules</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This boolean flag allows you to use "unweighted" quadrature rules (sized to exactly integrate unweighted shape functions in master element space) rather than "default" quadrature rules (sized to exactly integrate polynomials of one higher degree than mass matrix terms). </p>
<p>The results with the former, lower-order rules will be somewhat less accurate in many cases but will be much cheaper to compute.</p>
<p>The value is initialized to false, simply set it to true if you want to use the feature. </p>

<p>在文件 <a class="el" href="jump__error__estimator_8h_source.html">jump_error_estimator.h</a> 第 <a class="el" href="jump__error__estimator_8h_source.html#l00113">113</a> 行定义.</p>

<p>参考自 <a class="el" href="jump__error__estimator_8C_source.html#l00056">libMesh::JumpErrorEstimator::estimate_error()</a>.</p>

</div>
</div>
<a class="anchor" id="a05b93294744b2b7a95dc593d7ab122bf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int libMesh::JumpErrorEstimator::var</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The variable number currently being evaluated. </p>

<p>在文件 <a class="el" href="jump__error__estimator_8h_source.html">jump_error_estimator.h</a> 第 <a class="el" href="jump__error__estimator_8h_source.html#l00168">168</a> 行定义.</p>

<p>参考自 <a class="el" href="discontinuity__measure_8C_source.html#l00129">boundary_side_integration()</a>, <a class="el" href="kelly__error__estimator_8C_source.html#l00135">libMesh::KellyErrorEstimator::boundary_side_integration()</a>, <a class="el" href="jump__error__estimator_8C_source.html#l00056">libMesh::JumpErrorEstimator::estimate_error()</a>, <a class="el" href="fourth__error__estimators_8C_source.html#l00090">libMesh::LaplacianErrorEstimator::internal_side_integration()</a>, <a class="el" href="discontinuity__measure_8C_source.html#l00086">internal_side_integration()</a> , 以及 <a class="el" href="kelly__error__estimator_8C_source.html#l00090">libMesh::KellyErrorEstimator::internal_side_integration()</a>.</p>

</div>
</div>
<hr/>该类的文档由以下文件生成:<ul>
<li>/home/lwz/libmesh/include/error_estimation/<a class="el" href="discontinuity__measure_8h_source.html">discontinuity_measure.h</a></li>
<li>/home/lwz/libmesh/src/error_estimation/<a class="el" href="discontinuity__measure_8C_source.html">discontinuity_measure.C</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
生成于 2023年 十二月 20日 星期三 12:09:08 , 为 libmesh解析使用  &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
