<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>libmesh解析: libMesh::AdjointResidualErrorEstimator类 参考</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">libmesh解析
   </div>
   <div id="projectbrief">本工作只是尝试解析原libmesh的代码,供学习使用</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'搜索');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>首页</span></a></li>
      <li class="current"><a href="annotated.html"><span>类</span></a></li>
      <li><a href="files.html"><span>文件</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="搜索" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>类列表</span></a></li>
      <li><a href="classes.html"><span>类索引</span></a></li>
      <li><a href="inherits.html"><span>类继承关系</span></a></li>
      <li><a href="functions.html"><span>类成员</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>全部</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>类</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>命名空间</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>文件</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>函数</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>变量</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>类型定义</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>枚举</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>枚举值</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>友元</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>页</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacelibMesh.html">libMesh</a></li><li class="navelem"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html">AdjointResidualErrorEstimator</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public 类型</a> &#124;
<a href="#pub-methods">Public 成员函数</a> &#124;
<a href="#pub-attribs">Public 属性</a> &#124;
<a href="#pro-methods">Protected 成员函数</a> &#124;
<a href="#pro-attribs">Protected 属性</a> &#124;
<a href="classlibMesh_1_1AdjointResidualErrorEstimator-members.html">所有成员列表</a>  </div>
  <div class="headertitle">
<div class="title">libMesh::AdjointResidualErrorEstimator类 参考</div>  </div>
</div><!--header-->
<div class="contents">

<p>This class implements a goal oriented error indicator, by weighting residual-based estimates from the primal problem against estimates from the adjoint problem.  
 <a href="classlibMesh_1_1AdjointResidualErrorEstimator.html#details">更多...</a></p>

<p><code>#include &lt;<a class="el" href="adjoint__residual__error__estimator_8h_source.html">adjoint_residual_error_estimator.h</a>&gt;</code></p>
<div class="dynheader">
类 libMesh::AdjointResidualErrorEstimator 继承关系图:</div>
<div class="dyncontent">
<div class="center"><!-- SVG 0 -->
</div>
<center><span class="legend">[<a href="graph_legend.html">图例</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public 类型</h2></td></tr>
<tr class="memitem:ab37d862060bbddf77099b6e34c62ef71"><td class="memItemLeft" align="right" valign="top">typedef std::map&lt; std::pair<br class="typebreak"/>
&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, unsigned int &gt;<br class="typebreak"/>
, std::unique_ptr&lt; <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ErrorEstimator.html#ab37d862060bbddf77099b6e34c62ef71">ErrorMap</a></td></tr>
<tr class="memdesc:ab37d862060bbddf77099b6e34c62ef71"><td class="mdescLeft">&#160;</td><td class="mdescRight">When calculating many error vectors at once, we need a data structure to hold them all.  <a href="#ab37d862060bbddf77099b6e34c62ef71">更多...</a><br/></td></tr>
<tr class="separator:ab37d862060bbddf77099b6e34c62ef71"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public 成员函数</h2></td></tr>
<tr class="memitem:a6a0f8337eae9e8c156680441d2840c24"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a6a0f8337eae9e8c156680441d2840c24">AdjointResidualErrorEstimator</a> ()</td></tr>
<tr class="memdesc:a6a0f8337eae9e8c156680441d2840c24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <a href="#a6a0f8337eae9e8c156680441d2840c24">更多...</a><br/></td></tr>
<tr class="separator:a6a0f8337eae9e8c156680441d2840c24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f557cdc3f18f2107ae06d34f8991b7a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a3f557cdc3f18f2107ae06d34f8991b7a">AdjointResidualErrorEstimator</a> (const <a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html">AdjointResidualErrorEstimator</a> &amp;)=delete</td></tr>
<tr class="memdesc:a3f557cdc3f18f2107ae06d34f8991b7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class cannot be (default) copy constructed/assigned because it has unique_ptr members.  <a href="#a3f557cdc3f18f2107ae06d34f8991b7a">更多...</a><br/></td></tr>
<tr class="separator:a3f557cdc3f18f2107ae06d34f8991b7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a413daf2ddf36014329d2cdaa3dd32d98"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html">AdjointResidualErrorEstimator</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a413daf2ddf36014329d2cdaa3dd32d98">operator=</a> (const <a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html">AdjointResidualErrorEstimator</a> &amp;)=delete</td></tr>
<tr class="separator:a413daf2ddf36014329d2cdaa3dd32d98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a331621d77b1c60bb166339238e036c95"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a331621d77b1c60bb166339238e036c95">AdjointResidualErrorEstimator</a> (<a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html">AdjointResidualErrorEstimator</a> &amp;&amp;)=default</td></tr>
<tr class="memdesc:a331621d77b1c60bb166339238e036c95"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defaulted move ctor, move assignment operator, and destructor.  <a href="#a331621d77b1c60bb166339238e036c95">更多...</a><br/></td></tr>
<tr class="separator:a331621d77b1c60bb166339238e036c95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79b7a77d8e14b54b65efcfb94f8ce573"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html">AdjointResidualErrorEstimator</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a79b7a77d8e14b54b65efcfb94f8ce573">operator=</a> (<a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html">AdjointResidualErrorEstimator</a> &amp;&amp;)=default</td></tr>
<tr class="separator:a79b7a77d8e14b54b65efcfb94f8ce573"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8eb31b1283d8824410124f15246d4890"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a8eb31b1283d8824410124f15246d4890">~AdjointResidualErrorEstimator</a> ()=default</td></tr>
<tr class="separator:a8eb31b1283d8824410124f15246d4890"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9930b4a3f1b7c10ac5e1412d2960632"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classlibMesh_1_1ErrorEstimator.html">ErrorEstimator</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#ab9930b4a3f1b7c10ac5e1412d2960632">primal_error_estimator</a> ()</td></tr>
<tr class="memdesc:ab9930b4a3f1b7c10ac5e1412d2960632"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access to the "subestimator" (default: PatchRecovery) to use on the primal/forward solution.  <a href="#ab9930b4a3f1b7c10ac5e1412d2960632">更多...</a><br/></td></tr>
<tr class="separator:ab9930b4a3f1b7c10ac5e1412d2960632"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6bc793251852fa41a61a4e34b0098b1"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classlibMesh_1_1ErrorEstimator.html">ErrorEstimator</a> &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#af6bc793251852fa41a61a4e34b0098b1">dual_error_estimator</a> ()</td></tr>
<tr class="memdesc:af6bc793251852fa41a61a4e34b0098b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access to the "subestimator" (default: PatchRecovery) to use on the dual/adjoint solution.  <a href="#af6bc793251852fa41a61a4e34b0098b1">更多...</a><br/></td></tr>
<tr class="separator:af6bc793251852fa41a61a4e34b0098b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b1d0230d7ba9bfc8850ffa76c01e4a1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1QoISet.html">QoISet</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a4b1d0230d7ba9bfc8850ffa76c01e4a1">qoi_set</a> ()</td></tr>
<tr class="memdesc:a4b1d0230d7ba9bfc8850ffa76c01e4a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access to the <a class="el" href="classlibMesh_1_1QoISet.html" title="Data structure for specifying which Quantities of Interest should be calculated in an adjoint or a pa...">QoISet</a> (default: weight all QoIs equally) to use when computing errors.  <a href="#a4b1d0230d7ba9bfc8850ffa76c01e4a1">更多...</a><br/></td></tr>
<tr class="separator:a4b1d0230d7ba9bfc8850ffa76c01e4a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c9fe6a7945577d5c9622a989d1f8250"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classlibMesh_1_1QoISet.html">QoISet</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a2c9fe6a7945577d5c9622a989d1f8250">qoi_set</a> () const </td></tr>
<tr class="memdesc:a2c9fe6a7945577d5c9622a989d1f8250"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access to the <a class="el" href="classlibMesh_1_1QoISet.html" title="Data structure for specifying which Quantities of Interest should be calculated in an adjoint or a pa...">QoISet</a> (default: weight all QoIs equally) to use when computing errors.  <a href="#a2c9fe6a7945577d5c9622a989d1f8250">更多...</a><br/></td></tr>
<tr class="separator:a2c9fe6a7945577d5c9622a989d1f8250"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabb44aeaa53dd5cfdb1f78794f971815"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#aabb44aeaa53dd5cfdb1f78794f971815">estimate_error</a> (const <a class="el" href="classlibMesh_1_1System.html">System</a> &amp;system, <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;error_per_cell, const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *solution_vector=nullptr, bool estimate_parent_error=false) override</td></tr>
<tr class="memdesc:aabb44aeaa53dd5cfdb1f78794f971815"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the adjoint-weighted error on each element and place it in the <code>error_per_cell</code> vector.  <a href="#aabb44aeaa53dd5cfdb1f78794f971815">更多...</a><br/></td></tr>
<tr class="separator:aabb44aeaa53dd5cfdb1f78794f971815"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0605dad340ea999b5d7366326fd837a0"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespacelibMesh.html#a370493a82a7f09613a0fdc56fc7912b7">ErrorEstimatorType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a0605dad340ea999b5d7366326fd837a0">type</a> () const override</td></tr>
<tr class="separator:a0605dad340ea999b5d7366326fd837a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad575aa2606bb47551e562a290499df0"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ErrorEstimator.html#aad575aa2606bb47551e562a290499df0">estimate_errors</a> (const <a class="el" href="classlibMesh_1_1EquationSystems.html">EquationSystems</a> &amp;equation_systems, <a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;error_per_cell, const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, <a class="el" href="classlibMesh_1_1SystemNorm.html">SystemNorm</a> &gt; &amp;error_norms, const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; * &gt; *solution_vectors=nullptr, bool estimate_parent_error=false)</td></tr>
<tr class="memdesc:aad575aa2606bb47551e562a290499df0"><td class="mdescLeft">&#160;</td><td class="mdescRight">This virtual function can be redefined in derived classes, but by default computes the sum of the error_per_cell for each system in the equation_systems.  <a href="#aad575aa2606bb47551e562a290499df0">更多...</a><br/></td></tr>
<tr class="separator:aad575aa2606bb47551e562a290499df0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bf8e0fb666d439804046465cf443867"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ErrorEstimator.html#a6bf8e0fb666d439804046465cf443867">estimate_errors</a> (const <a class="el" href="classlibMesh_1_1EquationSystems.html">EquationSystems</a> &amp;equation_systems, <a class="el" href="classlibMesh_1_1ErrorEstimator.html#ab37d862060bbddf77099b6e34c62ef71">ErrorMap</a> &amp;errors_per_cell, const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; * &gt; *solution_vectors=nullptr, bool estimate_parent_error=false)</td></tr>
<tr class="memdesc:a6bf8e0fb666d439804046465cf443867"><td class="mdescLeft">&#160;</td><td class="mdescRight">This virtual function can be redefined in derived classes, but by default it calls estimate_error repeatedly to calculate the requested error vectors.  <a href="#a6bf8e0fb666d439804046465cf443867">更多...</a><br/></td></tr>
<tr class="separator:a6bf8e0fb666d439804046465cf443867"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public 属性</h2></td></tr>
<tr class="memitem:a40755ebde43be4598a02b45e4f1196d4"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a40755ebde43be4598a02b45e4f1196d4">error_plot_suffix</a></td></tr>
<tr class="memdesc:a40755ebde43be4598a02b45e4f1196d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">To aid in investigating error estimator behavior, set this string to a suffix with which to plot (prefixed by "primal_" or "dual_") the subestimator results.  <a href="#a40755ebde43be4598a02b45e4f1196d4">更多...</a><br/></td></tr>
<tr class="separator:a40755ebde43be4598a02b45e4f1196d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d626496b0b6f99f679c4ef4f0a5e46e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1SystemNorm.html">SystemNorm</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a></td></tr>
<tr class="memdesc:a9d626496b0b6f99f679c4ef4f0a5e46e"><td class="mdescLeft">&#160;</td><td class="mdescRight">When estimating the error in a single system, the <code>error_norm</code> is used to control the scaling and norm choice for each variable.  <a href="#a9d626496b0b6f99f679c4ef4f0a5e46e">更多...</a><br/></td></tr>
<tr class="separator:a9d626496b0b6f99f679c4ef4f0a5e46e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected 成员函数</h2></td></tr>
<tr class="memitem:ac29685e2e9f05123fd4d6db97326a2a9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1ErrorEstimator.html#ac29685e2e9f05123fd4d6db97326a2a9">reduce_error</a> (std::vector&lt; <a class="el" href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">ErrorVectorReal</a> &gt; &amp;error_per_cell, const Parallel::Communicator &amp;comm) const </td></tr>
<tr class="memdesc:ac29685e2e9f05123fd4d6db97326a2a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method takes the local error contributions in <code>error_per_cell</code> from each processor and combines them to get the global error vector.  <a href="#ac29685e2e9f05123fd4d6db97326a2a9">更多...</a><br/></td></tr>
<tr class="separator:ac29685e2e9f05123fd4d6db97326a2a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected 属性</h2></td></tr>
<tr class="memitem:a3e34dc73ee9e57e02b6204c5bdf72582"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classlibMesh_1_1ErrorEstimator.html">ErrorEstimator</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a3e34dc73ee9e57e02b6204c5bdf72582">_primal_error_estimator</a></td></tr>
<tr class="memdesc:a3e34dc73ee9e57e02b6204c5bdf72582"><td class="mdescLeft">&#160;</td><td class="mdescRight">An error estimator for the forward problem.  <a href="#a3e34dc73ee9e57e02b6204c5bdf72582">更多...</a><br/></td></tr>
<tr class="separator:a3e34dc73ee9e57e02b6204c5bdf72582"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e1d0928ffa681b2285cedc2dfc6575e"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="classlibMesh_1_1ErrorEstimator.html">ErrorEstimator</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a1e1d0928ffa681b2285cedc2dfc6575e">_dual_error_estimator</a></td></tr>
<tr class="memdesc:a1e1d0928ffa681b2285cedc2dfc6575e"><td class="mdescLeft">&#160;</td><td class="mdescRight">An error estimator for the adjoint problem.  <a href="#a1e1d0928ffa681b2285cedc2dfc6575e">更多...</a><br/></td></tr>
<tr class="separator:a1e1d0928ffa681b2285cedc2dfc6575e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d04cafa87de4f7aa6ad7bac316a7a39"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classlibMesh_1_1QoISet.html">QoISet</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a4d04cafa87de4f7aa6ad7bac316a7a39">_qoi_set</a></td></tr>
<tr class="memdesc:a4d04cafa87de4f7aa6ad7bac316a7a39"><td class="mdescLeft">&#160;</td><td class="mdescRight">A <a class="el" href="classlibMesh_1_1QoISet.html" title="Data structure for specifying which Quantities of Interest should be calculated in an adjoint or a pa...">QoISet</a> to handle cases with multiple QoIs available.  <a href="#a4d04cafa87de4f7aa6ad7bac316a7a39">更多...</a><br/></td></tr>
<tr class="separator:a4d04cafa87de4f7aa6ad7bac316a7a39"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">详细描述</h2>
<div class="textblock"><p>This class implements a goal oriented error indicator, by weighting residual-based estimates from the primal problem against estimates from the adjoint problem. </p>
<p>This is based on a trick suggested by Brian Carnes, (first proposed by Babuska and Miller in 1984) but if it doesn't actually work then the misunderstanding or misimplementation will be the fault of Roy Stogner. It's also Roy's fault there's no literature reference here yet.</p>
<dl class="section author"><dt>作者</dt><dd>Roy H. Stogner </dd></dl>
<dl class="section date"><dt>日期</dt><dd>2009 </dd></dl>

<p>在文件 <a class="el" href="adjoint__residual__error__estimator_8h_source.html">adjoint_residual_error_estimator.h</a> 第 <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00049">49</a> 行定义.</p>
</div><h2 class="groupheader">成员类型定义说明</h2>
<a class="anchor" id="ab37d862060bbddf77099b6e34c62ef71"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::map&lt;std::pair&lt;const <a class="el" href="classlibMesh_1_1System.html">System</a> *, unsigned int&gt;, std::unique_ptr&lt;<a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a>&gt; &gt; <a class="el" href="classlibMesh_1_1ErrorEstimator.html#ab37d862060bbddf77099b6e34c62ef71">libMesh::ErrorEstimator::ErrorMap</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>When calculating many error vectors at once, we need a data structure to hold them all. </p>

<p>在文件 <a class="el" href="error__estimator_8h_source.html">error_estimator.h</a> 第 <a class="el" href="error__estimator_8h_source.html#l00121">121</a> 行定义.</p>

</div>
</div>
<h2 class="groupheader">构造及析构函数说明</h2>
<a class="anchor" id="a6a0f8337eae9e8c156680441d2840c24"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">libMesh::AdjointResidualErrorEstimator::AdjointResidualErrorEstimator </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>
<p>Responsible for picking default subestimators. </p>

<p>在文件 <a class="el" href="adjoint__residual__error__estimator_8C_source.html">adjoint_residual_error_estimator.C</a> 第 <a class="el" href="adjoint__residual__error__estimator_8C_source.html#l00042">42</a> 行定义.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;                                                              :</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="classlibMesh_1_1ErrorEstimator.html#abd4e67c1f8f49543f64859513208faa4">ErrorEstimator</a>(),</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a40755ebde43be4598a02b45e4f1196d4">error_plot_suffix</a>(),</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a3e34dc73ee9e57e02b6204c5bdf72582">_primal_error_estimator</a>(std::make_unique&lt;PatchRecoveryErrorEstimator&gt;()),</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a1e1d0928ffa681b2285cedc2dfc6575e">_dual_error_estimator</a>(std::make_unique&lt;PatchRecoveryErrorEstimator&gt;()),</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a4d04cafa87de4f7aa6ad7bac316a7a39">_qoi_set</a>(QoISet())</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1AdjointResidualErrorEstimator_html_a4d04cafa87de4f7aa6ad7bac316a7a39"><div class="ttname"><a href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a4d04cafa87de4f7aa6ad7bac316a7a39">libMesh::AdjointResidualErrorEstimator::_qoi_set</a></div><div class="ttdeci">QoISet _qoi_set</div><div class="ttdoc">A QoISet to handle cases with multiple QoIs available. </div><div class="ttdef"><b>Definition:</b> <a href="adjoint__residual__error__estimator_8h_source.html#l00138">adjoint_residual_error_estimator.h:138</a></div></div>
<div class="ttc" id="classlibMesh_1_1AdjointResidualErrorEstimator_html_a40755ebde43be4598a02b45e4f1196d4"><div class="ttname"><a href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a40755ebde43be4598a02b45e4f1196d4">libMesh::AdjointResidualErrorEstimator::error_plot_suffix</a></div><div class="ttdeci">std::string error_plot_suffix</div><div class="ttdoc">To aid in investigating error estimator behavior, set this string to a suffix with which to plot (pre...</div><div class="ttdef"><b>Definition:</b> <a href="adjoint__residual__error__estimator_8h_source.html#l00104">adjoint_residual_error_estimator.h:104</a></div></div>
<div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_abd4e67c1f8f49543f64859513208faa4"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#abd4e67c1f8f49543f64859513208faa4">libMesh::ErrorEstimator::ErrorEstimator</a></div><div class="ttdeci">ErrorEstimator()=default</div><div class="ttdoc">Constructor. </div></div>
<div class="ttc" id="classlibMesh_1_1AdjointResidualErrorEstimator_html_a1e1d0928ffa681b2285cedc2dfc6575e"><div class="ttname"><a href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a1e1d0928ffa681b2285cedc2dfc6575e">libMesh::AdjointResidualErrorEstimator::_dual_error_estimator</a></div><div class="ttdeci">std::unique_ptr&lt; ErrorEstimator &gt; _dual_error_estimator</div><div class="ttdoc">An error estimator for the adjoint problem. </div><div class="ttdef"><b>Definition:</b> <a href="adjoint__residual__error__estimator_8h_source.html#l00133">adjoint_residual_error_estimator.h:133</a></div></div>
<div class="ttc" id="classlibMesh_1_1AdjointResidualErrorEstimator_html_a3e34dc73ee9e57e02b6204c5bdf72582"><div class="ttname"><a href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a3e34dc73ee9e57e02b6204c5bdf72582">libMesh::AdjointResidualErrorEstimator::_primal_error_estimator</a></div><div class="ttdeci">std::unique_ptr&lt; ErrorEstimator &gt; _primal_error_estimator</div><div class="ttdoc">An error estimator for the forward problem. </div><div class="ttdef"><b>Definition:</b> <a href="adjoint__residual__error__estimator_8h_source.html#l00128">adjoint_residual_error_estimator.h:128</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3f557cdc3f18f2107ae06d34f8991b7a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">libMesh::AdjointResidualErrorEstimator::AdjointResidualErrorEstimator </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html">AdjointResidualErrorEstimator</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This class cannot be (default) copy constructed/assigned because it has unique_ptr members. </p>
<p>Explicitly deleting these functions is the best way to document this fact. </p>

</div>
</div>
<a class="anchor" id="a331621d77b1c60bb166339238e036c95"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">libMesh::AdjointResidualErrorEstimator::AdjointResidualErrorEstimator </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html">AdjointResidualErrorEstimator</a> &amp;&amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Defaulted move ctor, move assignment operator, and destructor. </p>

</div>
</div>
<a class="anchor" id="a8eb31b1283d8824410124f15246d4890"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual libMesh::AdjointResidualErrorEstimator::~AdjointResidualErrorEstimator </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">成员函数说明</h2>
<a class="anchor" id="af6bc793251852fa41a61a4e34b0098b1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classlibMesh_1_1ErrorEstimator.html">ErrorEstimator</a>&gt;&amp; libMesh::AdjointResidualErrorEstimator::dual_error_estimator </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access to the "subestimator" (default: PatchRecovery) to use on the dual/adjoint solution. </p>

<p>在文件 <a class="el" href="adjoint__residual__error__estimator_8h_source.html">adjoint_residual_error_estimator.h</a> 第 <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00083">83</a> 行定义.</p>

<p>参考 <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00133">_dual_error_estimator</a>.</p>
<div class="fragment"><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a1e1d0928ffa681b2285cedc2dfc6575e">_dual_error_estimator</a>; }</div>
<div class="ttc" id="classlibMesh_1_1AdjointResidualErrorEstimator_html_a1e1d0928ffa681b2285cedc2dfc6575e"><div class="ttname"><a href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a1e1d0928ffa681b2285cedc2dfc6575e">libMesh::AdjointResidualErrorEstimator::_dual_error_estimator</a></div><div class="ttdeci">std::unique_ptr&lt; ErrorEstimator &gt; _dual_error_estimator</div><div class="ttdoc">An error estimator for the adjoint problem. </div><div class="ttdef"><b>Definition:</b> <a href="adjoint__residual__error__estimator_8h_source.html#l00133">adjoint_residual_error_estimator.h:133</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aabb44aeaa53dd5cfdb1f78794f971815"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::AdjointResidualErrorEstimator::estimate_error </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1System.html">System</a> &amp;&#160;</td>
          <td class="paramname"><em>system</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;&#160;</td>
          <td class="paramname"><em>error_per_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; *&#160;</td>
          <td class="paramname"><em>solution_vector</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>estimate_parent_error</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute the adjoint-weighted error on each element and place it in the <code>error_per_cell</code> vector. </p>
<dl class="section note"><dt>注解</dt><dd><code>this-&gt;error_norm</code> is ignored; the error estimate is in the seminorm given by the absolute value of the error in the quantity of interest functional. The primal and dual subestimator error_norm values are used, and should be chosen appropriately for your model. </dd></dl>

<p>实现了 <a class="el" href="classlibMesh_1_1ErrorEstimator.html#ab5ee8217ac35baaa00cc3b72e9815d93">libMesh::ErrorEstimator</a>.</p>

<p>在文件 <a class="el" href="adjoint__residual__error__estimator_8C_source.html">adjoint_residual_error_estimator.C</a> 第 <a class="el" href="adjoint__residual__error__estimator_8C_source.html#l00061">61</a> 行定义.</p>

<p>参考 <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00133">_dual_error_estimator</a>, <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00128">_primal_error_estimator</a>, <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00138">_qoi_set</a>, <a class="el" href="system_8h_source.html#l02542">libMesh::System::adjoint_solve()</a>, <a class="el" href="system__norm_8C_source.html#l00232">libMesh::SystemNorm::calculate_norm()</a>, <a class="el" href="error__estimator_8h_source.html#l00158">libMesh::ErrorEstimator::error_norm</a>, <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00104">error_plot_suffix</a>, <a class="el" href="libmesh__common_8h_source.html#l00225">libMesh::ErrorVectorReal</a>, <a class="el" href="system_8C_source.html#l01192">libMesh::System::get_adjoint_solution()</a>, <a class="el" href="system_8h_source.html#l00730">libMesh::System::get_equation_systems()</a>, <a class="el" href="system_8h_source.html#l02277">libMesh::System::get_mesh()</a>, <a class="el" href="qoi__set_8h_source.html#l00224">libMesh::QoISet::has_index()</a>, <a class="el" href="int__range_8h_source.html#l00111">libMesh::index_range()</a>, <a class="el" href="system_8h_source.html#l00406">libMesh::System::is_adjoint_already_solved()</a>, <a class="el" href="system__norm_8C_source.html#l00237">libMesh::SystemNorm::is_identity()</a>, <a class="el" href="namespacelibMesh.html#a4f791f2cb1525c37e7916d564c3b3b78">libMesh::libmesh_assert()</a>, <a class="el" href="classlibMesh_1_1MeshBase.html#a807e5541b5e0608c8847daf6f3ffc1cf">libMesh::MeshBase::max_elem_id()</a>, <a class="el" href="mesh__communication_8C_source.html#l01308">mesh</a>, <a class="el" href="system_8h_source.html#l02516">libMesh::System::n_qois()</a>, <a class="el" href="tecplot__io_8C_source.html#l00068">n_vars</a>, <a class="el" href="system_8h_source.html#l02349">libMesh::System::n_vars()</a>, <a class="el" href="error__vector_8C_source.html#l00210">libMesh::ErrorVector::plot_error()</a>, <a class="el" href="libmesh__common_8h_source.html#l00143">libMesh::Real</a>, <a class="el" href="system_8h_source.html#l01573">libMesh::System::solution</a> , 以及 <a class="el" href="qoi__set_8h_source.html#l00243">libMesh::QoISet::weight()</a>.</p>
<div class="fragment"><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;{</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  LOG_SCOPE(<span class="stringliteral">&quot;estimate_error()&quot;</span>, <span class="stringliteral">&quot;AdjointResidualErrorEstimator&quot;</span>);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="comment">// The current mesh</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keyword">const</span> MeshBase &amp; <a class="code" href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a> = _system.get_mesh();</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">// Resize the error_per_cell vector to be</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="comment">// the number of elements, initialize it to 0.</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  error_per_cell.resize (mesh.max_elem_id());</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  std::fill (error_per_cell.begin(), error_per_cell.end(), 0.);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="comment">// Get the number of variables in the system</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a> = _system.n_vars();</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="comment">// We need to make a map of the pointer to the solution vector</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  std::map&lt;const System *, const NumericVector&lt;Number&gt; *&gt;solutionvecs;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  solutionvecs[&amp;_system] = _system.solution.get();</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">// Solve the dual problem if we have to</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordflow">if</span> (!_system.is_adjoint_already_solved())</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="comment">// FIXME - we&#39;ll need to change a lot of APIs to make this trick</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <span class="comment">// work with a const System...</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      System &amp;  system = <span class="keyword">const_cast&lt;</span>System &amp;<span class="keyword">&gt;</span>(_system);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      system.adjoint_solve(<a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a4d04cafa87de4f7aa6ad7bac316a7a39">_qoi_set</a>);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="comment">// Flag to check whether we have not been asked to weight the variable error contributions in any specific manner</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordtype">bool</span> error_norm_is_identity = <a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a>.<a class="code" href="classlibMesh_1_1SystemNorm.html#ae6cce0dd5b1659cd55e4f8430ea1bb39">is_identity</a>();</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="comment">// Create an ErrorMap/ErrorVector to store the primal, dual and total_dual variable errors</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <a class="code" href="classlibMesh_1_1ErrorEstimator.html#ab37d862060bbddf77099b6e34c62ef71">ErrorMap</a> primal_errors_per_cell;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <a class="code" href="classlibMesh_1_1ErrorEstimator.html#ab37d862060bbddf77099b6e34c62ef71">ErrorMap</a> dual_errors_per_cell;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <a class="code" href="classlibMesh_1_1ErrorEstimator.html#ab37d862060bbddf77099b6e34c62ef71">ErrorMap</a> total_dual_errors_per_cell;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">// Allocate ErrorVectors to this map if we&#39;re going to use it</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordflow">if</span> (!error_norm_is_identity)</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>; v++)</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        primal_errors_per_cell[std::make_pair(&amp;_system, v)] = std::make_unique&lt;ErrorVector&gt;();</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        dual_errors_per_cell[std::make_pair(&amp;_system, v)] = std::make_unique&lt;ErrorVector&gt;();</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        total_dual_errors_per_cell[std::make_pair(&amp;_system, v)] = std::make_unique&lt;ErrorVector&gt;();</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      }</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  ErrorVector primal_error_per_cell;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  ErrorVector dual_error_per_cell;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  ErrorVector total_dual_error_per_cell;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="comment">// Have we been asked to weight the variable error contributions in any specific manner</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordflow">if</span> (!error_norm_is_identity) <span class="comment">// If we do</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="comment">// Estimate the primal problem error for each variable</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a3e34dc73ee9e57e02b6204c5bdf72582">_primal_error_estimator</a>-&gt;estimate_errors</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        (_system.get_equation_systems(), primal_errors_per_cell, &amp;solutionvecs, estimate_parent_error);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordflow">else</span> <span class="comment">// If not</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    {</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="comment">// Just get the combined error estimate</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a3e34dc73ee9e57e02b6204c5bdf72582">_primal_error_estimator</a>-&gt;estimate_error</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        (_system, primal_error_per_cell, solution_vector, estimate_parent_error);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="comment">// Sum and weight the dual error estimate based on our QoISet</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0, n_qois = _system.n_qois(); i != n_qois; ++i)</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a4d04cafa87de4f7aa6ad7bac316a7a39">_qoi_set</a>.<a class="code" href="classlibMesh_1_1QoISet.html#a46749d10659b735c902b306fb5262818">has_index</a>(i))</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;          <span class="comment">// Get the weight for the current QoI</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;          <a class="code" href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">Real</a> error_weight = <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a4d04cafa87de4f7aa6ad7bac316a7a39">_qoi_set</a>.<a class="code" href="classlibMesh_1_1QoISet.html#aca792ddab47c10954d5dc416d77d5b16">weight</a>(i);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;          <span class="comment">// We need to make a map of the pointer to the adjoint solution vector</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;          std::map&lt;const System *, const NumericVector&lt;Number&gt; *&gt;adjointsolutionvecs;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;          adjointsolutionvecs[&amp;_system] = &amp;_system.get_adjoint_solution(i);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;          <span class="comment">// Have we been asked to weight the variable error contributions in any specific manner</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;          <span class="keywordflow">if</span> (!error_norm_is_identity) <span class="comment">// If we have</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;              <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a1e1d0928ffa681b2285cedc2dfc6575e">_dual_error_estimator</a>-&gt;estimate_errors</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                (_system.get_equation_systems(), dual_errors_per_cell, &amp;adjointsolutionvecs,</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                 estimate_parent_error);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;          <span class="keywordflow">else</span> <span class="comment">// If not</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;              <span class="comment">// Just get the combined error estimate</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;              <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a1e1d0928ffa681b2285cedc2dfc6575e">_dual_error_estimator</a>-&gt;estimate_error</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                (_system, dual_error_per_cell, &amp;(_system.get_adjoint_solution(i)), estimate_parent_error);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            }</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;          std::size_t error_size;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;          <span class="comment">// Get the size of the first ErrorMap vector; this will give us the number of elements</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;          <span class="keywordflow">if</span> (!error_norm_is_identity) <span class="comment">// If in non default weights case</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;              error_size = dual_errors_per_cell[std::make_pair(&amp;_system, 0)]-&gt;size();</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;          <span class="keywordflow">else</span> <span class="comment">// If in the standard default weights case</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;              error_size = dual_error_per_cell.size();</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          <span class="comment">// Resize the ErrorVector(s)</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;          <span class="keywordflow">if</span> (!error_norm_is_identity)</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;              <span class="comment">// Loop over variables</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>; v++)</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                  <a class="code" href="namespacelibMesh.html#a4f791f2cb1525c37e7916d564c3b3b78">libmesh_assert</a>(!total_dual_errors_per_cell[std::make_pair(&amp;_system, v)]-&gt;size() ||</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                                 total_dual_errors_per_cell[std::make_pair(&amp;_system, v)]-&gt;size() == error_size) ;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                  total_dual_errors_per_cell[std::make_pair(&amp;_system, v)]-&gt;resize(error_size);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;              <a class="code" href="namespacelibMesh.html#a4f791f2cb1525c37e7916d564c3b3b78">libmesh_assert</a>(!total_dual_error_per_cell.size() ||</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                             total_dual_error_per_cell.size() == error_size);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;              total_dual_error_per_cell.resize(error_size);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            }</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;          <span class="keywordflow">for</span> (std::size_t e = 0; e != error_size; ++e)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;              <span class="comment">// Have we been asked to weight the variable error contributions in any specific manner</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;              <span class="keywordflow">if</span> (!error_norm_is_identity) <span class="comment">// If we have</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                  <span class="comment">// Loop over variables</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>; v++)</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                    {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                      <span class="comment">// Now fill in total_dual_error ErrorMap with the weight</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                      (*total_dual_errors_per_cell[std::make_pair(&amp;_system, v)])[e] +=</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                        static_cast&lt;ErrorVectorReal&gt;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                        (error_weight *</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                         (*dual_errors_per_cell[std::make_pair(&amp;_system, v)])[e]);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                    }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;              <span class="keywordflow">else</span> <span class="comment">// If not</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                  total_dual_error_per_cell[e] +=</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                    <span class="keyword">static_cast&lt;</span><a class="code" href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">ErrorVectorReal</a><span class="keyword">&gt;</span>(error_weight * dual_error_per_cell[e]);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="comment">// Do some debugging plots if requested</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a40755ebde43be4598a02b45e4f1196d4">error_plot_suffix</a>.empty())</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keywordflow">if</span> (!error_norm_is_identity) <span class="comment">// If we have</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;          <span class="comment">// Loop over variables</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>; v++)</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;              std::ostringstream primal_out;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;              std::ostringstream dual_out;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;              primal_out &lt;&lt; <span class="stringliteral">&quot;primal_&quot;</span> &lt;&lt; <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a40755ebde43be4598a02b45e4f1196d4">error_plot_suffix</a> &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;              dual_out &lt;&lt; <span class="stringliteral">&quot;dual_&quot;</span> &lt;&lt; error_plot_suffix &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;              primal_out &lt;&lt; std::setw(1)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                         &lt;&lt; std::setprecision(0)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                         &lt;&lt; std::setfill(<span class="charliteral">&#39;0&#39;</span>)</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                         &lt;&lt; std::right</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                         &lt;&lt; v;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;              dual_out &lt;&lt; std::setw(1)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                       &lt;&lt; std::setprecision(0)</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                       &lt;&lt; std::setfill(<span class="charliteral">&#39;0&#39;</span>)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                       &lt;&lt; std::right</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                       &lt;&lt; v;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;              primal_errors_per_cell[std::make_pair(&amp;_system, v)]-&gt;plot_error(primal_out.str(), _system.get_mesh());</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;              total_dual_errors_per_cell[std::make_pair(&amp;_system, v)]-&gt;plot_error(dual_out.str(), _system.get_mesh());</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;              primal_out.clear();</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;              dual_out.clear();</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        }</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="keywordflow">else</span> <span class="comment">// If not</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;          std::ostringstream primal_out;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;          std::ostringstream dual_out;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;          primal_out &lt;&lt; <span class="stringliteral">&quot;primal_&quot;</span> &lt;&lt; <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a40755ebde43be4598a02b45e4f1196d4">error_plot_suffix</a> ;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;          dual_out &lt;&lt; <span class="stringliteral">&quot;dual_&quot;</span> &lt;&lt; <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a40755ebde43be4598a02b45e4f1196d4">error_plot_suffix</a> ;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;          primal_error_per_cell.plot_error(primal_out.str(), _system.get_mesh());</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;          total_dual_error_per_cell.plot_error(dual_out.str(), _system.get_mesh());</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;          primal_out.clear();</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;          dual_out.clear();</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="comment">// Weight the primal error by the dual error using the system norm object</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="comment">// FIXME: we ought to thread this</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : <a class="code" href="namespacelibMesh.html#a26e38c0dc87c05a5e8df7e26bfed543b">index_range</a>(error_per_cell))</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="comment">// Have we been asked to weight the variable error contributions in any specific manner</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      <span class="keywordflow">if</span> (!error_norm_is_identity) <span class="comment">// If we do</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;          <span class="comment">// Create Error Vectors to pass to calculate_norm</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;          std::vector&lt;Real&gt; cell_primal_error;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;          std::vector&lt;Real&gt; cell_dual_error;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>; v++)</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;              cell_primal_error.push_back((*primal_errors_per_cell[std::make_pair(&amp;_system, v)])[i]);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;              cell_dual_error.push_back((*total_dual_errors_per_cell[std::make_pair(&amp;_system, v)])[i]);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;          error_per_cell[i] =</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <span class="keyword">static_cast&lt;</span><a class="code" href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">ErrorVectorReal</a><span class="keyword">&gt;</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            (<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a>.<a class="code" href="classlibMesh_1_1SystemNorm.html#ac8afa822767f85f32acc11abba82ece3">calculate_norm</a>(cell_primal_error, cell_dual_error));</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="keywordflow">else</span> <span class="comment">// If not</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;          error_per_cell[i] = primal_error_per_cell[i]*total_dual_error_per_cell[i];</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_a9d626496b0b6f99f679c4ef4f0a5e46e"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">libMesh::ErrorEstimator::error_norm</a></div><div class="ttdeci">SystemNorm error_norm</div><div class="ttdoc">When estimating the error in a single system, the error_norm is used to control the scaling and norm ...</div><div class="ttdef"><b>Definition:</b> <a href="error__estimator_8h_source.html#l00158">error_estimator.h:158</a></div></div>
<div class="ttc" id="mesh__communication_8C_html_afaa03b874c297f4693d9cdef7f50f3c6"><div class="ttname"><a href="mesh__communication_8C.html#afaa03b874c297f4693d9cdef7f50f3c6">mesh</a></div><div class="ttdeci">MeshBase &amp; mesh</div><div class="ttdef"><b>Definition:</b> <a href="mesh__communication_8C_source.html#l01308">mesh_communication.C:1308</a></div></div>
<div class="ttc" id="classlibMesh_1_1QoISet_html_aca792ddab47c10954d5dc416d77d5b16"><div class="ttname"><a href="classlibMesh_1_1QoISet.html#aca792ddab47c10954d5dc416d77d5b16">libMesh::QoISet::weight</a></div><div class="ttdeci">Real weight(std::size_t) const </div><div class="ttdoc">Get the weight for this index (default 1.0) </div><div class="ttdef"><b>Definition:</b> <a href="qoi__set_8h_source.html#l00243">qoi_set.h:243</a></div></div>
<div class="ttc" id="classlibMesh_1_1AdjointResidualErrorEstimator_html_a4d04cafa87de4f7aa6ad7bac316a7a39"><div class="ttname"><a href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a4d04cafa87de4f7aa6ad7bac316a7a39">libMesh::AdjointResidualErrorEstimator::_qoi_set</a></div><div class="ttdeci">QoISet _qoi_set</div><div class="ttdoc">A QoISet to handle cases with multiple QoIs available. </div><div class="ttdef"><b>Definition:</b> <a href="adjoint__residual__error__estimator_8h_source.html#l00138">adjoint_residual_error_estimator.h:138</a></div></div>
<div class="ttc" id="tecplot__io_8C_html_ac001e4247887b98c2aa5b8ec5107ca0d"><div class="ttname"><a href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a></div><div class="ttdeci">const unsigned int n_vars</div><div class="ttdef"><b>Definition:</b> <a href="tecplot__io_8C_source.html#l00068">tecplot_io.C:68</a></div></div>
<div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_ab37d862060bbddf77099b6e34c62ef71"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#ab37d862060bbddf77099b6e34c62ef71">libMesh::ErrorEstimator::ErrorMap</a></div><div class="ttdeci">std::map&lt; std::pair&lt; const System *, unsigned int &gt;, std::unique_ptr&lt; ErrorVector &gt; &gt; ErrorMap</div><div class="ttdoc">When calculating many error vectors at once, we need a data structure to hold them all...</div><div class="ttdef"><b>Definition:</b> <a href="error__estimator_8h_source.html#l00121">error_estimator.h:121</a></div></div>
<div class="ttc" id="classlibMesh_1_1QoISet_html_a46749d10659b735c902b306fb5262818"><div class="ttname"><a href="classlibMesh_1_1QoISet.html#a46749d10659b735c902b306fb5262818">libMesh::QoISet::has_index</a></div><div class="ttdeci">bool has_index(std::size_t) const </div><div class="ttdoc">Return whether or not this index is in the set to be calculated. </div><div class="ttdef"><b>Definition:</b> <a href="qoi__set_8h_source.html#l00224">qoi_set.h:224</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a26acf05f075521cbfb223db57e63d6d0"><div class="ttname"><a href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">libMesh::ErrorVectorReal</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef float ErrorVectorReal</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00225">libmesh_common.h:225</a></div></div>
<div class="ttc" id="classlibMesh_1_1AdjointResidualErrorEstimator_html_a40755ebde43be4598a02b45e4f1196d4"><div class="ttname"><a href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a40755ebde43be4598a02b45e4f1196d4">libMesh::AdjointResidualErrorEstimator::error_plot_suffix</a></div><div class="ttdeci">std::string error_plot_suffix</div><div class="ttdoc">To aid in investigating error estimator behavior, set this string to a suffix with which to plot (pre...</div><div class="ttdef"><b>Definition:</b> <a href="adjoint__residual__error__estimator_8h_source.html#l00104">adjoint_residual_error_estimator.h:104</a></div></div>
<div class="ttc" id="classlibMesh_1_1SystemNorm_html_ae6cce0dd5b1659cd55e4f8430ea1bb39"><div class="ttname"><a href="classlibMesh_1_1SystemNorm.html#ae6cce0dd5b1659cd55e4f8430ea1bb39">libMesh::SystemNorm::is_identity</a></div><div class="ttdeci">bool is_identity()</div><div class="ttdef"><b>Definition:</b> <a href="system__norm_8C_source.html#l00237">system_norm.C:237</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a4f791f2cb1525c37e7916d564c3b3b78"><div class="ttname"><a href="namespacelibMesh.html#a4f791f2cb1525c37e7916d564c3b3b78">libMesh::libmesh_assert</a></div><div class="ttdeci">libmesh_assert(ctx)</div></div>
<div class="ttc" id="classlibMesh_1_1AdjointResidualErrorEstimator_html_a1e1d0928ffa681b2285cedc2dfc6575e"><div class="ttname"><a href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a1e1d0928ffa681b2285cedc2dfc6575e">libMesh::AdjointResidualErrorEstimator::_dual_error_estimator</a></div><div class="ttdeci">std::unique_ptr&lt; ErrorEstimator &gt; _dual_error_estimator</div><div class="ttdoc">An error estimator for the adjoint problem. </div><div class="ttdef"><b>Definition:</b> <a href="adjoint__residual__error__estimator_8h_source.html#l00133">adjoint_residual_error_estimator.h:133</a></div></div>
<div class="ttc" id="namespacelibMesh_html_aef28359fb4851abec08fc99cfbac118d"><div class="ttname"><a href="namespacelibMesh.html#aef28359fb4851abec08fc99cfbac118d">libMesh::Real</a></div><div class="ttdeci">DIE A HORRIBLE DEATH HERE typedef LIBMESH_DEFAULT_SCALAR_TYPE Real</div><div class="ttdef"><b>Definition:</b> <a href="libmesh__common_8h_source.html#l00143">libmesh_common.h:143</a></div></div>
<div class="ttc" id="classlibMesh_1_1SystemNorm_html_ac8afa822767f85f32acc11abba82ece3"><div class="ttname"><a href="classlibMesh_1_1SystemNorm.html#ac8afa822767f85f32acc11abba82ece3">libMesh::SystemNorm::calculate_norm</a></div><div class="ttdeci">Real calculate_norm(const std::vector&lt; Real &gt; &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="system__norm_8C_source.html#l00232">system_norm.C:232</a></div></div>
<div class="ttc" id="classlibMesh_1_1AdjointResidualErrorEstimator_html_a3e34dc73ee9e57e02b6204c5bdf72582"><div class="ttname"><a href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a3e34dc73ee9e57e02b6204c5bdf72582">libMesh::AdjointResidualErrorEstimator::_primal_error_estimator</a></div><div class="ttdeci">std::unique_ptr&lt; ErrorEstimator &gt; _primal_error_estimator</div><div class="ttdoc">An error estimator for the forward problem. </div><div class="ttdef"><b>Definition:</b> <a href="adjoint__residual__error__estimator_8h_source.html#l00128">adjoint_residual_error_estimator.h:128</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a26e38c0dc87c05a5e8df7e26bfed543b"><div class="ttname"><a href="namespacelibMesh.html#a26e38c0dc87c05a5e8df7e26bfed543b">libMesh::index_range</a></div><div class="ttdeci">auto index_range(const T &amp;sizable)</div><div class="ttdoc">Helper function that returns an IntRange&amp;lt;std::size_t&amp;gt; representing all the indices of the passed-in v...</div><div class="ttdef"><b>Definition:</b> <a href="int__range_8h_source.html#l00111">int_range.h:111</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aad575aa2606bb47551e562a290499df0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::ErrorEstimator::estimate_errors </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1EquationSystems.html">EquationSystems</a> &amp;&#160;</td>
          <td class="paramname"><em>equation_systems</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1ErrorVector.html">ErrorVector</a> &amp;&#160;</td>
          <td class="paramname"><em>error_per_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, <a class="el" href="classlibMesh_1_1SystemNorm.html">SystemNorm</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>error_norms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; * &gt; *&#160;</td>
          <td class="paramname"><em>solution_vectors</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>estimate_parent_error</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This virtual function can be redefined in derived classes, but by default computes the sum of the error_per_cell for each system in the equation_systems. </p>
<p>Currently this function ignores the error_norm member variable, and uses the function argument error_norms instead.</p>
<p>This function is named estimate_errors instead of estimate_error because otherwise C++ can get confused. </p>

<p>被 <a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html#a41eeb5e8506a3489f913e1d3ec9c30b0">libMesh::UniformRefinementEstimator</a> 重载.</p>

<p>在文件 <a class="el" href="error__estimator_8C_source.html">error_estimator.C</a> 第 <a class="el" href="error__estimator_8C_source.html#l00047">47</a> 行定义.</p>

<p>参考 <a class="el" href="error__estimator_8h_source.html#l00158">libMesh::ErrorEstimator::error_norm</a>, <a class="el" href="classlibMesh_1_1ErrorEstimator.html#ab5ee8217ac35baaa00cc3b72e9815d93">libMesh::ErrorEstimator::estimate_error()</a>, <a class="el" href="equation__systems_8h_source.html#l00745">libMesh::EquationSystems::get_system()</a>, <a class="el" href="int__range_8h_source.html#l00111">libMesh::index_range()</a>, <a class="el" href="int__range_8h_source.html#l00134">libMesh::make_range()</a> , 以及 <a class="el" href="equation__systems_8h_source.html#l00649">libMesh::EquationSystems::n_systems()</a>.</p>
<div class="fragment"><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;{</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  SystemNorm old_error_norm = this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="comment">// Sum the error values from each system</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> s : <a class="code" href="namespacelibMesh.html#a18dea64f5cc7fa12c864d7571bb69d0b">make_range</a>(equation_systems.n_systems()))</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      ErrorVector system_error_per_cell;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="keyword">const</span> System &amp; sys = equation_systems.get_system(s);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="keywordflow">if</span> (error_norms.find(&amp;sys) == error_norms.end())</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a> = old_error_norm;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a> = error_norms.find(&amp;sys)-&gt;second;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#af63481288585b5ba172278c33c726667">NumericVector&lt;Number&gt;</a> * solution_vector = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="keywordflow">if</span> (solution_vectors &amp;&amp;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;          solution_vectors-&gt;find(&amp;sys) != solution_vectors-&gt;end())</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        solution_vector = solution_vectors-&gt;find(&amp;sys)-&gt;second;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#ab5ee8217ac35baaa00cc3b72e9815d93">estimate_error</a>(sys, system_error_per_cell,</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                           solution_vector, estimate_parent_error);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="keywordflow">if</span> (s)</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;          libmesh_assert_equal_to (error_per_cell.size(), system_error_per_cell.size());</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : <a class="code" href="namespacelibMesh.html#a26e38c0dc87c05a5e8df7e26bfed543b">index_range</a>(error_per_cell))</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            error_per_cell[i] += system_error_per_cell[i];</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        error_per_cell = system_error_per_cell;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">// Restore our old state before returning</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a> = old_error_norm;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_a9d626496b0b6f99f679c4ef4f0a5e46e"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">libMesh::ErrorEstimator::error_norm</a></div><div class="ttdeci">SystemNorm error_norm</div><div class="ttdoc">When estimating the error in a single system, the error_norm is used to control the scaling and norm ...</div><div class="ttdef"><b>Definition:</b> <a href="error__estimator_8h_source.html#l00158">error_estimator.h:158</a></div></div>
<div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_ab5ee8217ac35baaa00cc3b72e9815d93"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#ab5ee8217ac35baaa00cc3b72e9815d93">libMesh::ErrorEstimator::estimate_error</a></div><div class="ttdeci">virtual void estimate_error(const System &amp;system, ErrorVector &amp;error_per_cell, const NumericVector&lt; Number &gt; *solution_vector=nullptr, bool estimate_parent_error=false)=0</div><div class="ttdoc">This pure virtual function must be redefined in derived classes to compute the error for each active ...</div></div>
<div class="ttc" id="namespacelibMesh_html_a18dea64f5cc7fa12c864d7571bb69d0b"><div class="ttname"><a href="namespacelibMesh.html#a18dea64f5cc7fa12c864d7571bb69d0b">libMesh::make_range</a></div><div class="ttdeci">IntRange&lt; T &gt; make_range(T beg, T end)</div><div class="ttdoc">The 2-parameter make_range() helper function returns an IntRange&amp;lt;T&amp;gt; when both input parameters are of...</div><div class="ttdef"><b>Definition:</b> <a href="int__range_8h_source.html#l00134">int_range.h:134</a></div></div>
<div class="ttc" id="namespacelibMesh_html_af63481288585b5ba172278c33c726667"><div class="ttname"><a href="namespacelibMesh.html#af63481288585b5ba172278c33c726667">libMesh::NumericVector&lt; Number &gt;</a></div><div class="ttdeci">template class LIBMESH_EXPORT NumericVector&lt; Number &gt;</div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8C_source.html#l00436">numeric_vector.C:436</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a26e38c0dc87c05a5e8df7e26bfed543b"><div class="ttname"><a href="namespacelibMesh.html#a26e38c0dc87c05a5e8df7e26bfed543b">libMesh::index_range</a></div><div class="ttdeci">auto index_range(const T &amp;sizable)</div><div class="ttdoc">Helper function that returns an IntRange&amp;lt;std::size_t&amp;gt; representing all the indices of the passed-in v...</div><div class="ttdef"><b>Definition:</b> <a href="int__range_8h_source.html#l00111">int_range.h:111</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6bf8e0fb666d439804046465cf443867"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::ErrorEstimator::estimate_errors </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1EquationSystems.html">EquationSystems</a> &amp;&#160;</td>
          <td class="paramname"><em>equation_systems</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1ErrorEstimator.html#ab37d862060bbddf77099b6e34c62ef71">ErrorMap</a> &amp;&#160;</td>
          <td class="paramname"><em>errors_per_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::map&lt; const <a class="el" href="classlibMesh_1_1System.html">System</a> *, const <a class="el" href="classlibMesh_1_1NumericVector.html">NumericVector</a>&lt; <a class="el" href="namespacelibMesh.html#a8b17bf24a15bc292850c3a3894e2e8f9">Number</a> &gt; * &gt; *&#160;</td>
          <td class="paramname"><em>solution_vectors</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>estimate_parent_error</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This virtual function can be redefined in derived classes, but by default it calls estimate_error repeatedly to calculate the requested error vectors. </p>
<p>FIXME: This is a default implementation - derived classes should reimplement it for efficiency.</p>
<p>Currently this function ignores the <a class="el" href="namespacelibMesh_1_1MeshTools.html#a0701de7f01fd5eced3da4a332ff5ae51">error_norm.weight()</a> values because it calculates each variable's error individually, unscaled.</p>
<p>The user selects which errors get computed by filling a map with error vectors: If errors_per_cell[&amp;system][v] exists, it will be filled with the error values in variable <code>v</code> of <code>system</code> </p>

<p>被 <a class="el" href="classlibMesh_1_1UniformRefinementEstimator.html#a676215e74e7c4517162b4431835453a4">libMesh::UniformRefinementEstimator</a> 重载.</p>

<p>在文件 <a class="el" href="error__estimator_8C_source.html">error_estimator.C</a> 第 <a class="el" href="error__estimator_8C_source.html#l00093">93</a> 行定义.</p>

<p>参考 <a class="el" href="error__estimator_8h_source.html#l00158">libMesh::ErrorEstimator::error_norm</a>, <a class="el" href="classlibMesh_1_1ErrorEstimator.html#ab5ee8217ac35baaa00cc3b72e9815d93">libMesh::ErrorEstimator::estimate_error()</a>, <a class="el" href="equation__systems_8h_source.html#l00745">libMesh::EquationSystems::get_system()</a>, <a class="el" href="int__range_8h_source.html#l00134">libMesh::make_range()</a>, <a class="el" href="equation__systems_8h_source.html#l00649">libMesh::EquationSystems::n_systems()</a>, <a class="el" href="tecplot__io_8C_source.html#l00068">n_vars</a>, <a class="el" href="system_8h_source.html#l02349">libMesh::System::n_vars()</a> , 以及 <a class="el" href="system__norm_8C_source.html#l00112">libMesh::SystemNorm::type()</a>.</p>
<div class="fragment"><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;{</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  SystemNorm old_error_norm = this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="comment">// Find the requested error values from each system</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> s : <a class="code" href="namespacelibMesh.html#a18dea64f5cc7fa12c864d7571bb69d0b">make_range</a>(equation_systems.n_systems()))</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      <span class="keyword">const</span> System &amp; sys = equation_systems.get_system(s);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a> = sys.n_vars();</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v != <a class="code" href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a>; ++v)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;          <span class="comment">// Only fill in ErrorVectors the user asks for</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;          <span class="keywordflow">if</span> (!errors_per_cell.count(std::make_pair(&amp;sys, v)))</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;          <span class="comment">// Calculate error in only one variable</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;          std::vector&lt;Real&gt; weights(n_vars, 0.0);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;          weights[v] = 1.0;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a> =</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            SystemNorm(std::vector&lt;FEMNormType&gt;(n_vars, old_error_norm.type(v)),</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                       weights);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;          <span class="keyword">const</span> <a class="code" href="namespacelibMesh.html#af63481288585b5ba172278c33c726667">NumericVector&lt;Number&gt;</a> * solution_vector = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;          <span class="keywordflow">if</span> (solution_vectors &amp;&amp;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;              solution_vectors-&gt;find(&amp;sys) != solution_vectors-&gt;end())</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            solution_vector = solution_vectors-&gt;find(&amp;sys)-&gt;second;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;          this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#ab5ee8217ac35baaa00cc3b72e9815d93">estimate_error</a></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            (sys, *errors_per_cell[std::make_pair(&amp;sys, v)],</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;             solution_vector, estimate_parent_error);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="comment">// Restore our old state before returning</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  this-&gt;<a class="code" href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">error_norm</a> = old_error_norm;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;}</div>
<div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_a9d626496b0b6f99f679c4ef4f0a5e46e"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#a9d626496b0b6f99f679c4ef4f0a5e46e">libMesh::ErrorEstimator::error_norm</a></div><div class="ttdeci">SystemNorm error_norm</div><div class="ttdoc">When estimating the error in a single system, the error_norm is used to control the scaling and norm ...</div><div class="ttdef"><b>Definition:</b> <a href="error__estimator_8h_source.html#l00158">error_estimator.h:158</a></div></div>
<div class="ttc" id="classlibMesh_1_1ErrorEstimator_html_ab5ee8217ac35baaa00cc3b72e9815d93"><div class="ttname"><a href="classlibMesh_1_1ErrorEstimator.html#ab5ee8217ac35baaa00cc3b72e9815d93">libMesh::ErrorEstimator::estimate_error</a></div><div class="ttdeci">virtual void estimate_error(const System &amp;system, ErrorVector &amp;error_per_cell, const NumericVector&lt; Number &gt; *solution_vector=nullptr, bool estimate_parent_error=false)=0</div><div class="ttdoc">This pure virtual function must be redefined in derived classes to compute the error for each active ...</div></div>
<div class="ttc" id="tecplot__io_8C_html_ac001e4247887b98c2aa5b8ec5107ca0d"><div class="ttname"><a href="tecplot__io_8C.html#ac001e4247887b98c2aa5b8ec5107ca0d">n_vars</a></div><div class="ttdeci">const unsigned int n_vars</div><div class="ttdef"><b>Definition:</b> <a href="tecplot__io_8C_source.html#l00068">tecplot_io.C:68</a></div></div>
<div class="ttc" id="namespacelibMesh_html_a18dea64f5cc7fa12c864d7571bb69d0b"><div class="ttname"><a href="namespacelibMesh.html#a18dea64f5cc7fa12c864d7571bb69d0b">libMesh::make_range</a></div><div class="ttdeci">IntRange&lt; T &gt; make_range(T beg, T end)</div><div class="ttdoc">The 2-parameter make_range() helper function returns an IntRange&amp;lt;T&amp;gt; when both input parameters are of...</div><div class="ttdef"><b>Definition:</b> <a href="int__range_8h_source.html#l00134">int_range.h:134</a></div></div>
<div class="ttc" id="namespacelibMesh_html_af63481288585b5ba172278c33c726667"><div class="ttname"><a href="namespacelibMesh.html#af63481288585b5ba172278c33c726667">libMesh::NumericVector&lt; Number &gt;</a></div><div class="ttdeci">template class LIBMESH_EXPORT NumericVector&lt; Number &gt;</div><div class="ttdef"><b>Definition:</b> <a href="numeric__vector_8C_source.html#l00436">numeric_vector.C:436</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a413daf2ddf36014329d2cdaa3dd32d98"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html">AdjointResidualErrorEstimator</a>&amp; libMesh::AdjointResidualErrorEstimator::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html">AdjointResidualErrorEstimator</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a79b7a77d8e14b54b65efcfb94f8ce573"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html">AdjointResidualErrorEstimator</a>&amp; libMesh::AdjointResidualErrorEstimator::operator= </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classlibMesh_1_1AdjointResidualErrorEstimator.html">AdjointResidualErrorEstimator</a> &amp;&amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab9930b4a3f1b7c10ac5e1412d2960632"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classlibMesh_1_1ErrorEstimator.html">ErrorEstimator</a>&gt;&amp; libMesh::AdjointResidualErrorEstimator::primal_error_estimator </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access to the "subestimator" (default: PatchRecovery) to use on the primal/forward solution. </p>

<p>在文件 <a class="el" href="adjoint__residual__error__estimator_8h_source.html">adjoint_residual_error_estimator.h</a> 第 <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00077">77</a> 行定义.</p>

<p>参考 <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00128">_primal_error_estimator</a>.</p>
<div class="fragment"><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a3e34dc73ee9e57e02b6204c5bdf72582">_primal_error_estimator</a>; }</div>
<div class="ttc" id="classlibMesh_1_1AdjointResidualErrorEstimator_html_a3e34dc73ee9e57e02b6204c5bdf72582"><div class="ttname"><a href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a3e34dc73ee9e57e02b6204c5bdf72582">libMesh::AdjointResidualErrorEstimator::_primal_error_estimator</a></div><div class="ttdeci">std::unique_ptr&lt; ErrorEstimator &gt; _primal_error_estimator</div><div class="ttdoc">An error estimator for the forward problem. </div><div class="ttdef"><b>Definition:</b> <a href="adjoint__residual__error__estimator_8h_source.html#l00128">adjoint_residual_error_estimator.h:128</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4b1d0230d7ba9bfc8850ffa76c01e4a1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1QoISet.html">QoISet</a>&amp; libMesh::AdjointResidualErrorEstimator::qoi_set </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access to the <a class="el" href="classlibMesh_1_1QoISet.html" title="Data structure for specifying which Quantities of Interest should be calculated in an adjoint or a pa...">QoISet</a> (default: weight all QoIs equally) to use when computing errors. </p>

<p>在文件 <a class="el" href="adjoint__residual__error__estimator_8h_source.html">adjoint_residual_error_estimator.h</a> 第 <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00089">89</a> 行定义.</p>

<p>参考 <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00138">_qoi_set</a>.</p>
<div class="fragment"><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a4d04cafa87de4f7aa6ad7bac316a7a39">_qoi_set</a>; }</div>
<div class="ttc" id="classlibMesh_1_1AdjointResidualErrorEstimator_html_a4d04cafa87de4f7aa6ad7bac316a7a39"><div class="ttname"><a href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a4d04cafa87de4f7aa6ad7bac316a7a39">libMesh::AdjointResidualErrorEstimator::_qoi_set</a></div><div class="ttdeci">QoISet _qoi_set</div><div class="ttdoc">A QoISet to handle cases with multiple QoIs available. </div><div class="ttdef"><b>Definition:</b> <a href="adjoint__residual__error__estimator_8h_source.html#l00138">adjoint_residual_error_estimator.h:138</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2c9fe6a7945577d5c9622a989d1f8250"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classlibMesh_1_1QoISet.html">QoISet</a>&amp; libMesh::AdjointResidualErrorEstimator::qoi_set </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access to the <a class="el" href="classlibMesh_1_1QoISet.html" title="Data structure for specifying which Quantities of Interest should be calculated in an adjoint or a pa...">QoISet</a> (default: weight all QoIs equally) to use when computing errors. </p>

<p>在文件 <a class="el" href="adjoint__residual__error__estimator_8h_source.html">adjoint_residual_error_estimator.h</a> 第 <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00095">95</a> 行定义.</p>

<p>参考 <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00138">_qoi_set</a>.</p>
<div class="fragment"><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;{ <span class="keywordflow">return</span> <a class="code" href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a4d04cafa87de4f7aa6ad7bac316a7a39">_qoi_set</a>; }</div>
<div class="ttc" id="classlibMesh_1_1AdjointResidualErrorEstimator_html_a4d04cafa87de4f7aa6ad7bac316a7a39"><div class="ttname"><a href="classlibMesh_1_1AdjointResidualErrorEstimator.html#a4d04cafa87de4f7aa6ad7bac316a7a39">libMesh::AdjointResidualErrorEstimator::_qoi_set</a></div><div class="ttdeci">QoISet _qoi_set</div><div class="ttdoc">A QoISet to handle cases with multiple QoIs available. </div><div class="ttdef"><b>Definition:</b> <a href="adjoint__residual__error__estimator_8h_source.html#l00138">adjoint_residual_error_estimator.h:138</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac29685e2e9f05123fd4d6db97326a2a9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void libMesh::ErrorEstimator::reduce_error </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="namespacelibMesh.html#a26acf05f075521cbfb223db57e63d6d0">ErrorVectorReal</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>error_per_cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Parallel::Communicator &amp;&#160;</td>
          <td class="paramname"><em>comm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This method takes the local error contributions in <code>error_per_cell</code> from each processor and combines them to get the global error vector. </p>

<p>在文件 <a class="el" href="error__estimator_8C_source.html">error_estimator.C</a> 第 <a class="el" href="error__estimator_8C_source.html#l00032">32</a> 行定义.</p>

<p>参考自 <a class="el" href="uniform__refinement__estimator_8C_source.html#l00119">libMesh::UniformRefinementEstimator::_estimate_error()</a>, <a class="el" href="patch__recovery__error__estimator_8C_source.html#l00154">libMesh::PatchRecoveryErrorEstimator::estimate_error()</a>, <a class="el" href="weighted__patch__recovery__error__estimator_8C_source.html#l00055">libMesh::WeightedPatchRecoveryErrorEstimator::estimate_error()</a>, <a class="el" href="jump__error__estimator_8C_source.html#l00056">libMesh::JumpErrorEstimator::estimate_error()</a>, <a class="el" href="adjoint__refinement__estimator_8C_source.html#l00091">libMesh::AdjointRefinementEstimator::estimate_error()</a> , 以及 <a class="el" href="exact__error__estimator_8C_source.html#l00188">libMesh::ExactErrorEstimator::estimate_error()</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;{</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="comment">// This function must be run on all processors at once</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="comment">// parallel_object_only();</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="comment">// Each processor has now computed the error contributions</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="comment">// for its local elements.  We may need to sum the vector to</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="comment">// recover the error for each element.</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  comm.sum(error_per_cell);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0605dad340ea999b5d7366326fd837a0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacelibMesh.html#a370493a82a7f09613a0fdc56fc7912b7">ErrorEstimatorType</a> libMesh::AdjointResidualErrorEstimator::type </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>返回</dt><dd>The type for the <a class="el" href="classlibMesh_1_1ErrorEstimator.html" title="This class holds functions that will estimate the error in a finite element solution on a given mesh...">ErrorEstimator</a> subclass. </dd></dl>

<p>实现了 <a class="el" href="classlibMesh_1_1ErrorEstimator.html#a8a3162f59ee5f231d73ab54252cfa8f1">libMesh::ErrorEstimator</a>.</p>

<p>在文件 <a class="el" href="adjoint__residual__error__estimator_8C_source.html">adjoint_residual_error_estimator.C</a> 第 <a class="el" href="adjoint__residual__error__estimator_8C_source.html#l00054">54</a> 行定义.</p>

<p>参考 <a class="el" href="enum__error__estimator__type_8h_source.html#l00036">libMesh::ADJOINT_RESIDUAL</a>.</p>
<div class="fragment"><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;{</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="namespacelibMesh.html#a370493a82a7f09613a0fdc56fc7912b7aa905ae40b37d21c9bac957364d3a4fd0">ADJOINT_RESIDUAL</a>;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;}</div>
<div class="ttc" id="namespacelibMesh_html_a370493a82a7f09613a0fdc56fc7912b7aa905ae40b37d21c9bac957364d3a4fd0"><div class="ttname"><a href="namespacelibMesh.html#a370493a82a7f09613a0fdc56fc7912b7aa905ae40b37d21c9bac957364d3a4fd0">libMesh::ADJOINT_RESIDUAL</a></div><div class="ttdef"><b>Definition:</b> <a href="enum__error__estimator__type_8h_source.html#l00036">enum_error_estimator_type.h:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">类成员变量说明</h2>
<a class="anchor" id="a1e1d0928ffa681b2285cedc2dfc6575e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classlibMesh_1_1ErrorEstimator.html">ErrorEstimator</a>&gt; libMesh::AdjointResidualErrorEstimator::_dual_error_estimator</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>An error estimator for the adjoint problem. </p>

<p>在文件 <a class="el" href="adjoint__residual__error__estimator_8h_source.html">adjoint_residual_error_estimator.h</a> 第 <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00133">133</a> 行定义.</p>

<p>参考自 <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00083">dual_error_estimator()</a> , 以及 <a class="el" href="adjoint__residual__error__estimator_8C_source.html#l00061">estimate_error()</a>.</p>

</div>
</div>
<a class="anchor" id="a3e34dc73ee9e57e02b6204c5bdf72582"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt;<a class="el" href="classlibMesh_1_1ErrorEstimator.html">ErrorEstimator</a>&gt; libMesh::AdjointResidualErrorEstimator::_primal_error_estimator</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>An error estimator for the forward problem. </p>

<p>在文件 <a class="el" href="adjoint__residual__error__estimator_8h_source.html">adjoint_residual_error_estimator.h</a> 第 <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00128">128</a> 行定义.</p>

<p>参考自 <a class="el" href="adjoint__residual__error__estimator_8C_source.html#l00061">estimate_error()</a> , 以及 <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00077">primal_error_estimator()</a>.</p>

</div>
</div>
<a class="anchor" id="a4d04cafa87de4f7aa6ad7bac316a7a39"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1QoISet.html">QoISet</a> libMesh::AdjointResidualErrorEstimator::_qoi_set</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A <a class="el" href="classlibMesh_1_1QoISet.html" title="Data structure for specifying which Quantities of Interest should be calculated in an adjoint or a pa...">QoISet</a> to handle cases with multiple QoIs available. </p>

<p>在文件 <a class="el" href="adjoint__residual__error__estimator_8h_source.html">adjoint_residual_error_estimator.h</a> 第 <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00138">138</a> 行定义.</p>

<p>参考自 <a class="el" href="adjoint__residual__error__estimator_8C_source.html#l00061">estimate_error()</a> , 以及 <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00089">qoi_set()</a>.</p>

</div>
</div>
<a class="anchor" id="a9d626496b0b6f99f679c4ef4f0a5e46e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classlibMesh_1_1SystemNorm.html">SystemNorm</a> libMesh::ErrorEstimator::error_norm</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>When estimating the error in a single system, the <code>error_norm</code> is used to control the scaling and norm choice for each variable. </p>
<p>Not all estimators will support all norm choices. The default scaling is for all variables to be weighted equally. The default norm choice depends on the error estimator.</p>
<p>Part of this functionality was supported via component_scale and sobolev_order in older <a class="el" href="namespacelibMesh.html" title="The libMesh namespace provides an interface to certain functionality in the library. ">libMesh</a> versions, and a small part was supported via component_mask in even older versions. Hopefully the encapsulation here will allow us to avoid changing this API again. </p>

<p>在文件 <a class="el" href="error__estimator_8h_source.html">error_estimator.h</a> 第 <a class="el" href="error__estimator_8h_source.html#l00158">158</a> 行定义.</p>

<p>参考自 <a class="el" href="uniform__refinement__estimator_8C_source.html#l00119">libMesh::UniformRefinementEstimator::_estimate_error()</a>, <a class="el" href="adjoint__refinement__estimator_8C_source.html#l00073">libMesh::AdjointRefinementEstimator::AdjointRefinementEstimator()</a>, <a class="el" href="discontinuity__measure_8C_source.html#l00129">libMesh::DiscontinuityMeasure::boundary_side_integration()</a>, <a class="el" href="kelly__error__estimator_8C_source.html#l00135">libMesh::KellyErrorEstimator::boundary_side_integration()</a>, <a class="el" href="discontinuity__measure_8C_source.html#l00041">libMesh::DiscontinuityMeasure::DiscontinuityMeasure()</a>, <a class="el" href="jump__error__estimator_8C_source.html#l00056">libMesh::JumpErrorEstimator::estimate_error()</a>, <a class="el" href="adjoint__residual__error__estimator_8C_source.html#l00061">estimate_error()</a>, <a class="el" href="exact__error__estimator_8C_source.html#l00188">libMesh::ExactErrorEstimator::estimate_error()</a>, <a class="el" href="error__estimator_8C_source.html#l00047">libMesh::ErrorEstimator::estimate_errors()</a>, <a class="el" href="exact__error__estimator_8C_source.html#l00049">libMesh::ExactErrorEstimator::ExactErrorEstimator()</a>, <a class="el" href="exact__error__estimator_8C_source.html#l00402">libMesh::ExactErrorEstimator::find_squared_element_error()</a>, <a class="el" href="fourth__error__estimators_8C_source.html#l00063">libMesh::LaplacianErrorEstimator::init_context()</a>, <a class="el" href="discontinuity__measure_8C_source.html#l00059">libMesh::DiscontinuityMeasure::init_context()</a>, <a class="el" href="kelly__error__estimator_8C_source.html#l00059">libMesh::KellyErrorEstimator::init_context()</a>, <a class="el" href="fourth__error__estimators_8C_source.html#l00090">libMesh::LaplacianErrorEstimator::internal_side_integration()</a>, <a class="el" href="discontinuity__measure_8C_source.html#l00086">libMesh::DiscontinuityMeasure::internal_side_integration()</a>, <a class="el" href="kelly__error__estimator_8C_source.html#l00090">libMesh::KellyErrorEstimator::internal_side_integration()</a>, <a class="el" href="kelly__error__estimator_8C_source.html#l00041">libMesh::KellyErrorEstimator::KellyErrorEstimator()</a>, <a class="el" href="fourth__error__estimators_8C_source.html#l00046">libMesh::LaplacianErrorEstimator::LaplacianErrorEstimator()</a>, <a class="el" href="weighted__patch__recovery__error__estimator_8C_source.html#l00112">libMesh::WeightedPatchRecoveryErrorEstimator::EstimateError::operator()()</a>, <a class="el" href="patch__recovery__error__estimator_8C_source.html#l00211">libMesh::PatchRecoveryErrorEstimator::EstimateError::operator()()</a>, <a class="el" href="patch__recovery__error__estimator_8C_source.html#l00065">libMesh::PatchRecoveryErrorEstimator::PatchRecoveryErrorEstimator()</a>, <a class="el" href="jump__error__estimator_8C_source.html#l00450">libMesh::JumpErrorEstimator::reinit_sides()</a> , 以及 <a class="el" href="uniform__refinement__estimator_8C_source.html#l00054">libMesh::UniformRefinementEstimator::UniformRefinementEstimator()</a>.</p>

</div>
</div>
<a class="anchor" id="a40755ebde43be4598a02b45e4f1196d4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string libMesh::AdjointResidualErrorEstimator::error_plot_suffix</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>To aid in investigating error estimator behavior, set this string to a suffix with which to plot (prefixed by "primal_" or "dual_") the subestimator results. </p>
<p>The suffix should end with a file extension (e.g. ".gmv") that the <a class="el" href="classlibMesh_1_1ErrorVector.html#af42a70293b724817dd9c282642eb354c" title="Plots a data file, of a type determined by looking at the file extension in filename, of the error values on the active elements of mesh. ">ErrorVector::plot_error</a> recognizes. </p>

<p>在文件 <a class="el" href="adjoint__residual__error__estimator_8h_source.html">adjoint_residual_error_estimator.h</a> 第 <a class="el" href="adjoint__residual__error__estimator_8h_source.html#l00104">104</a> 行定义.</p>

<p>参考自 <a class="el" href="adjoint__residual__error__estimator_8C_source.html#l00061">estimate_error()</a>.</p>

</div>
</div>
<hr/>该类的文档由以下文件生成:<ul>
<li>/home/lwz/libmesh/include/error_estimation/<a class="el" href="adjoint__residual__error__estimator_8h_source.html">adjoint_residual_error_estimator.h</a></li>
<li>/home/lwz/libmesh/src/error_estimation/<a class="el" href="adjoint__residual__error__estimator_8C_source.html">adjoint_residual_error_estimator.C</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
生成于 2023年 十二月 20日 星期三 12:09:08 , 为 libmesh解析使用  &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
